(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function Ua(e,t){const n=Object.create(null),i=e.split(",");for(let r=0;r<i.length;r++)n[i[r]]=!0;return t?r=>!!n[r.toLowerCase()]:r=>!!n[r]}const Kd="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Hd=Ua(Kd);function iu(e){return!!e||e===""}function Dn(e){if(gt(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],r=Zt(i)?$d(i):Dn(i);if(r)for(const s in r)t[s]=r[s]}return t}else{if(Zt(e))return e;if(Ft(e))return e}}const jd=/;(?![^(]*\))/g,Vd=/:(.+)/;function $d(e){const t={};return e.split(jd).forEach(n=>{if(n){const i=n.split(Vd);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function Wa(e){let t="";if(Zt(e))t=e;else if(gt(e))for(let n=0;n<e.length;n++){const i=Wa(e[n]);i&&(t+=i+" ")}else if(Ft(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function Gd(e,t){if(e.length!==t.length)return!1;let n=!0;for(let i=0;n&&i<e.length;i++)n=mr(e[i],t[i]);return n}function mr(e,t){if(e===t)return!0;let n=Wo(e),i=Wo(t);if(n||i)return n&&i?e.getTime()===t.getTime():!1;if(n=qi(e),i=qi(t),n||i)return e===t;if(n=gt(e),i=gt(t),n||i)return n&&i?Gd(e,t):!1;if(n=Ft(e),i=Ft(t),n||i){if(!n||!i)return!1;const r=Object.keys(e).length,s=Object.keys(t).length;if(r!==s)return!1;for(const a in e){const o=e.hasOwnProperty(a),l=t.hasOwnProperty(a);if(o&&!l||!o&&l||!mr(e[a],t[a]))return!1}}return String(e)===String(t)}function Ka(e,t){return e.findIndex(n=>mr(n,t))}const mt=e=>Zt(e)?e:e==null?"":gt(e)||Ft(e)&&(e.toString===au||!bt(e.toString))?JSON.stringify(e,ru,2):String(e),ru=(e,t)=>t&&t.__v_isRef?ru(e,t.value):fi(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[i,r])=>(n[`${i} =>`]=r,n),{})}:Li(t)?{[`Set(${t.size})`]:[...t.values()]}:Ft(t)&&!gt(t)&&!ou(t)?String(t):t,kt={},ui=[],Oe=()=>{},zd=()=>!1,Yd=/^on[^a-z]/,hs=e=>Yd.test(e),Ha=e=>e.startsWith("onUpdate:"),Jt=Object.assign,ja=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},Xd=Object.prototype.hasOwnProperty,Dt=(e,t)=>Xd.call(e,t),gt=Array.isArray,fi=e=>pr(e)==="[object Map]",Li=e=>pr(e)==="[object Set]",Wo=e=>pr(e)==="[object Date]",bt=e=>typeof e=="function",Zt=e=>typeof e=="string",qi=e=>typeof e=="symbol",Ft=e=>e!==null&&typeof e=="object",su=e=>Ft(e)&&bt(e.then)&&bt(e.catch),au=Object.prototype.toString,pr=e=>au.call(e),Qd=e=>pr(e).slice(8,-1),ou=e=>pr(e)==="[object Object]",Va=e=>Zt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Hr=Ua(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),gs=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Jd=/-(\w)/g,mi=gs(e=>e.replace(Jd,(t,n)=>n?n.toUpperCase():"")),Zd=/\B([A-Z])/g,ni=gs(e=>e.replace(Zd,"-$1").toLowerCase()),lu=gs(e=>e.charAt(0).toUpperCase()+e.slice(1)),Vs=gs(e=>e?`on${lu(e)}`:""),tr=(e,t)=>!Object.is(e,t),jr=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},Qr=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},er=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Ko;const qd=()=>Ko||(Ko=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let We;class th{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&We&&(this.parent=We,this.index=(We.scopes||(We.scopes=[])).push(this)-1)}run(t){if(this.active){const n=We;try{return We=this,t()}finally{We=n}}}on(){We=this}off(){We=this.parent}stop(t){if(this.active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(this.parent&&!t){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.active=!1}}}function eh(e,t=We){t&&t.active&&t.effects.push(e)}const $a=e=>{const t=new Set(e);return t.w=0,t.n=0,t},cu=e=>(e.w&An)>0,uu=e=>(e.n&An)>0,nh=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=An},ih=e=>{const{deps:t}=e;if(t.length){let n=0;for(let i=0;i<t.length;i++){const r=t[i];cu(r)&&!uu(r)?r.delete(e):t[n++]=r,r.w&=~An,r.n&=~An}t.length=n}},fa=new WeakMap;let Ki=0,An=1;const da=30;let Le;const Xn=Symbol(""),ha=Symbol("");class Ga{constructor(t,n=null,i){this.fn=t,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,eh(this,i)}run(){if(!this.active)return this.fn();let t=Le,n=_n;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Le,Le=this,_n=!0,An=1<<++Ki,Ki<=da?nh(this):Ho(this),this.fn()}finally{Ki<=da&&ih(this),An=1<<--Ki,Le=this.parent,_n=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Le===this?this.deferStop=!0:this.active&&(Ho(this),this.onStop&&this.onStop(),this.active=!1)}}function Ho(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let _n=!0;const fu=[];function Di(){fu.push(_n),_n=!1}function Ai(){const e=fu.pop();_n=e===void 0?!0:e}function ve(e,t,n){if(_n&&Le){let i=fa.get(e);i||fa.set(e,i=new Map);let r=i.get(n);r||i.set(n,r=$a()),du(r)}}function du(e,t){let n=!1;Ki<=da?uu(e)||(e.n|=An,n=!cu(e)):n=!e.has(Le),n&&(e.add(Le),Le.deps.push(e))}function un(e,t,n,i,r,s){const a=fa.get(e);if(!a)return;let o=[];if(t==="clear")o=[...a.values()];else if(n==="length"&&gt(e))a.forEach((l,c)=>{(c==="length"||c>=i)&&o.push(l)});else switch(n!==void 0&&o.push(a.get(n)),t){case"add":gt(e)?Va(n)&&o.push(a.get("length")):(o.push(a.get(Xn)),fi(e)&&o.push(a.get(ha)));break;case"delete":gt(e)||(o.push(a.get(Xn)),fi(e)&&o.push(a.get(ha)));break;case"set":fi(e)&&o.push(a.get(Xn));break}if(o.length===1)o[0]&&ga(o[0]);else{const l=[];for(const c of o)c&&l.push(...c);ga($a(l))}}function ga(e,t){const n=gt(e)?e:[...e];for(const i of n)i.computed&&jo(i);for(const i of n)i.computed||jo(i)}function jo(e,t){(e!==Le||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const rh=Ua("__proto__,__v_isRef,__isVue"),hu=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(qi)),sh=za(),ah=za(!1,!0),oh=za(!0),Vo=lh();function lh(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...n){const i=Mt(this);for(let s=0,a=this.length;s<a;s++)ve(i,"get",s+"");const r=i[t](...n);return r===-1||r===!1?i[t](...n.map(Mt)):r}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...n){Di();const i=Mt(this)[t].apply(this,n);return Ai(),i}}),e}function za(e=!1,t=!1){return function(i,r,s){if(r==="__v_isReactive")return!e;if(r==="__v_isReadonly")return e;if(r==="__v_isShallow")return t;if(r==="__v_raw"&&s===(e?t?Sh:yu:t?pu:mu).get(i))return i;const a=gt(i);if(!e&&a&&Dt(Vo,r))return Reflect.get(Vo,r,s);const o=Reflect.get(i,r,s);return(qi(r)?hu.has(r):rh(r))||(e||ve(i,"get",r),t)?o:se(o)?a&&Va(r)?o:o.value:Ft(o)?e?Eu(o):yr(o):o}}const ch=gu(),uh=gu(!0);function gu(e=!1){return function(n,i,r,s){let a=n[i];if(pi(a)&&se(a)&&!se(r))return!1;if(!e&&(!Jr(r)&&!pi(r)&&(a=Mt(a),r=Mt(r)),!gt(n)&&se(a)&&!se(r)))return a.value=r,!0;const o=gt(n)&&Va(i)?Number(i)<n.length:Dt(n,i),l=Reflect.set(n,i,r,s);return n===Mt(s)&&(o?tr(r,a)&&un(n,"set",i,r):un(n,"add",i,r)),l}}function fh(e,t){const n=Dt(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&n&&un(e,"delete",t,void 0),i}function dh(e,t){const n=Reflect.has(e,t);return(!qi(t)||!hu.has(t))&&ve(e,"has",t),n}function hh(e){return ve(e,"iterate",gt(e)?"length":Xn),Reflect.ownKeys(e)}const vu={get:sh,set:ch,deleteProperty:fh,has:dh,ownKeys:hh},gh={get:oh,set(e,t){return!0},deleteProperty(e,t){return!0}},vh=Jt({},vu,{get:ah,set:uh}),Ya=e=>e,vs=e=>Reflect.getPrototypeOf(e);function Lr(e,t,n=!1,i=!1){e=e.__v_raw;const r=Mt(e),s=Mt(t);n||(t!==s&&ve(r,"get",t),ve(r,"get",s));const{has:a}=vs(r),o=i?Ya:n?Ja:nr;if(a.call(r,t))return o(e.get(t));if(a.call(r,s))return o(e.get(s));e!==r&&e.get(t)}function Dr(e,t=!1){const n=this.__v_raw,i=Mt(n),r=Mt(e);return t||(e!==r&&ve(i,"has",e),ve(i,"has",r)),e===r?n.has(e):n.has(e)||n.has(r)}function Ar(e,t=!1){return e=e.__v_raw,!t&&ve(Mt(e),"iterate",Xn),Reflect.get(e,"size",e)}function $o(e){e=Mt(e);const t=Mt(this);return vs(t).has.call(t,e)||(t.add(e),un(t,"add",e,e)),this}function Go(e,t){t=Mt(t);const n=Mt(this),{has:i,get:r}=vs(n);let s=i.call(n,e);s||(e=Mt(e),s=i.call(n,e));const a=r.call(n,e);return n.set(e,t),s?tr(t,a)&&un(n,"set",e,t):un(n,"add",e,t),this}function zo(e){const t=Mt(this),{has:n,get:i}=vs(t);let r=n.call(t,e);r||(e=Mt(e),r=n.call(t,e)),i&&i.call(t,e);const s=t.delete(e);return r&&un(t,"delete",e,void 0),s}function Yo(){const e=Mt(this),t=e.size!==0,n=e.clear();return t&&un(e,"clear",void 0,void 0),n}function Cr(e,t){return function(i,r){const s=this,a=s.__v_raw,o=Mt(a),l=t?Ya:e?Ja:nr;return!e&&ve(o,"iterate",Xn),a.forEach((c,u)=>i.call(r,l(c),l(u),s))}}function Mr(e,t,n){return function(...i){const r=this.__v_raw,s=Mt(r),a=fi(s),o=e==="entries"||e===Symbol.iterator&&a,l=e==="keys"&&a,c=r[e](...i),u=n?Ya:t?Ja:nr;return!t&&ve(s,"iterate",l?ha:Xn),{next(){const{value:h,done:d}=c.next();return d?{value:h,done:d}:{value:o?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function dn(e){return function(...t){return e==="delete"?!1:this}}function mh(){const e={get(s){return Lr(this,s)},get size(){return Ar(this)},has:Dr,add:$o,set:Go,delete:zo,clear:Yo,forEach:Cr(!1,!1)},t={get(s){return Lr(this,s,!1,!0)},get size(){return Ar(this)},has:Dr,add:$o,set:Go,delete:zo,clear:Yo,forEach:Cr(!1,!0)},n={get(s){return Lr(this,s,!0)},get size(){return Ar(this,!0)},has(s){return Dr.call(this,s,!0)},add:dn("add"),set:dn("set"),delete:dn("delete"),clear:dn("clear"),forEach:Cr(!0,!1)},i={get(s){return Lr(this,s,!0,!0)},get size(){return Ar(this,!0)},has(s){return Dr.call(this,s,!0)},add:dn("add"),set:dn("set"),delete:dn("delete"),clear:dn("clear"),forEach:Cr(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{e[s]=Mr(s,!1,!1),n[s]=Mr(s,!0,!1),t[s]=Mr(s,!1,!0),i[s]=Mr(s,!0,!0)}),[e,n,t,i]}const[ph,yh,Eh,xh]=mh();function Xa(e,t){const n=t?e?xh:Eh:e?yh:ph;return(i,r,s)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?i:Reflect.get(Dt(n,r)&&r in i?n:i,r,s)}const bh={get:Xa(!1,!1)},Th={get:Xa(!1,!0)},_h={get:Xa(!0,!1)},mu=new WeakMap,pu=new WeakMap,yu=new WeakMap,Sh=new WeakMap;function Lh(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Dh(e){return e.__v_skip||!Object.isExtensible(e)?0:Lh(Qd(e))}function yr(e){return pi(e)?e:Qa(e,!1,vu,bh,mu)}function Ah(e){return Qa(e,!1,vh,Th,pu)}function Eu(e){return Qa(e,!0,gh,_h,yu)}function Qa(e,t,n,i,r){if(!Ft(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const s=r.get(e);if(s)return s;const a=Dh(e);if(a===0)return e;const o=new Proxy(e,a===2?i:n);return r.set(e,o),o}function di(e){return pi(e)?di(e.__v_raw):!!(e&&e.__v_isReactive)}function pi(e){return!!(e&&e.__v_isReadonly)}function Jr(e){return!!(e&&e.__v_isShallow)}function xu(e){return di(e)||pi(e)}function Mt(e){const t=e&&e.__v_raw;return t?Mt(t):e}function bu(e){return Qr(e,"__v_skip",!0),e}const nr=e=>Ft(e)?yr(e):e,Ja=e=>Ft(e)?Eu(e):e;function Tu(e){_n&&Le&&(e=Mt(e),du(e.dep||(e.dep=$a())))}function _u(e,t){e=Mt(e),e.dep&&ga(e.dep)}function se(e){return!!(e&&e.__v_isRef===!0)}function at(e){return Su(e,!1)}function Ch(e){return Su(e,!0)}function Su(e,t){return se(e)?e:new Mh(e,t)}class Mh{constructor(t,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?t:Mt(t),this._value=n?t:nr(t)}get value(){return Tu(this),this._value}set value(t){const n=this.__v_isShallow||Jr(t)||pi(t);t=n?t:Mt(t),tr(t,this._rawValue)&&(this._rawValue=t,this._value=n?t:nr(t),_u(this))}}function ht(e){return se(e)?e.value:e}const Oh={get:(e,t,n)=>ht(Reflect.get(e,t,n)),set:(e,t,n,i)=>{const r=e[t];return se(r)&&!se(n)?(r.value=n,!0):Reflect.set(e,t,n,i)}};function Lu(e){return di(e)?e:new Proxy(e,Oh)}var Du;class Ph{constructor(t,n,i,r){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this[Du]=!1,this._dirty=!0,this.effect=new Ga(t,()=>{this._dirty||(this._dirty=!0,_u(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=i}get value(){const t=Mt(this);return Tu(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}Du="__v_isReadonly";function Rh(e,t,n=!1){let i,r;const s=bt(e);return s?(i=e,r=Oe):(i=e.get,r=e.set),new Ph(i,r,s||!r,n)}function Sn(e,t,n,i){let r;try{r=i?e(...i):e()}catch(s){ms(s,t,n)}return r}function Te(e,t,n,i){if(bt(e)){const s=Sn(e,t,n,i);return s&&su(s)&&s.catch(a=>{ms(a,t,n)}),s}const r=[];for(let s=0;s<e.length;s++)r.push(Te(e[s],t,n,i));return r}function ms(e,t,n,i=!0){const r=t?t.vnode:null;if(t){let s=t.parent;const a=t.proxy,o=n;for(;s;){const c=s.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](e,a,o)===!1)return}s=s.parent}const l=t.appContext.config.errorHandler;if(l){Sn(l,null,10,[e,a,o]);return}}Ih(e,n,r,i)}function Ih(e,t,n,i=!0){console.error(e)}let ir=!1,va=!1;const re=[];let je=0;const hi=[];let sn=null,$n=0;const Au=Promise.resolve();let Za=null;function qa(e){const t=Za||Au;return e?t.then(this?e.bind(this):e):t}function wh(e){let t=je+1,n=re.length;for(;t<n;){const i=t+n>>>1;rr(re[i])<e?t=i+1:n=i}return t}function to(e){(!re.length||!re.includes(e,ir&&e.allowRecurse?je+1:je))&&(e.id==null?re.push(e):re.splice(wh(e.id),0,e),Cu())}function Cu(){!ir&&!va&&(va=!0,Za=Au.then(Ou))}function kh(e){const t=re.indexOf(e);t>je&&re.splice(t,1)}function Fh(e){gt(e)?hi.push(...e):(!sn||!sn.includes(e,e.allowRecurse?$n+1:$n))&&hi.push(e),Cu()}function Xo(e,t=ir?je+1:0){for(;t<re.length;t++){const n=re[t];n&&n.pre&&(re.splice(t,1),t--,n())}}function Mu(e){if(hi.length){const t=[...new Set(hi)];if(hi.length=0,sn){sn.push(...t);return}for(sn=t,sn.sort((n,i)=>rr(n)-rr(i)),$n=0;$n<sn.length;$n++)sn[$n]();sn=null,$n=0}}const rr=e=>e.id==null?1/0:e.id,Bh=(e,t)=>{const n=rr(e)-rr(t);if(n===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return n};function Ou(e){va=!1,ir=!0,re.sort(Bh);const t=Oe;try{for(je=0;je<re.length;je++){const n=re[je];n&&n.active!==!1&&Sn(n,null,14)}}finally{je=0,re.length=0,Mu(),ir=!1,Za=null,(re.length||hi.length)&&Ou()}}function Nh(e,t,...n){if(e.isUnmounted)return;const i=e.vnode.props||kt;let r=n;const s=t.startsWith("update:"),a=s&&t.slice(7);if(a&&a in i){const u=`${a==="modelValue"?"model":a}Modifiers`,{number:h,trim:d}=i[u]||kt;d&&(r=n.map(y=>y.trim())),h&&(r=n.map(er))}let o,l=i[o=Vs(t)]||i[o=Vs(mi(t))];!l&&s&&(l=i[o=Vs(ni(t))]),l&&Te(l,e,6,r);const c=i[o+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,Te(c,e,6,r)}}function Pu(e,t,n=!1){const i=t.emitsCache,r=i.get(e);if(r!==void 0)return r;const s=e.emits;let a={},o=!1;if(!bt(e)){const l=c=>{const u=Pu(c,t,!0);u&&(o=!0,Jt(a,u))};!n&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!s&&!o?(Ft(e)&&i.set(e,null),null):(gt(s)?s.forEach(l=>a[l]=null):Jt(a,s),Ft(e)&&i.set(e,a),a)}function ps(e,t){return!e||!hs(t)?!1:(t=t.slice(2).replace(/Once$/,""),Dt(e,t[0].toLowerCase()+t.slice(1))||Dt(e,ni(t))||Dt(e,t))}let Ae=null,ys=null;function Zr(e){const t=Ae;return Ae=e,ys=e&&e.type.__scopeId||null,t}function Xe(e){ys=e}function Qe(){ys=null}function Qn(e,t=Ae,n){if(!t||e._n)return e;const i=(...r)=>{i._d&&sl(-1);const s=Zr(t),a=e(...r);return Zr(s),i._d&&sl(1),a};return i._n=!0,i._c=!0,i._d=!0,i}function $s(e){const{type:t,vnode:n,proxy:i,withProxy:r,props:s,propsOptions:[a],slots:o,attrs:l,emit:c,render:u,renderCache:h,data:d,setupState:y,ctx:x,inheritAttrs:D}=e;let S,L;const g=Zr(e);try{if(n.shapeFlag&4){const E=r||i;S=He(u.call(E,E,h,s,y,d,x)),L=l}else{const E=t;S=He(E.length>1?E(s,{attrs:l,slots:o,emit:c}):E(s,null)),L=t.props?l:Uh(l)}}catch(E){$i.length=0,ms(E,e,1),S=pt(Re)}let f=S;if(L&&D!==!1){const E=Object.keys(L),{shapeFlag:_}=f;E.length&&_&7&&(a&&E.some(Ha)&&(L=Wh(L,a)),f=Cn(f,L))}return n.dirs&&(f=Cn(f),f.dirs=f.dirs?f.dirs.concat(n.dirs):n.dirs),n.transition&&(f.transition=n.transition),S=f,Zr(g),S}const Uh=e=>{let t;for(const n in e)(n==="class"||n==="style"||hs(n))&&((t||(t={}))[n]=e[n]);return t},Wh=(e,t)=>{const n={};for(const i in e)(!Ha(i)||!(i.slice(9)in t))&&(n[i]=e[i]);return n};function Kh(e,t,n){const{props:i,children:r,component:s}=e,{props:a,children:o,patchFlag:l}=t,c=s.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?Qo(i,a,c):!!a;if(l&8){const u=t.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(a[d]!==i[d]&&!ps(c,d))return!0}}}else return(r||o)&&(!o||!o.$stable)?!0:i===a?!1:i?a?Qo(i,a,c):!0:!!a;return!1}function Qo(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(t[s]!==e[s]&&!ps(n,s))return!0}return!1}function Hh({vnode:e,parent:t},n){for(;t&&t.subTree===e;)(e=t.vnode).el=n,t=t.parent}const jh=e=>e.__isSuspense;function Vh(e,t){t&&t.pendingBranch?gt(e)?t.effects.push(...e):t.effects.push(e):Fh(e)}function Vr(e,t){if(qt){let n=qt.provides;const i=qt.parent&&qt.parent.provides;i===n&&(n=qt.provides=Object.create(i)),n[e]=t}}function Ge(e,t,n=!1){const i=qt||Ae;if(i){const r=i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides;if(r&&e in r)return r[e];if(arguments.length>1)return n&&bt(t)?t.call(i.proxy):t}}const Jo={};function Pe(e,t,n){return Ru(e,t,n)}function Ru(e,t,{immediate:n,deep:i,flush:r,onTrack:s,onTrigger:a}=kt){const o=qt;let l,c=!1,u=!1;if(se(e)?(l=()=>e.value,c=Jr(e)):di(e)?(l=()=>e,i=!0):gt(e)?(u=!0,c=e.some(L=>di(L)||Jr(L)),l=()=>e.map(L=>{if(se(L))return L.value;if(di(L))return Yn(L);if(bt(L))return Sn(L,o,2)})):bt(e)?t?l=()=>Sn(e,o,2):l=()=>{if(!(o&&o.isUnmounted))return h&&h(),Te(e,o,3,[d])}:l=Oe,t&&i){const L=l;l=()=>Yn(L())}let h,d=L=>{h=S.onStop=()=>{Sn(L,o,4)}};if(lr)return d=Oe,t?n&&Te(t,o,3,[l(),u?[]:void 0,d]):l(),Oe;let y=u?[]:Jo;const x=()=>{if(!!S.active)if(t){const L=S.run();(i||c||(u?L.some((g,f)=>tr(g,y[f])):tr(L,y)))&&(h&&h(),Te(t,o,3,[L,y===Jo?void 0:y,d]),y=L)}else S.run()};x.allowRecurse=!!t;let D;r==="sync"?D=x:r==="post"?D=()=>ue(x,o&&o.suspense):(x.pre=!0,o&&(x.id=o.uid),D=()=>to(x));const S=new Ga(l,D);return t?n?x():y=S.run():r==="post"?ue(S.run.bind(S),o&&o.suspense):S.run(),()=>{S.stop(),o&&o.scope&&ja(o.scope.effects,S)}}function $h(e,t,n){const i=this.proxy,r=Zt(e)?e.includes(".")?Iu(i,e):()=>i[e]:e.bind(i,i);let s;bt(t)?s=t:(s=t.handler,n=t);const a=qt;yi(this);const o=Ru(r,s.bind(i),n);return a?yi(a):Jn(),o}function Iu(e,t){const n=t.split(".");return()=>{let i=e;for(let r=0;r<n.length&&i;r++)i=i[n[r]];return i}}function Yn(e,t){if(!Ft(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),se(e))Yn(e.value,t);else if(gt(e))for(let n=0;n<e.length;n++)Yn(e[n],t);else if(Li(e)||fi(e))e.forEach(n=>{Yn(n,t)});else if(ou(e))for(const n in e)Yn(e[n],t);return e}function wu(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return he(()=>{e.isMounted=!0}),Wu(()=>{e.isUnmounting=!0}),e}const pe=[Function,Array],Gh={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:pe,onEnter:pe,onAfterEnter:pe,onEnterCancelled:pe,onBeforeLeave:pe,onLeave:pe,onAfterLeave:pe,onLeaveCancelled:pe,onBeforeAppear:pe,onAppear:pe,onAfterAppear:pe,onAppearCancelled:pe},setup(e,{slots:t}){const n=Zu(),i=wu();let r;return()=>{const s=t.default&&eo(t.default(),!0);if(!s||!s.length)return;let a=s[0];if(s.length>1){for(const D of s)if(D.type!==Re){a=D;break}}const o=Mt(e),{mode:l}=o;if(i.isLeaving)return Gs(a);const c=Zo(a);if(!c)return Gs(a);const u=sr(c,o,i,n);ar(c,u);const h=n.subTree,d=h&&Zo(h);let y=!1;const{getTransitionKey:x}=c.type;if(x){const D=x();r===void 0?r=D:D!==r&&(r=D,y=!0)}if(d&&d.type!==Re&&(!Gn(c,d)||y)){const D=sr(d,o,i,n);if(ar(d,D),l==="out-in")return i.isLeaving=!0,D.afterLeave=()=>{i.isLeaving=!1,n.update()},Gs(a);l==="in-out"&&c.type!==Re&&(D.delayLeave=(S,L,g)=>{const f=Fu(i,d);f[String(d.key)]=d,S._leaveCb=()=>{L(),S._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=g})}return a}}},ku=Gh;function Fu(e,t){const{leavingVNodes:n}=e;let i=n.get(t.type);return i||(i=Object.create(null),n.set(t.type,i)),i}function sr(e,t,n,i){const{appear:r,mode:s,persisted:a=!1,onBeforeEnter:o,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:h,onLeave:d,onAfterLeave:y,onLeaveCancelled:x,onBeforeAppear:D,onAppear:S,onAfterAppear:L,onAppearCancelled:g}=t,f=String(e.key),E=Fu(n,e),_=(v,m)=>{v&&Te(v,i,9,m)},C=(v,m)=>{const A=m[1];_(v,m),gt(v)?v.every(b=>b.length<=1)&&A():v.length<=1&&A()},p={mode:s,persisted:a,beforeEnter(v){let m=o;if(!n.isMounted)if(r)m=D||o;else return;v._leaveCb&&v._leaveCb(!0);const A=E[f];A&&Gn(e,A)&&A.el._leaveCb&&A.el._leaveCb(),_(m,[v])},enter(v){let m=l,A=c,b=u;if(!n.isMounted)if(r)m=S||l,A=L||c,b=g||u;else return;let T=!1;const P=v._enterCb=O=>{T||(T=!0,O?_(b,[v]):_(A,[v]),p.delayedLeave&&p.delayedLeave(),v._enterCb=void 0)};m?C(m,[v,P]):P()},leave(v,m){const A=String(e.key);if(v._enterCb&&v._enterCb(!0),n.isUnmounting)return m();_(h,[v]);let b=!1;const T=v._leaveCb=P=>{b||(b=!0,m(),P?_(x,[v]):_(y,[v]),v._leaveCb=void 0,E[A]===e&&delete E[A])};E[A]=e,d?C(d,[v,T]):T()},clone(v){return sr(v,t,n,i)}};return p}function Gs(e){if(Es(e))return e=Cn(e),e.children=null,e}function Zo(e){return Es(e)?e.children?e.children[0]:void 0:e}function ar(e,t){e.shapeFlag&6&&e.component?ar(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function eo(e,t=!1,n){let i=[],r=0;for(let s=0;s<e.length;s++){let a=e[s];const o=n==null?a.key:String(n)+String(a.key!=null?a.key:s);a.type===Rt?(a.patchFlag&128&&r++,i=i.concat(eo(a.children,t,o))):(t||a.type!==Re)&&i.push(o!=null?Cn(a,{key:o}):a)}if(r>1)for(let s=0;s<i.length;s++)i[s].patchFlag=-2;return i}function Bu(e){return bt(e)?{setup:e,name:e.name}:e}const $r=e=>!!e.type.__asyncLoader,Es=e=>e.type.__isKeepAlive;function zh(e,t){Nu(e,"a",t)}function Yh(e,t){Nu(e,"da",t)}function Nu(e,t,n=qt){const i=e.__wdc||(e.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if(xs(t,i,n),n){let r=n.parent;for(;r&&r.parent;)Es(r.parent.vnode)&&Xh(i,t,n,r),r=r.parent}}function Xh(e,t,n,i){const r=xs(t,e,i,!0);Ci(()=>{ja(i[t],r)},n)}function xs(e,t,n=qt,i=!1){if(n){const r=n[e]||(n[e]=[]),s=t.__weh||(t.__weh=(...a)=>{if(n.isUnmounted)return;Di(),yi(n);const o=Te(t,n,e,a);return Jn(),Ai(),o});return i?r.unshift(s):r.push(s),s}}const fn=e=>(t,n=qt)=>(!lr||e==="sp")&&xs(e,t,n),Qh=fn("bm"),he=fn("m"),Jh=fn("bu"),Uu=fn("u"),Wu=fn("bum"),Ci=fn("um"),Zh=fn("sp"),qh=fn("rtg"),tg=fn("rtc");function eg(e,t=qt){xs("ec",e,t)}function zt(e,t){const n=Ae;if(n===null)return e;const i=Ts(n)||n.proxy,r=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[a,o,l,c=kt]=t[s];bt(a)&&(a={mounted:a,updated:a}),a.deep&&Yn(o),r.push({dir:a,instance:i,value:o,oldValue:void 0,arg:l,modifiers:c})}return e}function Fn(e,t,n,i){const r=e.dirs,s=t&&t.dirs;for(let a=0;a<r.length;a++){const o=r[a];s&&(o.oldValue=s[a].value);let l=o.dir[i];l&&(Di(),Te(l,n,8,[e.el,o,e,t]),Ai())}}const ng=Symbol();function ze(e,t,n,i){let r;const s=n&&n[i];if(gt(e)||Zt(e)){r=new Array(e.length);for(let a=0,o=e.length;a<o;a++)r[a]=t(e[a],a,void 0,s&&s[a])}else if(typeof e=="number"){r=new Array(e);for(let a=0;a<e;a++)r[a]=t(a+1,a,void 0,s&&s[a])}else if(Ft(e))if(e[Symbol.iterator])r=Array.from(e,(a,o)=>t(a,o,void 0,s&&s[o]));else{const a=Object.keys(e);r=new Array(a.length);for(let o=0,l=a.length;o<l;o++){const c=a[o];r[o]=t(e[c],c,o,s&&s[o])}}else r=[];return n&&(n[i]=r),r}const ma=e=>e?qu(e)?Ts(e)||e.proxy:ma(e.parent):null,qr=Jt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>ma(e.parent),$root:e=>ma(e.root),$emit:e=>e.emit,$options:e=>no(e),$forceUpdate:e=>e.f||(e.f=()=>to(e.update)),$nextTick:e=>e.n||(e.n=qa.bind(e.proxy)),$watch:e=>$h.bind(e)}),ig={get({_:e},t){const{ctx:n,setupState:i,data:r,props:s,accessCache:a,type:o,appContext:l}=e;let c;if(t[0]!=="$"){const y=a[t];if(y!==void 0)switch(y){case 1:return i[t];case 2:return r[t];case 4:return n[t];case 3:return s[t]}else{if(i!==kt&&Dt(i,t))return a[t]=1,i[t];if(r!==kt&&Dt(r,t))return a[t]=2,r[t];if((c=e.propsOptions[0])&&Dt(c,t))return a[t]=3,s[t];if(n!==kt&&Dt(n,t))return a[t]=4,n[t];pa&&(a[t]=0)}}const u=qr[t];let h,d;if(u)return t==="$attrs"&&ve(e,"get",t),u(e);if((h=o.__cssModules)&&(h=h[t]))return h;if(n!==kt&&Dt(n,t))return a[t]=4,n[t];if(d=l.config.globalProperties,Dt(d,t))return d[t]},set({_:e},t,n){const{data:i,setupState:r,ctx:s}=e;return r!==kt&&Dt(r,t)?(r[t]=n,!0):i!==kt&&Dt(i,t)?(i[t]=n,!0):Dt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(s[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:r,propsOptions:s}},a){let o;return!!n[a]||e!==kt&&Dt(e,a)||t!==kt&&Dt(t,a)||(o=s[0])&&Dt(o,a)||Dt(i,a)||Dt(qr,a)||Dt(r.config.globalProperties,a)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:Dt(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};let pa=!0;function rg(e){const t=no(e),n=e.proxy,i=e.ctx;pa=!1,t.beforeCreate&&qo(t.beforeCreate,e,"bc");const{data:r,computed:s,methods:a,watch:o,provide:l,inject:c,created:u,beforeMount:h,mounted:d,beforeUpdate:y,updated:x,activated:D,deactivated:S,beforeDestroy:L,beforeUnmount:g,destroyed:f,unmounted:E,render:_,renderTracked:C,renderTriggered:p,errorCaptured:v,serverPrefetch:m,expose:A,inheritAttrs:b,components:T,directives:P,filters:O}=t;if(c&&sg(c,i,null,e.appContext.config.unwrapInjectedRef),a)for(const I in a){const w=a[I];bt(w)&&(i[I]=w.bind(n))}if(r){const I=r.call(n,n);Ft(I)&&(e.data=yr(I))}if(pa=!0,s)for(const I in s){const w=s[I],k=bt(w)?w.bind(n,n):bt(w.get)?w.get.bind(n,n):Oe,B=!bt(w)&&bt(w.set)?w.set.bind(n):Oe,F=xe({get:k,set:B});Object.defineProperty(i,I,{enumerable:!0,configurable:!0,get:()=>F.value,set:N=>F.value=N})}if(o)for(const I in o)Ku(o[I],i,n,I);if(l){const I=bt(l)?l.call(n):l;Reflect.ownKeys(I).forEach(w=>{Vr(w,I[w])})}u&&qo(u,e,"c");function R(I,w){gt(w)?w.forEach(k=>I(k.bind(n))):w&&I(w.bind(n))}if(R(Qh,h),R(he,d),R(Jh,y),R(Uu,x),R(zh,D),R(Yh,S),R(eg,v),R(tg,C),R(qh,p),R(Wu,g),R(Ci,E),R(Zh,m),gt(A))if(A.length){const I=e.exposed||(e.exposed={});A.forEach(w=>{Object.defineProperty(I,w,{get:()=>n[w],set:k=>n[w]=k})})}else e.exposed||(e.exposed={});_&&e.render===Oe&&(e.render=_),b!=null&&(e.inheritAttrs=b),T&&(e.components=T),P&&(e.directives=P)}function sg(e,t,n=Oe,i=!1){gt(e)&&(e=ya(e));for(const r in e){const s=e[r];let a;Ft(s)?"default"in s?a=Ge(s.from||r,s.default,!0):a=Ge(s.from||r):a=Ge(s),se(a)&&i?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>a.value,set:o=>a.value=o}):t[r]=a}}function qo(e,t,n){Te(gt(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,n)}function Ku(e,t,n,i){const r=i.includes(".")?Iu(n,i):()=>n[i];if(Zt(e)){const s=t[e];bt(s)&&Pe(r,s)}else if(bt(e))Pe(r,e.bind(n));else if(Ft(e))if(gt(e))e.forEach(s=>Ku(s,t,n,i));else{const s=bt(e.handler)?e.handler.bind(n):t[e.handler];bt(s)&&Pe(r,s,e)}}function no(e){const t=e.type,{mixins:n,extends:i}=t,{mixins:r,optionsCache:s,config:{optionMergeStrategies:a}}=e.appContext,o=s.get(t);let l;return o?l=o:!r.length&&!n&&!i?l=t:(l={},r.length&&r.forEach(c=>ts(l,c,a,!0)),ts(l,t,a)),Ft(t)&&s.set(t,l),l}function ts(e,t,n,i=!1){const{mixins:r,extends:s}=t;s&&ts(e,s,n,!0),r&&r.forEach(a=>ts(e,a,n,!0));for(const a in t)if(!(i&&a==="expose")){const o=ag[a]||n&&n[a];e[a]=o?o(e[a],t[a]):t[a]}return e}const ag={data:tl,props:Hn,emits:Hn,methods:Hn,computed:Hn,beforeCreate:ce,created:ce,beforeMount:ce,mounted:ce,beforeUpdate:ce,updated:ce,beforeDestroy:ce,beforeUnmount:ce,destroyed:ce,unmounted:ce,activated:ce,deactivated:ce,errorCaptured:ce,serverPrefetch:ce,components:Hn,directives:Hn,watch:lg,provide:tl,inject:og};function tl(e,t){return t?e?function(){return Jt(bt(e)?e.call(this,this):e,bt(t)?t.call(this,this):t)}:t:e}function og(e,t){return Hn(ya(e),ya(t))}function ya(e){if(gt(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function ce(e,t){return e?[...new Set([].concat(e,t))]:t}function Hn(e,t){return e?Jt(Jt(Object.create(null),e),t):t}function lg(e,t){if(!e)return t;if(!t)return e;const n=Jt(Object.create(null),e);for(const i in t)n[i]=ce(e[i],t[i]);return n}function cg(e,t,n,i=!1){const r={},s={};Qr(s,bs,1),e.propsDefaults=Object.create(null),Hu(e,t,r,s);for(const a in e.propsOptions[0])a in r||(r[a]=void 0);n?e.props=i?r:Ah(r):e.type.props?e.props=r:e.props=s,e.attrs=s}function ug(e,t,n,i){const{props:r,attrs:s,vnode:{patchFlag:a}}=e,o=Mt(r),[l]=e.propsOptions;let c=!1;if((i||a>0)&&!(a&16)){if(a&8){const u=e.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(ps(e.emitsOptions,d))continue;const y=t[d];if(l)if(Dt(s,d))y!==s[d]&&(s[d]=y,c=!0);else{const x=mi(d);r[x]=Ea(l,o,x,y,e,!1)}else y!==s[d]&&(s[d]=y,c=!0)}}}else{Hu(e,t,r,s)&&(c=!0);let u;for(const h in o)(!t||!Dt(t,h)&&((u=ni(h))===h||!Dt(t,u)))&&(l?n&&(n[h]!==void 0||n[u]!==void 0)&&(r[h]=Ea(l,o,h,void 0,e,!0)):delete r[h]);if(s!==o)for(const h in s)(!t||!Dt(t,h)&&!0)&&(delete s[h],c=!0)}c&&un(e,"set","$attrs")}function Hu(e,t,n,i){const[r,s]=e.propsOptions;let a=!1,o;if(t)for(let l in t){if(Hr(l))continue;const c=t[l];let u;r&&Dt(r,u=mi(l))?!s||!s.includes(u)?n[u]=c:(o||(o={}))[u]=c:ps(e.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,a=!0)}if(s){const l=Mt(n),c=o||kt;for(let u=0;u<s.length;u++){const h=s[u];n[h]=Ea(r,l,h,c[h],e,!Dt(c,h))}}return a}function Ea(e,t,n,i,r,s){const a=e[n];if(a!=null){const o=Dt(a,"default");if(o&&i===void 0){const l=a.default;if(a.type!==Function&&bt(l)){const{propsDefaults:c}=r;n in c?i=c[n]:(yi(r),i=c[n]=l.call(null,t),Jn())}else i=l}a[0]&&(s&&!o?i=!1:a[1]&&(i===""||i===ni(n))&&(i=!0))}return i}function ju(e,t,n=!1){const i=t.propsCache,r=i.get(e);if(r)return r;const s=e.props,a={},o=[];let l=!1;if(!bt(e)){const u=h=>{l=!0;const[d,y]=ju(h,t,!0);Jt(a,d),y&&o.push(...y)};!n&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}if(!s&&!l)return Ft(e)&&i.set(e,ui),ui;if(gt(s))for(let u=0;u<s.length;u++){const h=mi(s[u]);el(h)&&(a[h]=kt)}else if(s)for(const u in s){const h=mi(u);if(el(h)){const d=s[u],y=a[h]=gt(d)||bt(d)?{type:d}:d;if(y){const x=rl(Boolean,y.type),D=rl(String,y.type);y[0]=x>-1,y[1]=D<0||x<D,(x>-1||Dt(y,"default"))&&o.push(h)}}}const c=[a,o];return Ft(e)&&i.set(e,c),c}function el(e){return e[0]!=="$"}function nl(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function il(e,t){return nl(e)===nl(t)}function rl(e,t){return gt(t)?t.findIndex(n=>il(n,e)):bt(t)&&il(t,e)?0:-1}const Vu=e=>e[0]==="_"||e==="$stable",io=e=>gt(e)?e.map(He):[He(e)],fg=(e,t,n)=>{if(t._n)return t;const i=Qn((...r)=>io(t(...r)),n);return i._c=!1,i},$u=(e,t,n)=>{const i=e._ctx;for(const r in e){if(Vu(r))continue;const s=e[r];if(bt(s))t[r]=fg(r,s,i);else if(s!=null){const a=io(s);t[r]=()=>a}}},Gu=(e,t)=>{const n=io(t);e.slots.default=()=>n},dg=(e,t)=>{if(e.vnode.shapeFlag&32){const n=t._;n?(e.slots=Mt(t),Qr(t,"_",n)):$u(t,e.slots={})}else e.slots={},t&&Gu(e,t);Qr(e.slots,bs,1)},hg=(e,t,n)=>{const{vnode:i,slots:r}=e;let s=!0,a=kt;if(i.shapeFlag&32){const o=t._;o?n&&o===1?s=!1:(Jt(r,t),!n&&o===1&&delete r._):(s=!t.$stable,$u(t,r)),a=t}else t&&(Gu(e,t),a={default:1});if(s)for(const o in r)!Vu(o)&&!(o in a)&&delete r[o]};function zu(){return{app:null,config:{isNativeTag:zd,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let gg=0;function vg(e,t){return function(i,r=null){bt(i)||(i=Object.assign({},i)),r!=null&&!Ft(r)&&(r=null);const s=zu(),a=new Set;let o=!1;const l=s.app={_uid:gg++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:Rg,get config(){return s.config},set config(c){},use(c,...u){return a.has(c)||(c&&bt(c.install)?(a.add(c),c.install(l,...u)):bt(c)&&(a.add(c),c(l,...u))),l},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),l},component(c,u){return u?(s.components[c]=u,l):s.components[c]},directive(c,u){return u?(s.directives[c]=u,l):s.directives[c]},mount(c,u,h){if(!o){const d=pt(i,r);return d.appContext=s,u&&t?t(d,c):e(d,c,h),o=!0,l._container=c,c.__vue_app__=l,Ts(d.component)||d.component.proxy}},unmount(){o&&(e(null,l._container),delete l._container.__vue_app__)},provide(c,u){return s.provides[c]=u,l}};return l}}function xa(e,t,n,i,r=!1){if(gt(e)){e.forEach((d,y)=>xa(d,t&&(gt(t)?t[y]:t),n,i,r));return}if($r(i)&&!r)return;const s=i.shapeFlag&4?Ts(i.component)||i.component.proxy:i.el,a=r?null:s,{i:o,r:l}=e,c=t&&t.r,u=o.refs===kt?o.refs={}:o.refs,h=o.setupState;if(c!=null&&c!==l&&(Zt(c)?(u[c]=null,Dt(h,c)&&(h[c]=null)):se(c)&&(c.value=null)),bt(l))Sn(l,o,12,[a,u]);else{const d=Zt(l),y=se(l);if(d||y){const x=()=>{if(e.f){const D=d?u[l]:l.value;r?gt(D)&&ja(D,s):gt(D)?D.includes(s)||D.push(s):d?(u[l]=[s],Dt(h,l)&&(h[l]=u[l])):(l.value=[s],e.k&&(u[e.k]=l.value))}else d?(u[l]=a,Dt(h,l)&&(h[l]=a)):y&&(l.value=a,e.k&&(u[e.k]=a))};a?(x.id=-1,ue(x,n)):x()}}}const ue=Vh;function mg(e){return pg(e)}function pg(e,t){const n=qd();n.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:a,createText:o,createComment:l,setText:c,setElementText:u,parentNode:h,nextSibling:d,setScopeId:y=Oe,cloneNode:x,insertStaticContent:D}=e,S=(W,V,z,Y=null,Q=null,Z=null,st=!1,tt=null,et=!!V.dynamicChildren)=>{if(W===V)return;W&&!Gn(W,V)&&(Y=X(W),K(W,Q,Z,!0),W=null),V.patchFlag===-2&&(et=!1,V.dynamicChildren=null);const{type:q,ref:ut,shapeFlag:ct}=V;switch(q){case ro:L(W,V,z,Y);break;case Re:g(W,V,z,Y);break;case Gr:W==null&&f(V,z,Y,st);break;case Rt:P(W,V,z,Y,Q,Z,st,tt,et);break;default:ct&1?C(W,V,z,Y,Q,Z,st,tt,et):ct&6?O(W,V,z,Y,Q,Z,st,tt,et):(ct&64||ct&128)&&q.process(W,V,z,Y,Q,Z,st,tt,et,nt)}ut!=null&&Q&&xa(ut,W&&W.ref,Z,V||W,!V)},L=(W,V,z,Y)=>{if(W==null)i(V.el=o(V.children),z,Y);else{const Q=V.el=W.el;V.children!==W.children&&c(Q,V.children)}},g=(W,V,z,Y)=>{W==null?i(V.el=l(V.children||""),z,Y):V.el=W.el},f=(W,V,z,Y)=>{[W.el,W.anchor]=D(W.children,V,z,Y,W.el,W.anchor)},E=({el:W,anchor:V},z,Y)=>{let Q;for(;W&&W!==V;)Q=d(W),i(W,z,Y),W=Q;i(V,z,Y)},_=({el:W,anchor:V})=>{let z;for(;W&&W!==V;)z=d(W),r(W),W=z;r(V)},C=(W,V,z,Y,Q,Z,st,tt,et)=>{st=st||V.type==="svg",W==null?p(V,z,Y,Q,Z,st,tt,et):A(W,V,Q,Z,st,tt,et)},p=(W,V,z,Y,Q,Z,st,tt)=>{let et,q;const{type:ut,props:ct,shapeFlag:ft,transition:dt,patchFlag:vt,dirs:Et}=W;if(W.el&&x!==void 0&&vt===-1)et=W.el=x(W.el);else{if(et=W.el=a(W.type,Z,ct&&ct.is,ct),ft&8?u(et,W.children):ft&16&&m(W.children,et,null,Y,Q,Z&&ut!=="foreignObject",st,tt),Et&&Fn(W,null,Y,"created"),ct){for(const Tt in ct)Tt!=="value"&&!Hr(Tt)&&s(et,Tt,null,ct[Tt],Z,W.children,Y,Q,G);"value"in ct&&s(et,"value",null,ct.value),(q=ct.onVnodeBeforeMount)&&Ue(q,Y,W)}v(et,W,W.scopeId,st,Y)}Et&&Fn(W,null,Y,"beforeMount");const yt=(!Q||Q&&!Q.pendingBranch)&&dt&&!dt.persisted;yt&&dt.beforeEnter(et),i(et,V,z),((q=ct&&ct.onVnodeMounted)||yt||Et)&&ue(()=>{q&&Ue(q,Y,W),yt&&dt.enter(et),Et&&Fn(W,null,Y,"mounted")},Q)},v=(W,V,z,Y,Q)=>{if(z&&y(W,z),Y)for(let Z=0;Z<Y.length;Z++)y(W,Y[Z]);if(Q){let Z=Q.subTree;if(V===Z){const st=Q.vnode;v(W,st,st.scopeId,st.slotScopeIds,Q.parent)}}},m=(W,V,z,Y,Q,Z,st,tt,et=0)=>{for(let q=et;q<W.length;q++){const ut=W[q]=tt?pn(W[q]):He(W[q]);S(null,ut,V,z,Y,Q,Z,st,tt)}},A=(W,V,z,Y,Q,Z,st)=>{const tt=V.el=W.el;let{patchFlag:et,dynamicChildren:q,dirs:ut}=V;et|=W.patchFlag&16;const ct=W.props||kt,ft=V.props||kt;let dt;z&&Bn(z,!1),(dt=ft.onVnodeBeforeUpdate)&&Ue(dt,z,V,W),ut&&Fn(V,W,z,"beforeUpdate"),z&&Bn(z,!0);const vt=Q&&V.type!=="foreignObject";if(q?b(W.dynamicChildren,q,tt,z,Y,vt,Z):st||k(W,V,tt,null,z,Y,vt,Z,!1),et>0){if(et&16)T(tt,V,ct,ft,z,Y,Q);else if(et&2&&ct.class!==ft.class&&s(tt,"class",null,ft.class,Q),et&4&&s(tt,"style",ct.style,ft.style,Q),et&8){const Et=V.dynamicProps;for(let yt=0;yt<Et.length;yt++){const Tt=Et[yt],Wt=ct[Tt],ee=ft[Tt];(ee!==Wt||Tt==="value")&&s(tt,Tt,Wt,ee,Q,W.children,z,Y,G)}}et&1&&W.children!==V.children&&u(tt,V.children)}else!st&&q==null&&T(tt,V,ct,ft,z,Y,Q);((dt=ft.onVnodeUpdated)||ut)&&ue(()=>{dt&&Ue(dt,z,V,W),ut&&Fn(V,W,z,"updated")},Y)},b=(W,V,z,Y,Q,Z,st)=>{for(let tt=0;tt<V.length;tt++){const et=W[tt],q=V[tt],ut=et.el&&(et.type===Rt||!Gn(et,q)||et.shapeFlag&70)?h(et.el):z;S(et,q,ut,null,Y,Q,Z,st,!0)}},T=(W,V,z,Y,Q,Z,st)=>{if(z!==Y){for(const tt in Y){if(Hr(tt))continue;const et=Y[tt],q=z[tt];et!==q&&tt!=="value"&&s(W,tt,q,et,st,V.children,Q,Z,G)}if(z!==kt)for(const tt in z)!Hr(tt)&&!(tt in Y)&&s(W,tt,z[tt],null,st,V.children,Q,Z,G);"value"in Y&&s(W,"value",z.value,Y.value)}},P=(W,V,z,Y,Q,Z,st,tt,et)=>{const q=V.el=W?W.el:o(""),ut=V.anchor=W?W.anchor:o("");let{patchFlag:ct,dynamicChildren:ft,slotScopeIds:dt}=V;dt&&(tt=tt?tt.concat(dt):dt),W==null?(i(q,z,Y),i(ut,z,Y),m(V.children,z,ut,Q,Z,st,tt,et)):ct>0&&ct&64&&ft&&W.dynamicChildren?(b(W.dynamicChildren,ft,z,Q,Z,st,tt),(V.key!=null||Q&&V===Q.subTree)&&Yu(W,V,!0)):k(W,V,z,ut,Q,Z,st,tt,et)},O=(W,V,z,Y,Q,Z,st,tt,et)=>{V.slotScopeIds=tt,W==null?V.shapeFlag&512?Q.ctx.activate(V,z,Y,st,et):M(V,z,Y,Q,Z,st,et):R(W,V,et)},M=(W,V,z,Y,Q,Z,st)=>{const tt=W.component=Dg(W,Y,Q);if(Es(W)&&(tt.ctx.renderer=nt),Ag(tt),tt.asyncDep){if(Q&&Q.registerDep(tt,I),!W.el){const et=tt.subTree=pt(Re);g(null,et,V,z)}return}I(tt,W,V,z,Q,Z,st)},R=(W,V,z)=>{const Y=V.component=W.component;if(Kh(W,V,z))if(Y.asyncDep&&!Y.asyncResolved){w(Y,V,z);return}else Y.next=V,kh(Y.update),Y.update();else V.el=W.el,Y.vnode=V},I=(W,V,z,Y,Q,Z,st)=>{const tt=()=>{if(W.isMounted){let{next:ut,bu:ct,u:ft,parent:dt,vnode:vt}=W,Et=ut,yt;Bn(W,!1),ut?(ut.el=vt.el,w(W,ut,st)):ut=vt,ct&&jr(ct),(yt=ut.props&&ut.props.onVnodeBeforeUpdate)&&Ue(yt,dt,ut,vt),Bn(W,!0);const Tt=$s(W),Wt=W.subTree;W.subTree=Tt,S(Wt,Tt,h(Wt.el),X(Wt),W,Q,Z),ut.el=Tt.el,Et===null&&Hh(W,Tt.el),ft&&ue(ft,Q),(yt=ut.props&&ut.props.onVnodeUpdated)&&ue(()=>Ue(yt,dt,ut,vt),Q)}else{let ut;const{el:ct,props:ft}=V,{bm:dt,m:vt,parent:Et}=W,yt=$r(V);if(Bn(W,!1),dt&&jr(dt),!yt&&(ut=ft&&ft.onVnodeBeforeMount)&&Ue(ut,Et,V),Bn(W,!0),ct&&rt){const Tt=()=>{W.subTree=$s(W),rt(ct,W.subTree,W,Q,null)};yt?V.type.__asyncLoader().then(()=>!W.isUnmounted&&Tt()):Tt()}else{const Tt=W.subTree=$s(W);S(null,Tt,z,Y,W,Q,Z),V.el=Tt.el}if(vt&&ue(vt,Q),!yt&&(ut=ft&&ft.onVnodeMounted)){const Tt=V;ue(()=>Ue(ut,Et,Tt),Q)}(V.shapeFlag&256||Et&&$r(Et.vnode)&&Et.vnode.shapeFlag&256)&&W.a&&ue(W.a,Q),W.isMounted=!0,V=z=Y=null}},et=W.effect=new Ga(tt,()=>to(q),W.scope),q=W.update=()=>et.run();q.id=W.uid,Bn(W,!0),q()},w=(W,V,z)=>{V.component=W;const Y=W.vnode.props;W.vnode=V,W.next=null,ug(W,V.props,Y,z),hg(W,V.children,z),Di(),Xo(),Ai()},k=(W,V,z,Y,Q,Z,st,tt,et=!1)=>{const q=W&&W.children,ut=W?W.shapeFlag:0,ct=V.children,{patchFlag:ft,shapeFlag:dt}=V;if(ft>0){if(ft&128){F(q,ct,z,Y,Q,Z,st,tt,et);return}else if(ft&256){B(q,ct,z,Y,Q,Z,st,tt,et);return}}dt&8?(ut&16&&G(q,Q,Z),ct!==q&&u(z,ct)):ut&16?dt&16?F(q,ct,z,Y,Q,Z,st,tt,et):G(q,Q,Z,!0):(ut&8&&u(z,""),dt&16&&m(ct,z,Y,Q,Z,st,tt,et))},B=(W,V,z,Y,Q,Z,st,tt,et)=>{W=W||ui,V=V||ui;const q=W.length,ut=V.length,ct=Math.min(q,ut);let ft;for(ft=0;ft<ct;ft++){const dt=V[ft]=et?pn(V[ft]):He(V[ft]);S(W[ft],dt,z,null,Q,Z,st,tt,et)}q>ut?G(W,Q,Z,!0,!1,ct):m(V,z,Y,Q,Z,st,tt,et,ct)},F=(W,V,z,Y,Q,Z,st,tt,et)=>{let q=0;const ut=V.length;let ct=W.length-1,ft=ut-1;for(;q<=ct&&q<=ft;){const dt=W[q],vt=V[q]=et?pn(V[q]):He(V[q]);if(Gn(dt,vt))S(dt,vt,z,null,Q,Z,st,tt,et);else break;q++}for(;q<=ct&&q<=ft;){const dt=W[ct],vt=V[ft]=et?pn(V[ft]):He(V[ft]);if(Gn(dt,vt))S(dt,vt,z,null,Q,Z,st,tt,et);else break;ct--,ft--}if(q>ct){if(q<=ft){const dt=ft+1,vt=dt<ut?V[dt].el:Y;for(;q<=ft;)S(null,V[q]=et?pn(V[q]):He(V[q]),z,vt,Q,Z,st,tt,et),q++}}else if(q>ft)for(;q<=ct;)K(W[q],Q,Z,!0),q++;else{const dt=q,vt=q,Et=new Map;for(q=vt;q<=ft;q++){const St=V[q]=et?pn(V[q]):He(V[q]);St.key!=null&&Et.set(St.key,q)}let yt,Tt=0;const Wt=ft-vt+1;let ee=!1,Ht=0;const jt=new Array(Wt);for(q=0;q<Wt;q++)jt[q]=0;for(q=dt;q<=ct;q++){const St=W[q];if(Tt>=Wt){K(St,Q,Z,!0);continue}let It;if(St.key!=null)It=Et.get(St.key);else for(yt=vt;yt<=ft;yt++)if(jt[yt-vt]===0&&Gn(St,V[yt])){It=yt;break}It===void 0?K(St,Q,Z,!0):(jt[It-vt]=q+1,It>=Ht?Ht=It:ee=!0,S(St,V[It],z,null,Q,Z,st,tt,et),Tt++)}const le=ee?yg(jt):ui;for(yt=le.length-1,q=Wt-1;q>=0;q--){const St=vt+q,It=V[St],ne=St+1<ut?V[St+1].el:Y;jt[q]===0?S(null,It,z,ne,Q,Z,st,tt,et):ee&&(yt<0||q!==le[yt]?N(It,z,ne,2):yt--)}}},N=(W,V,z,Y,Q=null)=>{const{el:Z,type:st,transition:tt,children:et,shapeFlag:q}=W;if(q&6){N(W.component.subTree,V,z,Y);return}if(q&128){W.suspense.move(V,z,Y);return}if(q&64){st.move(W,V,z,nt);return}if(st===Rt){i(Z,V,z);for(let ct=0;ct<et.length;ct++)N(et[ct],V,z,Y);i(W.anchor,V,z);return}if(st===Gr){E(W,V,z);return}if(Y!==2&&q&1&&tt)if(Y===0)tt.beforeEnter(Z),i(Z,V,z),ue(()=>tt.enter(Z),Q);else{const{leave:ct,delayLeave:ft,afterLeave:dt}=tt,vt=()=>i(Z,V,z),Et=()=>{ct(Z,()=>{vt(),dt&&dt()})};ft?ft(Z,vt,Et):Et()}else i(Z,V,z)},K=(W,V,z,Y=!1,Q=!1)=>{const{type:Z,props:st,ref:tt,children:et,dynamicChildren:q,shapeFlag:ut,patchFlag:ct,dirs:ft}=W;if(tt!=null&&xa(tt,null,z,W,!0),ut&256){V.ctx.deactivate(W);return}const dt=ut&1&&ft,vt=!$r(W);let Et;if(vt&&(Et=st&&st.onVnodeBeforeUnmount)&&Ue(Et,V,W),ut&6)j(W.component,z,Y);else{if(ut&128){W.suspense.unmount(z,Y);return}dt&&Fn(W,null,V,"beforeUnmount"),ut&64?W.type.remove(W,V,z,Q,nt,Y):q&&(Z!==Rt||ct>0&&ct&64)?G(q,V,z,!1,!0):(Z===Rt&&ct&384||!Q&&ut&16)&&G(et,V,z),Y&&H(W)}(vt&&(Et=st&&st.onVnodeUnmounted)||dt)&&ue(()=>{Et&&Ue(Et,V,W),dt&&Fn(W,null,V,"unmounted")},z)},H=W=>{const{type:V,el:z,anchor:Y,transition:Q}=W;if(V===Rt){U(z,Y);return}if(V===Gr){_(W);return}const Z=()=>{r(z),Q&&!Q.persisted&&Q.afterLeave&&Q.afterLeave()};if(W.shapeFlag&1&&Q&&!Q.persisted){const{leave:st,delayLeave:tt}=Q,et=()=>st(z,Z);tt?tt(W.el,Z,et):et()}else Z()},U=(W,V)=>{let z;for(;W!==V;)z=d(W),r(W),W=z;r(V)},j=(W,V,z)=>{const{bum:Y,scope:Q,update:Z,subTree:st,um:tt}=W;Y&&jr(Y),Q.stop(),Z&&(Z.active=!1,K(st,W,V,z)),tt&&ue(tt,V),ue(()=>{W.isUnmounted=!0},V),V&&V.pendingBranch&&!V.isUnmounted&&W.asyncDep&&!W.asyncResolved&&W.suspenseId===V.pendingId&&(V.deps--,V.deps===0&&V.resolve())},G=(W,V,z,Y=!1,Q=!1,Z=0)=>{for(let st=Z;st<W.length;st++)K(W[st],V,z,Y,Q)},X=W=>W.shapeFlag&6?X(W.component.subTree):W.shapeFlag&128?W.suspense.next():d(W.anchor||W.el),J=(W,V,z)=>{W==null?V._vnode&&K(V._vnode,null,null,!0):S(V._vnode||null,W,V,null,null,null,z),Xo(),Mu(),V._vnode=W},nt={p:S,um:K,m:N,r:H,mt:M,mc:m,pc:k,pbc:b,n:X,o:e};let ot,rt;return t&&([ot,rt]=t(nt)),{render:J,hydrate:ot,createApp:vg(J,ot)}}function Bn({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function Yu(e,t,n=!1){const i=e.children,r=t.children;if(gt(i)&&gt(r))for(let s=0;s<i.length;s++){const a=i[s];let o=r[s];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=r[s]=pn(r[s]),o.el=a.el),n||Yu(a,o))}}function yg(e){const t=e.slice(),n=[0];let i,r,s,a,o;const l=e.length;for(i=0;i<l;i++){const c=e[i];if(c!==0){if(r=n[n.length-1],e[r]<c){t[i]=r,n.push(i);continue}for(s=0,a=n.length-1;s<a;)o=s+a>>1,e[n[o]]<c?s=o+1:a=o;c<e[n[s]]&&(s>0&&(t[i]=n[s-1]),n[s]=i)}}for(s=n.length,a=n[s-1];s-- >0;)n[s]=a,a=t[a];return n}const Eg=e=>e.__isTeleport,Rt=Symbol(void 0),ro=Symbol(void 0),Re=Symbol(void 0),Gr=Symbol(void 0),$i=[];let Ce=null;function it(e=!1){$i.push(Ce=e?null:[])}function xg(){$i.pop(),Ce=$i[$i.length-1]||null}let or=1;function sl(e){or+=e}function Xu(e){return e.dynamicChildren=or>0?Ce||ui:null,xg(),or>0&&Ce&&Ce.push(e),e}function lt(e,t,n,i,r,s){return Xu($(e,t,n,i,r,s,!0))}function Yt(e,t,n,i,r){return Xu(pt(e,t,n,i,r,!0))}function ba(e){return e?e.__v_isVNode===!0:!1}function Gn(e,t){return e.type===t.type&&e.key===t.key}const bs="__vInternal",Qu=({key:e})=>e!=null?e:null,zr=({ref:e,ref_key:t,ref_for:n})=>e!=null?Zt(e)||se(e)||bt(e)?{i:Ae,r:e,k:t,f:!!n}:e:null;function $(e,t=null,n=null,i=0,r=null,s=e===Rt?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Qu(t),ref:t&&zr(t),scopeId:ys,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null};return o?(so(l,n),s&128&&e.normalize(l)):n&&(l.shapeFlag|=Zt(n)?8:16),or>0&&!a&&Ce&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Ce.push(l),l}const pt=bg;function bg(e,t=null,n=null,i=0,r=null,s=!1){if((!e||e===ng)&&(e=Re),ba(e)){const o=Cn(e,t,!0);return n&&so(o,n),or>0&&!s&&Ce&&(o.shapeFlag&6?Ce[Ce.indexOf(e)]=o:Ce.push(o)),o.patchFlag|=-2,o}if(Pg(e)&&(e=e.__vccOpts),t){t=Tg(t);let{class:o,style:l}=t;o&&!Zt(o)&&(t.class=Wa(o)),Ft(l)&&(xu(l)&&!gt(l)&&(l=Jt({},l)),t.style=Dn(l))}const a=Zt(e)?1:jh(e)?128:Eg(e)?64:Ft(e)?4:bt(e)?2:0;return $(e,t,n,i,r,a,s,!0)}function Tg(e){return e?xu(e)||bs in e?Jt({},e):e:null}function Cn(e,t,n=!1){const{props:i,ref:r,patchFlag:s,children:a}=e,o=t?_g(i||{},t):i;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:o,key:o&&Qu(o),ref:t&&t.ref?n&&r?gt(r)?r.concat(zr(t)):[r,zr(t)]:zr(t):r,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Rt?s===-1?16:s|16:s,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Cn(e.ssContent),ssFallback:e.ssFallback&&Cn(e.ssFallback),el:e.el,anchor:e.anchor}}function we(e=" ",t=0){return pt(ro,null,e,t)}function Ju(e,t){const n=pt(Gr,null,e);return n.staticCount=t,n}function At(e="",t=!1){return t?(it(),Yt(Re,null,e)):pt(Re,null,e)}function He(e){return e==null||typeof e=="boolean"?pt(Re):gt(e)?pt(Rt,null,e.slice()):typeof e=="object"?pn(e):pt(ro,null,String(e))}function pn(e){return e.el===null||e.memo?e:Cn(e)}function so(e,t){let n=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(gt(t))n=16;else if(typeof t=="object")if(i&65){const r=t.default;r&&(r._c&&(r._d=!1),so(e,r()),r._c&&(r._d=!0));return}else{n=32;const r=t._;!r&&!(bs in t)?t._ctx=Ae:r===3&&Ae&&(Ae.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else bt(t)?(t={default:t,_ctx:Ae},n=32):(t=String(t),i&64?(n=16,t=[we(t)]):n=8);e.children=t,e.shapeFlag|=n}function _g(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const r in i)if(r==="class")t.class!==i.class&&(t.class=Wa([t.class,i.class]));else if(r==="style")t.style=Dn([t.style,i.style]);else if(hs(r)){const s=t[r],a=i[r];a&&s!==a&&!(gt(s)&&s.includes(a))&&(t[r]=s?[].concat(s,a):a)}else r!==""&&(t[r]=i[r])}return t}function Ue(e,t,n,i=null){Te(e,t,7,[n,i])}const Sg=zu();let Lg=0;function Dg(e,t,n){const i=e.type,r=(t?t.appContext:e.appContext)||Sg,s={uid:Lg++,vnode:e,type:i,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new th(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:ju(i,r),emitsOptions:Pu(i,r),emit:null,emitted:null,propsDefaults:kt,inheritAttrs:i.inheritAttrs,ctx:kt,data:kt,props:kt,attrs:kt,slots:kt,refs:kt,setupState:kt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=Nh.bind(null,s),e.ce&&e.ce(s),s}let qt=null;const Zu=()=>qt||Ae,yi=e=>{qt=e,e.scope.on()},Jn=()=>{qt&&qt.scope.off(),qt=null};function qu(e){return e.vnode.shapeFlag&4}let lr=!1;function Ag(e,t=!1){lr=t;const{props:n,children:i}=e.vnode,r=qu(e);cg(e,n,r,t),dg(e,i);const s=r?Cg(e,t):void 0;return lr=!1,s}function Cg(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=bu(new Proxy(e.ctx,ig));const{setup:i}=n;if(i){const r=e.setupContext=i.length>1?Og(e):null;yi(e),Di();const s=Sn(i,e,0,[e.props,r]);if(Ai(),Jn(),su(s)){if(s.then(Jn,Jn),t)return s.then(a=>{al(e,a,t)}).catch(a=>{ms(a,e,0)});e.asyncDep=s}else al(e,s,t)}else tf(e,t)}function al(e,t,n){bt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Ft(t)&&(e.setupState=Lu(t)),tf(e,n)}let ol;function tf(e,t,n){const i=e.type;if(!e.render){if(!t&&ol&&!i.render){const r=i.template||no(e).template;if(r){const{isCustomElement:s,compilerOptions:a}=e.appContext.config,{delimiters:o,compilerOptions:l}=i,c=Jt(Jt({isCustomElement:s,delimiters:o},a),l);i.render=ol(r,c)}}e.render=i.render||Oe}yi(e),Di(),rg(e),Ai(),Jn()}function Mg(e){return new Proxy(e.attrs,{get(t,n){return ve(e,"get","$attrs"),t[n]}})}function Og(e){const t=i=>{e.exposed=i||{}};let n;return{get attrs(){return n||(n=Mg(e))},slots:e.slots,emit:e.emit,expose:t}}function Ts(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Lu(bu(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in qr)return qr[n](e)}}))}function Pg(e){return bt(e)&&"__vccOpts"in e}const xe=(e,t)=>Rh(e,t,lr);function ao(e,t,n){const i=arguments.length;return i===2?Ft(t)&&!gt(t)?ba(t)?pt(e,null,[t]):pt(e,t):pt(e,null,t):(i>3?n=Array.prototype.slice.call(arguments,2):i===3&&ba(n)&&(n=[n]),pt(e,t,n))}const Rg="3.2.39",Ig="http://www.w3.org/2000/svg",zn=typeof document<"u"?document:null,ll=zn&&zn.createElement("template"),wg={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const r=t?zn.createElementNS(Ig,e):zn.createElement(e,n?{is:n}:void 0);return e==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:e=>zn.createTextNode(e),createComment:e=>zn.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>zn.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,n,i,r,s){const a=n?n.previousSibling:t.lastChild;if(r&&(r===s||r.nextSibling))for(;t.insertBefore(r.cloneNode(!0),n),!(r===s||!(r=r.nextSibling)););else{ll.innerHTML=i?`<svg>${e}</svg>`:e;const o=ll.content;if(i){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}t.insertBefore(o,n)}return[a?a.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};function kg(e,t,n){const i=e._vtc;i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}function Fg(e,t,n){const i=e.style,r=Zt(n);if(n&&!r){for(const s in n)Ta(i,s,n[s]);if(t&&!Zt(t))for(const s in t)n[s]==null&&Ta(i,s,"")}else{const s=i.display;r?t!==n&&(i.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(i.display=s)}}const cl=/\s*!important$/;function Ta(e,t,n){if(gt(n))n.forEach(i=>Ta(e,t,i));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const i=Bg(e,t);cl.test(n)?e.setProperty(ni(i),n.replace(cl,""),"important"):e[i]=n}}const ul=["Webkit","Moz","ms"],zs={};function Bg(e,t){const n=zs[t];if(n)return n;let i=mi(t);if(i!=="filter"&&i in e)return zs[t]=i;i=lu(i);for(let r=0;r<ul.length;r++){const s=ul[r]+i;if(s in e)return zs[t]=s}return t}const fl="http://www.w3.org/1999/xlink";function Ng(e,t,n,i,r){if(i&&t.startsWith("xlink:"))n==null?e.removeAttributeNS(fl,t.slice(6,t.length)):e.setAttributeNS(fl,t,n);else{const s=Hd(t);n==null||s&&!iu(n)?e.removeAttribute(t):e.setAttribute(t,s?"":n)}}function Ug(e,t,n,i,r,s,a){if(t==="innerHTML"||t==="textContent"){i&&a(i,r,s),e[t]=n==null?"":n;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=n;const l=n==null?"":n;(e.value!==l||e.tagName==="OPTION")&&(e.value=l),n==null&&e.removeAttribute(t);return}let o=!1;if(n===""||n==null){const l=typeof e[t];l==="boolean"?n=iu(n):n==null&&l==="string"?(n="",o=!0):l==="number"&&(n=0,o=!0)}try{e[t]=n}catch{}o&&e.removeAttribute(t)}const[ef,Wg]=(()=>{let e=Date.now,t=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(n&&Number(n[1])<=53)}return[e,t]})();let _a=0;const Kg=Promise.resolve(),Hg=()=>{_a=0},jg=()=>_a||(Kg.then(Hg),_a=ef());function En(e,t,n,i){e.addEventListener(t,n,i)}function Vg(e,t,n,i){e.removeEventListener(t,n,i)}function $g(e,t,n,i,r=null){const s=e._vei||(e._vei={}),a=s[t];if(i&&a)a.value=i;else{const[o,l]=Gg(t);if(i){const c=s[t]=zg(i,r);En(e,o,c,l)}else a&&(Vg(e,o,a,l),s[t]=void 0)}}const dl=/(?:Once|Passive|Capture)$/;function Gg(e){let t;if(dl.test(e)){t={};let i;for(;i=e.match(dl);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):ni(e.slice(2)),t]}function zg(e,t){const n=i=>{const r=i.timeStamp||ef();(Wg||r>=n.attached-1)&&Te(Yg(i,n.value),t,5,[i])};return n.value=e,n.attached=jg(),n}function Yg(e,t){if(gt(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(i=>r=>!r._stopped&&i&&i(r))}else return t}const hl=/^on[a-z]/,Xg=(e,t,n,i,r=!1,s,a,o,l)=>{t==="class"?kg(e,i,r):t==="style"?Fg(e,n,i):hs(t)?Ha(t)||$g(e,t,n,i,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Qg(e,t,i,r))?Ug(e,t,i,s,a,o,l):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),Ng(e,t,i,r))};function Qg(e,t,n,i){return i?!!(t==="innerHTML"||t==="textContent"||t in e&&hl.test(t)&&bt(n)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||hl.test(t)&&Zt(n)?!1:t in e}const hn="transition",Ri="animation",gi=(e,{slots:t})=>ao(ku,rf(e),t);gi.displayName="Transition";const nf={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Jg=gi.props=Jt({},ku.props,nf),Nn=(e,t=[])=>{gt(e)?e.forEach(n=>n(...t)):e&&e(...t)},gl=e=>e?gt(e)?e.some(t=>t.length>1):e.length>1:!1;function rf(e){const t={};for(const T in e)T in nf||(t[T]=e[T]);if(e.css===!1)return t;const{name:n="v",type:i,duration:r,enterFromClass:s=`${n}-enter-from`,enterActiveClass:a=`${n}-enter-active`,enterToClass:o=`${n}-enter-to`,appearFromClass:l=s,appearActiveClass:c=a,appearToClass:u=o,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:y=`${n}-leave-to`}=e,x=Zg(r),D=x&&x[0],S=x&&x[1],{onBeforeEnter:L,onEnter:g,onEnterCancelled:f,onLeave:E,onLeaveCancelled:_,onBeforeAppear:C=L,onAppear:p=g,onAppearCancelled:v=f}=t,m=(T,P,O)=>{mn(T,P?u:o),mn(T,P?c:a),O&&O()},A=(T,P)=>{T._isLeaving=!1,mn(T,h),mn(T,y),mn(T,d),P&&P()},b=T=>(P,O)=>{const M=T?p:g,R=()=>m(P,T,O);Nn(M,[P,R]),vl(()=>{mn(P,T?l:s),en(P,T?u:o),gl(M)||ml(P,i,D,R)})};return Jt(t,{onBeforeEnter(T){Nn(L,[T]),en(T,s),en(T,a)},onBeforeAppear(T){Nn(C,[T]),en(T,l),en(T,c)},onEnter:b(!1),onAppear:b(!0),onLeave(T,P){T._isLeaving=!0;const O=()=>A(T,P);en(T,h),af(),en(T,d),vl(()=>{!T._isLeaving||(mn(T,h),en(T,y),gl(E)||ml(T,i,S,O))}),Nn(E,[T,O])},onEnterCancelled(T){m(T,!1),Nn(f,[T])},onAppearCancelled(T){m(T,!0),Nn(v,[T])},onLeaveCancelled(T){A(T),Nn(_,[T])}})}function Zg(e){if(e==null)return null;if(Ft(e))return[Ys(e.enter),Ys(e.leave)];{const t=Ys(e);return[t,t]}}function Ys(e){return er(e)}function en(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e._vtc||(e._vtc=new Set)).add(t)}function mn(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function vl(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let qg=0;function ml(e,t,n,i){const r=e._endId=++qg,s=()=>{r===e._endId&&i()};if(n)return setTimeout(s,n);const{type:a,timeout:o,propCount:l}=sf(e,t);if(!a)return i();const c=a+"end";let u=0;const h=()=>{e.removeEventListener(c,d),s()},d=y=>{y.target===e&&++u>=l&&h()};setTimeout(()=>{u<l&&h()},o+1),e.addEventListener(c,d)}function sf(e,t){const n=window.getComputedStyle(e),i=x=>(n[x]||"").split(", "),r=i(hn+"Delay"),s=i(hn+"Duration"),a=pl(r,s),o=i(Ri+"Delay"),l=i(Ri+"Duration"),c=pl(o,l);let u=null,h=0,d=0;t===hn?a>0&&(u=hn,h=a,d=s.length):t===Ri?c>0&&(u=Ri,h=c,d=l.length):(h=Math.max(a,c),u=h>0?a>c?hn:Ri:null,d=u?u===hn?s.length:l.length:0);const y=u===hn&&/\b(transform|all)(,|$)/.test(n[hn+"Property"]);return{type:u,timeout:h,propCount:d,hasTransform:y}}function pl(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,i)=>yl(n)+yl(e[i])))}function yl(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function af(){return document.body.offsetHeight}const of=new WeakMap,lf=new WeakMap,tv={name:"TransitionGroup",props:Jt({},Jg,{tag:String,moveClass:String}),setup(e,{slots:t}){const n=Zu(),i=wu();let r,s;return Uu(()=>{if(!r.length)return;const a=e.moveClass||`${e.name||"v"}-move`;if(!rv(r[0].el,n.vnode.el,a))return;r.forEach(ev),r.forEach(nv);const o=r.filter(iv);af(),o.forEach(l=>{const c=l.el,u=c.style;en(c,a),u.transform=u.webkitTransform=u.transitionDuration="";const h=c._moveCb=d=>{d&&d.target!==c||(!d||/transform$/.test(d.propertyName))&&(c.removeEventListener("transitionend",h),c._moveCb=null,mn(c,a))};c.addEventListener("transitionend",h)})}),()=>{const a=Mt(e),o=rf(a);let l=a.tag||Rt;r=s,s=t.default?eo(t.default()):[];for(let c=0;c<s.length;c++){const u=s[c];u.key!=null&&ar(u,sr(u,o,i,n))}if(r)for(let c=0;c<r.length;c++){const u=r[c];ar(u,sr(u,o,i,n)),of.set(u,u.el.getBoundingClientRect())}return pt(l,null,s)}}},cf=tv;function ev(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function nv(e){lf.set(e,e.el.getBoundingClientRect())}function iv(e){const t=of.get(e),n=lf.get(e),i=t.left-n.left,r=t.top-n.top;if(i||r){const s=e.el.style;return s.transform=s.webkitTransform=`translate(${i}px,${r}px)`,s.transitionDuration="0s",e}}function rv(e,t,n){const i=e.cloneNode();e._vtc&&e._vtc.forEach(a=>{a.split(/\s+/).forEach(o=>o&&i.classList.remove(o))}),n.split(/\s+/).forEach(a=>a&&i.classList.add(a)),i.style.display="none";const r=t.nodeType===1?t:t.parentNode;r.appendChild(i);const{hasTransform:s}=sf(i);return r.removeChild(i),s}const Ei=e=>{const t=e.props["onUpdate:modelValue"]||!1;return gt(t)?n=>jr(t,n):t};function sv(e){e.target.composing=!0}function El(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const on={created(e,{modifiers:{lazy:t,trim:n,number:i}},r){e._assign=Ei(r);const s=i||r.props&&r.props.type==="number";En(e,t?"change":"input",a=>{if(a.target.composing)return;let o=e.value;n&&(o=o.trim()),s&&(o=er(o)),e._assign(o)}),n&&En(e,"change",()=>{e.value=e.value.trim()}),t||(En(e,"compositionstart",sv),En(e,"compositionend",El),En(e,"change",El))},mounted(e,{value:t}){e.value=t==null?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:n,trim:i,number:r}},s){if(e._assign=Ei(s),e.composing||document.activeElement===e&&e.type!=="range"&&(n||i&&e.value.trim()===t||(r||e.type==="number")&&er(e.value)===t))return;const a=t==null?"":t;e.value!==a&&(e.value=a)}},Un={deep:!0,created(e,t,n){e._assign=Ei(n),En(e,"change",()=>{const i=e._modelValue,r=cr(e),s=e.checked,a=e._assign;if(gt(i)){const o=Ka(i,r),l=o!==-1;if(s&&!l)a(i.concat(r));else if(!s&&l){const c=[...i];c.splice(o,1),a(c)}}else if(Li(i)){const o=new Set(i);s?o.add(r):o.delete(r),a(o)}else a(ff(e,s))})},mounted:xl,beforeUpdate(e,t,n){e._assign=Ei(n),xl(e,t,n)}};function xl(e,{value:t,oldValue:n},i){e._modelValue=t,gt(t)?e.checked=Ka(t,i.props.value)>-1:Li(t)?e.checked=t.has(i.props.value):t!==n&&(e.checked=mr(t,ff(e,!0)))}const uf={deep:!0,created(e,{value:t,modifiers:{number:n}},i){const r=Li(t);En(e,"change",()=>{const s=Array.prototype.filter.call(e.options,a=>a.selected).map(a=>n?er(cr(a)):cr(a));e._assign(e.multiple?r?new Set(s):s:s[0])}),e._assign=Ei(i)},mounted(e,{value:t}){bl(e,t)},beforeUpdate(e,t,n){e._assign=Ei(n)},updated(e,{value:t}){bl(e,t)}};function bl(e,t){const n=e.multiple;if(!(n&&!gt(t)&&!Li(t))){for(let i=0,r=e.options.length;i<r;i++){const s=e.options[i],a=cr(s);if(n)gt(t)?s.selected=Ka(t,a)>-1:s.selected=t.has(a);else if(mr(cr(s),t)){e.selectedIndex!==i&&(e.selectedIndex=i);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function cr(e){return"_value"in e?e._value:e.value}function ff(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const av=["ctrl","shift","alt","meta"],ov={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>av.some(n=>e[`${n}Key`]&&!t.includes(n))},lv=(e,t)=>(n,...i)=>{for(let r=0;r<t.length;r++){const s=ov[t[r]];if(s&&s(n,t))return}return e(n,...i)},cv={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},uv=(e,t)=>n=>{if(!("key"in n))return;const i=ni(n.key);if(t.some(r=>r===i||cv[r]===i))return e(n)},fv=Jt({patchProp:Xg},wg);let Tl;function dv(){return Tl||(Tl=mg(fv))}const hv=(...e)=>{const t=dv().createApp(...e),{mount:n}=t;return t.mount=i=>{const r=gv(i);if(!r)return;const s=t._component;!bt(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.innerHTML="";const a=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),a},t};function gv(e){return Zt(e)?document.querySelector(e):e}/*!
  * vue-router v4.1.5
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const ci=typeof window<"u";function vv(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const Ot=Object.assign;function Xs(e,t){const n={};for(const i in t){const r=t[i];n[i]=ke(r)?r.map(e):e(r)}return n}const Gi=()=>{},ke=Array.isArray,mv=/\/$/,pv=e=>e.replace(mv,"");function Qs(e,t,n="/"){let i,r={},s="",a="";const o=t.indexOf("#");let l=t.indexOf("?");return o<l&&o>=0&&(l=-1),l>-1&&(i=t.slice(0,l),s=t.slice(l+1,o>-1?o:t.length),r=e(s)),o>-1&&(i=i||t.slice(0,o),a=t.slice(o,t.length)),i=bv(i!=null?i:t,n),{fullPath:i+(s&&"?")+s+a,path:i,query:r,hash:a}}function yv(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function _l(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Ev(e,t,n){const i=t.matched.length-1,r=n.matched.length-1;return i>-1&&i===r&&xi(t.matched[i],n.matched[r])&&df(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function xi(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function df(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!xv(e[n],t[n]))return!1;return!0}function xv(e,t){return ke(e)?Sl(e,t):ke(t)?Sl(t,e):e===t}function Sl(e,t){return ke(t)?e.length===t.length&&e.every((n,i)=>n===t[i]):e.length===1&&e[0]===t}function bv(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),i=e.split("/");let r=n.length-1,s,a;for(s=0;s<i.length;s++)if(a=i[s],a!==".")if(a==="..")r>1&&r--;else break;return n.slice(0,r).join("/")+"/"+i.slice(s-(s===i.length?1:0)).join("/")}var ur;(function(e){e.pop="pop",e.push="push"})(ur||(ur={}));var zi;(function(e){e.back="back",e.forward="forward",e.unknown=""})(zi||(zi={}));function Tv(e){if(!e)if(ci){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),pv(e)}const _v=/^[^#]+#/;function Sv(e,t){return e.replace(_v,"#")+t}function Lv(e,t){const n=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-n.left-(t.left||0),top:i.top-n.top-(t.top||0)}}const _s=()=>({left:window.pageXOffset,top:window.pageYOffset});function Dv(e){let t;if("el"in e){const n=e.el,i=typeof n=="string"&&n.startsWith("#"),r=typeof n=="string"?i?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;t=Lv(r,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function Ll(e,t){return(history.state?history.state.position-t:-1)+e}const Sa=new Map;function Av(e,t){Sa.set(e,t)}function Cv(e){const t=Sa.get(e);return Sa.delete(e),t}let Mv=()=>location.protocol+"//"+location.host;function hf(e,t){const{pathname:n,search:i,hash:r}=t,s=e.indexOf("#");if(s>-1){let o=r.includes(e.slice(s))?e.slice(s).length:1,l=r.slice(o);return l[0]!=="/"&&(l="/"+l),_l(l,"")}return _l(n,e)+i+r}function Ov(e,t,n,i){let r=[],s=[],a=null;const o=({state:d})=>{const y=hf(e,location),x=n.value,D=t.value;let S=0;if(d){if(n.value=y,t.value=d,a&&a===x){a=null;return}S=D?d.position-D.position:0}else i(y);r.forEach(L=>{L(n.value,x,{delta:S,type:ur.pop,direction:S?S>0?zi.forward:zi.back:zi.unknown})})};function l(){a=n.value}function c(d){r.push(d);const y=()=>{const x=r.indexOf(d);x>-1&&r.splice(x,1)};return s.push(y),y}function u(){const{history:d}=window;!d.state||d.replaceState(Ot({},d.state,{scroll:_s()}),"")}function h(){for(const d of s)d();s=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",u),{pauseListeners:l,listen:c,destroy:h}}function Dl(e,t,n,i=!1,r=!1){return{back:e,current:t,forward:n,replaced:i,position:window.history.length,scroll:r?_s():null}}function Pv(e){const{history:t,location:n}=window,i={value:hf(e,n)},r={value:t.state};r.value||s(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function s(l,c,u){const h=e.indexOf("#"),d=h>-1?(n.host&&document.querySelector("base")?e:e.slice(h))+l:Mv()+e+l;try{t[u?"replaceState":"pushState"](c,"",d),r.value=c}catch(y){console.error(y),n[u?"replace":"assign"](d)}}function a(l,c){const u=Ot({},t.state,Dl(r.value.back,l,r.value.forward,!0),c,{position:r.value.position});s(l,u,!0),i.value=l}function o(l,c){const u=Ot({},r.value,t.state,{forward:l,scroll:_s()});s(u.current,u,!0);const h=Ot({},Dl(i.value,l,null),{position:u.position+1},c);s(l,h,!1),i.value=l}return{location:i,state:r,push:o,replace:a}}function Rv(e){e=Tv(e);const t=Pv(e),n=Ov(e,t.state,t.location,t.replace);function i(s,a=!0){a||n.pauseListeners(),history.go(s)}const r=Ot({location:"",base:e,go:i,createHref:Sv.bind(null,e)},t,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>t.state.value}),r}function Iv(e){return typeof e=="string"||e&&typeof e=="object"}function gf(e){return typeof e=="string"||typeof e=="symbol"}const gn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},vf=Symbol("");var Al;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(Al||(Al={}));function bi(e,t){return Ot(new Error,{type:e,[vf]:!0},t)}function qe(e,t){return e instanceof Error&&vf in e&&(t==null||!!(e.type&t))}const Cl="[^/]+?",wv={sensitive:!1,strict:!1,start:!0,end:!0},kv=/[.+*?^${}()[\]/\\]/g;function Fv(e,t){const n=Ot({},wv,t),i=[];let r=n.start?"^":"";const s=[];for(const c of e){const u=c.length?[]:[90];n.strict&&!c.length&&(r+="/");for(let h=0;h<c.length;h++){const d=c[h];let y=40+(n.sensitive?.25:0);if(d.type===0)h||(r+="/"),r+=d.value.replace(kv,"\\$&"),y+=40;else if(d.type===1){const{value:x,repeatable:D,optional:S,regexp:L}=d;s.push({name:x,repeatable:D,optional:S});const g=L||Cl;if(g!==Cl){y+=10;try{new RegExp(`(${g})`)}catch(E){throw new Error(`Invalid custom RegExp for param "${x}" (${g}): `+E.message)}}let f=D?`((?:${g})(?:/(?:${g}))*)`:`(${g})`;h||(f=S&&c.length<2?`(?:/${f})`:"/"+f),S&&(f+="?"),r+=f,y+=20,S&&(y+=-8),D&&(y+=-20),g===".*"&&(y+=-50)}u.push(y)}i.push(u)}if(n.strict&&n.end){const c=i.length-1;i[c][i[c].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&(r+="(?:/|$)");const a=new RegExp(r,n.sensitive?"":"i");function o(c){const u=c.match(a),h={};if(!u)return null;for(let d=1;d<u.length;d++){const y=u[d]||"",x=s[d-1];h[x.name]=y&&x.repeatable?y.split("/"):y}return h}function l(c){let u="",h=!1;for(const d of e){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const y of d)if(y.type===0)u+=y.value;else if(y.type===1){const{value:x,repeatable:D,optional:S}=y,L=x in c?c[x]:"";if(ke(L)&&!D)throw new Error(`Provided param "${x}" is an array but it is not repeatable (* or + modifiers)`);const g=ke(L)?L.join("/"):L;if(!g)if(S)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${x}"`);u+=g}}return u||"/"}return{re:a,score:i,keys:s,parse:o,stringify:l}}function Bv(e,t){let n=0;for(;n<e.length&&n<t.length;){const i=t[n]-e[n];if(i)return i;n++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function Nv(e,t){let n=0;const i=e.score,r=t.score;for(;n<i.length&&n<r.length;){const s=Bv(i[n],r[n]);if(s)return s;n++}if(Math.abs(r.length-i.length)===1){if(Ml(i))return 1;if(Ml(r))return-1}return r.length-i.length}function Ml(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const Uv={type:0,value:""},Wv=/[a-zA-Z0-9_]/;function Kv(e){if(!e)return[[]];if(e==="/")return[[Uv]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(y){throw new Error(`ERR (${n})/"${c}": ${y}`)}let n=0,i=n;const r=[];let s;function a(){s&&r.push(s),s=[]}let o=0,l,c="",u="";function h(){!c||(n===0?s.push({type:0,value:c}):n===1||n===2||n===3?(s.length>1&&(l==="*"||l==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):t("Invalid state to consume buffer"),c="")}function d(){c+=l}for(;o<e.length;){if(l=e[o++],l==="\\"&&n!==2){i=n,n=4;continue}switch(n){case 0:l==="/"?(c&&h(),a()):l===":"?(h(),n=1):d();break;case 4:d(),n=i;break;case 1:l==="("?n=2:Wv.test(l)?d():(h(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&o--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:n=3:u+=l;break;case 3:h(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&o--,u="";break;default:t("Unknown state");break}}return n===2&&t(`Unfinished custom RegExp for param "${c}"`),h(),a(),r}function Hv(e,t,n){const i=Fv(Kv(e.path),n),r=Ot(i,{record:e,parent:t,children:[],alias:[]});return t&&!r.record.aliasOf==!t.record.aliasOf&&t.children.push(r),r}function jv(e,t){const n=[],i=new Map;t=Rl({strict:!1,end:!0,sensitive:!1},t);function r(u){return i.get(u)}function s(u,h,d){const y=!d,x=Vv(u);x.aliasOf=d&&d.record;const D=Rl(t,u),S=[x];if("alias"in u){const f=typeof u.alias=="string"?[u.alias]:u.alias;for(const E of f)S.push(Ot({},x,{components:d?d.record.components:x.components,path:E,aliasOf:d?d.record:x}))}let L,g;for(const f of S){const{path:E}=f;if(h&&E[0]!=="/"){const _=h.record.path,C=_[_.length-1]==="/"?"":"/";f.path=h.record.path+(E&&C+E)}if(L=Hv(f,h,D),d?d.alias.push(L):(g=g||L,g!==L&&g.alias.push(L),y&&u.name&&!Pl(L)&&a(u.name)),x.children){const _=x.children;for(let C=0;C<_.length;C++)s(_[C],L,d&&d.children[C])}d=d||L,l(L)}return g?()=>{a(g)}:Gi}function a(u){if(gf(u)){const h=i.get(u);h&&(i.delete(u),n.splice(n.indexOf(h),1),h.children.forEach(a),h.alias.forEach(a))}else{const h=n.indexOf(u);h>-1&&(n.splice(h,1),u.record.name&&i.delete(u.record.name),u.children.forEach(a),u.alias.forEach(a))}}function o(){return n}function l(u){let h=0;for(;h<n.length&&Nv(u,n[h])>=0&&(u.record.path!==n[h].record.path||!mf(u,n[h]));)h++;n.splice(h,0,u),u.record.name&&!Pl(u)&&i.set(u.record.name,u)}function c(u,h){let d,y={},x,D;if("name"in u&&u.name){if(d=i.get(u.name),!d)throw bi(1,{location:u});D=d.record.name,y=Ot(Ol(h.params,d.keys.filter(g=>!g.optional).map(g=>g.name)),u.params&&Ol(u.params,d.keys.map(g=>g.name))),x=d.stringify(y)}else if("path"in u)x=u.path,d=n.find(g=>g.re.test(x)),d&&(y=d.parse(x),D=d.record.name);else{if(d=h.name?i.get(h.name):n.find(g=>g.re.test(h.path)),!d)throw bi(1,{location:u,currentLocation:h});D=d.record.name,y=Ot({},h.params,u.params),x=d.stringify(y)}const S=[];let L=d;for(;L;)S.unshift(L.record),L=L.parent;return{name:D,path:x,params:y,matched:S,meta:Gv(S)}}return e.forEach(u=>s(u)),{addRoute:s,resolve:c,removeRoute:a,getRoutes:o,getRecordMatcher:r}}function Ol(e,t){const n={};for(const i of t)i in e&&(n[i]=e[i]);return n}function Vv(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:$v(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function $v(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const i in e.components)t[i]=typeof n=="boolean"?n:n[i];return t}function Pl(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Gv(e){return e.reduce((t,n)=>Ot(t,n.meta),{})}function Rl(e,t){const n={};for(const i in e)n[i]=i in t?t[i]:e[i];return n}function mf(e,t){return t.children.some(n=>n===e||mf(e,n))}const pf=/#/g,zv=/&/g,Yv=/\//g,Xv=/=/g,Qv=/\?/g,yf=/\+/g,Jv=/%5B/g,Zv=/%5D/g,Ef=/%5E/g,qv=/%60/g,xf=/%7B/g,tm=/%7C/g,bf=/%7D/g,em=/%20/g;function oo(e){return encodeURI(""+e).replace(tm,"|").replace(Jv,"[").replace(Zv,"]")}function nm(e){return oo(e).replace(xf,"{").replace(bf,"}").replace(Ef,"^")}function La(e){return oo(e).replace(yf,"%2B").replace(em,"+").replace(pf,"%23").replace(zv,"%26").replace(qv,"`").replace(xf,"{").replace(bf,"}").replace(Ef,"^")}function im(e){return La(e).replace(Xv,"%3D")}function rm(e){return oo(e).replace(pf,"%23").replace(Qv,"%3F")}function sm(e){return e==null?"":rm(e).replace(Yv,"%2F")}function es(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function am(e){const t={};if(e===""||e==="?")return t;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let r=0;r<i.length;++r){const s=i[r].replace(yf," "),a=s.indexOf("="),o=es(a<0?s:s.slice(0,a)),l=a<0?null:es(s.slice(a+1));if(o in t){let c=t[o];ke(c)||(c=t[o]=[c]),c.push(l)}else t[o]=l}return t}function Il(e){let t="";for(let n in e){const i=e[n];if(n=im(n),i==null){i!==void 0&&(t+=(t.length?"&":"")+n);continue}(ke(i)?i.map(s=>s&&La(s)):[i&&La(i)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+n,s!=null&&(t+="="+s))})}return t}function om(e){const t={};for(const n in e){const i=e[n];i!==void 0&&(t[n]=ke(i)?i.map(r=>r==null?null:""+r):i==null?i:""+i)}return t}const lm=Symbol(""),wl=Symbol(""),Ss=Symbol(""),lo=Symbol(""),Da=Symbol("");function Ii(){let e=[];function t(i){return e.push(i),()=>{const r=e.indexOf(i);r>-1&&e.splice(r,1)}}function n(){e=[]}return{add:t,list:()=>e,reset:n}}function yn(e,t,n,i,r){const s=i&&(i.enterCallbacks[r]=i.enterCallbacks[r]||[]);return()=>new Promise((a,o)=>{const l=h=>{h===!1?o(bi(4,{from:n,to:t})):h instanceof Error?o(h):Iv(h)?o(bi(2,{from:t,to:h})):(s&&i.enterCallbacks[r]===s&&typeof h=="function"&&s.push(h),a())},c=e.call(i&&i.instances[r],t,n,l);let u=Promise.resolve(c);e.length<3&&(u=u.then(l)),u.catch(h=>o(h))})}function Js(e,t,n,i){const r=[];for(const s of e)for(const a in s.components){let o=s.components[a];if(!(t!=="beforeRouteEnter"&&!s.instances[a]))if(cm(o)){const c=(o.__vccOpts||o)[t];c&&r.push(yn(c,n,i,s,a))}else{let l=o();r.push(()=>l.then(c=>{if(!c)return Promise.reject(new Error(`Couldn't resolve component "${a}" at "${s.path}"`));const u=vv(c)?c.default:c;s.components[a]=u;const d=(u.__vccOpts||u)[t];return d&&yn(d,n,i,s,a)()}))}}return r}function cm(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function kl(e){const t=Ge(Ss),n=Ge(lo),i=xe(()=>t.resolve(ht(e.to))),r=xe(()=>{const{matched:l}=i.value,{length:c}=l,u=l[c-1],h=n.matched;if(!u||!h.length)return-1;const d=h.findIndex(xi.bind(null,u));if(d>-1)return d;const y=Fl(l[c-2]);return c>1&&Fl(u)===y&&h[h.length-1].path!==y?h.findIndex(xi.bind(null,l[c-2])):d}),s=xe(()=>r.value>-1&&hm(n.params,i.value.params)),a=xe(()=>r.value>-1&&r.value===n.matched.length-1&&df(n.params,i.value.params));function o(l={}){return dm(l)?t[ht(e.replace)?"replace":"push"](ht(e.to)).catch(Gi):Promise.resolve()}return{route:i,href:xe(()=>i.value.href),isActive:s,isExactActive:a,navigate:o}}const um=Bu({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:kl,setup(e,{slots:t}){const n=yr(kl(e)),{options:i}=Ge(Ss),r=xe(()=>({[Bl(e.activeClass,i.linkActiveClass,"router-link-active")]:n.isActive,[Bl(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const s=t.default&&t.default(n);return e.custom?s:ao("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},s)}}}),fm=um;function dm(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function hm(e,t){for(const n in t){const i=t[n],r=e[n];if(typeof i=="string"){if(i!==r)return!1}else if(!ke(r)||r.length!==i.length||i.some((s,a)=>s!==r[a]))return!1}return!0}function Fl(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Bl=(e,t,n)=>e!=null?e:t!=null?t:n,gm=Bu({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const i=Ge(Da),r=xe(()=>e.route||i.value),s=Ge(wl,0),a=xe(()=>{let c=ht(s);const{matched:u}=r.value;let h;for(;(h=u[c])&&!h.components;)c++;return c}),o=xe(()=>r.value.matched[a.value]);Vr(wl,xe(()=>a.value+1)),Vr(lm,o),Vr(Da,r);const l=at();return Pe(()=>[l.value,o.value,e.name],([c,u,h],[d,y,x])=>{u&&(u.instances[h]=c,y&&y!==u&&c&&c===d&&(u.leaveGuards.size||(u.leaveGuards=y.leaveGuards),u.updateGuards.size||(u.updateGuards=y.updateGuards))),c&&u&&(!y||!xi(u,y)||!d)&&(u.enterCallbacks[h]||[]).forEach(D=>D(c))},{flush:"post"}),()=>{const c=r.value,u=e.name,h=o.value,d=h&&h.components[u];if(!d)return Nl(n.default,{Component:d,route:c});const y=h.props[u],x=y?y===!0?c.params:typeof y=="function"?y(c):y:null,S=ao(d,Ot({},x,t,{onVnodeUnmounted:L=>{L.component.isUnmounted&&(h.instances[u]=null)},ref:l}));return Nl(n.default,{Component:S,route:c})||S}}});function Nl(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const Tf=gm;function vm(e){const t=jv(e.routes,e),n=e.parseQuery||am,i=e.stringifyQuery||Il,r=e.history,s=Ii(),a=Ii(),o=Ii(),l=Ch(gn);let c=gn;ci&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Xs.bind(null,U=>""+U),h=Xs.bind(null,sm),d=Xs.bind(null,es);function y(U,j){let G,X;return gf(U)?(G=t.getRecordMatcher(U),X=j):X=U,t.addRoute(X,G)}function x(U){const j=t.getRecordMatcher(U);j&&t.removeRoute(j)}function D(){return t.getRoutes().map(U=>U.record)}function S(U){return!!t.getRecordMatcher(U)}function L(U,j){if(j=Ot({},j||l.value),typeof U=="string"){const rt=Qs(n,U,j.path),W=t.resolve({path:rt.path},j),V=r.createHref(rt.fullPath);return Ot(rt,W,{params:d(W.params),hash:es(rt.hash),redirectedFrom:void 0,href:V})}let G;if("path"in U)G=Ot({},U,{path:Qs(n,U.path,j.path).path});else{const rt=Ot({},U.params);for(const W in rt)rt[W]==null&&delete rt[W];G=Ot({},U,{params:h(U.params)}),j.params=h(j.params)}const X=t.resolve(G,j),J=U.hash||"";X.params=u(d(X.params));const nt=yv(i,Ot({},U,{hash:nm(J),path:X.path})),ot=r.createHref(nt);return Ot({fullPath:nt,hash:J,query:i===Il?om(U.query):U.query||{}},X,{redirectedFrom:void 0,href:ot})}function g(U){return typeof U=="string"?Qs(n,U,l.value.path):Ot({},U)}function f(U,j){if(c!==U)return bi(8,{from:j,to:U})}function E(U){return p(U)}function _(U){return E(Ot(g(U),{replace:!0}))}function C(U){const j=U.matched[U.matched.length-1];if(j&&j.redirect){const{redirect:G}=j;let X=typeof G=="function"?G(U):G;return typeof X=="string"&&(X=X.includes("?")||X.includes("#")?X=g(X):{path:X},X.params={}),Ot({query:U.query,hash:U.hash,params:"path"in X?{}:U.params},X)}}function p(U,j){const G=c=L(U),X=l.value,J=U.state,nt=U.force,ot=U.replace===!0,rt=C(G);if(rt)return p(Ot(g(rt),{state:typeof rt=="object"?Ot({},J,rt.state):J,force:nt,replace:ot}),j||G);const W=G;W.redirectedFrom=j;let V;return!nt&&Ev(i,X,G)&&(V=bi(16,{to:W,from:X}),B(X,X,!0,!1)),(V?Promise.resolve(V):m(W,X)).catch(z=>qe(z)?qe(z,2)?z:k(z):I(z,W,X)).then(z=>{if(z){if(qe(z,2))return p(Ot({replace:ot},g(z.to),{state:typeof z.to=="object"?Ot({},J,z.to.state):J,force:nt}),j||W)}else z=b(W,X,!0,ot,J);return A(W,X,z),z})}function v(U,j){const G=f(U,j);return G?Promise.reject(G):Promise.resolve()}function m(U,j){let G;const[X,J,nt]=mm(U,j);G=Js(X.reverse(),"beforeRouteLeave",U,j);for(const rt of X)rt.leaveGuards.forEach(W=>{G.push(yn(W,U,j))});const ot=v.bind(null,U,j);return G.push(ot),ai(G).then(()=>{G=[];for(const rt of s.list())G.push(yn(rt,U,j));return G.push(ot),ai(G)}).then(()=>{G=Js(J,"beforeRouteUpdate",U,j);for(const rt of J)rt.updateGuards.forEach(W=>{G.push(yn(W,U,j))});return G.push(ot),ai(G)}).then(()=>{G=[];for(const rt of U.matched)if(rt.beforeEnter&&!j.matched.includes(rt))if(ke(rt.beforeEnter))for(const W of rt.beforeEnter)G.push(yn(W,U,j));else G.push(yn(rt.beforeEnter,U,j));return G.push(ot),ai(G)}).then(()=>(U.matched.forEach(rt=>rt.enterCallbacks={}),G=Js(nt,"beforeRouteEnter",U,j),G.push(ot),ai(G))).then(()=>{G=[];for(const rt of a.list())G.push(yn(rt,U,j));return G.push(ot),ai(G)}).catch(rt=>qe(rt,8)?rt:Promise.reject(rt))}function A(U,j,G){for(const X of o.list())X(U,j,G)}function b(U,j,G,X,J){const nt=f(U,j);if(nt)return nt;const ot=j===gn,rt=ci?history.state:{};G&&(X||ot?r.replace(U.fullPath,Ot({scroll:ot&&rt&&rt.scroll},J)):r.push(U.fullPath,J)),l.value=U,B(U,j,G,ot),k()}let T;function P(){T||(T=r.listen((U,j,G)=>{if(!H.listening)return;const X=L(U),J=C(X);if(J){p(Ot(J,{replace:!0}),X).catch(Gi);return}c=X;const nt=l.value;ci&&Av(Ll(nt.fullPath,G.delta),_s()),m(X,nt).catch(ot=>qe(ot,12)?ot:qe(ot,2)?(p(ot.to,X).then(rt=>{qe(rt,20)&&!G.delta&&G.type===ur.pop&&r.go(-1,!1)}).catch(Gi),Promise.reject()):(G.delta&&r.go(-G.delta,!1),I(ot,X,nt))).then(ot=>{ot=ot||b(X,nt,!1),ot&&(G.delta&&!qe(ot,8)?r.go(-G.delta,!1):G.type===ur.pop&&qe(ot,20)&&r.go(-1,!1)),A(X,nt,ot)}).catch(Gi)}))}let O=Ii(),M=Ii(),R;function I(U,j,G){k(U);const X=M.list();return X.length?X.forEach(J=>J(U,j,G)):console.error(U),Promise.reject(U)}function w(){return R&&l.value!==gn?Promise.resolve():new Promise((U,j)=>{O.add([U,j])})}function k(U){return R||(R=!U,P(),O.list().forEach(([j,G])=>U?G(U):j()),O.reset()),U}function B(U,j,G,X){const{scrollBehavior:J}=e;if(!ci||!J)return Promise.resolve();const nt=!G&&Cv(Ll(U.fullPath,0))||(X||!G)&&history.state&&history.state.scroll||null;return qa().then(()=>J(U,j,nt)).then(ot=>ot&&Dv(ot)).catch(ot=>I(ot,U,j))}const F=U=>r.go(U);let N;const K=new Set,H={currentRoute:l,listening:!0,addRoute:y,removeRoute:x,hasRoute:S,getRoutes:D,resolve:L,options:e,push:E,replace:_,go:F,back:()=>F(-1),forward:()=>F(1),beforeEach:s.add,beforeResolve:a.add,afterEach:o.add,onError:M.add,isReady:w,install(U){const j=this;U.component("RouterLink",fm),U.component("RouterView",Tf),U.config.globalProperties.$router=j,Object.defineProperty(U.config.globalProperties,"$route",{enumerable:!0,get:()=>ht(l)}),ci&&!N&&l.value===gn&&(N=!0,E(r.location).catch(J=>{}));const G={};for(const J in gn)G[J]=xe(()=>l.value[J]);U.provide(Ss,j),U.provide(lo,yr(G)),U.provide(Da,l);const X=U.unmount;K.add(U),U.unmount=function(){K.delete(U),K.size<1&&(c=gn,T&&T(),T=null,l.value=gn,N=!1,R=!1),X()}}};return H}function ai(e){return e.reduce((t,n)=>t.then(()=>n()),Promise.resolve())}function mm(e,t){const n=[],i=[],r=[],s=Math.max(t.matched.length,e.matched.length);for(let a=0;a<s;a++){const o=t.matched[a];o&&(e.matched.find(c=>xi(c,o))?i.push(o):n.push(o));const l=e.matched[a];l&&(t.matched.find(c=>xi(c,l))||r.push(l))}return[n,i,r]}function me(){return Ge(Ss)}function Mi(){return Ge(lo)}const pm={__name:"App",setup(e){console.log("asdf");let t=window.innerHeight*.01;return document.documentElement.style.setProperty("--vh",`${t}px`),window.addEventListener("resize",()=>{let n=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${n}px`)}),(n,i)=>(it(),Yt(ht(Tf)))}},Ie="https://api.bazzled.com",ym="https://api.ttv.lol",ns=e=>Ie+"/corsproxy/"+encodeURIComponent(e);const Em=["src"],xm=$("video",{width:"352",height:"198",controls:"",autoplay:""},[$("source",{src:"https://d2vjef5jvl6bfs.cloudfront.net/54f790f2c61d8ba5c420_xqc_40210004249_1663185654/chunked/index-muted-Y5M5KBUFTE.m3u8",type:"application/x-mpegURL"})],-1),bm={__name:"VodViewOriginal",setup(e){const t='video/mp4; codecs="avc1.42E01E, mp4a.40.2"',n=at(""),i=at("");at("");const r=at(""),s=at(null),a=async()=>{n.value||(n.value="https://www.twitch.tv/videos/1590984204");const l=await(await fetch(`${Ie.value}/twitch/getVodSource/${n.value}`)).text();i.value=l.split("chunked")[0],console.log(l),await fetch(`${Ie.value}/twitch/downloadChunk/${i.value}chunked/0.ts`);const c="frag2",u=new MediaSource;r.value=URL.createObjectURL(u),u.addEventListener("sourceopen",()=>{console.log(u.readyState);const h=u.addSourceBuffer(t);fetch(`${Ie.value}/twitch/getChunkMp4/${c}`).then(d=>d.arrayBuffer()).then(d=>{console.log(u.readyState),h.appendBuffer(d),h.onupdateend=()=>{u.endOfStream(),s.value.play()}})})};return(o,l)=>(it(),lt(Rt,null,[zt($("input",{"onUpdate:modelValue":l[0]||(l[0]=c=>n.value=c),id:"vod-input",placeholder:"enter vod link"},null,512),[[on,n.value]]),$("button",{onClick:a},"Go"),$("video",{ref_key:"videoPlayer",ref:s,id:"video-player",controls:"",autoplay:"",src:r.value,type:"video/mp4"},null,8,Em),xm],64))}};var Tm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _m(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var _f={exports:{}};(function(e,t){typeof window<"u"&&function(i,r){e.exports=r()}(Tm,function(){return function(n){var i={};function r(s){if(i[s])return i[s].exports;var a=i[s]={i:s,l:!1,exports:{}};return n[s].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=n,r.c=i,r.d=function(s,a,o){r.o(s,a)||Object.defineProperty(s,a,{enumerable:!0,get:o})},r.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},r.t=function(s,a){if(a&1&&(s=r(s)),a&8||a&4&&typeof s=="object"&&s&&s.__esModule)return s;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:s}),a&2&&typeof s!="string")for(var l in s)r.d(o,l,function(c){return s[c]}.bind(null,l));return o},r.n=function(s){var a=s&&s.__esModule?function(){return s.default}:function(){return s};return r.d(a,"a",a),a},r.o=function(s,a){return Object.prototype.hasOwnProperty.call(s,a)},r.p="/dist/",r(r.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(n,i,r){var s=Object.prototype.hasOwnProperty,a="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(a=!1));function l(d,y,x){this.fn=d,this.context=y,this.once=x||!1}function c(d,y,x,D,S){if(typeof x!="function")throw new TypeError("The listener must be a function");var L=new l(x,D||d,S),g=a?a+y:y;return d._events[g]?d._events[g].fn?d._events[g]=[d._events[g],L]:d._events[g].push(L):(d._events[g]=L,d._eventsCount++),d}function u(d,y){--d._eventsCount===0?d._events=new o:delete d._events[y]}function h(){this._events=new o,this._eventsCount=0}h.prototype.eventNames=function(){var y=[],x,D;if(this._eventsCount===0)return y;for(D in x=this._events)s.call(x,D)&&y.push(a?D.slice(1):D);return Object.getOwnPropertySymbols?y.concat(Object.getOwnPropertySymbols(x)):y},h.prototype.listeners=function(y){var x=a?a+y:y,D=this._events[x];if(!D)return[];if(D.fn)return[D.fn];for(var S=0,L=D.length,g=new Array(L);S<L;S++)g[S]=D[S].fn;return g},h.prototype.listenerCount=function(y){var x=a?a+y:y,D=this._events[x];return D?D.fn?1:D.length:0},h.prototype.emit=function(y,x,D,S,L,g){var f=a?a+y:y;if(!this._events[f])return!1;var E=this._events[f],_=arguments.length,C,p;if(E.fn){switch(E.once&&this.removeListener(y,E.fn,void 0,!0),_){case 1:return E.fn.call(E.context),!0;case 2:return E.fn.call(E.context,x),!0;case 3:return E.fn.call(E.context,x,D),!0;case 4:return E.fn.call(E.context,x,D,S),!0;case 5:return E.fn.call(E.context,x,D,S,L),!0;case 6:return E.fn.call(E.context,x,D,S,L,g),!0}for(p=1,C=new Array(_-1);p<_;p++)C[p-1]=arguments[p];E.fn.apply(E.context,C)}else{var v=E.length,m;for(p=0;p<v;p++)switch(E[p].once&&this.removeListener(y,E[p].fn,void 0,!0),_){case 1:E[p].fn.call(E[p].context);break;case 2:E[p].fn.call(E[p].context,x);break;case 3:E[p].fn.call(E[p].context,x,D);break;case 4:E[p].fn.call(E[p].context,x,D,S);break;default:if(!C)for(m=1,C=new Array(_-1);m<_;m++)C[m-1]=arguments[m];E[p].fn.apply(E[p].context,C)}}return!0},h.prototype.on=function(y,x,D){return c(this,y,x,D,!1)},h.prototype.once=function(y,x,D){return c(this,y,x,D,!0)},h.prototype.removeListener=function(y,x,D,S){var L=a?a+y:y;if(!this._events[L])return this;if(!x)return u(this,L),this;var g=this._events[L];if(g.fn)g.fn===x&&(!S||g.once)&&(!D||g.context===D)&&u(this,L);else{for(var f=0,E=[],_=g.length;f<_;f++)(g[f].fn!==x||S&&!g[f].once||D&&g[f].context!==D)&&E.push(g[f]);E.length?this._events[L]=E.length===1?E[0]:E:u(this,L)}return this},h.prototype.removeAllListeners=function(y){var x;return y?(x=a?a+y:y,this._events[x]&&u(this,x)):(this._events=new o,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=a,h.EventEmitter=h,n.exports=h},"./node_modules/url-toolkit/src/url-toolkit.js":function(n,i,r){(function(s){var a=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,o=/^(?=([^\/?#]*))\1([^]*)$/,l=/(?:\/|^)\.(?=\/)/g,c=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,u={buildAbsoluteURL:function(h,d,y){if(y=y||{},h=h.trim(),d=d.trim(),!d){if(!y.alwaysNormalize)return h;var x=u.parseURL(h);if(!x)throw new Error("Error trying to parse base URL.");return x.path=u.normalizePath(x.path),u.buildURLFromParts(x)}var D=u.parseURL(d);if(!D)throw new Error("Error trying to parse relative URL.");if(D.scheme)return y.alwaysNormalize?(D.path=u.normalizePath(D.path),u.buildURLFromParts(D)):d;var S=u.parseURL(h);if(!S)throw new Error("Error trying to parse base URL.");if(!S.netLoc&&S.path&&S.path[0]!=="/"){var L=o.exec(S.path);S.netLoc=L[1],S.path=L[2]}S.netLoc&&!S.path&&(S.path="/");var g={scheme:S.scheme,netLoc:D.netLoc,path:null,params:D.params,query:D.query,fragment:D.fragment};if(!D.netLoc&&(g.netLoc=S.netLoc,D.path[0]!=="/"))if(!D.path)g.path=S.path,D.params||(g.params=S.params,D.query||(g.query=S.query));else{var f=S.path,E=f.substring(0,f.lastIndexOf("/")+1)+D.path;g.path=u.normalizePath(E)}return g.path===null&&(g.path=y.alwaysNormalize?u.normalizePath(D.path):D.path),u.buildURLFromParts(g)},parseURL:function(h){var d=a.exec(h);return d?{scheme:d[1]||"",netLoc:d[2]||"",path:d[3]||"",params:d[4]||"",query:d[5]||"",fragment:d[6]||""}:null},normalizePath:function(h){for(h=h.split("").reverse().join("").replace(l,"");h.length!==(h=h.replace(c,"")).length;);return h.split("").reverse().join("")},buildURLFromParts:function(h){return h.scheme+h.netLoc+h.path+h.params+h.query+h.fragment}};n.exports=u})()},"./node_modules/webworkify-webpack/index.js":function(n,i,r){function s(y){var x={};function D(L){if(x[L])return x[L].exports;var g=x[L]={i:L,l:!1,exports:{}};return y[L].call(g.exports,g,g.exports,D),g.l=!0,g.exports}D.m=y,D.c=x,D.i=function(L){return L},D.d=function(L,g,f){D.o(L,g)||Object.defineProperty(L,g,{configurable:!1,enumerable:!0,get:f})},D.r=function(L){Object.defineProperty(L,"__esModule",{value:!0})},D.n=function(L){var g=L&&L.__esModule?function(){return L.default}:function(){return L};return D.d(g,"a",g),g},D.o=function(L,g){return Object.prototype.hasOwnProperty.call(L,g)},D.p="/",D.oe=function(L){throw console.error(L),L};var S=D(D.s=ENTRY_MODULE);return S.default||S}var a="[\\.|\\-|\\+|\\w|/|@]+",o="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+a+").*?\\)";function l(y){return(y+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function c(y){return!isNaN(1*y)}function u(y,x,D){var S={};S[D]=[];var L=x.toString(),g=L.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!g)return S;for(var f=g[1],E=new RegExp("(\\\\n|\\W)"+l(f)+o,"g"),_;_=E.exec(L);)_[3]!=="dll-reference"&&S[D].push(_[3]);for(E=new RegExp("\\("+l(f)+'\\("(dll-reference\\s('+a+'))"\\)\\)'+o,"g");_=E.exec(L);)y[_[2]]||(S[D].push(_[1]),y[_[2]]=r(_[1]).m),S[_[2]]=S[_[2]]||[],S[_[2]].push(_[4]);for(var C=Object.keys(S),p=0;p<C.length;p++)for(var v=0;v<S[C[p]].length;v++)c(S[C[p]][v])&&(S[C[p]][v]=1*S[C[p]][v]);return S}function h(y){var x=Object.keys(y);return x.reduce(function(D,S){return D||y[S].length>0},!1)}function d(y,x){for(var D={main:[x]},S={main:[]},L={main:{}};h(D);)for(var g=Object.keys(D),f=0;f<g.length;f++){var E=g[f],_=D[E],C=_.pop();if(L[E]=L[E]||{},!(L[E][C]||!y[E][C])){L[E][C]=!0,S[E]=S[E]||[],S[E].push(C);for(var p=u(y,y[E][C],E),v=Object.keys(p),m=0;m<v.length;m++)D[v[m]]=D[v[m]]||[],D[v[m]]=D[v[m]].concat(p[v[m]])}}return S}n.exports=function(y,x){x=x||{};var D={main:r.m},S=x.all?{main:Object.keys(D.main)}:d(D,y),L="";Object.keys(S).filter(function(C){return C!=="main"}).forEach(function(C){for(var p=0;S[C][p];)p++;S[C].push(p),D[C][p]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",L=L+"var "+C+" = ("+s.toString().replace("ENTRY_MODULE",JSON.stringify(p))+")({"+S[C].map(function(v){return""+JSON.stringify(v)+": "+D[C][v].toString()}).join(",")+`});
`}),L=L+"new (("+s.toString().replace("ENTRY_MODULE",JSON.stringify(y))+")({"+S.main.map(function(C){return""+JSON.stringify(C)+": "+D.main[C].toString()}).join(",")+"}))(self);";var g=new window.Blob([L],{type:"text/javascript"});if(x.bare)return g;var f=window.URL||window.webkitURL||window.mozURL||window.msURL,E=f.createObjectURL(g),_=new window.Worker(E);return _.objectURL=E,_}},"./src/config.ts":function(n,i,r){r.r(i),r.d(i,"hlsDefaultConfig",function(){return m}),r.d(i,"mergeConfig",function(){return b}),r.d(i,"enableStreamingMode",function(){return T});var s=r("./src/controller/abr-controller.ts"),a=r("./src/controller/audio-stream-controller.ts"),o=r("./src/controller/audio-track-controller.ts"),l=r("./src/controller/subtitle-stream-controller.ts"),c=r("./src/controller/subtitle-track-controller.ts"),u=r("./src/controller/buffer-controller.ts"),h=r("./src/controller/timeline-controller.ts"),d=r("./src/controller/cap-level-controller.ts"),y=r("./src/controller/fps-controller.ts"),x=r("./src/controller/eme-controller.ts"),D=r("./src/controller/cmcd-controller.ts"),S=r("./src/utils/xhr-loader.ts"),L=r("./src/utils/fetch-loader.ts"),g=r("./src/utils/cues.ts"),f=r("./src/utils/mediakeys-helper.ts"),E=r("./src/utils/logger.ts");function _(){return _=Object.assign?Object.assign.bind():function(P){for(var O=1;O<arguments.length;O++){var M=arguments[O];for(var R in M)Object.prototype.hasOwnProperty.call(M,R)&&(P[R]=M[R])}return P},_.apply(this,arguments)}function C(P,O){var M=Object.keys(P);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(P);O&&(R=R.filter(function(I){return Object.getOwnPropertyDescriptor(P,I).enumerable})),M.push.apply(M,R)}return M}function p(P){for(var O=1;O<arguments.length;O++){var M=arguments[O]!=null?arguments[O]:{};O%2?C(Object(M),!0).forEach(function(R){v(P,R,M[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(M)):C(Object(M)).forEach(function(R){Object.defineProperty(P,R,Object.getOwnPropertyDescriptor(M,R))})}return P}function v(P,O,M){return O in P?Object.defineProperty(P,O,{value:M,enumerable:!0,configurable:!0,writable:!0}):P[O]=M,P}var m=p(p({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:S.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:s.default,bufferController:u.default,capLevelController:d.default,fpsController:y.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:f.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0},A()),{},{subtitleStreamController:l.SubtitleStreamController,subtitleTrackController:c.default,timelineController:h.TimelineController,audioStreamController:a.default,audioTrackController:o.default,emeController:x.default,cmcdController:D.default});function A(){return{cueHandler:g.default,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function b(P,O){if((O.liveSyncDurationCount||O.liveMaxLatencyDurationCount)&&(O.liveSyncDuration||O.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(O.liveMaxLatencyDurationCount!==void 0&&(O.liveSyncDurationCount===void 0||O.liveMaxLatencyDurationCount<=O.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(O.liveMaxLatencyDuration!==void 0&&(O.liveSyncDuration===void 0||O.liveMaxLatencyDuration<=O.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return _({},P,O)}function T(P){var O=P.loader;if(O!==L.default&&O!==S.default)E.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),P.progressive=!1;else{var M=Object(L.fetchSupported)();M&&(P.loader=L.default,P.progressive=!0,P.enableSoftwareAES=!0,E.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":function(n,i,r){r.r(i);var s=r("./src/polyfills/number.ts"),a=r("./src/utils/ewma-bandwidth-estimator.ts"),o=r("./src/events.ts"),l=r("./src/utils/buffer-helper.ts"),c=r("./src/errors.ts"),u=r("./src/types/loader.ts"),h=r("./src/utils/logger.ts");function d(D,S){for(var L=0;L<S.length;L++){var g=S[L];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(D,g.key,g)}}function y(D,S,L){return S&&d(D.prototype,S),L&&d(D,L),Object.defineProperty(D,"prototype",{writable:!1}),D}var x=function(){function D(L){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=L;var g=L.config;this.bwEstimator=new a.default(g.abrEwmaSlowVoD,g.abrEwmaFastVoD,g.abrEwmaDefaultEstimate),this.registerListeners()}var S=D.prototype;return S.registerListeners=function(){var g=this.hls;g.on(o.Events.FRAG_LOADING,this.onFragLoading,this),g.on(o.Events.FRAG_LOADED,this.onFragLoaded,this),g.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this),g.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),g.on(o.Events.ERROR,this.onError,this)},S.unregisterListeners=function(){var g=this.hls;g.off(o.Events.FRAG_LOADING,this.onFragLoading,this),g.off(o.Events.FRAG_LOADED,this.onFragLoaded,this),g.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this),g.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),g.off(o.Events.ERROR,this.onError,this)},S.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},S.onFragLoading=function(g,f){var E=f.frag;if(E.type===u.PlaylistLevelType.MAIN&&!this.timer){var _;this.fragCurrent=E,this.partCurrent=(_=f.part)!=null?_:null,this.timer=self.setInterval(this.onCheck,100)}},S.onLevelLoaded=function(g,f){var E=this.hls.config;f.details.live?this.bwEstimator.update(E.abrEwmaSlowLive,E.abrEwmaFastLive):this.bwEstimator.update(E.abrEwmaSlowVoD,E.abrEwmaFastVoD)},S._abandonRulesCheck=function(){var g=this.fragCurrent,f=this.partCurrent,E=this.hls,_=E.autoLevelEnabled,C=E.config,p=E.media;if(!(!g||!p)){var v=f?f.stats:g.stats,m=f?f.duration:g.duration;if(v.aborted){h.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!_||p.paused||!p.playbackRate||!p.readyState)){var A=performance.now()-v.loading.start,b=Math.abs(p.playbackRate);if(!(A<=500*m/b)){var T=E.levels,P=E.minAutoLevel,O=T[g.level],M=v.total||Math.max(v.loaded,Math.round(m*O.maxBitrate/8)),R=Math.max(1,v.bwEstimate?v.bwEstimate/8:v.loaded*1e3/A),I=(M-v.loaded)/R,w=p.currentTime,k=(l.BufferHelper.bufferInfo(p,w,C.maxBufferHole).end-w)/b;if(!(k>=2*m/b||I<=k)){var B=Number.POSITIVE_INFINITY,F;for(F=g.level-1;F>P;F--){var N=T[F].maxBitrate;if(B=m*N/(8*.8*R),B<k)break}if(!(B>=I)){var K=this.bwEstimator.getEstimate();h.logger.warn("Fragment "+g.sn+(f?" part "+f.index:"")+" of level "+g.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+F+`
      Current BW estimate: `+(Object(s.isFiniteNumber)(K)?(K/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+I.toFixed(3)+` s
      Estimated load time for the next fragment: `+B.toFixed(3)+` s
      Time to underbuffer: `+k.toFixed(3)+" s"),E.nextLoadLevel=F,this.bwEstimator.sample(A,v.loaded),this.clearTimer(),g.loader&&(this.fragCurrent=this.partCurrent=null,g.loader.abort()),E.trigger(o.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:g,part:f,stats:v})}}}}}},S.onFragLoaded=function(g,f){var E=f.frag,_=f.part;if(E.type===u.PlaylistLevelType.MAIN&&Object(s.isFiniteNumber)(E.sn)){var C=_?_.stats:E.stats,p=_?_.duration:E.duration;if(this.clearTimer(),this.lastLoadedFragLevel=E.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var v=this.hls.levels[E.level],m=(v.loaded?v.loaded.bytes:0)+C.loaded,A=(v.loaded?v.loaded.duration:0)+p;v.loaded={bytes:m,duration:A},v.realBitrate=Math.round(8*m/A)}if(E.bitrateTest){var b={stats:C,frag:E,part:_,id:E.type};this.onFragBuffered(o.Events.FRAG_BUFFERED,b)}}},S.onFragBuffered=function(g,f){var E=f.frag,_=f.part,C=_?_.stats:E.stats;if(!C.aborted&&!(E.type!==u.PlaylistLevelType.MAIN||E.sn==="initSegment")){var p=C.parsing.end-C.loading.start;this.bwEstimator.sample(p,C.loaded),C.bwEstimate=this.bwEstimator.getEstimate(),E.bitrateTest?this.bitrateTestDelay=p/1e3:this.bitrateTestDelay=0}},S.onError=function(g,f){switch(f.details){case c.ErrorDetails.FRAG_LOAD_ERROR:case c.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},S.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},S.getNextABRAutoLevel=function(){var g=this.fragCurrent,f=this.partCurrent,E=this.hls,_=E.maxAutoLevel,C=E.config,p=E.minAutoLevel,v=E.media,m=f?f.duration:g?g.duration:0,A=v?v.currentTime:0,b=v&&v.playbackRate!==0?Math.abs(v.playbackRate):1,T=this.bwEstimator?this.bwEstimator.getEstimate():C.abrEwmaDefaultEstimate,P=(l.BufferHelper.bufferInfo(v,A,C.maxBufferHole).end-A)/b,O=this.findBestLevel(T,p,_,P,C.abrBandWidthFactor,C.abrBandWidthUpFactor);if(O>=0)return O;h.logger.trace((P?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var M=m?Math.min(m,C.maxStarvationDelay):C.maxStarvationDelay,R=C.abrBandWidthFactor,I=C.abrBandWidthUpFactor;if(!P){var w=this.bitrateTestDelay;if(w){var k=m?Math.min(m,C.maxLoadingDelay):C.maxLoadingDelay;M=k-w,h.logger.trace("bitrate test took "+Math.round(1e3*w)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*M)+" ms"),R=I=1}}return O=this.findBestLevel(T,p,_,P+M,R,I),Math.max(O,0)},S.findBestLevel=function(g,f,E,_,C,p){for(var v,m=this.fragCurrent,A=this.partCurrent,b=this.lastLoadedFragLevel,T=this.hls.levels,P=T[b],O=!!(P!=null&&(v=P.details)!==null&&v!==void 0&&v.live),M=P==null?void 0:P.codecSet,R=A?A.duration:m?m.duration:0,I=E;I>=f;I--){var w=T[I];if(!(!w||M&&w.codecSet!==M)){var k=w.details,B=(A?k==null?void 0:k.partTarget:k==null?void 0:k.averagetargetduration)||R,F=void 0;I<=b?F=C*g:F=p*g;var N=T[I].maxBitrate,K=N*B/F;if(h.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+I+"/"+Math.round(F)+"/"+N+"/"+B+"/"+_+"/"+K),F>N&&(!K||O&&!this.bitrateTestDelay||K<_))return I}}return-1},y(D,[{key:"nextAutoLevel",get:function(){var g=this._nextAutoLevel,f=this.bwEstimator;if(g!==-1&&!f.canEstimate())return g;var E=this.getNextABRAutoLevel();return g!==-1&&this.hls.levels[E].loadError?g:(g!==-1&&(E=Math.min(g,E)),E)},set:function(g){this._nextAutoLevel=g}}]),D}();i.default=x},"./src/controller/audio-stream-controller.ts":function(n,i,r){r.r(i);var s=r("./src/polyfills/number.ts"),a=r("./src/controller/base-stream-controller.ts"),o=r("./src/events.ts"),l=r("./src/utils/buffer-helper.ts"),c=r("./src/controller/fragment-tracker.ts"),u=r("./src/types/level.ts"),h=r("./src/types/loader.ts"),d=r("./src/loader/fragment.ts"),y=r("./src/demux/chunk-cache.ts"),x=r("./src/demux/transmuxer-interface.ts"),D=r("./src/types/transmuxer.ts"),S=r("./src/controller/fragment-finders.ts"),L=r("./src/utils/discontinuities.ts"),g=r("./src/errors.ts");function f(){return f=Object.assign?Object.assign.bind():function(v){for(var m=1;m<arguments.length;m++){var A=arguments[m];for(var b in A)Object.prototype.hasOwnProperty.call(A,b)&&(v[b]=A[b])}return v},f.apply(this,arguments)}function E(v,m){v.prototype=Object.create(m.prototype),v.prototype.constructor=v,_(v,m)}function _(v,m){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(b,T){return b.__proto__=T,b},_(v,m)}var C=100,p=function(v){E(m,v);function m(b,T){var P;return P=v.call(this,b,T,"[audio-stream-controller]")||this,P.videoBuffer=null,P.videoTrackCC=-1,P.waitingVideoCC=-1,P.audioSwitch=!1,P.trackId=-1,P.waitingData=null,P.mainDetails=null,P.bufferFlushed=!1,P.cachedTrackLoadedData=null,P._registerListeners(),P}var A=m.prototype;return A.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},A._registerListeners=function(){var T=this.hls;T.on(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),T.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),T.on(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),T.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),T.on(o.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),T.on(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),T.on(o.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),T.on(o.Events.ERROR,this.onError,this),T.on(o.Events.BUFFER_RESET,this.onBufferReset,this),T.on(o.Events.BUFFER_CREATED,this.onBufferCreated,this),T.on(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),T.on(o.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),T.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},A._unregisterListeners=function(){var T=this.hls;T.off(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),T.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),T.off(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),T.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),T.off(o.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),T.off(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),T.off(o.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),T.off(o.Events.ERROR,this.onError,this),T.off(o.Events.BUFFER_RESET,this.onBufferReset,this),T.off(o.Events.BUFFER_CREATED,this.onBufferCreated,this),T.off(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),T.off(o.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),T.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},A.onInitPtsFound=function(T,P){var O=P.frag,M=P.id,R=P.initPTS;if(M==="main"){var I=O.cc;this.initPTS[O.cc]=R,this.log("InitPTS for cc: "+I+" found from main: "+R),this.videoTrackCC=I,this.state===a.State.WAITING_INIT_PTS&&this.tick()}},A.startLoad=function(T){if(!this.levels){this.startPosition=T,this.state=a.State.STOPPED;return}var P=this.lastCurrentTime;this.stopLoad(),this.setInterval(C),this.fragLoadError=0,P>0&&T===-1?(this.log("Override startPosition with lastCurrentTime @"+P.toFixed(3)),T=P,this.state=a.State.IDLE):(this.loadedmetadata=!1,this.state=a.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=T,this.tick()},A.doTick=function(){switch(this.state){case a.State.IDLE:this.doTickIdle();break;case a.State.WAITING_TRACK:{var T,P=this.levels,O=this.trackId,M=P==null||(T=P[O])===null||T===void 0?void 0:T.details;if(M){if(this.waitForCdnTuneIn(M))break;this.state=a.State.WAITING_INIT_PTS}break}case a.State.FRAG_LOADING_WAITING_RETRY:{var R,I=performance.now(),w=this.retryDate;(!w||I>=w||(R=this.media)!==null&&R!==void 0&&R.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=a.State.IDLE);break}case a.State.WAITING_INIT_PTS:{var k=this.waitingData;if(k){var B=k.frag,F=k.part,N=k.cache,K=k.complete;if(this.initPTS[B.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=a.State.FRAG_LOADING;var H=N.flush(),U={frag:B,part:F,payload:H,networkDetails:null};this._handleFragmentLoadProgress(U),K&&v.prototype._handleFragmentLoadComplete.call(this,U)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+B.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var j=this.getLoadPosition(),G=l.BufferHelper.bufferInfo(this.mediaBuffer,j,this.config.maxBufferHole),X=Object(S.fragmentWithinToleranceTest)(G.end,this.config.maxFragLookUpTolerance,B);X<0&&(this.log("Waiting fragment cc ("+B.cc+") @ "+B.start+" cancelled because another fragment at "+G.end+" is needed"),this.clearWaitingFragment())}}else this.state=a.State.IDLE}}this.onTickEnd()},A.clearWaitingFragment=function(){var T=this.waitingData;T&&(this.fragmentTracker.removeFragment(T.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=a.State.IDLE)},A.resetLoadingState=function(){this.clearWaitingFragment(),v.prototype.resetLoadingState.call(this)},A.onTickEnd=function(){var T=this.media;if(!(!T||!T.readyState)){var P=this.mediaBuffer?this.mediaBuffer:T,O=P.buffered;!this.loadedmetadata&&O.length&&(this.loadedmetadata=!0),this.lastCurrentTime=T.currentTime}},A.doTickIdle=function(){var T,P,O=this.hls,M=this.levels,R=this.media,I=this.trackId,w=O.config;if(!(!M||!M[I])&&!(!R&&(this.startFragRequested||!w.startFragPrefetch))){var k=M[I],B=k.details;if(!B||B.live&&this.levelLastLoaded!==I||this.waitForCdnTuneIn(B)){this.state=a.State.WAITING_TRACK;return}var F=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&F&&(this.bufferFlushed=!1,this.afterBufferFlushed(F,d.ElementaryStreamTypes.AUDIO,h.PlaylistLevelType.AUDIO));var N=this.getFwdBufferInfo(F,h.PlaylistLevelType.AUDIO);if(N!==null){var K=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,h.PlaylistLevelType.MAIN),H=N.len,U=this.getMaxBufferLength(K==null?void 0:K.len),j=this.audioSwitch;if(!(H>=U&&!j)){if(!j&&this._streamEnded(N,B)){O.trigger(o.Events.BUFFER_EOS,{type:"audio"}),this.state=a.State.ENDED;return}var G=B.fragments,X=G[0].start,J=N.end;if(j&&R){var nt=this.getLoadPosition();J=nt,B.PTSKnown&&nt<X&&(N.end>X||N.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),R.currentTime=X+.05)}if(!(K&&J>K.end+B.targetduration)&&!((!K||!K.len)&&N.len)){var ot=this.getNextFragment(J,B);if(!ot){this.bufferFlushed=!0;return}((T=ot.decryptdata)===null||T===void 0?void 0:T.keyFormat)==="identity"&&!((P=ot.decryptdata)!==null&&P!==void 0&&P.key)?this.loadKey(ot,B):this.loadFragment(ot,B,J)}}}}},A.getMaxBufferLength=function(T){var P=v.prototype.getMaxBufferLength.call(this);return T?Math.max(P,T):P},A.onMediaDetaching=function(){this.videoBuffer=null,v.prototype.onMediaDetaching.call(this)},A.onAudioTracksUpdated=function(T,P){var O=P.audioTracks;this.resetTransmuxer(),this.levels=O.map(function(M){return new u.Level(M)})},A.onAudioTrackSwitching=function(T,P){var O=!!P.url;this.trackId=P.id;var M=this.fragCurrent;M!=null&&M.loader&&M.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),O?this.setInterval(C):this.resetTransmuxer(),O?(this.audioSwitch=!0,this.state=a.State.IDLE):this.state=a.State.STOPPED,this.tick()},A.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},A.onLevelLoaded=function(T,P){this.mainDetails=P.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(o.Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},A.onAudioTrackLoaded=function(T,P){var O;if(this.mainDetails==null){this.cachedTrackLoadedData=P;return}var M=this.levels,R=P.details,I=P.id;if(!M){this.warn("Audio tracks were reset while loading level "+I);return}this.log("Track "+I+" loaded ["+R.startSN+","+R.endSN+"],duration:"+R.totalduration);var w=M[I],k=0;if(R.live||(O=w.details)!==null&&O!==void 0&&O.live){var B=this.mainDetails;if(R.fragments[0]||(R.deltaUpdateFailed=!0),R.deltaUpdateFailed||!B)return;!w.details&&R.hasProgramDateTime&&B.hasProgramDateTime?(Object(L.alignMediaPlaylistByPDT)(R,B),k=R.fragments[0].start):k=this.alignPlaylists(R,w.details)}w.details=R,this.levelLastLoaded=I,!this.startFragRequested&&(this.mainDetails||!R.live)&&this.setStartPosition(w.details,k),this.state===a.State.WAITING_TRACK&&!this.waitForCdnTuneIn(R)&&(this.state=a.State.IDLE),this.tick()},A._handleFragmentLoadProgress=function(T){var P,O=T.frag,M=T.part,R=T.payload,I=this.config,w=this.trackId,k=this.levels;if(!k){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+O.sn+" of level "+O.level+" will not be buffered");return}var B=k[w];console.assert(B,"Audio track is defined on fragment load progress");var F=B.details;console.assert(F,"Audio track details are defined on fragment load progress");var N=I.defaultAudioCodec||B.audioCodec||"mp4a.40.2",K=this.transmuxer;K||(K=this.transmuxer=new x.default(this.hls,h.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var H=this.initPTS[O.cc],U=(P=O.initSegment)===null||P===void 0?void 0:P.data;if(H!==void 0){var j=!1,G=M?M.index:-1,X=G!==-1,J=new D.ChunkMetadata(O.level,O.sn,O.stats.chunkCount,R.byteLength,G,X);K.push(R,U,N,"",O,M,F.totalduration,j,J,H)}else{this.log("Unknown video PTS for cc "+O.cc+", waiting for video PTS before demuxing audio frag "+O.sn+" of ["+F.startSN+" ,"+F.endSN+"],track "+w);var nt=this.waitingData=this.waitingData||{frag:O,part:M,cache:new y.default,complete:!1},ot=nt.cache;ot.push(new Uint8Array(R)),this.waitingVideoCC=this.videoTrackCC,this.state=a.State.WAITING_INIT_PTS}},A._handleFragmentLoadComplete=function(T){if(this.waitingData){this.waitingData.complete=!0;return}v.prototype._handleFragmentLoadComplete.call(this,T)},A.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},A.onBufferCreated=function(T,P){var O=P.tracks.audio;O&&(this.mediaBuffer=O.buffer||null),P.tracks.video&&(this.videoBuffer=P.tracks.video.buffer||null)},A.onFragBuffered=function(T,P){var O=P.frag,M=P.part;if(O.type===h.PlaylistLevelType.AUDIO){if(this.fragContextChanged(O)){this.warn("Fragment "+O.sn+(M?" p: "+M.index:"")+" of level "+O.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}O.sn!=="initSegment"&&(this.fragPrevious=O,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(o.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(O,M)}},A.onError=function(T,P){switch(P.details){case g.ErrorDetails.FRAG_LOAD_ERROR:case g.ErrorDetails.FRAG_LOAD_TIMEOUT:case g.ErrorDetails.KEY_LOAD_ERROR:case g.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(h.PlaylistLevelType.AUDIO,P);break;case g.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case g.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==a.State.ERROR&&this.state!==a.State.STOPPED&&(this.state=P.fatal?a.State.ERROR:a.State.IDLE,this.warn(P.details+" while loading frag, switching to "+this.state+" state"));break;case g.ErrorDetails.BUFFER_FULL_ERROR:if(P.parent==="audio"&&(this.state===a.State.PARSING||this.state===a.State.PARSED)){var O=!0,M=this.getFwdBufferInfo(this.mediaBuffer,h.PlaylistLevelType.AUDIO);M&&M.len>.5&&(O=!this.reduceMaxBufferLength(M.len)),O&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,v.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},A.onBufferFlushed=function(T,P){var O=P.type;O===d.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},A._handleTransmuxComplete=function(T){var P,O="audio",M=this.hls,R=T.remuxResult,I=T.chunkMeta,w=this.getCurrentContext(I);if(!w){this.warn("The loading context changed while buffering fragment "+I.sn+" of level "+I.level+". This chunk will not be buffered."),this.resetStartWhenNotLoaded(I.level);return}var k=w.frag,B=w.part,F=w.level.details,N=R.audio,K=R.text,H=R.id3,U=R.initSegment;if(!(this.fragContextChanged(k)||!F)){if(this.state=a.State.PARSING,this.audioSwitch&&N&&this.completeAudioSwitch(),U!=null&&U.tracks&&(this._bufferInitSegment(U.tracks,k,I),M.trigger(o.Events.FRAG_PARSING_INIT_SEGMENT,{frag:k,id:O,tracks:U.tracks})),N){var j=N.startPTS,G=N.endPTS,X=N.startDTS,J=N.endDTS;B&&(B.elementaryStreams[d.ElementaryStreamTypes.AUDIO]={startPTS:j,endPTS:G,startDTS:X,endDTS:J}),k.setElementaryStreamInfo(d.ElementaryStreamTypes.AUDIO,j,G,X,J),this.bufferFragmentData(N,k,B,I)}if(H!=null&&(P=H.samples)!==null&&P!==void 0&&P.length){var nt=f({id:O,frag:k,details:F},H);M.trigger(o.Events.FRAG_PARSING_METADATA,nt)}if(K){var ot=f({id:O,frag:k,details:F},K);M.trigger(o.Events.FRAG_PARSING_USERDATA,ot)}}},A._bufferInitSegment=function(T,P,O){if(this.state===a.State.PARSING){T.video&&delete T.video;var M=T.audio;if(!!M){M.levelCodec=M.codec,M.id="audio",this.log("Init audio buffer, container:"+M.container+", codecs[parsed]=["+M.codec+"]"),this.hls.trigger(o.Events.BUFFER_CODECS,T);var R=M.initSegment;if(R!=null&&R.byteLength){var I={type:"audio",frag:P,part:null,chunkMeta:O,parent:P.type,data:R};this.hls.trigger(o.Events.BUFFER_APPENDING,I)}this.tick()}}},A.loadFragment=function(T,P,O){var M=this.fragmentTracker.getState(T);this.fragCurrent=T,(this.audioSwitch||M===c.FragmentState.NOT_LOADED||M===c.FragmentState.PARTIAL)&&(T.sn==="initSegment"?this._loadInitSegment(T):P.live&&!Object(s.isFiniteNumber)(this.initPTS[T.cc])?(this.log("Waiting for video PTS in continuity counter "+T.cc+" of live stream before loading audio fragment "+T.sn+" of level "+this.trackId),this.state=a.State.WAITING_INIT_PTS):(this.startFragRequested=!0,v.prototype.loadFragment.call(this,T,P,O)))},A.completeAudioSwitch=function(){var T=this.hls,P=this.media,O=this.trackId;P&&(this.log("Switching audio track : flushing all audio"),v.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,T.trigger(o.Events.AUDIO_TRACK_SWITCHED,{id:O})},m}(a.default);i.default=p},"./src/controller/audio-track-controller.ts":function(n,i,r){r.r(i);var s=r("./src/events.ts"),a=r("./src/errors.ts"),o=r("./src/controller/base-playlist-controller.ts"),l=r("./src/types/loader.ts");function c(x,D){for(var S=0;S<D.length;S++){var L=D[S];L.enumerable=L.enumerable||!1,L.configurable=!0,"value"in L&&(L.writable=!0),Object.defineProperty(x,L.key,L)}}function u(x,D,S){return D&&c(x.prototype,D),S&&c(x,S),Object.defineProperty(x,"prototype",{writable:!1}),x}function h(x,D){x.prototype=Object.create(D.prototype),x.prototype.constructor=x,d(x,D)}function d(x,D){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(L,g){return L.__proto__=g,L},d(x,D)}var y=function(x){h(D,x);function D(L){var g;return g=x.call(this,L,"[audio-track-controller]")||this,g.tracks=[],g.groupId=null,g.tracksInGroup=[],g.trackId=-1,g.trackName="",g.selectDefaultTrack=!0,g.registerListeners(),g}var S=D.prototype;return S.registerListeners=function(){var g=this.hls;g.on(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),g.on(s.Events.MANIFEST_PARSED,this.onManifestParsed,this),g.on(s.Events.LEVEL_LOADING,this.onLevelLoading,this),g.on(s.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),g.on(s.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),g.on(s.Events.ERROR,this.onError,this)},S.unregisterListeners=function(){var g=this.hls;g.off(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),g.off(s.Events.MANIFEST_PARSED,this.onManifestParsed,this),g.off(s.Events.LEVEL_LOADING,this.onLevelLoading,this),g.off(s.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),g.off(s.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),g.off(s.Events.ERROR,this.onError,this)},S.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,x.prototype.destroy.call(this)},S.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},S.onManifestParsed=function(g,f){this.tracks=f.audioTracks||[]},S.onAudioTrackLoaded=function(g,f){var E=f.id,_=f.details,C=this.tracksInGroup[E];if(!C){this.warn("Invalid audio track id "+E);return}var p=C.details;C.details=f.details,this.log("audioTrack "+E+" loaded ["+_.startSN+"-"+_.endSN+"]"),E===this.trackId&&(this.retryCount=0,this.playlistLoaded(E,f,p))},S.onLevelLoading=function(g,f){this.switchLevel(f.level)},S.onLevelSwitching=function(g,f){this.switchLevel(f.level)},S.switchLevel=function(g){var f=this.hls.levels[g];if(!!(f!=null&&f.audioGroupIds)){var E=f.audioGroupIds[f.urlId];if(this.groupId!==E){this.groupId=E;var _=this.tracks.filter(function(p){return!E||p.groupId===E});this.selectDefaultTrack&&!_.some(function(p){return p.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=_;var C={audioTracks:_};this.log("Updating audio tracks, "+_.length+' track(s) found in "'+E+'" group-id'),this.hls.trigger(s.Events.AUDIO_TRACKS_UPDATED,C),this.selectInitialTrack()}}},S.onError=function(g,f){x.prototype.onError.call(this,g,f),!(f.fatal||!f.context)&&f.context.type===l.PlaylistContextType.AUDIO_TRACK&&f.context.id===this.trackId&&f.context.groupId===this.groupId&&this.retryLoadingOrFail(f)},S.setAudioTrack=function(g){var f=this.tracksInGroup;if(g<0||g>=f.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var E=f[this.trackId];this.log("Now switching to audio-track index "+g);var _=f[g],C=_.id,p=_.groupId,v=p===void 0?"":p,m=_.name,A=_.type,b=_.url;if(this.trackId=g,this.trackName=m,this.selectDefaultTrack=!1,this.hls.trigger(s.Events.AUDIO_TRACK_SWITCHING,{id:C,groupId:v,name:m,type:A,url:b}),!(_.details&&!_.details.live)){var T=this.switchParams(_.url,E==null?void 0:E.details);this.loadPlaylist(T)}},S.selectInitialTrack=function(){var g=this.tracksInGroup;console.assert(g.length,"Initial audio track should be selected when tracks are known");var f=this.trackName,E=this.findTrackId(f)||this.findTrackId();E!==-1?this.setAudioTrack(E):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},S.findTrackId=function(g){for(var f=this.tracksInGroup,E=0;E<f.length;E++){var _=f[E];if((!this.selectDefaultTrack||_.default)&&(!g||g===_.name))return _.id}return-1},S.loadPlaylist=function(g){var f=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(f)){var E=f.id,_=f.groupId,C=f.url;if(g)try{C=g.addDirectives(C)}catch(p){this.warn("Could not construct new URL with HLS Delivery Directives: "+p)}this.log("loading audio-track playlist for id: "+E),this.clearTimer(),this.hls.trigger(s.Events.AUDIO_TRACK_LOADING,{url:C,id:E,groupId:_,deliveryDirectives:g||null})}},u(D,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(g){this.selectDefaultTrack=!1,this.setAudioTrack(g)}}]),D}(o.default);i.default=y},"./src/controller/base-playlist-controller.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return u});var s=r("./src/polyfills/number.ts"),a=r("./src/types/level.ts"),o=r("./src/controller/level-helper.ts"),l=r("./src/utils/logger.ts"),c=r("./src/errors.ts"),u=function(){function h(y,x){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=l.logger.log.bind(l.logger,x+":"),this.warn=l.logger.warn.bind(l.logger,x+":"),this.hls=y}var d=h.prototype;return d.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},d.onError=function(x,D){D.fatal&&D.type===c.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},d.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},d.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},d.stopLoad=function(){this.canLoad=!1,this.clearTimer()},d.switchParams=function(x,D){var S=D==null?void 0:D.renditionReports;if(S)for(var L=0;L<S.length;L++){var g=S[L],f=""+g.URI;if(f===x.slice(-f.length)){var E=parseInt(g["LAST-MSN"]),_=parseInt(g["LAST-PART"]);if(D&&this.hls.config.lowLatencyMode){var C=Math.min(D.age-D.partTarget,D.targetduration);_!==void 0&&C>D.partTarget&&(_+=1)}if(Object(s.isFiniteNumber)(E))return new a.HlsUrlParameters(E,Object(s.isFiniteNumber)(_)?_:void 0,a.HlsSkip.No)}}},d.loadPlaylist=function(x){},d.shouldLoadTrack=function(x){return this.canLoad&&x&&!!x.url&&(!x.details||x.details.live)},d.playlistLoaded=function(x,D,S){var L=this,g=D.details,f=D.stats,E=f.loading.end?Math.max(0,self.performance.now()-f.loading.end):0;if(g.advancedDateTime=Date.now()-E,g.live||S!=null&&S.live){if(g.reloaded(S),S&&this.log("live playlist "+x+" "+(g.advanced?"REFRESHED "+g.lastPartSn+"-"+g.lastPartIndex:"MISSED")),S&&g.fragments.length>0&&Object(o.mergeDetails)(S,g),!this.canLoad||!g.live)return;var _,C=void 0,p=void 0;if(g.canBlockReload&&g.endSN&&g.advanced){var v=this.hls.config.lowLatencyMode,m=g.lastPartSn,A=g.endSN,b=g.lastPartIndex,T=b!==-1,P=m===A,O=v?0:b;T?(C=P?A+1:m,p=P?O:b+1):C=A+1;var M=g.age,R=M+g.ageHeader,I=Math.min(R-g.partTarget,g.targetduration*1.5);if(I>0){if(S&&I>S.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+S.tuneInGoal+" to: "+I+" with playlist age: "+g.age),I=0;else{var w=Math.floor(I/g.targetduration);if(C+=w,p!==void 0){var k=Math.round(I%g.targetduration/g.partTarget);p+=k}this.log("CDN Tune-in age: "+g.ageHeader+"s last advanced "+M.toFixed(2)+"s goal: "+I+" skip sn "+w+" to part "+p)}g.tuneInGoal=I}if(_=this.getDeliveryDirectives(g,D.deliveryDirectives,C,p),v||!P){this.loadPlaylist(_);return}}else _=this.getDeliveryDirectives(g,D.deliveryDirectives,C,p);var B=Object(o.computeReloadInterval)(g,f);C!==void 0&&g.canBlockReload&&(B-=g.partTarget||1),this.log("reload live playlist "+x+" in "+Math.round(B)+" ms"),this.timer=self.setTimeout(function(){return L.loadPlaylist(_)},B)}else this.clearTimer()},d.getDeliveryDirectives=function(x,D,S,L){var g=Object(a.getSkipValue)(x,S);return D!=null&&D.skip&&x.deltaUpdateFailed&&(S=D.msn,L=D.part,g=a.HlsSkip.No),new a.HlsUrlParameters(S,L,g)},d.retryLoadingOrFail=function(x){var D=this,S=this.hls.config,L=this.retryCount<S.levelLoadingMaxRetry;if(L){var g;if(this.retryCount++,x.details.indexOf("LoadTimeOut")>-1&&(g=x.context)!==null&&g!==void 0&&g.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+x.details+'"'),this.loadPlaylist();else{var f=Math.min(Math.pow(2,this.retryCount)*S.levelLoadingRetryDelay,S.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return D.loadPlaylist()},f),this.warn("retry playlist loading #"+this.retryCount+" in "+f+' ms after "'+x.details+'"')}}else this.warn('cannot recover from error "'+x.details+'"'),this.clearTimer(),x.fatal=!0;return L},h}()},"./src/controller/base-stream-controller.ts":function(n,i,r){r.r(i),r.d(i,"State",function(){return A}),r.d(i,"default",function(){return b});var s=r("./src/polyfills/number.ts"),a=r("./src/task-loop.ts"),o=r("./src/controller/fragment-tracker.ts"),l=r("./src/utils/buffer-helper.ts"),c=r("./src/utils/logger.ts"),u=r("./src/events.ts"),h=r("./src/errors.ts"),d=r("./src/types/transmuxer.ts"),y=r("./src/utils/mp4-tools.ts"),x=r("./src/utils/discontinuities.ts"),D=r("./src/controller/fragment-finders.ts"),S=r("./src/controller/level-helper.ts"),L=r("./src/loader/fragment-loader.ts"),g=r("./src/crypt/decrypter.ts"),f=r("./src/utils/time-ranges.ts"),E=r("./src/types/loader.ts");function _(T,P){for(var O=0;O<P.length;O++){var M=P[O];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(T,M.key,M)}}function C(T,P,O){return P&&_(T.prototype,P),O&&_(T,O),Object.defineProperty(T,"prototype",{writable:!1}),T}function p(T){if(T===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T}function v(T,P){T.prototype=Object.create(P.prototype),T.prototype.constructor=T,m(T,P)}function m(T,P){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(M,R){return M.__proto__=R,M},m(T,P)}var A={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},b=function(T){v(P,T);function P(M,R,I){var w;return w=T.call(this)||this,w.hls=void 0,w.fragPrevious=null,w.fragCurrent=null,w.fragmentTracker=void 0,w.transmuxer=null,w._state=A.STOPPED,w.media=null,w.mediaBuffer=null,w.config=void 0,w.bitrateTest=!1,w.lastCurrentTime=0,w.nextLoadPosition=0,w.startPosition=0,w.loadedmetadata=!1,w.fragLoadError=0,w.retryDate=0,w.levels=null,w.fragmentLoader=void 0,w.levelLastLoaded=null,w.startFragRequested=!1,w.decrypter=void 0,w.initPTS=[],w.onvseeking=null,w.onvended=null,w.logPrefix="",w.log=void 0,w.warn=void 0,w.logPrefix=I,w.log=c.logger.log.bind(c.logger,I+":"),w.warn=c.logger.warn.bind(c.logger,I+":"),w.hls=M,w.fragmentLoader=new L.default(M.config),w.fragmentTracker=R,w.config=M.config,w.decrypter=new g.default(M,M.config),M.on(u.Events.KEY_LOADED,w.onKeyLoaded,p(w)),M.on(u.Events.LEVEL_SWITCHING,w.onLevelSwitching,p(w)),w}var O=P.prototype;return O.doTick=function(){this.onTickEnd()},O.onTickEnd=function(){},O.startLoad=function(R){},O.stopLoad=function(){this.fragmentLoader.abort();var R=this.fragCurrent;R&&this.fragmentTracker.removeFragment(R),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=A.STOPPED},O._streamEnded=function(R,I){var w=this.fragCurrent,k=this.fragmentTracker;if(!I.live&&w&&this.media&&w.sn>=I.endSN&&!R.nextStart){var B=I.partList;if(B!=null&&B.length){var F=B[B.length-1],N=l.BufferHelper.isBuffered(this.media,F.start+F.duration/2);return N}var K=k.getState(w);return K===o.FragmentState.PARTIAL||K===o.FragmentState.OK}return!1},O.onMediaAttached=function(R,I){var w=this.media=this.mediaBuffer=I.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),w.addEventListener("seeking",this.onvseeking),w.addEventListener("ended",this.onvended);var k=this.config;this.levels&&k.autoStartLoad&&this.state===A.STOPPED&&this.startLoad(k.startPosition)},O.onMediaDetaching=function(){var R=this.media;R!=null&&R.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),R&&this.onvseeking&&this.onvended&&(R.removeEventListener("seeking",this.onvseeking),R.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},O.onMediaSeeking=function(){var R=this.config,I=this.fragCurrent,w=this.media,k=this.mediaBuffer,B=this.state,F=w?w.currentTime:0,N=l.BufferHelper.bufferInfo(k||w,F,R.maxBufferHole);if(this.log("media seeking to "+(Object(s.isFiniteNumber)(F)?F.toFixed(3):F)+", state: "+B),B===A.ENDED)this.resetLoadingState();else if(I&&!N.len){var K=R.maxFragLookUpTolerance,H=I.start-K,U=I.start+I.duration+K,j=F>U;(F<H||j)&&(j&&I.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),I.loader.abort()),this.resetLoadingState())}w&&(this.lastCurrentTime=F),!this.loadedmetadata&&!N.len&&(this.nextLoadPosition=this.startPosition=F),this.tickImmediate()},O.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},O.onKeyLoaded=function(R,I){if(!(this.state!==A.KEY_LOADING||I.frag!==this.fragCurrent||!this.levels)){this.state=A.IDLE;var w=this.levels[I.frag.level].details;w&&this.loadFragment(I.frag,w,I.frag.start)}},O.onLevelSwitching=function(R,I){this.fragLoadError=0},O.onHandlerDestroying=function(){this.stopLoad(),T.prototype.onHandlerDestroying.call(this)},O.onHandlerDestroyed=function(){this.state=A.STOPPED,this.hls.off(u.Events.KEY_LOADED,this.onKeyLoaded,this),this.hls.off(u.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,T.prototype.onHandlerDestroyed.call(this)},O.loadKey=function(R,I){this.log("Loading key for "+R.sn+" of ["+I.startSN+"-"+I.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+R.level),this.state=A.KEY_LOADING,this.fragCurrent=R,this.hls.trigger(u.Events.KEY_LOADING,{frag:R})},O.loadFragment=function(R,I,w){this._loadFragForPlayback(R,I,w)},O._loadFragForPlayback=function(R,I,w){var k=this,B=function(N){if(k.fragContextChanged(R)){k.warn("Fragment "+R.sn+(N.part?" p: "+N.part.index:"")+" of level "+R.level+" was dropped during download."),k.fragmentTracker.removeFragment(R);return}R.stats.chunkCount++,k._handleFragmentLoadProgress(N)};this._doFragLoad(R,I,w,B).then(function(F){if(!!F){k.fragLoadError=0;var N=k.state;if(k.fragContextChanged(R)){(N===A.FRAG_LOADING||!k.fragCurrent&&N===A.PARSING)&&(k.fragmentTracker.removeFragment(R),k.state=A.IDLE);return}"payload"in F&&(k.log("Loaded fragment "+R.sn+" of level "+R.level),k.hls.trigger(u.Events.FRAG_LOADED,F)),k._handleFragmentLoadComplete(F)}}).catch(function(F){k.state===A.STOPPED||k.state===A.ERROR||(k.warn(F),k.resetFragmentLoading(R))})},O.flushMainBuffer=function(R,I,w){if(w===void 0&&(w=null),!!(R-I)){var k={startOffset:R,endOffset:I,type:w};this.fragLoadError=0,this.hls.trigger(u.Events.BUFFER_FLUSHING,k)}},O._loadInitSegment=function(R){var I=this;this._doFragLoad(R).then(function(w){if(!w||I.fragContextChanged(R)||!I.levels)throw new Error("init load aborted");return w}).then(function(w){var k=I.hls,B=w.payload,F=R.decryptdata;if(B&&B.byteLength>0&&F&&F.key&&F.iv&&F.method==="AES-128"){var N=self.performance.now();return I.decrypter.webCryptoDecrypt(new Uint8Array(B),F.key.buffer,F.iv.buffer).then(function(K){var H=self.performance.now();return k.trigger(u.Events.FRAG_DECRYPTED,{frag:R,payload:K,stats:{tstart:N,tdecrypt:H}}),w.payload=K,w})}return w}).then(function(w){var k=I.fragCurrent,B=I.hls,F=I.levels;if(!F)throw new Error("init load aborted, missing levels");var N=F[R.level].details;console.assert(N,"Level details are defined when init segment is loaded");var K=R.stats;I.state=A.IDLE,I.fragLoadError=0,R.data=new Uint8Array(w.payload),K.parsing.start=K.buffering.start=self.performance.now(),K.parsing.end=K.buffering.end=self.performance.now(),w.frag===k&&B.trigger(u.Events.FRAG_BUFFERED,{stats:K,frag:k,part:null,id:R.type}),I.tick()}).catch(function(w){I.state===A.STOPPED||I.state===A.ERROR||(I.warn(w),I.resetFragmentLoading(R))})},O.fragContextChanged=function(R){var I=this.fragCurrent;return!R||!I||R.level!==I.level||R.sn!==I.sn||R.urlId!==I.urlId},O.fragBufferedComplete=function(R,I){var w=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+R.type+" sn: "+R.sn+(I?" part: "+I.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+R.level+" "+(w?f.default.toString(l.BufferHelper.getBuffered(w)):"(detached)")),this.state=A.IDLE,w&&(!this.loadedmetadata&&w.buffered.length&&this.fragCurrent===this.fragPrevious&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},O.seekToStartPos=function(){},O._handleFragmentLoadComplete=function(R){var I=this.transmuxer;if(!!I){var w=R.frag,k=R.part,B=R.partsLoaded,F=!B||B.length===0||B.some(function(K){return!K}),N=new d.ChunkMetadata(w.level,w.sn,w.stats.chunkCount+1,0,k?k.index:-1,!F);I.flush(N)}},O._handleFragmentLoadProgress=function(R){},O._doFragLoad=function(R,I,w,k){var B=this;if(w===void 0&&(w=null),!this.levels)throw new Error("frag load aborted, missing levels");if(w=Math.max(R.start,w||0),this.config.lowLatencyMode&&I){var F=I.partList;if(F&&k){w>R.end&&I.fragmentHint&&(R=I.fragmentHint);var N=this.getNextPart(F,R,w);if(N>-1){var K=F[N];return this.log("Loading part sn: "+R.sn+" p: "+K.index+" cc: "+R.cc+" of playlist ["+I.startSN+"-"+I.endSN+"] parts [0-"+N+"-"+(F.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+R.level+", target: "+parseFloat(w.toFixed(3))),this.nextLoadPosition=K.start+K.duration,this.state=A.FRAG_LOADING,this.hls.trigger(u.Events.FRAG_LOADING,{frag:R,part:F[N],targetBufferTime:w}),this.doFragPartsLoad(R,F,N,k).catch(function(H){return B.handleFragLoadError(H)})}else if(!R.url||this.loadedEndOfParts(F,w))return Promise.resolve(null)}}return this.log("Loading fragment "+R.sn+" cc: "+R.cc+" "+(I?"of ["+I.startSN+"-"+I.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+R.level+", target: "+parseFloat(w.toFixed(3))),Object(s.isFiniteNumber)(R.sn)&&!this.bitrateTest&&(this.nextLoadPosition=R.start+R.duration),this.state=A.FRAG_LOADING,this.hls.trigger(u.Events.FRAG_LOADING,{frag:R,targetBufferTime:w}),this.fragmentLoader.load(R,k).catch(function(H){return B.handleFragLoadError(H)})},O.doFragPartsLoad=function(R,I,w,k){var B=this;return new Promise(function(F,N){var K=[],H=function U(j){var G=I[j];B.fragmentLoader.loadPart(R,G,k).then(function(X){K[G.index]=X;var J=X.part;B.hls.trigger(u.Events.FRAG_LOADED,X);var nt=I[j+1];if(nt&&nt.fragment===R)U(j+1);else return F({frag:R,part:J,partsLoaded:K})}).catch(N)};H(w)})},O.handleFragLoadError=function(R){var I=R.data;return I&&I.details===h.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(I.frag,I.part):this.hls.trigger(u.Events.ERROR,I),null},O._handleTransmuxerFlush=function(R){var I=this.getCurrentContext(R);if(!I||this.state!==A.PARSING){this.fragCurrent||(this.state=A.IDLE);return}var w=I.frag,k=I.part,B=I.level,F=self.performance.now();w.stats.parsing.end=F,k&&(k.stats.parsing.end=F),this.updateLevelTiming(w,k,B,R.partial)},O.getCurrentContext=function(R){var I=this.levels,w=R.level,k=R.sn,B=R.part;if(!I||!I[w])return this.warn("Levels object was unset while buffering fragment "+k+" of level "+w+". The current chunk will not be buffered."),null;var F=I[w],N=B>-1?Object(S.getPartWith)(F,k,B):null,K=N?N.fragment:Object(S.getFragmentWithSN)(F,k,this.fragCurrent);return K?{frag:K,part:N,level:F}:null},O.bufferFragmentData=function(R,I,w,k){if(!(!R||this.state!==A.PARSING)){var B=R.data1,F=R.data2,N=B;if(B&&F&&(N=Object(y.appendUint8Array)(B,F)),!(!N||!N.length)){var K={type:R.type,frag:I,part:w,chunkMeta:k,parent:I.type,data:N};this.hls.trigger(u.Events.BUFFER_APPENDING,K),R.dropped&&R.independent&&!w&&this.flushBufferGap(I)}}},O.flushBufferGap=function(R){var I=this.media;if(!!I){if(!l.BufferHelper.isBuffered(I,I.currentTime)){this.flushMainBuffer(0,R.start);return}var w=I.currentTime,k=l.BufferHelper.bufferInfo(I,w,0),B=R.duration,F=Math.min(this.config.maxFragLookUpTolerance*2,B*.25),N=Math.max(Math.min(R.start-F,k.end-F),w+F);R.start-N>F&&this.flushMainBuffer(N,R.start)}},O.getFwdBufferInfo=function(R,I){var w=this.config,k=this.getLoadPosition();if(!Object(s.isFiniteNumber)(k))return null;var B=l.BufferHelper.bufferInfo(R,k,w.maxBufferHole);if(B.len===0&&B.nextStart!==void 0){var F=this.fragmentTracker.getBufferedFrag(k,I);if(F&&B.nextStart<F.end)return l.BufferHelper.bufferInfo(R,k,Math.max(B.nextStart,w.maxBufferHole))}return B},O.getMaxBufferLength=function(R){var I=this.config,w;return R?w=Math.max(8*I.maxBufferSize/R,I.maxBufferLength):w=I.maxBufferLength,Math.min(w,I.maxMaxBufferLength)},O.reduceMaxBufferLength=function(R){var I=this.config,w=R||I.maxBufferLength;return I.maxMaxBufferLength>=w?(I.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+I.maxMaxBufferLength+"s"),!0):!1},O.getNextFragment=function(R,I){var w=I.fragments,k=w.length;if(!k)return null;var B=this.config,F=w[0].start,N;if(I.live){var K=B.initialLiveManifestSize;if(k<K)return this.warn("Not enough fragments to start playback (have: "+k+", need: "+K+")"),null;!I.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(N=this.getInitialLiveFragment(I,w),this.startPosition=N?this.hls.liveSyncPosition||N.start:R)}else R<=F&&(N=w[0]);if(!N){var H=B.lowLatencyMode?I.partEnd:I.fragmentEnd;N=this.getFragmentAtPosition(R,H,I)}return this.mapToInitFragWhenRequired(N)},O.mapToInitFragWhenRequired=function(R){return R!=null&&R.initSegment&&!(R!=null&&R.initSegment.data)&&!this.bitrateTest?R.initSegment:R},O.getNextPart=function(R,I,w){for(var k=-1,B=!1,F=!0,N=0,K=R.length;N<K;N++){var H=R[N];if(F=F&&!H.independent,k>-1&&w<H.start)break;var U=H.loaded;!U&&(B||H.independent||F)&&H.fragment===I&&(k=N),B=U}return k},O.loadedEndOfParts=function(R,I){var w=R[R.length-1];return w&&I>w.start&&w.loaded},O.getInitialLiveFragment=function(R,I){var w=this.fragPrevious,k=null;if(w){if(R.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+w.programDateTime),k=Object(D.findFragmentByPDT)(I,w.endProgramDateTime,this.config.maxFragLookUpTolerance)),!k){var B=w.sn+1;if(B>=R.startSN&&B<=R.endSN){var F=I[B-R.startSN];w.cc===F.cc&&(k=F,this.log("Live playlist, switching playlist, load frag with next SN: "+k.sn))}k||(k=Object(D.findFragWithCC)(I,w.cc),k&&this.log("Live playlist, switching playlist, load frag with same CC: "+k.sn))}}else{var N=this.hls.liveSyncPosition;N!==null&&(k=this.getFragmentAtPosition(N,this.bitrateTest?R.fragmentEnd:R.edge,R))}return k},O.getFragmentAtPosition=function(R,I,w){var k=this.config,B=this.fragPrevious,F=w.fragments,N=w.endSN,K=w.fragmentHint,H=k.maxFragLookUpTolerance,U=!!(k.lowLatencyMode&&w.partList&&K);U&&K&&!this.bitrateTest&&(F=F.concat(K),N=K.sn);var j;if(R<I){var G=R>I-H?0:H;j=Object(D.findFragmentByPTS)(B,F,R,G)}else j=F[F.length-1];if(j){var X=j.sn-w.startSN;if(B&&j.sn===B.sn&&!U){var J=B&&j.level===B.level;if(J){var nt=F[X+1];j.sn<N&&this.fragmentTracker.getState(nt)!==o.FragmentState.OK?(this.log("SN "+j.sn+" just loaded, load next one: "+nt.sn),j=nt):j=null}}}return j},O.synchronizeToLiveEdge=function(R){var I=this.config,w=this.media;if(!!w){var k=this.hls.liveSyncPosition,B=w.currentTime,F=R.fragments[0].start,N=R.edge,K=B>=F-I.maxFragLookUpTolerance&&B<=N;if(k!==null&&w.duration>k&&(B<k||!K)){var H=I.liveMaxLatencyDuration!==void 0?I.liveMaxLatencyDuration:I.liveMaxLatencyDurationCount*R.targetduration;(!K&&w.readyState<4||B<N-H)&&(this.loadedmetadata||(this.nextLoadPosition=k),w.readyState&&(this.warn("Playback: "+B.toFixed(3)+" is located too far from the end of live sliding playlist: "+N+", reset currentTime to : "+k.toFixed(3)),w.currentTime=k))}}},O.alignPlaylists=function(R,I){var w=this.levels,k=this.levelLastLoaded,B=this.fragPrevious,F=k!==null?w[k]:null,N=R.fragments.length;if(!N)return this.warn("No fragments in live playlist"),0;var K=R.fragments[0].start,H=!I,U=R.alignedSliding&&Object(s.isFiniteNumber)(K);if(H||!U&&!K){Object(x.alignStream)(B,F,R);var j=R.fragments[0].start;return this.log("Live playlist sliding: "+j.toFixed(2)+" start-sn: "+(I?I.startSN:"na")+"->"+R.startSN+" prev-sn: "+(B?B.sn:"na")+" fragments: "+N),j}return K},O.waitForCdnTuneIn=function(R){var I=3;return R.live&&R.canBlockReload&&R.partTarget&&R.tuneInGoal>Math.max(R.partHoldBack,R.partTarget*I)},O.setStartPosition=function(R,I){var w=this.startPosition;if(w<I&&(w=-1),w===-1||this.lastCurrentTime===-1){var k=R.startTimeOffset;Object(s.isFiniteNumber)(k)?(w=I+k,k<0&&(w+=R.totalduration),w=Math.min(Math.max(I,w),I+R.totalduration),this.log("Start time offset "+k+" found in playlist, adjust startPosition to "+w),this.startPosition=w):R.live?w=this.hls.liveSyncPosition||I:this.startPosition=w=0,this.lastCurrentTime=w}this.nextLoadPosition=w},O.getLoadPosition=function(){var R=this.media,I=0;return this.loadedmetadata&&R?I=R.currentTime:this.nextLoadPosition&&(I=this.nextLoadPosition),I},O.handleFragLoadAborted=function(R,I){this.transmuxer&&R.sn!=="initSegment"&&R.stats.aborted&&(this.warn("Fragment "+R.sn+(I?" part"+I.index:"")+" of level "+R.level+" was aborted"),this.resetFragmentLoading(R))},O.resetFragmentLoading=function(R){(!this.fragCurrent||!this.fragContextChanged(R)&&this.state!==A.FRAG_LOADING_WAITING_RETRY)&&(this.state=A.IDLE)},O.onFragmentOrKeyLoadError=function(R,I){if(!I.fatal){var w=I.frag;if(!(!w||w.type!==R)){var k=this.fragCurrent;console.assert(k&&w.sn===k.sn&&w.level===k.level&&w.urlId===k.urlId,"Frag load error must match current frag to retry");var B=this.config;if(this.fragLoadError+1<=B.fragLoadingMaxRetry){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);var F=Math.min(Math.pow(2,this.fragLoadError)*B.fragLoadingRetryDelay,B.fragLoadingMaxRetryTimeout);this.warn("Fragment "+w.sn+" of "+R+" "+w.level+" failed to load, retrying in "+F+"ms"),this.retryDate=self.performance.now()+F,this.fragLoadError++,this.state=A.FRAG_LOADING_WAITING_RETRY}else I.levelRetry?(R===E.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=A.IDLE):(c.logger.error(I.details+" reaches max retry, redispatch as fatal ..."),I.fatal=!0,this.hls.stopLoad(),this.state=A.ERROR)}}},O.afterBufferFlushed=function(R,I,w){if(!!R){var k=l.BufferHelper.getBuffered(R);this.fragmentTracker.detectEvictedFragments(I,k,w),this.state===A.ENDED&&this.resetLoadingState()}},O.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=A.IDLE},O.resetStartWhenNotLoaded=function(R){if(!this.loadedmetadata){this.startFragRequested=!1;var I=this.levels?this.levels[R].details:null;I!=null&&I.live?(this.startPosition=-1,this.setStartPosition(I,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},O.updateLevelTiming=function(R,I,w,k){var B=this,F=w.details;console.assert(!!F,"level.details must be defined");var N=Object.keys(R.elementaryStreams).reduce(function(K,H){var U=R.elementaryStreams[H];if(U){var j=U.endPTS-U.startPTS;if(j<=0)return B.warn("Could not parse fragment "+R.sn+" "+H+" duration reliably ("+j+")"),K||!1;var G=k?0:Object(S.updateFragPTSDTS)(F,R,U.startPTS,U.endPTS,U.startDTS,U.endDTS);return B.hls.trigger(u.Events.LEVEL_PTS_UPDATED,{details:F,level:w,drift:G,type:H,frag:R,start:U.startPTS,end:U.endPTS}),!0}return K},!1);N||(this.warn("Found no media in fragment "+R.sn+" of level "+w.id+" resetting transmuxer to fallback to playlist timing"),this.resetTransmuxer()),this.state=A.PARSED,this.hls.trigger(u.Events.FRAG_PARSED,{frag:R,part:I})},O.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},C(P,[{key:"state",get:function(){return this._state},set:function(R){var I=this._state;I!==R&&(this._state=R,this.log(I+"->"+R))}}]),P}(a.default)},"./src/controller/buffer-controller.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return D});var s=r("./src/polyfills/number.ts"),a=r("./src/events.ts"),o=r("./src/utils/logger.ts"),l=r("./src/errors.ts"),c=r("./src/utils/buffer-helper.ts"),u=r("./src/utils/mediasource-helper.ts"),h=r("./src/loader/fragment.ts"),d=r("./src/controller/buffer-operation-queue.ts"),y=Object(u.getMediaSource)(),x=/([ha]vc.)(?:\.[^.,]+)+/,D=function(){function S(g){var f=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var E=f.hls,_=f.media,C=f.mediaSource;o.logger.log("[buffer-controller]: Media source opened"),_&&(f.updateMediaElementDuration(),E.trigger(a.Events.MEDIA_ATTACHED,{media:_})),C&&C.removeEventListener("sourceopen",f._onMediaSourceOpen),f.checkPendingTracks()},this._onMediaSourceClose=function(){o.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){o.logger.log("[buffer-controller]: Media source ended")},this.hls=g,this._initSourceBuffer(),this.registerListeners()}var L=S.prototype;return L.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},L.destroy=function(){this.unregisterListeners(),this.details=null},L.registerListeners=function(){var f=this.hls;f.on(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),f.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.on(a.Events.MANIFEST_PARSED,this.onManifestParsed,this),f.on(a.Events.BUFFER_RESET,this.onBufferReset,this),f.on(a.Events.BUFFER_APPENDING,this.onBufferAppending,this),f.on(a.Events.BUFFER_CODECS,this.onBufferCodecs,this),f.on(a.Events.BUFFER_EOS,this.onBufferEos,this),f.on(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),f.on(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this),f.on(a.Events.FRAG_PARSED,this.onFragParsed,this),f.on(a.Events.FRAG_CHANGED,this.onFragChanged,this)},L.unregisterListeners=function(){var f=this.hls;f.off(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),f.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.off(a.Events.MANIFEST_PARSED,this.onManifestParsed,this),f.off(a.Events.BUFFER_RESET,this.onBufferReset,this),f.off(a.Events.BUFFER_APPENDING,this.onBufferAppending,this),f.off(a.Events.BUFFER_CODECS,this.onBufferCodecs,this),f.off(a.Events.BUFFER_EOS,this.onBufferEos,this),f.off(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),f.off(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this),f.off(a.Events.FRAG_PARSED,this.onFragParsed,this),f.off(a.Events.FRAG_CHANGED,this.onFragChanged,this)},L._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new d.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},L.onManifestParsed=function(f,E){var _=2;(E.audio&&!E.video||!E.altAudio)&&(_=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=_,this.details=null,o.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},L.onMediaAttaching=function(f,E){var _=this.media=E.media;if(_&&y){var C=this.mediaSource=new y;C.addEventListener("sourceopen",this._onMediaSourceOpen),C.addEventListener("sourceended",this._onMediaSourceEnded),C.addEventListener("sourceclose",this._onMediaSourceClose),_.src=self.URL.createObjectURL(C),this._objectUrl=_.src}},L.onMediaDetaching=function(){var f=this.media,E=this.mediaSource,_=this._objectUrl;if(E){if(o.logger.log("[buffer-controller]: media source detaching"),E.readyState==="open")try{E.endOfStream()}catch(C){o.logger.warn("[buffer-controller]: onMediaDetaching: "+C.message+" while calling endOfStream")}this.onBufferReset(),E.removeEventListener("sourceopen",this._onMediaSourceOpen),E.removeEventListener("sourceended",this._onMediaSourceEnded),E.removeEventListener("sourceclose",this._onMediaSourceClose),f&&(_&&self.URL.revokeObjectURL(_),f.src===_?(f.removeAttribute("src"),f.load()):o.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(a.Events.MEDIA_DETACHED,void 0)},L.onBufferReset=function(){var f=this;this.getSourceBufferTypes().forEach(function(E){var _=f.sourceBuffer[E];try{_&&(f.removeBufferListeners(E),f.mediaSource&&f.mediaSource.removeSourceBuffer(_),f.sourceBuffer[E]=void 0)}catch(C){o.logger.warn("[buffer-controller]: Failed to reset the "+E+" buffer",C)}}),this._initSourceBuffer()},L.onBufferCodecs=function(f,E){var _=this,C=this.getSourceBufferTypes().length;Object.keys(E).forEach(function(p){if(C){var v=_.tracks[p];if(v&&typeof v.buffer.changeType=="function"){var m=E[p],A=m.id,b=m.codec,T=m.levelCodec,P=m.container,O=m.metadata,M=(v.levelCodec||v.codec).replace(x,"$1"),R=(T||b).replace(x,"$1");if(M!==R){var I=P+";codecs="+(T||b);_.appendChangeType(p,I),o.logger.log("[buffer-controller]: switching codec "+M+" to "+R),_.tracks[p]={buffer:v.buffer,codec:b,container:P,levelCodec:T,metadata:O,id:A}}}}else _.pendingTracks[p]=E[p]}),!C&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},L.appendChangeType=function(f,E){var _=this,C=this.operationQueue,p={execute:function(){var m=_.sourceBuffer[f];m&&(o.logger.log("[buffer-controller]: changing "+f+" sourceBuffer type to "+E),m.changeType(E)),C.shiftAndExecuteNext(f)},onStart:function(){},onComplete:function(){},onError:function(m){o.logger.warn("[buffer-controller]: Failed to change "+f+" SourceBuffer type",m)}};C.append(p,f)},L.onBufferAppending=function(f,E){var _=this,C=this.hls,p=this.operationQueue,v=this.tracks,m=E.data,A=E.type,b=E.frag,T=E.part,P=E.chunkMeta,O=P.buffering[A],M=self.performance.now();O.start=M;var R=b.stats.buffering,I=T?T.stats.buffering:null;R.start===0&&(R.start=M),I&&I.start===0&&(I.start=M);var w=v.audio,k=A==="audio"&&P.id===1&&(w==null?void 0:w.container)==="audio/mpeg",B={execute:function(){if(O.executeStart=self.performance.now(),k){var N=_.sourceBuffer[A];if(N){var K=b.start-N.timestampOffset;Math.abs(K)>=.1&&(o.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+b.start+" (delta: "+K+") sn: "+b.sn+")"),N.timestampOffset=b.start)}}_.appendExecutor(m,A)},onStart:function(){},onComplete:function(){var N=self.performance.now();O.executeEnd=O.end=N,R.first===0&&(R.first=N),I&&I.first===0&&(I.first=N);var K=_.sourceBuffer,H={};for(var U in K)H[U]=c.BufferHelper.getBuffered(K[U]);_.appendError=0,_.hls.trigger(a.Events.BUFFER_APPENDED,{type:A,frag:b,part:T,chunkMeta:P,parent:b.type,timeRanges:H})},onError:function(N){o.logger.error("[buffer-controller]: Error encountered while trying to append to the "+A+" SourceBuffer",N);var K={type:l.ErrorTypes.MEDIA_ERROR,parent:b.type,details:l.ErrorDetails.BUFFER_APPEND_ERROR,err:N,fatal:!1};N.code===DOMException.QUOTA_EXCEEDED_ERR?K.details=l.ErrorDetails.BUFFER_FULL_ERROR:(_.appendError++,K.details=l.ErrorDetails.BUFFER_APPEND_ERROR,_.appendError>C.config.appendErrorMaxRetry&&(o.logger.error("[buffer-controller]: Failed "+C.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),K.fatal=!0,C.stopLoad())),C.trigger(a.Events.ERROR,K)}};p.append(B,A)},L.onBufferFlushing=function(f,E){var _=this,C=this.operationQueue,p=function(m){return{execute:_.removeExecutor.bind(_,m,E.startOffset,E.endOffset),onStart:function(){},onComplete:function(){_.hls.trigger(a.Events.BUFFER_FLUSHED,{type:m})},onError:function(b){o.logger.warn("[buffer-controller]: Failed to remove from "+m+" SourceBuffer",b)}}};E.type?C.append(p(E.type),E.type):this.getSourceBufferTypes().forEach(function(v){C.append(p(v),v)})},L.onFragParsed=function(f,E){var _=this,C=E.frag,p=E.part,v=[],m=p?p.elementaryStreams:C.elementaryStreams;m[h.ElementaryStreamTypes.AUDIOVIDEO]?v.push("audiovideo"):(m[h.ElementaryStreamTypes.AUDIO]&&v.push("audio"),m[h.ElementaryStreamTypes.VIDEO]&&v.push("video"));var A=function(){var T=self.performance.now();C.stats.buffering.end=T,p&&(p.stats.buffering.end=T);var P=p?p.stats:C.stats;_.hls.trigger(a.Events.FRAG_BUFFERED,{frag:C,part:p,stats:P,id:C.type})};v.length===0&&o.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+C.type+" level: "+C.level+" sn: "+C.sn),this.blockBuffers(A,v)},L.onFragChanged=function(f,E){this.flushBackBuffer()},L.onBufferEos=function(f,E){var _=this,C=this.getSourceBufferTypes().reduce(function(p,v){var m=_.sourceBuffer[v];return(!E.type||E.type===v)&&m&&!m.ended&&(m.ended=!0,o.logger.log("[buffer-controller]: "+v+" sourceBuffer now EOS")),p&&!!(!m||m.ended)},!0);C&&this.blockBuffers(function(){var p=_.mediaSource;!p||p.readyState!=="open"||p.endOfStream()})},L.onLevelUpdated=function(f,E){var _=E.details;!_.fragments.length||(this.details=_,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},L.flushBackBuffer=function(){var f=this.hls,E=this.details,_=this.media,C=this.sourceBuffer;if(!(!_||E===null)){var p=this.getSourceBufferTypes();if(!!p.length){var v=E.live&&f.config.liveBackBufferLength!==null?f.config.liveBackBufferLength:f.config.backBufferLength;if(!(!Object(s.isFiniteNumber)(v)||v<0)){var m=_.currentTime,A=E.levelTargetDuration,b=Math.max(v,A),T=Math.floor(m/A)*A-b;p.forEach(function(P){var O=C[P];if(O){var M=c.BufferHelper.getBuffered(O);M.length>0&&T>M.start(0)&&(f.trigger(a.Events.BACK_BUFFER_REACHED,{bufferEnd:T}),E.live&&f.trigger(a.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:T}),f.trigger(a.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:T,type:P}))}})}}}},L.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var f=this.details,E=this.hls,_=this.media,C=this.mediaSource,p=f.fragments[0].start+f.totalduration,v=_.duration,m=Object(s.isFiniteNumber)(C.duration)?C.duration:0;f.live&&E.config.liveDurationInfinity?(o.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),C.duration=1/0,this.updateSeekableRange(f)):(p>m&&p>v||!Object(s.isFiniteNumber)(v))&&(o.logger.log("[buffer-controller]: Updating Media Source duration to "+p.toFixed(3)),C.duration=p)}},L.updateSeekableRange=function(f){var E=this.mediaSource,_=f.fragments,C=_.length;if(C&&f.live&&E!==null&&E!==void 0&&E.setLiveSeekableRange){var p=Math.max(0,_[0].start),v=Math.max(p,p+f.totalduration);E.setLiveSeekableRange(p,v)}},L.checkPendingTracks=function(){var f=this.bufferCodecEventsExpected,E=this.operationQueue,_=this.pendingTracks,C=Object.keys(_).length;if(C&&!f||C===2){this.createSourceBuffers(_),this.pendingTracks={};var p=this.getSourceBufferTypes();if(p.length===0){this.hls.trigger(a.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}p.forEach(function(v){E.executeNext(v)})}},L.createSourceBuffers=function(f){var E=this.sourceBuffer,_=this.mediaSource;if(!_)throw Error("createSourceBuffers called when mediaSource was null");var C=0;for(var p in f)if(!E[p]){var v=f[p];if(!v)throw Error("source buffer exists for track "+p+", however track does not");var m=v.levelCodec||v.codec,A=v.container+";codecs="+m;o.logger.log("[buffer-controller]: creating sourceBuffer("+A+")");try{var b=E[p]=_.addSourceBuffer(A),T=p;this.addBufferListener(T,"updatestart",this._onSBUpdateStart),this.addBufferListener(T,"updateend",this._onSBUpdateEnd),this.addBufferListener(T,"error",this._onSBUpdateError),this.tracks[p]={buffer:b,codec:m,container:v.container,levelCodec:v.levelCodec,metadata:v.metadata,id:v.id},C++}catch(P){o.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+P.message),this.hls.trigger(a.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:P,mimeType:A})}}C&&this.hls.trigger(a.Events.BUFFER_CREATED,{tracks:this.tracks})},L._onSBUpdateStart=function(f){var E=this.operationQueue,_=E.current(f);_.onStart()},L._onSBUpdateEnd=function(f){var E=this.operationQueue,_=E.current(f);_.onComplete(),E.shiftAndExecuteNext(f)},L._onSBUpdateError=function(f,E){o.logger.error("[buffer-controller]: "+f+" SourceBuffer error",E),this.hls.trigger(a.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var _=this.operationQueue.current(f);_&&_.onError(E)},L.removeExecutor=function(f,E,_){var C=this.media,p=this.mediaSource,v=this.operationQueue,m=this.sourceBuffer,A=m[f];if(!C||!p||!A){o.logger.warn("[buffer-controller]: Attempting to remove from the "+f+" SourceBuffer, but it does not exist"),v.shiftAndExecuteNext(f);return}var b=Object(s.isFiniteNumber)(C.duration)?C.duration:1/0,T=Object(s.isFiniteNumber)(p.duration)?p.duration:1/0,P=Math.max(0,E),O=Math.min(_,b,T);O>P?(o.logger.log("[buffer-controller]: Removing ["+P+","+O+"] from the "+f+" SourceBuffer"),console.assert(!A.updating,f+" sourceBuffer must not be updating"),A.remove(P,O)):v.shiftAndExecuteNext(f)},L.appendExecutor=function(f,E){var _=this.operationQueue,C=this.sourceBuffer,p=C[E];if(!p){o.logger.warn("[buffer-controller]: Attempting to append to the "+E+" SourceBuffer, but it does not exist"),_.shiftAndExecuteNext(E);return}p.ended=!1,console.assert(!p.updating,E+" sourceBuffer must not be updating"),p.appendBuffer(f)},L.blockBuffers=function(f,E){var _=this;if(E===void 0&&(E=this.getSourceBufferTypes()),!E.length){o.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(f);return}var C=this.operationQueue,p=E.map(function(v){return C.appendBlocker(v)});Promise.all(p).then(function(){f(),E.forEach(function(v){var m=_.sourceBuffer[v];(!m||!m.updating)&&C.shiftAndExecuteNext(v)})})},L.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},L.addBufferListener=function(f,E,_){var C=this.sourceBuffer[f];if(!!C){var p=_.bind(this,f);this.listeners[f].push({event:E,listener:p}),C.addEventListener(E,p)}},L.removeBufferListeners=function(f){var E=this.sourceBuffer[f];!E||this.listeners[f].forEach(function(_){E.removeEventListener(_.event,_.listener)})},S}()},"./src/controller/buffer-operation-queue.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return a});var s=r("./src/utils/logger.ts"),a=function(){function o(c){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=c}var l=o.prototype;return l.append=function(u,h){var d=this.queues[h];d.push(u),d.length===1&&this.buffers[h]&&this.executeNext(h)},l.insertAbort=function(u,h){var d=this.queues[h];d.unshift(u),this.executeNext(h)},l.appendBlocker=function(u){var h,d=new Promise(function(x){h=x}),y={execute:h,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(y,u),d},l.executeNext=function(u){var h=this.buffers,d=this.queues,y=h[u],x=d[u];if(x.length){var D=x[0];try{D.execute()}catch(S){s.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),D.onError(S),(!y||!y.updating)&&(x.shift(),this.executeNext(u))}}},l.shiftAndExecuteNext=function(u){this.queues[u].shift(),this.executeNext(u)},l.current=function(u){return this.queues[u][0]},o}()},"./src/controller/cap-level-controller.ts":function(n,i,r){r.r(i);var s=r("./src/events.ts");function a(c,u){for(var h=0;h<u.length;h++){var d=u[h];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}function o(c,u,h){return u&&a(c.prototype,u),h&&a(c,h),Object.defineProperty(c,"prototype",{writable:!1}),c}var l=function(){function c(h){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=h,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var u=c.prototype;return u.setStreamController=function(d){this.streamController=d},u.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},u.registerListeners=function(){var d=this.hls;d.on(s.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),d.on(s.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),d.on(s.Events.MANIFEST_PARSED,this.onManifestParsed,this),d.on(s.Events.BUFFER_CODECS,this.onBufferCodecs,this),d.on(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},u.unregisterListener=function(){var d=this.hls;d.off(s.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),d.off(s.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),d.off(s.Events.MANIFEST_PARSED,this.onManifestParsed,this),d.off(s.Events.BUFFER_CODECS,this.onBufferCodecs,this),d.off(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},u.onFpsDropLevelCapping=function(d,y){c.isLevelAllowed(y.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(y.droppedLevel)},u.onMediaAttaching=function(d,y){this.media=y.media instanceof HTMLVideoElement?y.media:null},u.onManifestParsed=function(d,y){var x=this.hls;this.restrictedLevels=[],this.firstLevel=y.firstLevel,x.config.capLevelToPlayerSize&&y.video&&this.startCapping()},u.onBufferCodecs=function(d,y){var x=this.hls;x.config.capLevelToPlayerSize&&y.video&&this.startCapping()},u.onMediaDetaching=function(){this.stopCapping()},u.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var d=this.hls.levels;if(d.length){var y=this.hls;y.autoLevelCapping=this.getMaxLevel(d.length-1),y.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=y.autoLevelCapping}}},u.getMaxLevel=function(d){var y=this,x=this.hls.levels;if(!x.length)return-1;var D=x.filter(function(S,L){return c.isLevelAllowed(L,y.restrictedLevels)&&L<=d});return this.clientRect=null,c.getMaxLevelByMediaSize(D,this.mediaWidth,this.mediaHeight)},u.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},u.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},u.getDimensions=function(){if(this.clientRect)return this.clientRect;var d=this.media,y={width:0,height:0};if(d){var x=d.getBoundingClientRect();y.width=x.width,y.height=x.height,!y.width&&!y.height&&(y.width=x.right-x.left||d.width||0,y.height=x.bottom-x.top||d.height||0)}return this.clientRect=y,y},c.isLevelAllowed=function(d,y){return y===void 0&&(y=[]),y.indexOf(d)===-1},c.getMaxLevelByMediaSize=function(d,y,x){if(!d||!d.length)return-1;for(var D=function(E,_){return _?E.width!==_.width||E.height!==_.height:!0},S=d.length-1,L=0;L<d.length;L+=1){var g=d[L];if((g.width>=y||g.height>=x)&&D(g,d[L+1])){S=L;break}}return S},o(c,[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var d=1;if(!this.hls.config.ignoreDevicePixelRatio)try{d=self.devicePixelRatio}catch{}return d}}]),c}();i.default=l},"./src/controller/cmcd-controller.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return D});var s=r("./src/events.ts"),a=r("./src/types/cmcd.ts"),o=r("./src/utils/buffer-helper.ts"),l=r("./src/utils/logger.ts");function c(S,L){for(var g=0;g<L.length;g++){var f=L[g];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(S,f.key,f)}}function u(S,L,g){return L&&c(S.prototype,L),g&&c(S,g),Object.defineProperty(S,"prototype",{writable:!1}),S}function h(S,L){var g=typeof Symbol<"u"&&S[Symbol.iterator]||S["@@iterator"];if(g)return(g=g.call(S)).next.bind(g);if(Array.isArray(S)||(g=d(S))||L&&S&&typeof S.length=="number"){g&&(S=g);var f=0;return function(){return f>=S.length?{done:!0}:{done:!1,value:S[f++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d(S,L){if(!!S){if(typeof S=="string")return y(S,L);var g=Object.prototype.toString.call(S).slice(8,-1);if(g==="Object"&&S.constructor&&(g=S.constructor.name),g==="Map"||g==="Set")return Array.from(S);if(g==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(g))return y(S,L)}}function y(S,L){(L==null||L>S.length)&&(L=S.length);for(var g=0,f=new Array(L);g<L;g++)f[g]=S[g];return f}function x(){return x=Object.assign?Object.assign.bind():function(S){for(var L=1;L<arguments.length;L++){var g=arguments[L];for(var f in g)Object.prototype.hasOwnProperty.call(g,f)&&(S[f]=g[f])}return S},x.apply(this,arguments)}var D=function(){function S(g){var f=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){f.initialized&&(f.starved=!0),f.buffering=!0},this.onPlaying=function(){f.initialized||(f.initialized=!0),f.buffering=!1},this.applyPlaylistData=function(C){try{f.apply(C,{ot:a.CMCDObjectType.MANIFEST,su:!f.initialized})}catch(p){l.logger.warn("Could not generate manifest CMCD data.",p)}},this.applyFragmentData=function(C){try{var p=C.frag,v=f.hls.levels[p.level],m=f.getObjectType(p),A={d:p.duration*1e3,ot:m};(m===a.CMCDObjectType.VIDEO||m===a.CMCDObjectType.AUDIO||m==a.CMCDObjectType.MUXED)&&(A.br=v.bitrate/1e3,A.tb=f.getTopBandwidth(m)/1e3,A.bl=f.getBufferLength(m)),f.apply(C,A)}catch(b){l.logger.warn("Could not generate segment CMCD data.",b)}},this.hls=g;var E=this.config=g.config,_=E.cmcd;_!=null&&(E.pLoader=this.createPlaylistLoader(),E.fLoader=this.createFragmentLoader(),this.sid=_.sessionId||S.uuid(),this.cid=_.contentId,this.useHeaders=_.useHeaders===!0,this.registerListeners())}var L=S.prototype;return L.registerListeners=function(){var f=this.hls;f.on(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.on(s.Events.MEDIA_DETACHED,this.onMediaDetached,this),f.on(s.Events.BUFFER_CREATED,this.onBufferCreated,this)},L.unregisterListeners=function(){var f=this.hls;f.off(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.off(s.Events.MEDIA_DETACHED,this.onMediaDetached,this),f.off(s.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},L.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},L.onMediaAttached=function(f,E){this.media=E.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},L.onMediaDetached=function(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},L.onBufferCreated=function(f,E){var _,C;this.audioBuffer=(_=E.tracks.audio)===null||_===void 0?void 0:_.buffer,this.videoBuffer=(C=E.tracks.video)===null||C===void 0?void 0:C.buffer},L.createData=function(){var f;return{v:a.CMCDVersion,sf:a.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(f=this.media)===null||f===void 0?void 0:f.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},L.apply=function(f,E){E===void 0&&(E={}),x(E,this.createData());var _=E.ot===a.CMCDObjectType.INIT||E.ot===a.CMCDObjectType.VIDEO||E.ot===a.CMCDObjectType.MUXED;if(this.starved&&_&&(E.bs=!0,E.su=!0,this.starved=!1),E.su==null&&(E.su=this.buffering),this.useHeaders){var C=S.toHeaders(E);if(!Object.keys(C).length)return;f.headers||(f.headers={}),x(f.headers,C)}else{var p=S.toQuery(E);if(!p)return;f.url=S.appendQueryToUri(f.url,p)}},L.getObjectType=function(f){var E=f.type;if(E==="subtitle")return a.CMCDObjectType.TIMED_TEXT;if(f.sn==="initSegment")return a.CMCDObjectType.INIT;if(E==="audio")return a.CMCDObjectType.AUDIO;if(E==="main")return this.hls.audioTracks.length?a.CMCDObjectType.VIDEO:a.CMCDObjectType.MUXED},L.getTopBandwidth=function(f){var E=0,_,C=this.hls;if(f===a.CMCDObjectType.AUDIO)_=C.audioTracks;else{var p=C.maxAutoLevel,v=p>-1?p+1:C.levels.length;_=C.levels.slice(0,v)}for(var m=h(_),A;!(A=m()).done;){var b=A.value;b.bitrate>E&&(E=b.bitrate)}return E>0?E:NaN},L.getBufferLength=function(f){var E=this.hls.media,_=f===a.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!_||!E)return NaN;var C=o.BufferHelper.bufferInfo(_,E.currentTime,this.config.maxBufferHole);return C.len*1e3},L.createPlaylistLoader=function(){var f=this.config.pLoader,E=this.applyPlaylistData,_=f||this.config.loader;return function(){function C(v){this.loader=void 0,this.loader=new _(v)}var p=C.prototype;return p.destroy=function(){this.loader.destroy()},p.abort=function(){this.loader.abort()},p.load=function(m,A,b){E(m),this.loader.load(m,A,b)},u(C,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),C}()},L.createFragmentLoader=function(){var f=this.config.fLoader,E=this.applyFragmentData,_=f||this.config.loader;return function(){function C(v){this.loader=void 0,this.loader=new _(v)}var p=C.prototype;return p.destroy=function(){this.loader.destroy()},p.abort=function(){this.loader.abort()},p.load=function(m,A,b){E(m),this.loader.load(m,A,b)},u(C,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),C}()},S.uuid=function(){var f=URL.createObjectURL(new Blob),E=f.toString();return URL.revokeObjectURL(f),E.slice(E.lastIndexOf("/")+1)},S.serialize=function(f){for(var E=[],_=function(k){return!Number.isNaN(k)&&k!=null&&k!==""&&k!==!1},C=function(k){return Math.round(k)},p=function(k){return C(k/100)*100},v=function(k){return encodeURIComponent(k)},m={br:C,d:C,bl:p,dl:p,mtp:p,nor:v,rtp:p,tb:C},A=Object.keys(f||{}).sort(),b=h(A),T;!(T=b()).done;){var P=T.value,O=f[P];if(!!_(O)&&!(P==="v"&&O===1)&&!(P=="pr"&&O===1)){var M=m[P];M&&(O=M(O));var R=typeof O,I=void 0;P==="ot"||P==="sf"||P==="st"?I=P+"="+O:R==="boolean"?I=P:R==="number"?I=P+"="+O:I=P+"="+JSON.stringify(O),E.push(I)}}return E.join(",")},S.toHeaders=function(f){for(var E=Object.keys(f),_={},C=["Object","Request","Session","Status"],p=[{},{},{},{}],v={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},m=0,A=E;m<A.length;m++){var b=A[m],T=v[b]!=null?v[b]:1;p[T][b]=f[b]}for(var P=0;P<p.length;P++){var O=S.serialize(p[P]);O&&(_["CMCD-"+C[P]]=O)}return _},S.toQuery=function(f){return"CMCD="+encodeURIComponent(S.serialize(f))},S.appendQueryToUri=function(f,E){if(!E)return f;var _=f.includes("?")?"&":"?";return""+f+_+E},S}()},"./src/controller/eme-controller.ts":function(n,i,r){r.r(i);var s=r("./src/events.ts"),a=r("./src/errors.ts"),o=r("./src/utils/logger.ts"),l=r("./src/utils/mediakeys-helper.ts");function c(D,S){for(var L=0;L<S.length;L++){var g=S[L];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(D,g.key,g)}}function u(D,S,L){return S&&c(D.prototype,S),L&&c(D,L),Object.defineProperty(D,"prototype",{writable:!1}),D}var h=3,d=function(S,L,g){var f={audioCapabilities:[],videoCapabilities:[]};return S.forEach(function(E){f.audioCapabilities.push({contentType:'audio/mp4; codecs="'+E+'"',robustness:g.audioRobustness||""})}),L.forEach(function(E){f.videoCapabilities.push({contentType:'video/mp4; codecs="'+E+'"',robustness:g.videoRobustness||""})}),[f]},y=function(S,L,g,f){switch(S){case l.KeySystems.WIDEVINE:return d(L,g,f);default:throw new Error("Unknown key-system: "+S)}},x=function(){function D(L){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=L,this._config=L.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var S=D.prototype;return S.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},S._registerListeners=function(){this.hls.on(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(s.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(s.Events.MANIFEST_PARSED,this.onManifestParsed,this)},S._unregisterListeners=function(){this.hls.off(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(s.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(s.Events.MANIFEST_PARSED,this.onManifestParsed,this)},S.getLicenseServerUrl=function(g){switch(g){case l.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+g+'"')},S._attemptKeySystemAccess=function(g,f,E){var _=this,C=y(g,f,E,this._drmSystemOptions);o.logger.log("Requesting encrypted media key-system access");var p=this.requestMediaKeySystemAccess(g,C);this.mediaKeysPromise=p.then(function(v){return _._onMediaKeySystemAccessObtained(g,v)}),p.catch(function(v){o.logger.error('Failed to obtain key-system "'+g+'" access:',v)})},S._onMediaKeySystemAccessObtained=function(g,f){var E=this;o.logger.log('Access for key-system "'+g+'" obtained');var _={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:f,mediaKeySystemDomain:g};this._mediaKeysList.push(_);var C=Promise.resolve().then(function(){return f.createMediaKeys()}).then(function(p){return _.mediaKeys=p,o.logger.log('Media-keys created for key-system "'+g+'"'),E._onMediaKeysCreated(),p});return C.catch(function(p){o.logger.error("Failed to create media-keys:",p)}),C},S._onMediaKeysCreated=function(){var g=this;this._mediaKeysList.forEach(function(f){f.mediaKeysSession||(f.mediaKeysSession=f.mediaKeys.createSession(),g._onNewMediaKeySession(f.mediaKeysSession))})},S._onNewMediaKeySession=function(g){var f=this;o.logger.log("New key-system session "+g.sessionId),g.addEventListener("message",function(E){f._onKeySessionMessage(g,E.message)},!1)},S._onKeySessionMessage=function(g,f){o.logger.log("Got EME message event, creating license request"),this._requestLicense(f,function(E){o.logger.log("Received license data (length: "+(E&&E.byteLength)+"), updating key-session"),g.update(E).catch(function(_){o.logger.warn("Updating key-session failed: "+_)})})},S.onMediaEncrypted=function(g){var f=this;if(o.logger.log('Media is encrypted using "'+g.initDataType+'" init data type'),!this.mediaKeysPromise){o.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var E=function(C){!f._media||(f._attemptSetMediaKeys(C),f._generateRequestWithPreferredKeySession(g.initDataType,g.initData))};this.mediaKeysPromise.then(E).catch(E)},S._attemptSetMediaKeys=function(g){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var f=this._mediaKeysList[0];if(!f||!f.mediaKeys){o.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}o.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(f.mediaKeys),this._hasSetMediaKeys=!0}},S._generateRequestWithPreferredKeySession=function(g,f){var E=this,_=this._mediaKeysList[0];if(!_){o.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(_.mediaKeysSessionInitialized){o.logger.warn("Key-Session already initialized but requested again");return}var C=_.mediaKeysSession;if(!C){o.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!f){o.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}o.logger.log('Generating key-session request for "'+g+'" init data type'),_.mediaKeysSessionInitialized=!0,C.generateRequest(g,f).then(function(){o.logger.debug("Key-session generation succeeded")}).catch(function(p){o.logger.error("Error generating key-session request:",p),E.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},S._createLicenseXhr=function(g,f,E){var _=new XMLHttpRequest;_.responseType="arraybuffer",_.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,_,g,f,E);var C=this._licenseXhrSetup;if(C)try{C.call(this.hls,_,g),C=void 0}catch(p){o.logger.error(p)}try{_.readyState||_.open("POST",g,!0),C&&C.call(this.hls,_,g)}catch(p){throw new Error("issue setting up KeySystem license XHR "+p)}return _},S._onLicenseRequestReadyStageChange=function(g,f,E,_){switch(g.readyState){case 4:if(g.status===200){this._requestLicenseFailureCount=0,o.logger.log("License request succeeded");var C=g.response,p=this._licenseResponseCallback;if(p)try{C=p.call(this.hls,g,f)}catch(m){o.logger.error(m)}_(C)}else{if(o.logger.error("License Request XHR failed ("+f+"). Status: "+g.status+" ("+g.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>h){this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var v=h-this._requestLicenseFailureCount+1;o.logger.warn("Retrying license request, "+v+" attempts left"),this._requestLicense(E,_)}break}},S._generateLicenseRequestChallenge=function(g,f){switch(g.mediaKeySystemDomain){case l.KeySystems.WIDEVINE:return f}throw new Error("unsupported key-system: "+g.mediaKeySystemDomain)},S._requestLicense=function(g,f){o.logger.log("Requesting content license for key-system");var E=this._mediaKeysList[0];if(!E){o.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var _=this.getLicenseServerUrl(E.mediaKeySystemDomain),C=this._createLicenseXhr(_,g,f);o.logger.log("Sending license request to URL: "+_);var p=this._generateLicenseRequestChallenge(E,g);C.send(p)}catch(v){o.logger.error("Failure requesting DRM license: "+v),this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},S.onMediaAttached=function(g,f){if(!!this._emeEnabled){var E=f.media;this._media=E,E.addEventListener("encrypted",this._onMediaEncrypted)}},S.onMediaDetached=function(){var g=this._media,f=this._mediaKeysList;!g||(g.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(f.map(function(E){if(E.mediaKeysSession)return E.mediaKeysSession.close().catch(function(){})})).then(function(){return g.setMediaKeys(null)}).catch(function(){}))},S.onManifestParsed=function(g,f){if(!!this._emeEnabled){var E=f.levels.map(function(C){return C.audioCodec}).filter(function(C){return!!C}),_=f.levels.map(function(C){return C.videoCodec}).filter(function(C){return!!C});this._attemptKeySystemAccess(l.KeySystems.WIDEVINE,E,_)}},u(D,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),D}();i.default=x},"./src/controller/fps-controller.ts":function(n,i,r){r.r(i);var s=r("./src/events.ts"),a=r("./src/utils/logger.ts"),o=function(){function l(u){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=u,this.registerListeners()}var c=l.prototype;return c.setStreamController=function(h){this.streamController=h},c.registerListeners=function(){this.hls.on(s.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},c.unregisterListeners=function(){this.hls.off(s.Events.MEDIA_ATTACHING,this.onMediaAttaching)},c.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},c.onMediaAttaching=function(h,d){var y=this.hls.config;if(y.capLevelOnFPSDrop){var x=d.media instanceof self.HTMLVideoElement?d.media:null;this.media=x,x&&typeof x.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),y.fpsDroppedMonitoringPeriod)}},c.checkFPS=function(h,d,y){var x=performance.now();if(d){if(this.lastTime){var D=x-this.lastTime,S=y-this.lastDroppedFrames,L=d-this.lastDecodedFrames,g=1e3*S/D,f=this.hls;if(f.trigger(s.Events.FPS_DROP,{currentDropped:S,currentDecoded:L,totalDroppedFrames:y}),g>0&&S>f.config.fpsDroppedMonitoringThreshold*L){var E=f.currentLevel;a.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+E),E>0&&(f.autoLevelCapping===-1||f.autoLevelCapping>=E)&&(E=E-1,f.trigger(s.Events.FPS_DROP_LEVEL_CAPPING,{level:E,droppedLevel:f.currentLevel}),f.autoLevelCapping=E,this.streamController.nextLevelSwitch())}}this.lastTime=x,this.lastDroppedFrames=y,this.lastDecodedFrames=d}},c.checkFPSInterval=function(){var h=this.media;if(h)if(this.isVideoPlaybackQualityAvailable){var d=h.getVideoPlaybackQuality();this.checkFPS(h,d.totalVideoFrames,d.droppedVideoFrames)}else this.checkFPS(h,h.webkitDecodedFrameCount,h.webkitDroppedFrameCount)},l}();i.default=o},"./src/controller/fragment-finders.ts":function(n,i,r){r.r(i),r.d(i,"findFragmentByPDT",function(){return o}),r.d(i,"findFragmentByPTS",function(){return l}),r.d(i,"fragmentWithinToleranceTest",function(){return c}),r.d(i,"pdtWithinToleranceTest",function(){return u}),r.d(i,"findFragWithCC",function(){return h});var s=r("./src/polyfills/number.ts"),a=r("./src/utils/binary-search.ts");function o(d,y,x){if(y===null||!Array.isArray(d)||!d.length||!Object(s.isFiniteNumber)(y))return null;var D=d[0].programDateTime;if(y<(D||0))return null;var S=d[d.length-1].endProgramDateTime;if(y>=(S||0))return null;x=x||0;for(var L=0;L<d.length;++L){var g=d[L];if(u(y,x,g))return g}return null}function l(d,y,x,D){x===void 0&&(x=0),D===void 0&&(D=0);var S=null;if(d?S=y[d.sn-y[0].sn+1]||null:x===0&&y[0].start===0&&(S=y[0]),S&&c(x,D,S)===0)return S;var L=a.default.search(y,c.bind(null,x,D));return L||S}function c(d,y,x){d===void 0&&(d=0),y===void 0&&(y=0);var D=Math.min(y,x.duration+(x.deltaPTS?x.deltaPTS:0));return x.start+x.duration-D<=d?1:x.start-D>d&&x.start?-1:0}function u(d,y,x){var D=Math.min(y,x.duration+(x.deltaPTS?x.deltaPTS:0))*1e3,S=x.endProgramDateTime||0;return S-D>d}function h(d,y){return a.default.search(d,function(x){return x.cc<y?1:x.cc>y?-1:0})}},"./src/controller/fragment-tracker.ts":function(n,i,r){r.r(i),r.d(i,"FragmentState",function(){return o}),r.d(i,"FragmentTracker",function(){return l});var s=r("./src/events.ts"),a=r("./src/types/loader.ts"),o;(function(h){h.NOT_LOADED="NOT_LOADED",h.APPENDING="APPENDING",h.PARTIAL="PARTIAL",h.OK="OK"})(o||(o={}));var l=function(){function h(y){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=y,this._registerListeners()}var d=h.prototype;return d._registerListeners=function(){var x=this.hls;x.on(s.Events.BUFFER_APPENDED,this.onBufferAppended,this),x.on(s.Events.FRAG_BUFFERED,this.onFragBuffered,this),x.on(s.Events.FRAG_LOADED,this.onFragLoaded,this)},d._unregisterListeners=function(){var x=this.hls;x.off(s.Events.BUFFER_APPENDED,this.onBufferAppended,this),x.off(s.Events.FRAG_BUFFERED,this.onFragBuffered,this),x.off(s.Events.FRAG_LOADED,this.onFragLoaded,this)},d.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},d.getAppendedFrag=function(x,D){if(D===a.PlaylistLevelType.MAIN){var S=this.activeFragment,L=this.activeParts;if(!S)return null;if(L)for(var g=L.length;g--;){var f=L[g],E=f?f.end:S.appendedPTS;if(f.start<=x&&E!==void 0&&x<=E)return g>9&&(this.activeParts=L.slice(g-9)),f}else if(S.start<=x&&S.appendedPTS!==void 0&&x<=S.appendedPTS)return S}return this.getBufferedFrag(x,D)},d.getBufferedFrag=function(x,D){for(var S=this.fragments,L=Object.keys(S),g=L.length;g--;){var f=S[L[g]];if((f==null?void 0:f.body.type)===D&&f.buffered){var E=f.body;if(E.start<=x&&x<=E.end)return E}}return null},d.detectEvictedFragments=function(x,D,S){var L=this;Object.keys(this.fragments).forEach(function(g){var f=L.fragments[g];if(!!f){if(!f.buffered){f.body.type===S&&L.removeFragment(f.body);return}var E=f.range[x];!E||E.time.some(function(_){var C=!L.isTimeBuffered(_.startPTS,_.endPTS,D);return C&&L.removeFragment(f.body),C})}})},d.detectPartialFragments=function(x){var D=this,S=this.timeRanges,L=x.frag,g=x.part;if(!(!S||L.sn==="initSegment")){var f=u(L),E=this.fragments[f];!E||(Object.keys(S).forEach(function(_){var C=L.elementaryStreams[_];if(!!C){var p=S[_],v=g!==null||C.partial===!0;E.range[_]=D.getBufferedTimes(L,g,v,p)}}),E.loaded=null,Object.keys(E.range).length?E.buffered=!0:this.removeFragment(E.body))}},d.fragBuffered=function(x){var D=u(x),S=this.fragments[D];S&&(S.loaded=null,S.buffered=!0)},d.getBufferedTimes=function(x,D,S,L){for(var g={time:[],partial:S},f=D?D.start:x.start,E=D?D.end:x.end,_=x.minEndPTS||E,C=x.maxStartPTS||f,p=0;p<L.length;p++){var v=L.start(p)-this.bufferPadding,m=L.end(p)+this.bufferPadding;if(C>=v&&_<=m){g.time.push({startPTS:Math.max(f,L.start(p)),endPTS:Math.min(E,L.end(p))});break}else if(f<m&&E>v)g.partial=!0,g.time.push({startPTS:Math.max(f,L.start(p)),endPTS:Math.min(E,L.end(p))});else if(E<=v)break}return g},d.getPartialFragment=function(x){var D=null,S,L,g,f=0,E=this.bufferPadding,_=this.fragments;return Object.keys(_).forEach(function(C){var p=_[C];!p||c(p)&&(L=p.body.start-E,g=p.body.end+E,x>=L&&x<=g&&(S=Math.min(x-L,g-x),f<=S&&(D=p.body,f=S)))}),D},d.getState=function(x){var D=u(x),S=this.fragments[D];return S?S.buffered?c(S)?o.PARTIAL:o.OK:o.APPENDING:o.NOT_LOADED},d.isTimeBuffered=function(x,D,S){for(var L,g,f=0;f<S.length;f++){if(L=S.start(f)-this.bufferPadding,g=S.end(f)+this.bufferPadding,x>=L&&D<=g)return!0;if(D<=L)return!1}return!1},d.onFragLoaded=function(x,D){var S=D.frag,L=D.part;if(!(S.sn==="initSegment"||S.bitrateTest||L)){var g=u(S);this.fragments[g]={body:S,loaded:D,buffered:!1,range:Object.create(null)}}},d.onBufferAppended=function(x,D){var S=this,L=D.frag,g=D.part,f=D.timeRanges;if(L.type===a.PlaylistLevelType.MAIN)if(this.activeFragment=L,g){var E=this.activeParts;E||(this.activeParts=E=[]),E.push(g)}else this.activeParts=null;this.timeRanges=f,Object.keys(f).forEach(function(_){var C=f[_];if(S.detectEvictedFragments(_,C),!g)for(var p=0;p<C.length;p++)L.appendedPTS=Math.max(C.end(p),L.appendedPTS||0)})},d.onFragBuffered=function(x,D){this.detectPartialFragments(D)},d.hasFragment=function(x){var D=u(x);return!!this.fragments[D]},d.removeFragmentsInRange=function(x,D,S){var L=this;Object.keys(this.fragments).forEach(function(g){var f=L.fragments[g];if(!!f&&f.buffered){var E=f.body;E.type===S&&E.start<D&&E.end>x&&L.removeFragment(E)}})},d.removeFragment=function(x){var D=u(x);x.stats.loaded=0,x.clearElementaryStreamInfo(),delete this.fragments[D]},d.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},h}();function c(h){var d,y;return h.buffered&&(((d=h.range.video)===null||d===void 0?void 0:d.partial)||((y=h.range.audio)===null||y===void 0?void 0:y.partial))}function u(h){return h.type+"_"+h.level+"_"+h.urlId+"_"+h.sn}},"./src/controller/gap-controller.ts":function(n,i,r){r.r(i),r.d(i,"STALL_MINIMUM_DURATION_MS",function(){return c}),r.d(i,"MAX_START_GAP_JUMP",function(){return u}),r.d(i,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return h}),r.d(i,"SKIP_BUFFER_RANGE_START",function(){return d}),r.d(i,"default",function(){return y});var s=r("./src/utils/buffer-helper.ts"),a=r("./src/errors.ts"),o=r("./src/events.ts"),l=r("./src/utils/logger.ts"),c=250,u=2,h=.1,d=.05,y=function(){function x(S,L,g,f){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=S,this.media=L,this.fragmentTracker=g,this.hls=f}var D=x.prototype;return D.destroy=function(){this.media=null,this.hls=this.fragmentTracker=null},D.poll=function(L,g){var f=this.config,E=this.media,_=this.stalled;if(E!==null){var C=E.currentTime,p=E.seeking,v=this.seeking&&!p,m=!this.seeking&&p;if(this.seeking=p,C!==L){if(this.moved=!0,_!==null){if(this.stallReported){var A=self.performance.now()-_;l.logger.warn("playback not stuck anymore @"+C+", after "+Math.round(A)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((m||v)&&(this.stalled=null),!(E.paused&&!p||E.ended||E.playbackRate===0||!s.BufferHelper.getBuffered(E).length)){var b=s.BufferHelper.bufferInfo(E,C,0),T=b.len>0,P=b.nextStart||0;if(!(!T&&!P)){if(p){var O=b.len>u,M=!P||g&&g.start<=C||P-C>u&&!this.fragmentTracker.getPartialFragment(C);if(O||M)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var R,I=Math.max(P,b.start||0)-C,w=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,k=w==null||(R=w.details)===null||R===void 0?void 0:R.live,B=k?w.details.targetduration*2:u;if(I>0&&I<=B){this._trySkipBufferHole(null);return}}var F=self.performance.now();if(_===null){this.stalled=F;return}var N=F-_;if(!(!p&&N>=c&&(this._reportStall(b),!this.media))){var K=s.BufferHelper.bufferInfo(E,C,f.maxBufferHole);this._tryFixBufferStall(K,N)}}}}},D._tryFixBufferStall=function(L,g){var f=this.config,E=this.fragmentTracker,_=this.media;if(_!==null){var C=_.currentTime,p=E.getPartialFragment(C);if(p){var v=this._trySkipBufferHole(p);if(v||!this.media)return}L.len>f.maxBufferHole&&g>f.highBufferWatchdogPeriod*1e3&&(l.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},D._reportStall=function(L){var g=this.hls,f=this.media,E=this.stallReported;!E&&f&&(this.stallReported=!0,l.logger.warn("Playback stalling at @"+f.currentTime+" due to low buffer ("+JSON.stringify(L)+")"),g.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:L.len}))},D._trySkipBufferHole=function(L){var g=this.config,f=this.hls,E=this.media;if(E===null)return 0;for(var _=E.currentTime,C=0,p=s.BufferHelper.getBuffered(E),v=0;v<p.length;v++){var m=p.start(v);if(_+g.maxBufferHole>=C&&_<m){var A=Math.max(m+d,E.currentTime+h);return l.logger.warn("skipping hole, adjusting currentTime from "+_+" to "+A),this.moved=!0,this.stalled=null,E.currentTime=A,L&&f.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+_+" to "+A,frag:L}),A}C=p.end(v)}return 0},D._tryNudgeBuffer=function(){var L=this.config,g=this.hls,f=this.media,E=this.nudgeRetry;if(f!==null){var _=f.currentTime;if(this.nudgeRetry++,E<L.nudgeMaxRetry){var C=_+(E+1)*L.nudgeOffset;l.logger.warn("Nudging 'currentTime' from "+_+" to "+C),f.currentTime=C,g.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else l.logger.error("Playhead still not moving while enough data buffered @"+_+" after "+L.nudgeMaxRetry+" nudges"),g.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}},x}()},"./src/controller/id3-track-controller.ts":function(n,i,r){r.r(i);var s=r("./src/polyfills/number.ts"),a=r("./src/events.ts"),o=r("./src/utils/texttrack-utils.ts"),l=r("./src/demux/id3.ts"),c=r("./src/loader/date-range.ts"),u=r("./src/types/demuxer.ts"),h=.25;function d(){return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}function y(S,L){return S.getTime()/1e3-L}function x(S){return Uint8Array.from(S.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}var D=function(){function S(g){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=g,this._registerListeners()}var L=S.prototype;return L.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},L._registerListeners=function(){var f=this.hls;f.on(a.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.on(a.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),f.on(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),f.on(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},L._unregisterListeners=function(){var f=this.hls;f.off(a.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.off(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.off(a.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),f.off(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),f.off(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},L.onMediaAttached=function(f,E){this.media=E.media},L.onMediaDetaching=function(){!this.id3Track||(Object(o.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},L.onManifestLoading=function(){this.dateRangeCuesAppended={}},L.createTrack=function(f){var E=this.getID3Track(f.textTracks);return E.mode="hidden",E},L.getID3Track=function(f){if(!!this.media){for(var E=0;E<f.length;E++){var _=f[E];if(_.kind==="metadata"&&_.label==="id3")return Object(o.sendAddTrackEvent)(_,this.media),_}return this.media.addTextTrack("metadata","id3")}},L.onFragParsingMetadata=function(f,E){if(!!this.media){var _=this.hls.config,C=_.enableEmsgMetadataCues,p=_.enableID3MetadataCues;if(!(!C&&!p)){var v=E.frag,m=E.samples,A=E.details;this.id3Track||(this.id3Track=this.createTrack(this.media));for(var b=A.edge||v.end,T=d(),P=!1,O={},M=0;M<m.length;M++){var R=m[M].type;if(!(R===u.MetadataSchema.emsg&&!C||!p)){var I=l.getID3Frames(m[M].data);if(I){var w=m[M].pts,k=b,B=k-w;B<=0&&(k=w+h);for(var F=0;F<I.length;F++){var N=I[F];if(!l.isTimeStampFrame(N)){var K=new T(w,k,"");K.value=N,R&&(K.type=R),this.id3Track.addCue(K),O[N.key]=null,P=!0}}}}}P&&this.updateId3CueEnds(O)}}},L.updateId3CueEnds=function(f){var E,_=(E=this.id3Track)===null||E===void 0?void 0:E.cues;if(_)for(var C=_.length;C--;){var p,v=_[C],m=(p=v.value)===null||p===void 0?void 0:p.key;if(m&&m in f){var A=f[m];A&&v.endTime!==A&&(v.endTime=A),f[m]=v.startTime}}},L.onBufferFlushing=function(f,E){var _=E.startOffset,C=E.endOffset,p=E.type,v=this.id3Track,m=this.hls;if(!!m){var A=m.config,b=A.enableEmsgMetadataCues,T=A.enableID3MetadataCues;if(v&&(b||T)){var P;p==="audio"?P=function(M){return M.type===u.MetadataSchema.audioId3&&T}:p==="video"?P=function(M){return M.type===u.MetadataSchema.emsg&&b}:P=function(M){return M.type===u.MetadataSchema.audioId3&&T||M.type===u.MetadataSchema.emsg&&b},Object(o.removeCuesInRange)(v,_,C,P)}}},L.onLevelUpdated=function(f,E){var _=this,C=E.details;if(!(!this.media||!C.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)){var p=this.dateRangeCuesAppended,v=this.id3Track,m=C.dateRanges,A=Object.keys(m);if(v)for(var b=Object.keys(p).filter(function(B){return!A.includes(B)}),T=function(F){var N=b[F];Object.keys(p[N].cues).forEach(function(K){v.removeCue(p[N].cues[K])}),delete p[N]},P=b.length;P--;)T(P);var O=C.fragments[C.fragments.length-1];if(!(A.length===0||!Object(s.isFiniteNumber)(O==null?void 0:O.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var M=O.programDateTime/1e3-O.start,R=C.edge||O.end,I=d(),w=function(F){var N=A[F],K=m[N],H=p[N],U=(H==null?void 0:H.cues)||{},j=(H==null?void 0:H.durationKnown)||!1,G=y(K.startDate,M),X=R,J=K.endDate;if(J)X=y(J,M),j=!0;else if(K.endOnNext&&!j){var nt=A.reduce(function(Y,Q){var Z=m[Q];return Z.class===K.class&&Z.id!==Q&&Z.startDate>K.startDate&&Y.push(Z),Y},[]).sort(function(Y,Q){return Y.startDate.getTime()-Q.startDate.getTime()})[0];nt&&(X=y(nt.startDate,M),j=!0)}for(var ot=Object.keys(K.attr),rt=0;rt<ot.length;rt++){var W=ot[rt];if(!(W===c.DateRangeAttribute.ID||W===c.DateRangeAttribute.CLASS||W===c.DateRangeAttribute.START_DATE||W===c.DateRangeAttribute.DURATION||W===c.DateRangeAttribute.END_DATE||W===c.DateRangeAttribute.END_ON_NEXT)){var V=U[W];if(V)j&&!H.durationKnown&&(V.endTime=X);else{var z=K.attr[W];V=new I(G,X,""),(W===c.DateRangeAttribute.SCTE35_OUT||W===c.DateRangeAttribute.SCTE35_IN)&&(z=x(z)),V.value={key:W,data:z},V.type=u.MetadataSchema.dateRange,_.id3Track.addCue(V),U[W]=V}}}p[N]={cues:U,dateRange:K,durationKnown:j}},k=0;k<A.length;k++)w(k)}}},S}();i.default=D},"./src/controller/latency-controller.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return u});var s=r("./src/errors.ts"),a=r("./src/events.ts"),o=r("./src/utils/logger.ts");function l(h,d){for(var y=0;y<d.length;y++){var x=d[y];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(h,x.key,x)}}function c(h,d,y){return d&&l(h.prototype,d),y&&l(h,y),Object.defineProperty(h,"prototype",{writable:!1}),h}var u=function(){function h(y){var x=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return x.timeupdate()},this.hls=y,this.config=y.config,this.registerListeners()}var d=h.prototype;return d.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},d.registerListeners=function(){this.hls.on(a.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(a.Events.ERROR,this.onError,this)},d.unregisterListeners=function(){this.hls.off(a.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(a.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(a.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(a.Events.ERROR,this.onError)},d.onMediaAttached=function(x,D){this.media=D.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},d.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},d.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},d.onLevelUpdated=function(x,D){var S=D.details;this.levelDetails=S,S.advanced&&this.timeupdate(),!S.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},d.onError=function(x,D){D.details===s.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,o.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},d.timeupdate=function(){var x=this.media,D=this.levelDetails;if(!(!x||!D)){this.currentTime=x.currentTime;var S=this.computeLatency();if(S!==null){this._latency=S;var L=this.config,g=L.lowLatencyMode,f=L.maxLiveSyncPlaybackRate;if(!(!g||f===1)){var E=this.targetLatency;if(E!==null){var _=S-E,C=Math.min(this.maxLatency,E+D.targetduration),p=_<C;if(D.live&&p&&_>.05&&this.forwardBufferLength>1){var v=Math.min(2,Math.max(1,f)),m=Math.round(2/(1+Math.exp(-.75*_-this.edgeStalled))*20)/20;x.playbackRate=Math.min(v,Math.max(1,m))}else x.playbackRate!==1&&x.playbackRate!==0&&(x.playbackRate=1)}}}}},d.estimateLiveEdge=function(){var x=this.levelDetails;return x===null?null:x.edge+x.age},d.computeLatency=function(){var x=this.estimateLiveEdge();return x===null?null:x-this.currentTime},c(h,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var x=this.config,D=this.levelDetails;return x.liveMaxLatencyDuration!==void 0?x.liveMaxLatencyDuration:D?x.liveMaxLatencyDurationCount*D.targetduration:0}},{key:"targetLatency",get:function(){var x=this.levelDetails;if(x===null)return null;var D=x.holdBack,S=x.partHoldBack,L=x.targetduration,g=this.config,f=g.liveSyncDuration,E=g.liveSyncDurationCount,_=g.lowLatencyMode,C=this.hls.userConfig,p=_&&S||D;(C.liveSyncDuration||C.liveSyncDurationCount||p===0)&&(p=f!==void 0?f:E*L);var v=L,m=1;return p+Math.min(this.stallCount*m,v)}},{key:"liveSyncPosition",get:function(){var x=this.estimateLiveEdge(),D=this.targetLatency,S=this.levelDetails;if(x===null||D===null||S===null)return null;var L=S.edge,g=x-D-this.edgeStalled,f=L-S.totalduration,E=L-(this.config.lowLatencyMode&&S.partTarget||S.targetduration);return Math.min(Math.max(f,g),E)}},{key:"drift",get:function(){var x=this.levelDetails;return x===null?1:x.drift}},{key:"edgeStalled",get:function(){var x=this.levelDetails;if(x===null)return 0;var D=(this.config.lowLatencyMode&&x.partTarget||x.targetduration)*3;return Math.max(x.age-D,0)}},{key:"forwardBufferLength",get:function(){var x=this.media,D=this.levelDetails;if(!x||!D)return 0;var S=x.buffered.length;return(S?x.buffered.end(S-1):D.edge)-this.currentTime}}]),h}()},"./src/controller/level-controller.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return g});var s=r("./src/types/level.ts"),a=r("./src/events.ts"),o=r("./src/errors.ts"),l=r("./src/utils/codecs.ts"),c=r("./src/controller/level-helper.ts"),u=r("./src/controller/base-playlist-controller.ts"),h=r("./src/types/loader.ts");function d(){return d=Object.assign?Object.assign.bind():function(f){for(var E=1;E<arguments.length;E++){var _=arguments[E];for(var C in _)Object.prototype.hasOwnProperty.call(_,C)&&(f[C]=_[C])}return f},d.apply(this,arguments)}function y(f,E){for(var _=0;_<E.length;_++){var C=E[_];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(f,C.key,C)}}function x(f,E,_){return E&&y(f.prototype,E),_&&y(f,_),Object.defineProperty(f,"prototype",{writable:!1}),f}function D(f,E){f.prototype=Object.create(E.prototype),f.prototype.constructor=f,S(f,E)}function S(f,E){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(C,p){return C.__proto__=p,C},S(f,E)}var L=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),g=function(f){D(E,f);function E(C){var p;return p=f.call(this,C,"[level-controller]")||this,p._levels=[],p._firstLevel=-1,p._startLevel=void 0,p.currentLevelIndex=-1,p.manualLevelIndex=-1,p.onParsedComplete=void 0,p._registerListeners(),p}var _=E.prototype;return _._registerListeners=function(){var p=this.hls;p.on(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),p.on(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),p.on(a.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),p.on(a.Events.FRAG_LOADED,this.onFragLoaded,this),p.on(a.Events.ERROR,this.onError,this)},_._unregisterListeners=function(){var p=this.hls;p.off(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),p.off(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),p.off(a.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),p.off(a.Events.FRAG_LOADED,this.onFragLoaded,this),p.off(a.Events.ERROR,this.onError,this)},_.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,f.prototype.destroy.call(this)},_.startLoad=function(){var p=this._levels;p.forEach(function(v){v.loadError=0}),f.prototype.startLoad.call(this)},_.onManifestLoaded=function(p,v){var m=[],A=[],b=[],T,P={},O,M=!1,R=!1,I=!1;if(v.levels.forEach(function(F){var N=F.attrs;M=M||!!(F.width&&F.height),R=R||!!F.videoCodec,I=I||!!F.audioCodec,L&&F.audioCodec&&F.audioCodec.indexOf("mp4a.40.34")!==-1&&(F.audioCodec=void 0);var K=F.bitrate+"-"+F.attrs.RESOLUTION+"-"+F.attrs.CODECS;O=P[K],O?O.url.push(F.url):(O=new s.Level(F),P[K]=O,m.push(O)),N&&(N.AUDIO&&Object(c.addGroupId)(O,"audio",N.AUDIO),N.SUBTITLES&&Object(c.addGroupId)(O,"text",N.SUBTITLES))}),(M||R)&&I&&(m=m.filter(function(F){var N=F.videoCodec,K=F.width,H=F.height;return!!N||!!(K&&H)})),m=m.filter(function(F){var N=F.audioCodec,K=F.videoCodec;return(!N||Object(l.isCodecSupportedInMp4)(N,"audio"))&&(!K||Object(l.isCodecSupportedInMp4)(K,"video"))}),v.audioTracks&&(A=v.audioTracks.filter(function(F){return!F.audioCodec||Object(l.isCodecSupportedInMp4)(F.audioCodec,"audio")}),Object(c.assignTrackIdsByGroup)(A)),v.subtitles&&(b=v.subtitles,Object(c.assignTrackIdsByGroup)(b)),m.length>0){T=m[0].bitrate,m.sort(function(F,N){return F.bitrate-N.bitrate}),this._levels=m;for(var w=0;w<m.length;w++)if(m[w].bitrate===T){this._firstLevel=w,this.log("manifest loaded, "+m.length+" level(s) found, first bitrate: "+T);break}var k=I&&!R,B={levels:m,audioTracks:A,subtitleTracks:b,firstLevel:this._firstLevel,stats:v.stats,audio:I,video:R,altAudio:!k&&A.some(function(F){return!!F.url})};this.hls.trigger(a.Events.MANIFEST_PARSED,B),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(a.Events.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:v.url,reason:"no level with compatible codecs found in manifest"})},_.onError=function(p,v){var m;if(f.prototype.onError.call(this,p,v),!v.fatal){var A=v.context,b=this._levels[this.currentLevelIndex];if(A&&(A.type===h.PlaylistContextType.AUDIO_TRACK&&b.audioGroupIds&&A.groupId===b.audioGroupIds[b.urlId]||A.type===h.PlaylistContextType.SUBTITLE_TRACK&&b.textGroupIds&&A.groupId===b.textGroupIds[b.urlId])){this.redundantFailover(this.currentLevelIndex);return}var T=!1,P=!0,O;switch(v.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:case o.ErrorDetails.KEY_LOAD_ERROR:case o.ErrorDetails.KEY_LOAD_TIMEOUT:if(v.frag){var M=v.frag.type===h.PlaylistLevelType.MAIN?v.frag.level:this.currentLevelIndex,R=this._levels[M];R?(R.fragmentError++,R.fragmentError>this.hls.config.fragLoadingMaxRetry&&(O=M)):O=M}break;case o.ErrorDetails.LEVEL_LOAD_ERROR:case o.ErrorDetails.LEVEL_LOAD_TIMEOUT:A&&(A.deliveryDirectives&&(P=!1),O=A.level),T=!0;break;case o.ErrorDetails.REMUX_ALLOC_ERROR:O=(m=v.level)!=null?m:this.currentLevelIndex,T=!0;break}O!==void 0&&this.recoverLevel(v,O,T,P)}},_.recoverLevel=function(p,v,m,A){var b=p.details,T=this._levels[v];if(T.loadError++,m){var P=this.retryLoadingOrFail(p);if(P)p.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(A){var O=T.url.length;if(O>1&&T.loadError<O)p.levelRetry=!0,this.redundantFailover(v);else if(this.manualLevelIndex===-1){for(var M=-1,R=this._levels,I=R.length;I--;){var w=(I+this.currentLevelIndex)%R.length;if(w!==this.currentLevelIndex&&R[w].loadError===0){M=w;break}}M>-1&&this.currentLevelIndex!==M&&(this.warn(b+": switch to "+M),p.levelRetry=!0,this.hls.nextAutoLevel=M)}}},_.redundantFailover=function(p){var v=this._levels[p],m=v.url.length;if(m>1){var A=(v.urlId+1)%m;this.warn("Switching to redundant URL-id "+A),this._levels.forEach(function(b){b.urlId=A}),this.level=p}},_.onFragLoaded=function(p,v){var m=v.frag;if(m!==void 0&&m.type===h.PlaylistLevelType.MAIN){var A=this._levels[m.level];A!==void 0&&(A.fragmentError=0,A.loadError=0)}},_.onLevelLoaded=function(p,v){var m,A=v.level,b=v.details,T=this._levels[A];if(!T){var P;this.warn("Invalid level index "+A),(P=v.deliveryDirectives)!==null&&P!==void 0&&P.skip&&(b.deltaUpdateFailed=!0);return}A===this.currentLevelIndex?(T.fragmentError===0&&(T.loadError=0,this.retryCount=0),this.playlistLoaded(A,v,T.details)):(m=v.deliveryDirectives)!==null&&m!==void 0&&m.skip&&(b.deltaUpdateFailed=!0)},_.onAudioTrackSwitched=function(p,v){var m=this.hls.levels[this.currentLevelIndex];if(!!m&&m.audioGroupIds){for(var A=-1,b=this.hls.audioTracks[v.id].groupId,T=0;T<m.audioGroupIds.length;T++)if(m.audioGroupIds[T]===b){A=T;break}A!==m.urlId&&(m.urlId=A,this.startLoad())}},_.loadPlaylist=function(p){var v=this.currentLevelIndex,m=this._levels[v];if(this.canLoad&&m&&m.url.length>0){var A=m.urlId,b=m.url[A];if(p)try{b=p.addDirectives(b)}catch(T){this.warn("Could not construct new URL with HLS Delivery Directives: "+T)}this.log("Attempt loading level index "+v+(p?" at sn "+p.msn+" part "+p.part:"")+" with URL-id "+A+" "+b),this.clearTimer(),this.hls.trigger(a.Events.LEVEL_LOADING,{url:b,level:v,id:A,deliveryDirectives:p||null})}},_.removeLevel=function(p,v){var m=function(T,P){return P!==v},A=this._levels.filter(function(b,T){return T!==p?!0:b.url.length>1&&v!==void 0?(b.url=b.url.filter(m),b.audioGroupIds&&(b.audioGroupIds=b.audioGroupIds.filter(m)),b.textGroupIds&&(b.textGroupIds=b.textGroupIds.filter(m)),b.urlId=0,!0):!1}).map(function(b,T){var P=b.details;return P!=null&&P.fragments&&P.fragments.forEach(function(O){O.level=T}),b});this._levels=A,this.hls.trigger(a.Events.LEVELS_UPDATED,{levels:A})},x(E,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(p){var v,m=this._levels;if(m.length!==0&&!(this.currentLevelIndex===p&&(v=m[p])!==null&&v!==void 0&&v.details)){if(p<0||p>=m.length){var A=p<0;if(this.hls.trigger(a.Events.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.LEVEL_SWITCH_ERROR,level:p,fatal:A,reason:"invalid level idx"}),A)return;p=Math.min(p,m.length-1)}this.clearTimer();var b=this.currentLevelIndex,T=m[b],P=m[p];this.log("switching to level "+p+" from "+b),this.currentLevelIndex=p;var O=d({},P,{level:p,maxBitrate:P.maxBitrate,uri:P.uri,urlId:P.urlId});delete O._urlId,this.hls.trigger(a.Events.LEVEL_SWITCHING,O);var M=P.details;if(!M||M.live){var R=this.switchParams(P.uri,T==null?void 0:T.details);this.loadPlaylist(R)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(p){this.manualLevelIndex=p,this._startLevel===void 0&&(this._startLevel=p),p!==-1&&(this.level=p)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(p){this._firstLevel=p}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var p=this.hls.config.startLevel;return p!==void 0?p:this._firstLevel}else return this._startLevel},set:function(p){this._startLevel=p}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(p){this.level=p,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=p)}}]),E}(u.default)},"./src/controller/level-helper.ts":function(n,i,r){r.r(i),r.d(i,"addGroupId",function(){return c}),r.d(i,"assignTrackIdsByGroup",function(){return u}),r.d(i,"updatePTS",function(){return h}),r.d(i,"updateFragPTSDTS",function(){return y}),r.d(i,"mergeDetails",function(){return x}),r.d(i,"mapPartIntersection",function(){return S}),r.d(i,"mapFragmentIntersection",function(){return L}),r.d(i,"adjustSliding",function(){return g}),r.d(i,"addSliding",function(){return f}),r.d(i,"computeReloadInterval",function(){return E}),r.d(i,"getFragmentWithSN",function(){return _}),r.d(i,"getPartWith",function(){return C});var s=r("./src/polyfills/number.ts"),a=r("./src/utils/logger.ts"),o=r("./src/loader/date-range.ts");function l(){return l=Object.assign?Object.assign.bind():function(p){for(var v=1;v<arguments.length;v++){var m=arguments[v];for(var A in m)Object.prototype.hasOwnProperty.call(m,A)&&(p[A]=m[A])}return p},l.apply(this,arguments)}function c(p,v,m){switch(v){case"audio":p.audioGroupIds||(p.audioGroupIds=[]),p.audioGroupIds.push(m);break;case"text":p.textGroupIds||(p.textGroupIds=[]),p.textGroupIds.push(m);break}}function u(p){var v={};p.forEach(function(m){var A=m.groupId||"";m.id=v[A]=v[A]||0,v[A]++})}function h(p,v,m){var A=p[v],b=p[m];d(A,b)}function d(p,v){var m=v.startPTS;if(Object(s.isFiniteNumber)(m)){var A=0,b;v.sn>p.sn?(A=m-p.start,b=p):(A=p.start-m,b=v),b.duration!==A&&(b.duration=A)}else if(v.sn>p.sn){var T=p.cc===v.cc;T&&p.minEndPTS?v.start=p.start+(p.minEndPTS-p.start):v.start=p.start+p.duration}else v.start=Math.max(p.start-v.duration,0)}function y(p,v,m,A,b,T){var P=A-m;P<=0&&(a.logger.warn("Fragment should have a positive duration",v),A=m+v.duration,T=b+v.duration);var O=m,M=A,R=v.startPTS,I=v.endPTS;if(Object(s.isFiniteNumber)(R)){var w=Math.abs(R-m);Object(s.isFiniteNumber)(v.deltaPTS)?v.deltaPTS=Math.max(w,v.deltaPTS):v.deltaPTS=w,O=Math.max(m,R),m=Math.min(m,R),b=Math.min(b,v.startDTS),M=Math.min(A,I),A=Math.max(A,I),T=Math.max(T,v.endDTS)}v.duration=A-m;var k=m-v.start;v.appendedPTS=A,v.start=v.startPTS=m,v.maxStartPTS=O,v.startDTS=b,v.endPTS=A,v.minEndPTS=M,v.endDTS=T;var B=v.sn;if(!p||B<p.startSN||B>p.endSN)return 0;var F,N=B-p.startSN,K=p.fragments;for(K[N]=v,F=N;F>0;F--)d(K[F],K[F-1]);for(F=N;F<K.length-1;F++)d(K[F],K[F+1]);return p.fragmentHint&&d(K[K.length-1],p.fragmentHint),p.PTSKnown=p.alignedSliding=!0,k}function x(p,v){for(var m=null,A=p.fragments,b=A.length-1;b>=0;b--){var T=A[b].initSegment;if(T){m=T;break}}p.fragmentHint&&delete p.fragmentHint.endPTS;var P=0,O;if(L(p,v,function(F,N){F.relurl&&(P=F.cc-N.cc),Object(s.isFiniteNumber)(F.startPTS)&&Object(s.isFiniteNumber)(F.endPTS)&&(N.start=N.startPTS=F.startPTS,N.startDTS=F.startDTS,N.appendedPTS=F.appendedPTS,N.maxStartPTS=F.maxStartPTS,N.endPTS=F.endPTS,N.endDTS=F.endDTS,N.minEndPTS=F.minEndPTS,N.duration=F.endPTS-F.startPTS,N.duration&&(O=N),v.PTSKnown=v.alignedSliding=!0),N.elementaryStreams=F.elementaryStreams,N.loader=F.loader,N.stats=F.stats,N.urlId=F.urlId,F.initSegment&&(N.initSegment=F.initSegment,m=F.initSegment)}),m){var M=v.fragmentHint?v.fragments.concat(v.fragmentHint):v.fragments;M.forEach(function(F){var N;(!F.initSegment||F.initSegment.relurl===((N=m)===null||N===void 0?void 0:N.relurl))&&(F.initSegment=m)})}if(v.skippedSegments)if(v.deltaUpdateFailed=v.fragments.some(function(F){return!F}),v.deltaUpdateFailed){a.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var R=v.skippedSegments;R--;)v.fragments.shift();v.startSN=v.fragments[0].sn,v.startCC=v.fragments[0].cc}else v.canSkipDateRanges&&(v.dateRanges=D(p.dateRanges,v.dateRanges,v.recentlyRemovedDateranges));var I=v.fragments;if(P){a.logger.warn("discontinuity sliding from playlist, take drift into account");for(var w=0;w<I.length;w++)I[w].cc+=P}v.skippedSegments&&(v.startCC=v.fragments[0].cc),S(p.partList,v.partList,function(F,N){N.elementaryStreams=F.elementaryStreams,N.stats=F.stats}),O?y(v,O,O.startPTS,O.endPTS,O.startDTS,O.endDTS):g(p,v),I.length&&(v.totalduration=v.edge-I[0].start),v.driftStartTime=p.driftStartTime,v.driftStart=p.driftStart;var k=v.advancedDateTime;if(v.advanced&&k){var B=v.edge;v.driftStart||(v.driftStartTime=k,v.driftStart=B),v.driftEndTime=k,v.driftEnd=B}else v.driftEndTime=p.driftEndTime,v.driftEnd=p.driftEnd,v.advancedDateTime=p.advancedDateTime}function D(p,v,m){var A=l({},p);return m&&m.forEach(function(b){delete A[b]}),Object.keys(v).forEach(function(b){var T=new o.DateRange(v[b].attr,A[b]);T.isValid?A[b]=T:a.logger.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(v[b].attr)+'"')}),A}function S(p,v,m){if(p&&v)for(var A=0,b=0,T=p.length;b<=T;b++){var P=p[b],O=v[b+A];P&&O&&P.index===O.index&&P.fragment.sn===O.fragment.sn?m(P,O):A--}}function L(p,v,m){for(var A=v.skippedSegments,b=Math.max(p.startSN,v.startSN)-v.startSN,T=(p.fragmentHint?1:0)+(A?v.endSN:Math.min(p.endSN,v.endSN))-v.startSN,P=v.startSN-p.startSN,O=v.fragmentHint?v.fragments.concat(v.fragmentHint):v.fragments,M=p.fragmentHint?p.fragments.concat(p.fragmentHint):p.fragments,R=b;R<=T;R++){var I=M[P+R],w=O[R];A&&!w&&R<A&&(w=v.fragments[R]=I),I&&w&&m(I,w)}}function g(p,v){var m=v.startSN+v.skippedSegments-p.startSN,A=p.fragments;m<0||m>=A.length||f(v,A[m].start)}function f(p,v){if(v){for(var m=p.fragments,A=p.skippedSegments;A<m.length;A++)m[A].start+=v;p.fragmentHint&&(p.fragmentHint.start+=v)}}function E(p,v){var m=1e3*p.levelTargetDuration,A=m/2,b=p.age,T=b>0&&b<m*3,P=v.loading.end-v.loading.start,O,M=p.availabilityDelay;if(p.updated===!1)if(T){var R=333*p.misses;O=Math.max(Math.min(A,P*2),R),p.availabilityDelay=(p.availabilityDelay||0)+O}else O=A;else T?(M=Math.min(M||m/2,b),p.availabilityDelay=M,O=M+m-b):O=m-P;return Math.round(O)}function _(p,v,m){if(!p||!p.details)return null;var A=p.details,b=A.fragments[v-A.startSN];return b||(b=A.fragmentHint,b&&b.sn===v)?b:v<A.startSN&&m&&m.sn===v?m:null}function C(p,v,m){if(!p||!p.details)return null;var A=p.details.partList;if(A)for(var b=A.length;b--;){var T=A[b];if(T.index===m&&T.fragment.sn===v)return T}return null}},"./src/controller/stream-controller.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return C});var s=r("./src/polyfills/number.ts"),a=r("./src/controller/base-stream-controller.ts"),o=r("./src/is-supported.ts"),l=r("./src/events.ts"),c=r("./src/utils/buffer-helper.ts"),u=r("./src/controller/fragment-tracker.ts"),h=r("./src/types/loader.ts"),d=r("./src/loader/fragment.ts"),y=r("./src/demux/transmuxer-interface.ts"),x=r("./src/types/transmuxer.ts"),D=r("./src/controller/gap-controller.ts"),S=r("./src/errors.ts");function L(p,v){for(var m=0;m<v.length;m++){var A=v[m];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(p,A.key,A)}}function g(p,v,m){return v&&L(p.prototype,v),m&&L(p,m),Object.defineProperty(p,"prototype",{writable:!1}),p}function f(p,v){p.prototype=Object.create(v.prototype),p.prototype.constructor=p,E(p,v)}function E(p,v){return E=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(A,b){return A.__proto__=b,A},E(p,v)}var _=100,C=function(p){f(v,p);function v(A,b){var T;return T=p.call(this,A,b,"[stream-controller]")||this,T.audioCodecSwap=!1,T.gapController=null,T.level=-1,T._forceStartLoad=!1,T.altAudio=!1,T.audioOnly=!1,T.fragPlaying=null,T.onvplaying=null,T.onvseeked=null,T.fragLastKbps=0,T.couldBacktrack=!1,T.backtrackFragment=null,T.audioCodecSwitch=!1,T.videoBuffer=null,T._registerListeners(),T}var m=v.prototype;return m._registerListeners=function(){var b=this.hls;b.on(l.Events.MEDIA_ATTACHED,this.onMediaAttached,this),b.on(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this),b.on(l.Events.MANIFEST_LOADING,this.onManifestLoading,this),b.on(l.Events.MANIFEST_PARSED,this.onManifestParsed,this),b.on(l.Events.LEVEL_LOADING,this.onLevelLoading,this),b.on(l.Events.LEVEL_LOADED,this.onLevelLoaded,this),b.on(l.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),b.on(l.Events.ERROR,this.onError,this),b.on(l.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),b.on(l.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),b.on(l.Events.BUFFER_CREATED,this.onBufferCreated,this),b.on(l.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),b.on(l.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),b.on(l.Events.FRAG_BUFFERED,this.onFragBuffered,this)},m._unregisterListeners=function(){var b=this.hls;b.off(l.Events.MEDIA_ATTACHED,this.onMediaAttached,this),b.off(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this),b.off(l.Events.MANIFEST_LOADING,this.onManifestLoading,this),b.off(l.Events.MANIFEST_PARSED,this.onManifestParsed,this),b.off(l.Events.LEVEL_LOADED,this.onLevelLoaded,this),b.off(l.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),b.off(l.Events.ERROR,this.onError,this),b.off(l.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),b.off(l.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),b.off(l.Events.BUFFER_CREATED,this.onBufferCreated,this),b.off(l.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),b.off(l.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),b.off(l.Events.FRAG_BUFFERED,this.onFragBuffered,this)},m.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},m.startLoad=function(b){if(this.levels){var T=this.lastCurrentTime,P=this.hls;if(this.stopLoad(),this.setInterval(_),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var O=P.startLevel;O===-1&&(P.config.testBandwidth&&this.levels.length>1?(O=0,this.bitrateTest=!0):O=P.nextAutoLevel),this.level=P.nextLoadLevel=O,this.loadedmetadata=!1}T>0&&b===-1&&(this.log("Override startPosition with lastCurrentTime @"+T.toFixed(3)),b=T),this.state=a.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=b,this.tick()}else this._forceStartLoad=!0,this.state=a.State.STOPPED},m.stopLoad=function(){this._forceStartLoad=!1,p.prototype.stopLoad.call(this)},m.doTick=function(){switch(this.state){case a.State.IDLE:this.doTickIdle();break;case a.State.WAITING_LEVEL:{var b,T=this.levels,P=this.level,O=T==null||(b=T[P])===null||b===void 0?void 0:b.details;if(O&&(!O.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(O))break;this.state=a.State.IDLE;break}break}case a.State.FRAG_LOADING_WAITING_RETRY:{var M,R=self.performance.now(),I=this.retryDate;(!I||R>=I||(M=this.media)!==null&&M!==void 0&&M.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.level),this.state=a.State.IDLE)}break}this.onTickEnd()},m.onTickEnd=function(){p.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},m.doTickIdle=function(){var b,T,P=this.hls,O=this.levelLastLoaded,M=this.levels,R=this.media,I=P.config,w=P.nextLoadLevel;if(!(O===null||!R&&(this.startFragRequested||!I.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!M||!M[w])){var k=M[w];this.level=P.nextLoadLevel=w;var B=k.details;if(!B||this.state===a.State.WAITING_LEVEL||B.live&&this.levelLastLoaded!==w){this.state=a.State.WAITING_LEVEL;return}var F=this.getMainFwdBufferInfo();if(F!==null){var N=F.len,K=this.getMaxBufferLength(k.maxBitrate);if(!(N>=K)){if(this._streamEnded(F,B)){var H={};this.altAudio&&(H.type="video"),this.hls.trigger(l.Events.BUFFER_EOS,H),this.state=a.State.ENDED;return}this.backtrackFragment&&this.backtrackFragment.start>F.end&&(this.backtrackFragment=null);var U=this.backtrackFragment?this.backtrackFragment.start:F.end,j=this.getNextFragment(U,B);if(this.couldBacktrack&&!this.fragPrevious&&j&&j.sn!=="initSegment"&&this.fragmentTracker.getState(j)!==u.FragmentState.OK){var G,X=((G=this.backtrackFragment)!=null?G:j).sn,J=X-B.startSN,nt=B.fragments[J-1];nt&&j.cc===nt.cc&&(j=nt,this.fragmentTracker.removeFragment(nt))}else this.backtrackFragment&&F.len&&(this.backtrackFragment=null);if(j&&this.fragmentTracker.getState(j)===u.FragmentState.OK&&this.nextLoadPosition>U){var ot=this.audioOnly&&!this.altAudio?d.ElementaryStreamTypes.AUDIO:d.ElementaryStreamTypes.VIDEO;R&&this.afterBufferFlushed(R,ot,h.PlaylistLevelType.MAIN),j=this.getNextFragment(this.nextLoadPosition,B)}!j||(j.initSegment&&!j.initSegment.data&&!this.bitrateTest&&(j=j.initSegment),((b=j.decryptdata)===null||b===void 0?void 0:b.keyFormat)==="identity"&&!((T=j.decryptdata)!==null&&T!==void 0&&T.key)?this.loadKey(j,B):this.loadFragment(j,B,U))}}}},m.loadFragment=function(b,T,P){var O,M=this.fragmentTracker.getState(b);this.fragCurrent=b,M===u.FragmentState.NOT_LOADED?b.sn==="initSegment"?this._loadInitSegment(b):this.bitrateTest?(this.log("Fragment "+b.sn+" of level "+b.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(b)):(this.startFragRequested=!0,p.prototype.loadFragment.call(this,b,T,P)):M===u.FragmentState.APPENDING?this.reduceMaxBufferLength(b.duration)&&this.fragmentTracker.removeFragment(b):((O=this.media)===null||O===void 0?void 0:O.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},m.getAppendedFrag=function(b){var T=this.fragmentTracker.getAppendedFrag(b,h.PlaylistLevelType.MAIN);return T&&"fragment"in T?T.fragment:T},m.getBufferedFrag=function(b){return this.fragmentTracker.getBufferedFrag(b,h.PlaylistLevelType.MAIN)},m.followingBufferedFrag=function(b){return b?this.getBufferedFrag(b.end+.5):null},m.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},m.nextLevelSwitch=function(){var b=this.levels,T=this.media;if(T!=null&&T.readyState){var P,O=this.getAppendedFrag(T.currentTime);if(O&&O.start>1&&this.flushMainBuffer(0,O.start-1),!T.paused&&b){var M=this.hls.nextLoadLevel,R=b[M],I=this.fragLastKbps;I&&this.fragCurrent?P=this.fragCurrent.duration*R.maxBitrate/(1e3*I)+1:P=0}else P=0;var w=this.getBufferedFrag(T.currentTime+P);if(w){var k=this.followingBufferedFrag(w);if(k){this.abortCurrentFrag();var B=k.maxStartPTS?k.maxStartPTS:k.start,F=k.duration,N=Math.max(w.end,B+Math.min(Math.max(F-this.config.maxFragLookUpTolerance,F*.5),F*.75));this.flushMainBuffer(N,Number.POSITIVE_INFINITY)}}}},m.abortCurrentFrag=function(){var b=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,b!=null&&b.loader&&b.loader.abort(),this.state){case a.State.KEY_LOADING:case a.State.FRAG_LOADING:case a.State.FRAG_LOADING_WAITING_RETRY:case a.State.PARSING:case a.State.PARSED:this.state=a.State.IDLE;break}this.nextLoadPosition=this.getLoadPosition()},m.flushMainBuffer=function(b,T){p.prototype.flushMainBuffer.call(this,b,T,this.altAudio?"video":null)},m.onMediaAttached=function(b,T){p.prototype.onMediaAttached.call(this,b,T);var P=T.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),P.addEventListener("playing",this.onvplaying),P.addEventListener("seeked",this.onvseeked),this.gapController=new D.default(this.config,P,this.fragmentTracker,this.hls)},m.onMediaDetaching=function(){var b=this.media;b&&this.onvplaying&&this.onvseeked&&(b.removeEventListener("playing",this.onvplaying),b.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),p.prototype.onMediaDetaching.call(this)},m.onMediaPlaying=function(){this.tick()},m.onMediaSeeked=function(){var b=this.media,T=b?b.currentTime:null;Object(s.isFiniteNumber)(T)&&this.log("Media seeked to "+T.toFixed(3)),this.tick()},m.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(l.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null},m.onManifestParsed=function(b,T){var P=!1,O=!1,M;T.levels.forEach(function(R){M=R.audioCodec,M&&(M.indexOf("mp4a.40.2")!==-1&&(P=!0),M.indexOf("mp4a.40.5")!==-1&&(O=!0))}),this.audioCodecSwitch=P&&O&&!Object(o.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=T.levels,this.startFragRequested=!1},m.onLevelLoading=function(b,T){var P=this.levels;if(!(!P||this.state!==a.State.IDLE)){var O=P[T.level];(!O.details||O.details.live&&this.levelLastLoaded!==T.level||this.waitForCdnTuneIn(O.details))&&(this.state=a.State.WAITING_LEVEL)}},m.onLevelLoaded=function(b,T){var P,O=this.levels,M=T.level,R=T.details,I=R.totalduration;if(!O){this.warn("Levels were reset while loading level "+M);return}this.log("Level "+M+" loaded ["+R.startSN+","+R.endSN+"], cc ["+R.startCC+", "+R.endCC+"] duration:"+I);var w=this.fragCurrent;w&&(this.state===a.State.FRAG_LOADING||this.state===a.State.FRAG_LOADING_WAITING_RETRY)&&w.level!==T.level&&w.loader&&(this.state=a.State.IDLE,this.backtrackFragment=null,w.loader.abort());var k=O[M],B=0;if(R.live||(P=k.details)!==null&&P!==void 0&&P.live){if(R.fragments[0]||(R.deltaUpdateFailed=!0),R.deltaUpdateFailed)return;B=this.alignPlaylists(R,k.details)}if(k.details=R,this.levelLastLoaded=M,this.hls.trigger(l.Events.LEVEL_UPDATED,{details:R,level:M}),this.state===a.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(R))return;this.state=a.State.IDLE}this.startFragRequested?R.live&&this.synchronizeToLiveEdge(R):this.setStartPosition(R,B),this.tick()},m._handleFragmentLoadProgress=function(b){var T,P=b.frag,O=b.part,M=b.payload,R=this.levels;if(!R){this.warn("Levels were reset while fragment load was in progress. Fragment "+P.sn+" of level "+P.level+" will not be buffered");return}var I=R[P.level],w=I.details;if(!w){this.warn("Dropping fragment "+P.sn+" of level "+P.level+" after level details were reset");return}var k=I.videoCodec,B=w.PTSKnown||!w.live,F=(T=P.initSegment)===null||T===void 0?void 0:T.data,N=this._getAudioCodec(I),K=this.transmuxer=this.transmuxer||new y.default(this.hls,h.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),H=O?O.index:-1,U=H!==-1,j=new x.ChunkMetadata(P.level,P.sn,P.stats.chunkCount,M.byteLength,H,U),G=this.initPTS[P.cc];K.push(M,F,N,k,P,O,w.totalduration,B,j,G)},m.onAudioTrackSwitching=function(b,T){var P=this.altAudio,O=!!T.url,M=T.id;if(!O){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var R=this.fragCurrent;R!=null&&R.loader&&(this.log("Switching to main audio track, cancel main fragment load"),R.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var I=this.hls;P&&I.trigger(l.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),I.trigger(l.Events.AUDIO_TRACK_SWITCHED,{id:M})}},m.onAudioTrackSwitched=function(b,T){var P=T.id,O=!!this.hls.audioTracks[P].url;if(O){var M=this.videoBuffer;M&&this.mediaBuffer!==M&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=M)}this.altAudio=O,this.tick()},m.onBufferCreated=function(b,T){var P=T.tracks,O,M,R=!1;for(var I in P){var w=P[I];if(w.id==="main"){if(M=I,O=w,I==="video"){var k=P[I];k&&(this.videoBuffer=k.buffer)}}else R=!0}R&&O?(this.log("Alternate track found, use "+M+".buffered to schedule main fragment loading"),this.mediaBuffer=O.buffer):this.mediaBuffer=this.media},m.onFragBuffered=function(b,T){var P=T.frag,O=T.part;if(!(P&&P.type!==h.PlaylistLevelType.MAIN)){if(this.fragContextChanged(P)){this.warn("Fragment "+P.sn+(O?" p: "+O.index:"")+" of level "+P.level+" finished buffering, but was aborted. state: "+this.state),this.state===a.State.PARSED&&(this.state=a.State.IDLE);return}var M=O?O.stats:P.stats;this.fragLastKbps=Math.round(8*M.total/(M.buffering.end-M.loading.first)),P.sn!=="initSegment"&&(this.fragPrevious=P),this.fragBufferedComplete(P,O)}},m.onError=function(b,T){switch(T.details){case S.ErrorDetails.FRAG_LOAD_ERROR:case S.ErrorDetails.FRAG_LOAD_TIMEOUT:case S.ErrorDetails.KEY_LOAD_ERROR:case S.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(h.PlaylistLevelType.MAIN,T);break;case S.ErrorDetails.LEVEL_LOAD_ERROR:case S.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==a.State.ERROR&&(T.fatal?(this.warn(""+T.details),this.state=a.State.ERROR):!T.levelRetry&&this.state===a.State.WAITING_LEVEL&&(this.state=a.State.IDLE));break;case S.ErrorDetails.BUFFER_FULL_ERROR:if(T.parent==="main"&&(this.state===a.State.PARSING||this.state===a.State.PARSED)){var P=!0,O=this.getFwdBufferInfo(this.media,h.PlaylistLevelType.MAIN);O&&O.len>.5&&(P=!this.reduceMaxBufferLength(O.len)),P&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},m.checkBuffer=function(){var b=this.media,T=this.gapController;if(!(!b||!T||!b.readyState)){if(this.loadedmetadata||!c.BufferHelper.getBuffered(b).length){var P=this.state!==a.State.IDLE?this.fragCurrent:null;T.poll(this.lastCurrentTime,P)}this.lastCurrentTime=b.currentTime}},m.onFragLoadEmergencyAborted=function(){this.state=a.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},m.onBufferFlushed=function(b,T){var P=T.type;if(P!==d.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var O=(P===d.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(O,P,h.PlaylistLevelType.MAIN)}},m.onLevelsUpdated=function(b,T){this.levels=T.levels},m.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},m.seekToStartPos=function(){var b=this.media;if(!!b){var T=b.currentTime,P=this.startPosition;if(P>=0&&T<P){if(b.seeking){this.log("could not seek to "+P+", already seeking at "+T);return}var O=c.BufferHelper.getBuffered(b),M=O.length?O.start(0):0,R=M-P;R>0&&(R<this.config.maxBufferHole||R<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+R+" to match buffer start"),P+=R,this.startPosition=P),this.log("seek to target start position "+P+" from current time "+T),b.currentTime=P}}},m._getAudioCodec=function(b){var T=this.config.defaultAudioCodec||b.audioCodec;return this.audioCodecSwap&&T&&(this.log("Swapping audio codec"),T.indexOf("mp4a.40.5")!==-1?T="mp4a.40.2":T="mp4a.40.5"),T},m._loadBitrateTestFrag=function(b){var T=this;b.bitrateTest=!0,this._doFragLoad(b).then(function(P){var O=T.hls;if(!(!P||O.nextLoadLevel||T.fragContextChanged(b))){T.fragLoadError=0,T.state=a.State.IDLE,T.startFragRequested=!1,T.bitrateTest=!1;var M=b.stats;M.parsing.start=M.parsing.end=M.buffering.start=M.buffering.end=self.performance.now(),O.trigger(l.Events.FRAG_LOADED,P),b.bitrateTest=!1}})},m._handleTransmuxComplete=function(b){var T,P="main",O=this.hls,M=b.remuxResult,R=b.chunkMeta,I=this.getCurrentContext(R);if(!I){this.warn("The loading context changed while buffering fragment "+R.sn+" of level "+R.level+". This chunk will not be buffered."),this.resetStartWhenNotLoaded(R.level);return}var w=I.frag,k=I.part,B=I.level,F=M.video,N=M.text,K=M.id3,H=M.initSegment,U=B.details,j=this.altAudio?void 0:M.audio;if(!this.fragContextChanged(w)){if(this.state=a.State.PARSING,H){H.tracks&&(this._bufferInitSegment(B,H.tracks,w,R),O.trigger(l.Events.FRAG_PARSING_INIT_SEGMENT,{frag:w,id:P,tracks:H.tracks}));var G=H.initPTS,X=H.timescale;Object(s.isFiniteNumber)(G)&&(this.initPTS[w.cc]=G,O.trigger(l.Events.INIT_PTS_FOUND,{frag:w,id:P,initPTS:G,timescale:X}))}if(F&&M.independent!==!1){if(U){var J=F.startPTS,nt=F.endPTS,ot=F.startDTS,rt=F.endDTS;if(k)k.elementaryStreams[F.type]={startPTS:J,endPTS:nt,startDTS:ot,endDTS:rt};else if(F.firstKeyFrame&&F.independent&&(this.couldBacktrack=!0),F.dropped&&F.independent){var W=this.getMainFwdBufferInfo(),V=(W?W.end:this.getLoadPosition())+this.config.maxBufferHole,z=F.firstKeyFramePTS?F.firstKeyFramePTS:J;if(V<z-this.config.maxBufferHole){this.backtrack(w);return}w.setElementaryStreamInfo(F.type,w.start,nt,w.start,rt,!0)}w.setElementaryStreamInfo(F.type,J,nt,ot,rt),this.backtrackFragment&&(this.backtrackFragment=w),this.bufferFragmentData(F,w,k,R)}}else if(M.independent===!1){this.backtrack(w);return}if(j){var Y=j.startPTS,Q=j.endPTS,Z=j.startDTS,st=j.endDTS;k&&(k.elementaryStreams[d.ElementaryStreamTypes.AUDIO]={startPTS:Y,endPTS:Q,startDTS:Z,endDTS:st}),w.setElementaryStreamInfo(d.ElementaryStreamTypes.AUDIO,Y,Q,Z,st),this.bufferFragmentData(j,w,k,R)}if(U&&K!==null&&K!==void 0&&(T=K.samples)!==null&&T!==void 0&&T.length){var tt={id:P,frag:w,details:U,samples:K.samples};O.trigger(l.Events.FRAG_PARSING_METADATA,tt)}if(U&&N){var et={id:P,frag:w,details:U,samples:N.samples};O.trigger(l.Events.FRAG_PARSING_USERDATA,et)}}},m._bufferInitSegment=function(b,T,P,O){var M=this;if(this.state===a.State.PARSING){this.audioOnly=!!T.audio&&!T.video,this.altAudio&&!this.audioOnly&&delete T.audio;var R=T.audio,I=T.video,w=T.audiovideo;if(R){var k=b.audioCodec,B=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(k&&(k.indexOf("mp4a.40.5")!==-1?k="mp4a.40.2":k="mp4a.40.5"),R.metadata.channelCount!==1&&B.indexOf("firefox")===-1&&(k="mp4a.40.5")),B.indexOf("android")!==-1&&R.container!=="audio/mpeg"&&(k="mp4a.40.2",this.log("Android: force audio codec to "+k)),b.audioCodec&&b.audioCodec!==k&&this.log('Swapping manifest audio codec "'+b.audioCodec+'" for "'+k+'"'),R.levelCodec=k,R.id="main",this.log("Init audio buffer, container:"+R.container+", codecs[selected/level/parsed]=["+(k||"")+"/"+(b.audioCodec||"")+"/"+R.codec+"]")}I&&(I.levelCodec=b.videoCodec,I.id="main",this.log("Init video buffer, container:"+I.container+", codecs[level/parsed]=["+(b.videoCodec||"")+"/"+I.codec+"]")),w&&this.log("Init audiovideo buffer, container:"+w.container+", codecs[level/parsed]=["+(b.attrs.CODECS||"")+"/"+w.codec+"]"),this.hls.trigger(l.Events.BUFFER_CODECS,T),Object.keys(T).forEach(function(F){var N=T[F],K=N.initSegment;K!=null&&K.byteLength&&M.hls.trigger(l.Events.BUFFER_APPENDING,{type:F,data:K,frag:P,part:null,chunkMeta:O,parent:P.type})}),this.tick()}},m.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,h.PlaylistLevelType.MAIN)},m.backtrack=function(b){this.couldBacktrack=!0,this.backtrackFragment=b,this.resetTransmuxer(),this.flushBufferGap(b),this.fragmentTracker.removeFragment(b),this.fragPrevious=null,this.nextLoadPosition=b.start,this.state=a.State.IDLE},m.checkFragmentChanged=function(){var b=this.media,T=null;if(b&&b.readyState>1&&b.seeking===!1){var P=b.currentTime;if(c.BufferHelper.isBuffered(b,P)?T=this.getAppendedFrag(P):c.BufferHelper.isBuffered(b,P+.1)&&(T=this.getAppendedFrag(P+.1)),T){this.backtrackFragment=null;var O=this.fragPlaying,M=T.level;(!O||T.sn!==O.sn||O.level!==M||T.urlId!==O.urlId)&&(this.hls.trigger(l.Events.FRAG_CHANGED,{frag:T}),(!O||O.level!==M)&&this.hls.trigger(l.Events.LEVEL_SWITCHED,{level:M}),this.fragPlaying=T)}}},g(v,[{key:"nextLevel",get:function(){var b=this.nextBufferedFrag;return b?b.level:-1}},{key:"currentFrag",get:function(){var b=this.media;return b?this.fragPlaying||this.getAppendedFrag(b.currentTime):null}},{key:"currentProgramDateTime",get:function(){var b=this.media;if(b){var T=b.currentTime,P=this.currentFrag;if(P&&Object(s.isFiniteNumber)(T)&&Object(s.isFiniteNumber)(P.programDateTime)){var O=P.programDateTime+(T-P.start)*1e3;return new Date(O)}}return null}},{key:"currentLevel",get:function(){var b=this.currentFrag;return b?b.level:-1}},{key:"nextBufferedFrag",get:function(){var b=this.currentFrag;return b?this.followingBufferedFrag(b):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),v}(a.default)},"./src/controller/subtitle-stream-controller.ts":function(n,i,r){r.r(i),r.d(i,"SubtitleStreamController",function(){return f});var s=r("./src/events.ts"),a=r("./src/utils/buffer-helper.ts"),o=r("./src/controller/fragment-finders.ts"),l=r("./src/utils/discontinuities.ts"),c=r("./src/controller/level-helper.ts"),u=r("./src/controller/fragment-tracker.ts"),h=r("./src/controller/base-stream-controller.ts"),d=r("./src/types/loader.ts"),y=r("./src/types/level.ts");function x(_,C){for(var p=0;p<C.length;p++){var v=C[p];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(_,v.key,v)}}function D(_,C,p){return C&&x(_.prototype,C),p&&x(_,p),Object.defineProperty(_,"prototype",{writable:!1}),_}function S(_,C){_.prototype=Object.create(C.prototype),_.prototype.constructor=_,L(_,C)}function L(_,C){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(v,m){return v.__proto__=m,v},L(_,C)}var g=500,f=function(_){S(C,_);function C(v,m){var A;return A=_.call(this,v,m,"[subtitle-stream-controller]")||this,A.levels=[],A.currentTrackId=-1,A.tracksBuffered=[],A.mainDetails=null,A._registerListeners(),A}var p=C.prototype;return p.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},p._registerListeners=function(){var m=this.hls;m.on(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),m.on(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this),m.on(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),m.on(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),m.on(s.Events.ERROR,this.onError,this),m.on(s.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),m.on(s.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),m.on(s.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),m.on(s.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),m.on(s.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},p._unregisterListeners=function(){var m=this.hls;m.off(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),m.off(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this),m.off(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),m.off(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),m.off(s.Events.ERROR,this.onError,this),m.off(s.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),m.off(s.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),m.off(s.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),m.off(s.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),m.off(s.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},p.startLoad=function(){this.stopLoad(),this.state=h.State.IDLE,this.setInterval(g),this.tick()},p.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},p.onLevelLoaded=function(m,A){this.mainDetails=A.details},p.onSubtitleFragProcessed=function(m,A){var b=A.frag,T=A.success;if(this.fragPrevious=b,this.state=h.State.IDLE,!!T){var P=this.tracksBuffered[this.currentTrackId];if(!!P){for(var O,M=b.start,R=0;R<P.length;R++)if(M>=P[R].start&&M<=P[R].end){O=P[R];break}var I=b.start+b.duration;O?O.end=I:(O={start:M,end:I},P.push(O)),this.fragmentTracker.fragBuffered(b)}}},p.onBufferFlushing=function(m,A){var b=A.startOffset,T=A.endOffset;if(b===0&&T!==Number.POSITIVE_INFINITY){var P=this.currentTrackId,O=this.levels;if(!O.length||!O[P]||!O[P].details)return;var M=O[P].details,R=M.targetduration,I=T-R;if(I<=0)return;A.endOffsetSubtitles=Math.max(0,I),this.tracksBuffered.forEach(function(w){for(var k=0;k<w.length;){if(w[k].end<=I){w.shift();continue}else if(w[k].start<I)w[k].start=I;else break;k++}}),this.fragmentTracker.removeFragmentsInRange(b,I,d.PlaylistLevelType.SUBTITLE)}},p.onError=function(m,A){var b,T=A.frag;!T||T.type!==d.PlaylistLevelType.SUBTITLE||((b=this.fragCurrent)!==null&&b!==void 0&&b.loader&&this.fragCurrent.loader.abort(),this.state=h.State.IDLE)},p.onSubtitleTracksUpdated=function(m,A){var b=this,T=A.subtitleTracks;this.tracksBuffered=[],this.levels=T.map(function(P){return new y.Level(P)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(P){b.tracksBuffered[P.id]=[]}),this.mediaBuffer=null},p.onSubtitleTrackSwitch=function(m,A){if(this.currentTrackId=A.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var b=this.levels[this.currentTrackId];b!=null&&b.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,b&&this.setInterval(g)},p.onSubtitleTrackLoaded=function(m,A){var b,T=A.details,P=A.id,O=this.currentTrackId,M=this.levels;if(!!M.length){var R=M[O];if(!(P>=M.length||P!==O||!R)){if(this.mediaBuffer=this.mediaBufferTimeRanges,T.live||(b=R.details)!==null&&b!==void 0&&b.live){var I=this.mainDetails;if(T.deltaUpdateFailed||!I)return;var w=I.fragments[0];if(!R.details)T.hasProgramDateTime&&I.hasProgramDateTime?Object(l.alignMediaPlaylistByPDT)(T,I):w&&Object(c.addSliding)(T,w.start);else{var k=this.alignPlaylists(T,R.details);k===0&&w&&Object(c.addSliding)(T,w.start)}}if(R.details=T,this.levelLastLoaded=P,this.tick(),T.live&&!this.fragCurrent&&this.media&&this.state===h.State.IDLE){var B=Object(o.findFragmentByPTS)(null,T.fragments,this.media.currentTime,0);B||(this.warn("Subtitle playlist not aligned with playback"),R.details=void 0)}}}},p._handleFragmentLoadComplete=function(m){var A=m.frag,b=m.payload,T=A.decryptdata,P=this.hls;if(!this.fragContextChanged(A)&&b&&b.byteLength>0&&T&&T.key&&T.iv&&T.method==="AES-128"){var O=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(b),T.key.buffer,T.iv.buffer).then(function(M){var R=performance.now();P.trigger(s.Events.FRAG_DECRYPTED,{frag:A,payload:M,stats:{tstart:O,tdecrypt:R}})})}},p.doTick=function(){if(!this.media){this.state=h.State.IDLE;return}if(this.state===h.State.IDLE){var m=this.currentTrackId,A=this.levels;if(!A.length||!A[m]||!A[m].details)return;var b=A[m].details,T=b.targetduration,P=this.config,O=this.media,M=a.BufferHelper.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],O.currentTime-T,P.maxBufferHole),R=M.end,I=M.len,w=this.getMaxBufferLength()+T;if(I>w)return;console.assert(b,"Subtitle track details are defined on idle subtitle stream controller tick");var k=b.fragments,B=k.length,F=b.edge,N,K=this.fragPrevious;if(R<F){var H=P.maxFragLookUpTolerance;N=Object(o.findFragmentByPTS)(K,k,Math.max(k[0].start,R),H),!N&&K&&K.start<k[0].start&&(N=k[0])}else N=k[B-1];if(N=this.mapToInitFragWhenRequired(N),!N||this.fragmentTracker.getState(N)!==u.FragmentState.NOT_LOADED)return;N.encrypted?this.loadKey(N,b):this.loadFragment(N,b,R)}},p.loadFragment=function(m,A,b){this.fragCurrent=m,m.sn==="initSegment"?this._loadInitSegment(m):_.prototype.loadFragment.call(this,m,A,b)},D(C,[{key:"mediaBufferTimeRanges",get:function(){return new E(this.tracksBuffered[this.currentTrackId]||[])}}]),C}(h.default),E=function(C){this.buffered=void 0;var p=function(m,A,b){if(A=A>>>0,A>b-1)throw new DOMException("Failed to execute '"+m+"' on 'TimeRanges': The index provided ("+A+") is greater than the maximum bound ("+b+")");return C[A][m]};this.buffered={get length(){return C.length},end:function(m){return p("end",m,C.length)},start:function(m){return p("start",m,C.length)}}}},"./src/controller/subtitle-track-controller.ts":function(n,i,r){r.r(i);var s=r("./src/events.ts"),a=r("./src/utils/texttrack-utils.ts"),o=r("./src/controller/base-playlist-controller.ts"),l=r("./src/types/loader.ts");function c(D,S){for(var L=0;L<S.length;L++){var g=S[L];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(D,g.key,g)}}function u(D,S,L){return S&&c(D.prototype,S),L&&c(D,L),Object.defineProperty(D,"prototype",{writable:!1}),D}function h(D,S){D.prototype=Object.create(S.prototype),D.prototype.constructor=D,d(D,S)}function d(D,S){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(g,f){return g.__proto__=f,g},d(D,S)}var y=function(D){h(S,D);function S(g){var f;return f=D.call(this,g,"[subtitle-track-controller]")||this,f.media=null,f.tracks=[],f.groupId=null,f.tracksInGroup=[],f.trackId=-1,f.selectDefaultTrack=!0,f.queuedDefaultTrack=-1,f.trackChangeListener=function(){return f.onTextTracksChanged()},f.asyncPollTrackChange=function(){return f.pollTrackChange(0)},f.useTextTrackPolling=!1,f.subtitlePollingInterval=-1,f._subtitleDisplay=!0,f.registerListeners(),f}var L=S.prototype;return L.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,D.prototype.destroy.call(this)},L.registerListeners=function(){var f=this.hls;f.on(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.on(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.on(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.on(s.Events.MANIFEST_PARSED,this.onManifestParsed,this),f.on(s.Events.LEVEL_LOADING,this.onLevelLoading,this),f.on(s.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),f.on(s.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),f.on(s.Events.ERROR,this.onError,this)},L.unregisterListeners=function(){var f=this.hls;f.off(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.off(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.off(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.off(s.Events.MANIFEST_PARSED,this.onManifestParsed,this),f.off(s.Events.LEVEL_LOADING,this.onLevelLoading,this),f.off(s.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),f.off(s.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),f.off(s.Events.ERROR,this.onError,this)},L.onMediaAttached=function(f,E){this.media=E.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},L.pollTrackChange=function(f){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,f)},L.onMediaDetaching=function(){if(!!this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var f=x(this.media.textTracks);f.forEach(function(E){Object(a.clearCurrentCues)(E)}),this.subtitleTrack=-1,this.media=null}},L.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},L.onManifestParsed=function(f,E){this.tracks=E.subtitleTracks},L.onSubtitleTrackLoaded=function(f,E){var _=E.id,C=E.details,p=this.trackId,v=this.tracksInGroup[p];if(!v){this.warn("Invalid subtitle track id "+_);return}var m=v.details;v.details=E.details,this.log("subtitle track "+_+" loaded ["+C.startSN+"-"+C.endSN+"]"),_===this.trackId&&(this.retryCount=0,this.playlistLoaded(_,E,m))},L.onLevelLoading=function(f,E){this.switchLevel(E.level)},L.onLevelSwitching=function(f,E){this.switchLevel(E.level)},L.switchLevel=function(f){var E=this.hls.levels[f];if(!!(E!=null&&E.textGroupIds)){var _=E.textGroupIds[E.urlId];if(this.groupId!==_){var C=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,p=this.tracks.filter(function(A){return!_||A.groupId===_});this.tracksInGroup=p;var v=this.findTrackId(C==null?void 0:C.name)||this.findTrackId();this.groupId=_;var m={subtitleTracks:p};this.log("Updating subtitle tracks, "+p.length+' track(s) found in "'+_+'" group-id'),this.hls.trigger(s.Events.SUBTITLE_TRACKS_UPDATED,m),v!==-1&&this.setSubtitleTrack(v,C)}}},L.findTrackId=function(f){for(var E=this.tracksInGroup,_=0;_<E.length;_++){var C=E[_];if((!this.selectDefaultTrack||C.default)&&(!f||f===C.name))return C.id}return-1},L.onError=function(f,E){D.prototype.onError.call(this,f,E),!(E.fatal||!E.context)&&E.context.type===l.PlaylistContextType.SUBTITLE_TRACK&&E.context.id===this.trackId&&E.context.groupId===this.groupId&&this.retryLoadingOrFail(E)},L.loadPlaylist=function(f){var E=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(E)){var _=E.id,C=E.groupId,p=E.url;if(f)try{p=f.addDirectives(p)}catch(v){this.warn("Could not construct new URL with HLS Delivery Directives: "+v)}this.log("Loading subtitle playlist for id "+_),this.hls.trigger(s.Events.SUBTITLE_TRACK_LOADING,{url:p,id:_,groupId:C,deliveryDirectives:f||null})}},L.toggleTrackModes=function(f){var E=this,_=this.media,C=this.trackId;if(!!_){var p=x(_.textTracks),v=p.filter(function(b){return b.groupId===E.groupId});if(f===-1)[].slice.call(p).forEach(function(b){b.mode="disabled"});else{var m=v[C];m&&(m.mode="disabled")}var A=v[f];A&&(A.mode=this.subtitleDisplay?"showing":"hidden")}},L.setSubtitleTrack=function(f,E){var _,C=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=f;return}if(this.trackId!==f&&this.toggleTrackModes(f),!(this.trackId===f&&(f===-1||(_=C[f])!==null&&_!==void 0&&_.details)||f<-1||f>=C.length)){this.clearTimer();var p=C[f];if(this.log("Switching to subtitle track "+f),this.trackId=f,p){var v=p.id,m=p.groupId,A=m===void 0?"":m,b=p.name,T=p.type,P=p.url;this.hls.trigger(s.Events.SUBTITLE_TRACK_SWITCH,{id:v,groupId:A,name:b,type:T,url:P});var O=this.switchParams(p.url,E==null?void 0:E.details);this.loadPlaylist(O)}else this.hls.trigger(s.Events.SUBTITLE_TRACK_SWITCH,{id:f})}},L.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var f=-1,E=x(this.media.textTracks),_=0;_<E.length;_++)if(E[_].mode==="hidden")f=_;else if(E[_].mode==="showing"){f=_;break}this.subtitleTrack!==f&&(this.subtitleTrack=f)}},u(S,[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(f){this._subtitleDisplay=f,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(f){this.selectDefaultTrack=!1;var E=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(f,E)}}]),S}(o.default);function x(D){for(var S=[],L=0;L<D.length;L++){var g=D[L];g.kind==="subtitles"&&g.label&&S.push(D[L])}return S}i.default=y},"./src/controller/timeline-controller.ts":function(n,i,r){r.r(i),r.d(i,"TimelineController",function(){return D});var s=r("./src/polyfills/number.ts"),a=r("./src/events.ts"),o=r("./src/utils/cea-608-parser.ts"),l=r("./src/utils/output-filter.ts"),c=r("./src/utils/webvtt-parser.ts"),u=r("./src/utils/texttrack-utils.ts"),h=r("./src/utils/imsc1-ttml-parser.ts"),d=r("./src/utils/mp4-tools.ts"),y=r("./src/types/loader.ts"),x=r("./src/utils/logger.ts"),D=function(){function f(_){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=g(),this.captionsProperties=void 0,this.hls=_,this.config=_.config,this.Cues=_.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var C=new l.default(this,"textTrack1"),p=new l.default(this,"textTrack2"),v=new l.default(this,"textTrack3"),m=new l.default(this,"textTrack4");this.cea608Parser1=new o.default(1,C,p),this.cea608Parser2=new o.default(3,v,m)}_.on(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),_.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),_.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),_.on(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),_.on(a.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),_.on(a.Events.FRAG_LOADING,this.onFragLoading,this),_.on(a.Events.FRAG_LOADED,this.onFragLoaded,this),_.on(a.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),_.on(a.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),_.on(a.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),_.on(a.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),_.on(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var E=f.prototype;return E.destroy=function(){var C=this.hls;C.off(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),C.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),C.off(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),C.off(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),C.off(a.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),C.off(a.Events.FRAG_LOADING,this.onFragLoading,this),C.off(a.Events.FRAG_LOADED,this.onFragLoaded,this),C.off(a.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),C.off(a.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),C.off(a.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),C.off(a.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),C.off(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},E.addCues=function(C,p,v,m,A){for(var b=!1,T=A.length;T--;){var P=A[T],O=L(P[0],P[1],p,v);if(O>=0&&(P[0]=Math.min(P[0],p),P[1]=Math.max(P[1],v),b=!0,O/(v-p)>.5))return}if(b||A.push([p,v]),this.config.renderTextTracksNatively){var M=this.captionsTracks[C];this.Cues.newCue(M,p,v,m)}else{var R=this.Cues.newCue(null,p,v,m);this.hls.trigger(a.Events.CUES_PARSED,{type:"captions",cues:R,track:C})}},E.onInitPtsFound=function(C,p){var v=this,m=p.frag,A=p.id,b=p.initPTS,T=p.timescale,P=this.unparsedVttFrags;A==="main"&&(this.initPTS[m.cc]=b,this.timescale[m.cc]=T),P.length&&(this.unparsedVttFrags=[],P.forEach(function(O){v.onFragLoaded(a.Events.FRAG_LOADED,O)}))},E.getExistingTrack=function(C){var p=this.media;if(p)for(var v=0;v<p.textTracks.length;v++){var m=p.textTracks[v];if(m[C])return m}return null},E.createCaptionsTrack=function(C){this.config.renderTextTracksNatively?this.createNativeTrack(C):this.createNonNativeTrack(C)},E.createNativeTrack=function(C){if(!this.captionsTracks[C]){var p=this.captionsProperties,v=this.captionsTracks,m=this.media,A=p[C],b=A.label,T=A.languageCode,P=this.getExistingTrack(C);if(P)v[C]=P,Object(u.clearCurrentCues)(v[C]),Object(u.sendAddTrackEvent)(v[C],m);else{var O=this.createTextTrack("captions",b,T);O&&(O[C]=!0,v[C]=O)}}},E.createNonNativeTrack=function(C){if(!this.nonNativeCaptionsTracks[C]){var p=this.captionsProperties[C];if(!!p){var v=p.label,m={_id:C,label:v,kind:"captions",default:p.media?!!p.media.default:!1,closedCaptions:p.media};this.nonNativeCaptionsTracks[C]=m,this.hls.trigger(a.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[m]})}}},E.createTextTrack=function(C,p,v){var m=this.media;if(!!m)return m.addTextTrack(C,p,v)},E.onMediaAttaching=function(C,p){this.media=p.media,this._cleanTracks()},E.onMediaDetaching=function(){var C=this.captionsTracks;Object.keys(C).forEach(function(p){Object(u.clearCurrentCues)(C[p]),delete C[p]}),this.nonNativeCaptionsTracks={}},E.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=g(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},E._cleanTracks=function(){var C=this.media;if(!!C){var p=C.textTracks;if(p)for(var v=0;v<p.length;v++)Object(u.clearCurrentCues)(p[v])}},E.onSubtitleTracksUpdated=function(C,p){var v=this;this.textTracks=[];var m=p.subtitleTracks||[],A=m.some(function(O){return O.textCodec===h.IMSC1_CODEC});if(this.config.enableWebVTT||A&&this.config.enableIMSC1){var b=this.tracks&&m&&this.tracks.length===m.length;if(this.tracks=m||[],this.config.renderTextTracksNatively){var T=this.media?this.media.textTracks:[];this.tracks.forEach(function(O,M){var R;if(M<T.length){for(var I=null,w=0;w<T.length;w++)if(S(T[w],O)){I=T[w];break}I&&(R=I)}if(R)Object(u.clearCurrentCues)(R);else{var k=v._captionsOrSubtitlesFromCharacteristics(O);R=v.createTextTrack(k,O.name,O.lang),R&&(R.mode="disabled")}R&&(R.groupId=O.groupId,v.textTracks.push(R))})}else if(!b&&this.tracks&&this.tracks.length){var P=this.tracks.map(function(O){return{label:O.name,kind:O.type.toLowerCase(),default:O.default,subtitleTrack:O}});this.hls.trigger(a.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:P})}}},E._captionsOrSubtitlesFromCharacteristics=function(C){var p;if((p=C.attrs)!==null&&p!==void 0&&p.CHARACTERISTICS){var v=/transcribes-spoken-dialog/gi.test(C.attrs.CHARACTERISTICS),m=/describes-music-and-sound/gi.test(C.attrs.CHARACTERISTICS);if(v&&m)return"captions"}return"subtitles"},E.onManifestLoaded=function(C,p){var v=this;this.config.enableCEA708Captions&&p.captions&&p.captions.forEach(function(m){var A=/(?:CC|SERVICE)([1-4])/.exec(m.instreamId);if(!!A){var b="textTrack"+A[1],T=v.captionsProperties[b];!T||(T.label=m.name,m.lang&&(T.languageCode=m.lang),T.media=m)}})},E.onFragLoading=function(C,p){var v=this.cea608Parser1,m=this.cea608Parser2,A=this.lastSn,b=this.lastPartIndex;if(!(!this.enabled||!(v&&m))&&p.frag.type===y.PlaylistLevelType.MAIN){var T,P,O=p.frag.sn,M=(T=p==null||(P=p.part)===null||P===void 0?void 0:P.index)!=null?T:-1;O===A+1||O===A&&M===b+1||(v.reset(),m.reset()),this.lastSn=O,this.lastPartIndex=M}},E.onFragLoaded=function(C,p){var v=p.frag,m=p.payload,A=this.initPTS,b=this.unparsedVttFrags;if(v.type===y.PlaylistLevelType.SUBTITLE)if(m.byteLength){if(!Object(s.isFiniteNumber)(A[v.cc])){b.push(p),A.length&&this.hls.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:v,error:new Error("Missing initial subtitle PTS")});return}var T=v.decryptdata,P="stats"in p;if(T==null||T.key==null||T.method!=="AES-128"||P){var O=this.tracks[v.level],M=this.vttCCs;M[v.cc]||(M[v.cc]={start:v.start,prevCC:this.prevCC,new:!0},this.prevCC=v.cc),O&&O.textCodec===h.IMSC1_CODEC?this._parseIMSC1(v,m):this._parseVTTs(v,m,M)}}else this.hls.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:v,error:new Error("Empty subtitle payload")})},E._parseIMSC1=function(C,p){var v=this,m=this.hls;Object(h.parseIMSC1)(p,this.initPTS[C.cc],this.timescale[C.cc],function(A){v._appendCues(A,C.level),m.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:C})},function(A){x.logger.log("Failed to parse IMSC1: "+A),m.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:C,error:A})})},E._parseVTTs=function(C,p,v){var m,A=this,b=this.hls,T=(m=C.initSegment)!==null&&m!==void 0&&m.data?Object(d.appendUint8Array)(C.initSegment.data,new Uint8Array(p)):p;Object(c.parseWebVTT)(T,this.initPTS[C.cc],this.timescale[C.cc],v,C.cc,C.start,function(P){A._appendCues(P,C.level),b.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:C})},function(P){A._fallbackToIMSC1(C,p),x.logger.log("Failed to parse VTT cue: "+P),b.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:C,error:P})})},E._fallbackToIMSC1=function(C,p){var v=this,m=this.tracks[C.level];m.textCodec||Object(h.parseIMSC1)(p,this.initPTS[C.cc],this.timescale[C.cc],function(){m.textCodec=h.IMSC1_CODEC,v._parseIMSC1(C,p)},function(){m.textCodec="wvtt"})},E._appendCues=function(C,p){var v=this.hls;if(this.config.renderTextTracksNatively){var m=this.textTracks[p];if(!m||m.mode==="disabled")return;C.forEach(function(T){return Object(u.addCueToTrack)(m,T)})}else{var A=this.tracks[p];if(!A)return;var b=A.default?"default":"subtitles"+p;v.trigger(a.Events.CUES_PARSED,{type:"subtitles",cues:C,track:b})}},E.onFragDecrypted=function(C,p){var v=p.frag;if(v.type===y.PlaylistLevelType.SUBTITLE){if(!Object(s.isFiniteNumber)(this.initPTS[v.cc])){this.unparsedVttFrags.push(p);return}this.onFragLoaded(a.Events.FRAG_LOADED,p)}},E.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},E.onFragParsingUserdata=function(C,p){var v=this.cea608Parser1,m=this.cea608Parser2;if(!(!this.enabled||!(v&&m)))for(var A=0;A<p.samples.length;A++){var b=p.samples[A].bytes;if(b){var T=this.extractCea608Data(b);v.addData(p.samples[A].pts,T[0]),m.addData(p.samples[A].pts,T[1])}}},E.onBufferFlushing=function(C,p){var v=p.startOffset,m=p.endOffset,A=p.endOffsetSubtitles,b=p.type,T=this.media;if(!(!T||T.currentTime<m)){if(!b||b==="video"){var P=this.captionsTracks;Object.keys(P).forEach(function(M){return Object(u.removeCuesInRange)(P[M],v,m)})}if(this.config.renderTextTracksNatively&&v===0&&A!==void 0){var O=this.textTracks;Object.keys(O).forEach(function(M){return Object(u.removeCuesInRange)(O[M],v,A)})}}},E.extractCea608Data=function(C){for(var p=[[],[]],v=C[0]&31,m=2,A=0;A<v;A++){var b=C[m++],T=127&C[m++],P=127&C[m++];if(!(T===0&&P===0)){var O=(4&b)!==0;if(O){var M=3&b;(M===0||M===1)&&(p[M].push(T),p[M].push(P))}}}return p},f}();function S(f,E){return f&&f.label===E.name&&!(f.textTrack1||f.textTrack2)}function L(f,E,_,C){return Math.min(E,C)-Math.max(f,_)}function g(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}},"./src/crypt/aes-crypto.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return s});var s=function(){function a(l,c){this.subtle=void 0,this.aesIV=void 0,this.subtle=l,this.aesIV=c}var o=a.prototype;return o.decrypt=function(c,u){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},u,c)},a}()},"./src/crypt/aes-decryptor.ts":function(n,i,r){r.r(i),r.d(i,"removePadding",function(){return a}),r.d(i,"default",function(){return o});var s=r("./src/utils/typed-array.ts");function a(l){var c=l.byteLength,u=c&&new DataView(l.buffer).getUint8(c-1);return u?Object(s.sliceUint8)(l,0,c-u):l}var o=function(){function l(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var c=l.prototype;return c.uint8ArrayToUint32Array_=function(h){for(var d=new DataView(h),y=new Uint32Array(4),x=0;x<4;x++)y[x]=d.getUint32(x*4);return y},c.initTable=function(){var h=this.sBox,d=this.invSBox,y=this.subMix,x=y[0],D=y[1],S=y[2],L=y[3],g=this.invSubMix,f=g[0],E=g[1],_=g[2],C=g[3],p=new Uint32Array(256),v=0,m=0,A=0;for(A=0;A<256;A++)A<128?p[A]=A<<1:p[A]=A<<1^283;for(A=0;A<256;A++){var b=m^m<<1^m<<2^m<<3^m<<4;b=b>>>8^b&255^99,h[v]=b,d[b]=v;var T=p[v],P=p[T],O=p[P],M=p[b]*257^b*16843008;x[v]=M<<24|M>>>8,D[v]=M<<16|M>>>16,S[v]=M<<8|M>>>24,L[v]=M,M=O*16843009^P*65537^T*257^v*16843008,f[b]=M<<24|M>>>8,E[b]=M<<16|M>>>16,_[b]=M<<8|M>>>24,C[b]=M,v?(v=T^p[p[p[O^T]]],m^=p[p[m]]):v=m=1}},c.expandKey=function(h){for(var d=this.uint8ArrayToUint32Array_(h),y=!0,x=0;x<d.length&&y;)y=d[x]===this.key[x],x++;if(!y){this.key=d;var D=this.keySize=d.length;if(D!==4&&D!==6&&D!==8)throw new Error("Invalid aes key size="+D);var S=this.ksRows=(D+6+1)*4,L,g,f=this.keySchedule=new Uint32Array(S),E=this.invKeySchedule=new Uint32Array(S),_=this.sBox,C=this.rcon,p=this.invSubMix,v=p[0],m=p[1],A=p[2],b=p[3],T,P;for(L=0;L<S;L++){if(L<D){T=f[L]=d[L];continue}P=T,L%D===0?(P=P<<8|P>>>24,P=_[P>>>24]<<24|_[P>>>16&255]<<16|_[P>>>8&255]<<8|_[P&255],P^=C[L/D|0]<<24):D>6&&L%D===4&&(P=_[P>>>24]<<24|_[P>>>16&255]<<16|_[P>>>8&255]<<8|_[P&255]),f[L]=T=(f[L-D]^P)>>>0}for(g=0;g<S;g++)L=S-g,g&3?P=f[L]:P=f[L-4],g<4||L<=4?E[g]=P:E[g]=v[_[P>>>24]]^m[_[P>>>16&255]]^A[_[P>>>8&255]]^b[_[P&255]],E[g]=E[g]>>>0}},c.networkToHostOrderSwap=function(h){return h<<24|(h&65280)<<8|(h&16711680)>>8|h>>>24},c.decrypt=function(h,d,y){for(var x=this.keySize+6,D=this.invKeySchedule,S=this.invSBox,L=this.invSubMix,g=L[0],f=L[1],E=L[2],_=L[3],C=this.uint8ArrayToUint32Array_(y),p=C[0],v=C[1],m=C[2],A=C[3],b=new Int32Array(h),T=new Int32Array(b.length),P,O,M,R,I,w,k,B,F,N,K,H,U,j,G=this.networkToHostOrderSwap;d<b.length;){for(F=G(b[d]),N=G(b[d+1]),K=G(b[d+2]),H=G(b[d+3]),I=F^D[0],w=H^D[1],k=K^D[2],B=N^D[3],U=4,j=1;j<x;j++)P=g[I>>>24]^f[w>>16&255]^E[k>>8&255]^_[B&255]^D[U],O=g[w>>>24]^f[k>>16&255]^E[B>>8&255]^_[I&255]^D[U+1],M=g[k>>>24]^f[B>>16&255]^E[I>>8&255]^_[w&255]^D[U+2],R=g[B>>>24]^f[I>>16&255]^E[w>>8&255]^_[k&255]^D[U+3],I=P,w=O,k=M,B=R,U=U+4;P=S[I>>>24]<<24^S[w>>16&255]<<16^S[k>>8&255]<<8^S[B&255]^D[U],O=S[w>>>24]<<24^S[k>>16&255]<<16^S[B>>8&255]<<8^S[I&255]^D[U+1],M=S[k>>>24]<<24^S[B>>16&255]<<16^S[I>>8&255]<<8^S[w&255]^D[U+2],R=S[B>>>24]<<24^S[I>>16&255]<<16^S[w>>8&255]<<8^S[k&255]^D[U+3],T[d]=G(P^p),T[d+1]=G(R^v),T[d+2]=G(M^m),T[d+3]=G(O^A),p=F,v=N,m=K,A=H,d=d+4}return T.buffer},l}()},"./src/crypt/decrypter.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return d});var s=r("./src/crypt/aes-crypto.ts"),a=r("./src/crypt/fast-aes-key.ts"),o=r("./src/crypt/aes-decryptor.ts"),l=r("./src/utils/logger.ts"),c=r("./src/utils/mp4-tools.ts"),u=r("./src/utils/typed-array.ts"),h=16,d=function(){function y(D,S,L){var g=L===void 0?{}:L,f=g.removePKCS7Padding,E=f===void 0?!0:f;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=D,this.config=S,this.removePKCS7Padding=E,E)try{var _=self.crypto;_&&(this.subtle=_.subtle||_.webkitSubtle)}catch{}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var x=y.prototype;return x.destroy=function(){this.observer=null},x.isSync=function(){return this.config.enableSoftwareAES},x.flush=function(){var S=this.currentResult;if(!S){this.reset();return}var L=new Uint8Array(S);return this.reset(),this.removePKCS7Padding?Object(o.removePadding)(L):L},x.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},x.decrypt=function(S,L,g,f){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(S),L,g);var E=this.flush();E&&f(E.buffer)}else this.webCryptoDecrypt(new Uint8Array(S),L,g).then(f)},x.softwareDecrypt=function(S,L,g){var f=this.currentIV,E=this.currentResult,_=this.remainderData;this.logOnce("JS AES decrypt"),_&&(S=Object(c.appendUint8Array)(_,S),this.remainderData=null);var C=this.getValidChunk(S);if(!C.length)return null;f&&(g=f);var p=this.softwareDecrypter;p||(p=this.softwareDecrypter=new o.default),p.expandKey(L);var v=E;return this.currentResult=p.decrypt(C.buffer,0,g),this.currentIV=Object(u.sliceUint8)(C,-16).buffer,v||null},x.webCryptoDecrypt=function(S,L,g){var f=this,E=this.subtle;return(this.key!==L||!this.fastAesKey)&&(this.key=L,this.fastAesKey=new a.default(E,L)),this.fastAesKey.expandKey().then(function(_){if(!E)return Promise.reject(new Error("web crypto not initialized"));var C=new s.default(E,g);return C.decrypt(S.buffer,_)}).catch(function(_){return f.onWebCryptoError(_,S,L,g)})},x.onWebCryptoError=function(S,L,g,f){return l.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",S),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(L,g,f)},x.getValidChunk=function(S){var L=S,g=S.length-S.length%h;return g!==S.length&&(L=Object(u.sliceUint8)(S,0,g),this.remainderData=Object(u.sliceUint8)(S,g)),L},x.logOnce=function(S){!this.logEnabled||(l.logger.log("[decrypter.ts]: "+S),this.logEnabled=!1)},y}()},"./src/crypt/fast-aes-key.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return s});var s=function(){function a(l,c){this.subtle=void 0,this.key=void 0,this.subtle=l,this.key=c}var o=a.prototype;return o.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},a}()},"./src/demux/aacdemuxer.ts":function(n,i,r){r.r(i);var s=r("./src/demux/base-audio-demuxer.ts"),a=r("./src/demux/adts.ts"),o=r("./src/utils/logger.ts"),l=r("./src/demux/id3.ts");function c(d,y){d.prototype=Object.create(y.prototype),d.prototype.constructor=d,u(d,y)}function u(d,y){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,S){return D.__proto__=S,D},u(d,y)}var h=function(d){c(y,d);function y(D,S){var L;return L=d.call(this)||this,L.observer=void 0,L.config=void 0,L.observer=D,L.config=S,L}var x=y.prototype;return x.resetInitSegment=function(S,L,g,f){d.prototype.resetInitSegment.call(this,S,L,g,f),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:L,duration:f,inputTimeScale:9e4,dropped:0}},y.probe=function(S){if(!S)return!1;for(var L=l.getID3Data(S,0)||[],g=L.length,f=S.length;g<f;g++)if(a.probe(S,g))return o.logger.log("ADTS sync word found !"),!0;return!1},x.canParse=function(S,L){return a.canParse(S,L)},x.appendFrame=function(S,L,g){a.initTrackConfig(S,this.observer,L,g,S.manifestCodec);var f=a.appendFrame(S,L,g,this.basePTS,this.frameIndex);if(f&&f.missing===0)return f},y}(s.default);i.default=h},"./src/demux/adts.ts":function(n,i,r){r.r(i),r.d(i,"getAudioConfig",function(){return l}),r.d(i,"isHeaderPattern",function(){return c}),r.d(i,"getHeaderLength",function(){return u}),r.d(i,"getFullFrameLength",function(){return h}),r.d(i,"canGetFrameLength",function(){return d}),r.d(i,"isHeader",function(){return y}),r.d(i,"canParse",function(){return x}),r.d(i,"probe",function(){return D}),r.d(i,"initTrackConfig",function(){return S}),r.d(i,"getFrameDuration",function(){return L}),r.d(i,"parseFrameHeader",function(){return g}),r.d(i,"appendFrame",function(){return f});var s=r("./src/utils/logger.ts"),a=r("./src/errors.ts"),o=r("./src/events.ts");function l(E,_,C,p){var v,m,A,b,T=navigator.userAgent.toLowerCase(),P=p,O=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];v=((_[C+2]&192)>>>6)+1;var M=(_[C+2]&60)>>>2;if(M>O.length-1){E.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+M});return}return A=(_[C+2]&1)<<2,A|=(_[C+3]&192)>>>6,s.logger.log("manifest codec:"+p+", ADTS type:"+v+", samplingIndex:"+M),/firefox/i.test(T)?M>=6?(v=5,b=new Array(4),m=M-3):(v=2,b=new Array(2),m=M):T.indexOf("android")!==-1?(v=2,b=new Array(2),m=M):(v=5,b=new Array(4),p&&(p.indexOf("mp4a.40.29")!==-1||p.indexOf("mp4a.40.5")!==-1)||!p&&M>=6?m=M-3:((p&&p.indexOf("mp4a.40.2")!==-1&&(M>=6&&A===1||/vivaldi/i.test(T))||!p&&A===1)&&(v=2,b=new Array(2)),m=M)),b[0]=v<<3,b[0]|=(M&14)>>1,b[1]|=(M&1)<<7,b[1]|=A<<3,v===5&&(b[1]|=(m&14)>>1,b[2]=(m&1)<<7,b[2]|=2<<2,b[3]=0),{config:b,samplerate:O[M],channelCount:A,codec:"mp4a.40."+v,manifestCodec:P}}function c(E,_){return E[_]===255&&(E[_+1]&246)===240}function u(E,_){return E[_+1]&1?7:9}function h(E,_){return(E[_+3]&3)<<11|E[_+4]<<3|(E[_+5]&224)>>>5}function d(E,_){return _+5<E.length}function y(E,_){return _+1<E.length&&c(E,_)}function x(E,_){return d(E,_)&&c(E,_)&&h(E,_)<=E.length-_}function D(E,_){if(y(E,_)){var C=u(E,_);if(_+C>=E.length)return!1;var p=h(E,_);if(p<=C)return!1;var v=_+p;return v===E.length||y(E,v)}return!1}function S(E,_,C,p,v){if(!E.samplerate){var m=l(_,C,p,v);if(!m)return;E.config=m.config,E.samplerate=m.samplerate,E.channelCount=m.channelCount,E.codec=m.codec,E.manifestCodec=m.manifestCodec,s.logger.log("parsed codec:"+E.codec+", rate:"+m.samplerate+", channels:"+m.channelCount)}}function L(E){return 1024*9e4/E}function g(E,_){var C=u(E,_);if(_+C<=E.length){var p=h(E,_)-C;if(p>0)return{headerLength:C,frameLength:p}}}function f(E,_,C,p,v){var m=L(E.samplerate),A=p+v*m,b=g(_,C),T;if(b){var P=b.frameLength,O=b.headerLength,M=O+P,R=Math.max(0,C+M-_.length);R?(T=new Uint8Array(M-O),T.set(_.subarray(C+O,_.length),0)):T=_.subarray(C+O,C+M);var I={unit:T,pts:A};return R||E.samples.push(I),{sample:I,length:M,missing:R}}var w=_.length-C;T=new Uint8Array(w),T.set(_.subarray(C,_.length),0);var k={unit:T,pts:A};return{sample:k,length:w,missing:-1}}},"./src/demux/base-audio-demuxer.ts":function(n,i,r){r.r(i),r.d(i,"initPTSFn",function(){return d});var s=r("./src/polyfills/number.ts"),a=r("./src/demux/id3.ts"),o=r("./src/types/demuxer.ts"),l=r("./src/demux/dummy-demuxed-track.ts"),c=r("./src/utils/mp4-tools.ts"),u=r("./src/utils/typed-array.ts"),h=function(){function y(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null}var x=y.prototype;return x.resetInitSegment=function(S,L,g,f){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},x.resetTimeStamp=function(S){this.initPTS=S,this.resetContiguity()},x.resetContiguity=function(){this.basePTS=null,this.frameIndex=0},x.canParse=function(S,L){return!1},x.appendFrame=function(S,L,g){},x.demux=function(S,L){this.cachedData&&(S=Object(c.appendUint8Array)(this.cachedData,S),this.cachedData=null);var g=a.getID3Data(S,0),f=g?g.length:0,E,_,C=this._audioTrack,p=this._id3Track,v=g?a.getTimeStamp(g):void 0,m=S.length;for((this.basePTS===null||this.frameIndex===0&&Object(s.isFiniteNumber)(v))&&(this.basePTS=d(v,L,this.initPTS)),g&&g.length>0&&p.samples.push({pts:this.basePTS,dts:this.basePTS,data:g,type:o.MetadataSchema.audioId3}),_=this.basePTS;f<m;){if(this.canParse(S,f)){var A=this.appendFrame(C,S,f);A?(this.frameIndex++,_=A.sample.pts,f+=A.length,E=f):f=m}else a.canParse(S,f)?(g=a.getID3Data(S,f),p.samples.push({pts:_,dts:_,data:g,type:o.MetadataSchema.audioId3}),f+=g.length,E=f):f++;if(f===m&&E!==m){var b=Object(u.sliceUint8)(S,E);this.cachedData?this.cachedData=Object(c.appendUint8Array)(this.cachedData,b):this.cachedData=b}}return{audioTrack:C,videoTrack:Object(l.dummyTrack)(),id3Track:p,textTrack:Object(l.dummyTrack)()}},x.demuxSampleAes=function(S,L,g){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},x.flush=function(S){var L=this.cachedData;return L&&(this.cachedData=null,this.demux(L,0)),{audioTrack:this._audioTrack,videoTrack:Object(l.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(l.dummyTrack)()}},x.destroy=function(){},y}(),d=function(x,D,S){return Object(s.isFiniteNumber)(x)?x*90:D*9e4+(S||0)};i.default=h},"./src/demux/chunk-cache.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return s});var s=function(){function o(){this.chunks=[],this.dataLength=0}var l=o.prototype;return l.push=function(u){this.chunks.push(u),this.dataLength+=u.length},l.flush=function(){var u=this.chunks,h=this.dataLength,d;if(u.length)u.length===1?d=u[0]:d=a(u,h);else return new Uint8Array(0);return this.reset(),d},l.reset=function(){this.chunks.length=0,this.dataLength=0},o}();function a(o,l){for(var c=new Uint8Array(l),u=0,h=0;h<o.length;h++){var d=o[h];c.set(d,u),u+=d.length}return c}},"./src/demux/dummy-demuxed-track.ts":function(n,i,r){r.r(i),r.d(i,"dummyTrack",function(){return s});function s(a,o){return a===void 0&&(a=""),o===void 0&&(o=9e4),{type:a,id:-1,pid:-1,inputTimeScale:o,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":function(n,i,r){r.r(i);var s=r("./src/utils/logger.ts"),a=function(){function o(c){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=c,this.bytesAvailable=c.byteLength,this.word=0,this.bitsAvailable=0}var l=o.prototype;return l.loadWord=function(){var u=this.data,h=this.bytesAvailable,d=u.byteLength-h,y=new Uint8Array(4),x=Math.min(4,h);if(x===0)throw new Error("no bytes available");y.set(u.subarray(d,d+x)),this.word=new DataView(y.buffer).getUint32(0),this.bitsAvailable=x*8,this.bytesAvailable-=x},l.skipBits=function(u){var h;this.bitsAvailable>u?(this.word<<=u,this.bitsAvailable-=u):(u-=this.bitsAvailable,h=u>>3,u-=h>>3,this.bytesAvailable-=h,this.loadWord(),this.word<<=u,this.bitsAvailable-=u)},l.readBits=function(u){var h=Math.min(this.bitsAvailable,u),d=this.word>>>32-h;return u>32&&s.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=h,this.bitsAvailable>0?this.word<<=h:this.bytesAvailable>0&&this.loadWord(),h=u-h,h>0&&this.bitsAvailable?d<<h|this.readBits(h):d},l.skipLZ=function(){var u;for(u=0;u<this.bitsAvailable;++u)if((this.word&2147483648>>>u)!==0)return this.word<<=u,this.bitsAvailable-=u,u;return this.loadWord(),u+this.skipLZ()},l.skipUEG=function(){this.skipBits(1+this.skipLZ())},l.skipEG=function(){this.skipBits(1+this.skipLZ())},l.readUEG=function(){var u=this.skipLZ();return this.readBits(u+1)-1},l.readEG=function(){var u=this.readUEG();return 1&u?1+u>>>1:-1*(u>>>1)},l.readBoolean=function(){return this.readBits(1)===1},l.readUByte=function(){return this.readBits(8)},l.readUShort=function(){return this.readBits(16)},l.readUInt=function(){return this.readBits(32)},l.skipScalingList=function(u){for(var h=8,d=8,y,x=0;x<u;x++)d!==0&&(y=this.readEG(),d=(h+y+256)%256),h=d===0?h:d},l.readSPS=function(){var u=0,h=0,d=0,y=0,x,D,S,L=this.readUByte.bind(this),g=this.readBits.bind(this),f=this.readUEG.bind(this),E=this.readBoolean.bind(this),_=this.skipBits.bind(this),C=this.skipEG.bind(this),p=this.skipUEG.bind(this),v=this.skipScalingList.bind(this);L();var m=L();if(g(5),_(3),L(),p(),m===100||m===110||m===122||m===244||m===44||m===83||m===86||m===118||m===128){var A=f();if(A===3&&_(1),p(),p(),_(1),E())for(D=A!==3?8:12,S=0;S<D;S++)E()&&(S<6?v(16):v(64))}p();var b=f();if(b===0)f();else if(b===1)for(_(1),C(),C(),x=f(),S=0;S<x;S++)C();p(),_(1);var T=f(),P=f(),O=g(1);O===0&&_(1),_(1),E()&&(u=f(),h=f(),d=f(),y=f());var M=[1,1];if(E()&&E()){var R=L();switch(R){case 1:M=[1,1];break;case 2:M=[12,11];break;case 3:M=[10,11];break;case 4:M=[16,11];break;case 5:M=[40,33];break;case 6:M=[24,11];break;case 7:M=[20,11];break;case 8:M=[32,11];break;case 9:M=[80,33];break;case 10:M=[18,11];break;case 11:M=[15,11];break;case 12:M=[64,33];break;case 13:M=[160,99];break;case 14:M=[4,3];break;case 15:M=[3,2];break;case 16:M=[2,1];break;case 255:{M=[L()<<8|L(),L()<<8|L()];break}}}return{width:Math.ceil((T+1)*16-u*2-h*2),height:(2-O)*(P+1)*16-(O?2:4)*(d+y),pixelRatio:M}},l.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},o}();i.default=a},"./src/demux/id3.ts":function(n,i,r){r.r(i),r.d(i,"isHeader",function(){return s}),r.d(i,"isFooter",function(){return a}),r.d(i,"getID3Data",function(){return o}),r.d(i,"canParse",function(){return c}),r.d(i,"getTimeStamp",function(){return u}),r.d(i,"isTimeStampFrame",function(){return h}),r.d(i,"getID3Frames",function(){return y}),r.d(i,"decodeFrame",function(){return x}),r.d(i,"utf8ArrayToStr",function(){return f}),r.d(i,"testables",function(){return E});var s=function(v,m){return m+10<=v.length&&v[m]===73&&v[m+1]===68&&v[m+2]===51&&v[m+3]<255&&v[m+4]<255&&v[m+6]<128&&v[m+7]<128&&v[m+8]<128&&v[m+9]<128},a=function(v,m){return m+10<=v.length&&v[m]===51&&v[m+1]===68&&v[m+2]===73&&v[m+3]<255&&v[m+4]<255&&v[m+6]<128&&v[m+7]<128&&v[m+8]<128&&v[m+9]<128},o=function(v,m){for(var A=m,b=0;s(v,m);){b+=10;var T=l(v,m+6);b+=T,a(v,m+10)&&(b+=10),m+=b}if(b>0)return v.subarray(A,A+b)},l=function(v,m){var A=0;return A=(v[m]&127)<<21,A|=(v[m+1]&127)<<14,A|=(v[m+2]&127)<<7,A|=v[m+3]&127,A},c=function(v,m){return s(v,m)&&l(v,m+6)+10<=v.length-m},u=function(v){for(var m=y(v),A=0;A<m.length;A++){var b=m[A];if(h(b))return g(b)}},h=function(v){return v&&v.key==="PRIV"&&v.info==="com.apple.streaming.transportStreamTimestamp"},d=function(v){var m=String.fromCharCode(v[0],v[1],v[2],v[3]),A=l(v,4),b=10;return{type:m,size:A,data:v.subarray(b,b+A)}},y=function(v){for(var m=0,A=[];s(v,m);){var b=l(v,m+6);m+=10;for(var T=m+b;m+8<T;){var P=d(v.subarray(m)),O=x(P);O&&A.push(O),m+=P.size+10}a(v,m)&&(m+=10)}return A},x=function(v){return v.type==="PRIV"?D(v):v.type[0]==="W"?L(v):S(v)},D=function(v){if(!(v.size<2)){var m=f(v.data,!0),A=new Uint8Array(v.data.subarray(m.length+1));return{key:v.type,info:m,data:A.buffer}}},S=function(v){if(!(v.size<2)){if(v.type==="TXXX"){var m=1,A=f(v.data.subarray(m),!0);m+=A.length+1;var b=f(v.data.subarray(m));return{key:v.type,info:A,data:b}}var T=f(v.data.subarray(1));return{key:v.type,data:T}}},L=function(v){if(v.type==="WXXX"){if(v.size<2)return;var m=1,A=f(v.data.subarray(m),!0);m+=A.length+1;var b=f(v.data.subarray(m));return{key:v.type,info:A,data:b}}var T=f(v.data);return{key:v.type,data:T}},g=function(v){if(v.data.byteLength===8){var m=new Uint8Array(v.data),A=m[3]&1,b=(m[4]<<23)+(m[5]<<15)+(m[6]<<7)+m[7];return b/=45,A&&(b+=4772185884e-2),Math.round(b)}},f=function(v,m){m===void 0&&(m=!1);var A=C();if(A){var b=A.decode(v);if(m){var T=b.indexOf("\0");return T!==-1?b.substring(0,T):b}return b.replace(/\0/g,"")}for(var P=v.length,O,M,R,I="",w=0;w<P;){if(O=v[w++],O===0&&m)return I;if(O===0||O===3)continue;switch(O>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:I+=String.fromCharCode(O);break;case 12:case 13:M=v[w++],I+=String.fromCharCode((O&31)<<6|M&63);break;case 14:M=v[w++],R=v[w++],I+=String.fromCharCode((O&15)<<12|(M&63)<<6|(R&63)<<0);break}}return I},E={decodeTextFrame:S},_;function C(){return!_&&typeof self.TextDecoder<"u"&&(_=new self.TextDecoder("utf-8")),_}},"./src/demux/mp3demuxer.ts":function(n,i,r){r.r(i);var s=r("./src/demux/base-audio-demuxer.ts"),a=r("./src/demux/id3.ts"),o=r("./src/utils/logger.ts"),l=r("./src/demux/mpegaudio.ts");function c(d,y){d.prototype=Object.create(y.prototype),d.prototype.constructor=d,u(d,y)}function u(d,y){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,S){return D.__proto__=S,D},u(d,y)}var h=function(d){c(y,d);function y(){return d.apply(this,arguments)||this}var x=y.prototype;return x.resetInitSegment=function(S,L,g,f){d.prototype.resetInitSegment.call(this,S,L,g,f),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:L,duration:f,inputTimeScale:9e4,dropped:0}},y.probe=function(S){if(!S)return!1;for(var L=a.getID3Data(S,0)||[],g=L.length,f=S.length;g<f;g++)if(l.probe(S,g))return o.logger.log("MPEG Audio sync word found !"),!0;return!1},x.canParse=function(S,L){return l.canParse(S,L)},x.appendFrame=function(S,L,g){if(this.basePTS!==null)return l.appendFrame(S,L,g,this.basePTS,this.frameIndex)},y}(s.default);i.default=h},"./src/demux/mp4demuxer.ts":function(n,i,r){r.r(i);var s=r("./src/polyfills/number.ts"),a=r("./src/types/demuxer.ts"),o=r("./src/utils/mp4-tools.ts"),l=r("./src/demux/dummy-demuxed-track.ts"),c=/\/emsg[-/]ID3/i,u=function(){function h(y,x){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=x}var d=h.prototype;return d.resetTimeStamp=function(){},d.resetInitSegment=function(x,D,S,L){var g=Object(o.parseInitSegment)(x),f=this.videoTrack=Object(l.dummyTrack)("video",1),E=this.audioTrack=Object(l.dummyTrack)("audio",1),_=this.txtTrack=Object(l.dummyTrack)("text",1);if(this.id3Track=Object(l.dummyTrack)("id3",1),this.timeOffset=0,g.video){var C=g.video,p=C.id,v=C.timescale,m=C.codec;f.id=p,f.timescale=_.timescale=v,f.codec=m}if(g.audio){var A=g.audio,b=A.id,T=A.timescale,P=A.codec;E.id=b,E.timescale=T,E.codec=P}_.id=o.RemuxerTrackIdConfig.text,f.sampleDuration=0,f.duration=E.duration=L},d.resetContiguity=function(){},h.probe=function(x){return x=x.length>16384?x.subarray(0,16384):x,Object(o.findBox)(x,["moof"]).length>0},d.demux=function(x,D){this.timeOffset=D;var S=x,L=this.videoTrack,g=this.txtTrack;if(this.config.progressive){this.remainderData&&(S=Object(o.appendUint8Array)(this.remainderData,x));var f=Object(o.segmentValidRange)(S);this.remainderData=f.remainder,L.samples=f.valid||new Uint8Array}else L.samples=S;var E=this.extractID3Track(L,D);return g.samples=Object(o.parseSamples)(D,L),{videoTrack:L,audioTrack:this.audioTrack,id3Track:E,textTrack:this.txtTrack}},d.flush=function(){var x=this.timeOffset,D=this.videoTrack,S=this.txtTrack;D.samples=this.remainderData||new Uint8Array,this.remainderData=null;var L=this.extractID3Track(D,this.timeOffset);return S.samples=Object(o.parseSamples)(x,D),{videoTrack:D,audioTrack:Object(l.dummyTrack)(),id3Track:L,textTrack:Object(l.dummyTrack)()}},d.extractID3Track=function(x,D){var S=this.id3Track;if(x.samples.length){var L=Object(o.findBox)(x.samples,["emsg"]);L&&L.forEach(function(g){var f=Object(o.parseEmsg)(g);if(c.test(f.schemeIdUri)){var E=Object(s.isFiniteNumber)(f.presentationTime)?f.presentationTime/f.timeScale:D+f.presentationTimeDelta/f.timeScale,_=f.payload;S.samples.push({data:_,len:_.byteLength,dts:E,pts:E,type:a.MetadataSchema.emsg})}})}return S},d.demuxSampleAes=function(x,D,S){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},d.destroy=function(){},h}();i.default=u},"./src/demux/mpegaudio.ts":function(n,i,r){r.r(i),r.d(i,"appendFrame",function(){return u}),r.d(i,"parseHeader",function(){return h}),r.d(i,"isHeaderPattern",function(){return d}),r.d(i,"isHeader",function(){return y}),r.d(i,"canParse",function(){return x}),r.d(i,"probe",function(){return D});var s=null,a=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],o=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],l=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],c=[0,1,1,4];function u(S,L,g,f,E){if(!(g+24>L.length)){var _=h(L,g);if(_&&g+_.frameLength<=L.length){var C=_.samplesPerFrame*9e4/_.sampleRate,p=f+E*C,v={unit:L.subarray(g,g+_.frameLength),pts:p,dts:p};return S.config=[],S.channelCount=_.channelCount,S.samplerate=_.sampleRate,S.samples.push(v),{sample:v,length:_.frameLength,missing:0}}}}function h(S,L){var g=S[L+1]>>3&3,f=S[L+1]>>1&3,E=S[L+2]>>4&15,_=S[L+2]>>2&3;if(g!==1&&E!==0&&E!==15&&_!==3){var C=S[L+2]>>1&1,p=S[L+3]>>6,v=g===3?3-f:f===3?3:4,m=a[v*14+E-1]*1e3,A=g===3?0:g===2?1:2,b=o[A*3+_],T=p===3?1:2,P=l[g][f],O=c[f],M=P*8*O,R=Math.floor(P*m/b+C)*O;if(s===null){var I=navigator.userAgent||"",w=I.match(/Chrome\/(\d+)/i);s=w?parseInt(w[1]):0}var k=!!s&&s<=87;return k&&f===2&&m>=224e3&&p===0&&(S[L+3]=S[L+3]|128),{sampleRate:b,channelCount:T,frameLength:R,samplesPerFrame:M}}}function d(S,L){return S[L]===255&&(S[L+1]&224)===224&&(S[L+1]&6)!==0}function y(S,L){return L+1<S.length&&d(S,L)}function x(S,L){var g=4;return d(S,L)&&g<=S.length-L}function D(S,L){if(L+1<S.length&&d(S,L)){var g=4,f=h(S,L),E=g;f!=null&&f.frameLength&&(E=f.frameLength);var _=L+E;return _===S.length||y(S,_)}return!1}},"./src/demux/sample-aes.ts":function(n,i,r){r.r(i);var s=r("./src/crypt/decrypter.ts"),a=r("./src/demux/tsdemuxer.ts"),o=function(){function l(u,h,d){this.keyData=void 0,this.decrypter=void 0,this.keyData=d,this.decrypter=new s.default(u,h,{removePKCS7Padding:!1})}var c=l.prototype;return c.decryptBuffer=function(h,d){this.decrypter.decrypt(h,this.keyData.key.buffer,this.keyData.iv.buffer,d)},c.decryptAacSample=function(h,d,y,x){var D=h[d].unit;if(!(D.length<=16)){var S=D.subarray(16,D.length-D.length%16),L=S.buffer.slice(S.byteOffset,S.byteOffset+S.length),g=this;this.decryptBuffer(L,function(f){var E=new Uint8Array(f);D.set(E,16),x||g.decryptAacSamples(h,d+1,y)})}},c.decryptAacSamples=function(h,d,y){for(;;d++){if(d>=h.length){y();return}if(!(h[d].unit.length<32)){var x=this.decrypter.isSync();if(this.decryptAacSample(h,d,y,x),!x)return}}},c.getAvcEncryptedData=function(h){for(var d=Math.floor((h.length-48)/160)*16+16,y=new Int8Array(d),x=0,D=32;D<h.length-16;D+=160,x+=16)y.set(h.subarray(D,D+16),x);return y},c.getAvcDecryptedUnit=function(h,d){for(var y=new Uint8Array(d),x=0,D=32;D<h.length-16;D+=160,x+=16)h.set(y.subarray(x,x+16),D);return h},c.decryptAvcSample=function(h,d,y,x,D,S){var L=Object(a.discardEPB)(D.data),g=this.getAvcEncryptedData(L),f=this;this.decryptBuffer(g.buffer,function(E){D.data=f.getAvcDecryptedUnit(L,E),S||f.decryptAvcSamples(h,d,y+1,x)})},c.decryptAvcSamples=function(h,d,y,x){if(h instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;d++,y=0){if(d>=h.length){x();return}for(var D=h[d].units;!(y>=D.length);y++){var S=D[y];if(!(S.data.length<=48||S.type!==1&&S.type!==5)){var L=this.decrypter.isSync();if(this.decryptAvcSample(h,d,y,x,S,L),!L)return}}}},l}();i.default=o},"./src/demux/transmuxer-interface.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return y});var s=r("./node_modules/webworkify-webpack/index.js"),a=r("./src/events.ts"),o=r("./src/demux/transmuxer.ts"),l=r("./src/utils/logger.ts"),c=r("./src/errors.ts"),u=r("./src/utils/mediasource-helper.ts"),h=r("./node_modules/eventemitter3/index.js"),d=Object(u.getMediaSource)()||{isTypeSupported:function(){return!1}},y=function(){function x(S,L,g,f){var E=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=S,this.id=L,this.onTransmuxComplete=g,this.onFlush=f;var _=S.config,C=function(b,T){T=T||{},T.frag=E.frag,T.id=E.id,S.trigger(b,T)};this.observer=new h.EventEmitter,this.observer.on(a.Events.FRAG_DECRYPTED,C),this.observer.on(a.Events.ERROR,C);var p={mp4:d.isTypeSupported("video/mp4"),mpeg:d.isTypeSupported("audio/mpeg"),mp3:d.isTypeSupported('audio/mp4; codecs="mp3"')},v=navigator.vendor;if(_.enableWorker&&typeof Worker<"u"){l.logger.log("demuxing in webworker");var m;try{m=this.worker=s("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),m.addEventListener("message",this.onwmsg),m.onerror=function(A){S.trigger(a.Events.ERROR,{type:c.ErrorTypes.OTHER_ERROR,details:c.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(A.message+"  ("+A.filename+":"+A.lineno+")")})},m.postMessage({cmd:"init",typeSupported:p,vendor:v,id:L,config:JSON.stringify(_)})}catch(A){l.logger.warn("Error in worker:",A),l.logger.error("Error while initializing DemuxerWorker, fallback to inline"),m&&self.URL.revokeObjectURL(m.objectURL),this.transmuxer=new o.default(this.observer,p,_,v,L),this.worker=null}}else this.transmuxer=new o.default(this.observer,p,_,v,L)}var D=x.prototype;return D.destroy=function(){var L=this.worker;if(L)L.removeEventListener("message",this.onwmsg),L.terminate(),this.worker=null,this.onwmsg=void 0;else{var g=this.transmuxer;g&&(g.destroy(),this.transmuxer=null)}var f=this.observer;f&&f.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},D.push=function(L,g,f,E,_,C,p,v,m,A){var b,T,P=this;m.transmuxing.start=self.performance.now();var O=this.transmuxer,M=this.worker,R=C?C.start:_.start,I=_.decryptdata,w=this.frag,k=!(w&&_.cc===w.cc),B=!(w&&m.level===w.level),F=w?m.sn-w.sn:-1,N=this.part?m.part-this.part.index:-1,K=F===0&&m.id>1&&m.id===(w==null?void 0:w.stats.chunkCount),H=!B&&(F===1||F===0&&(N===1||K&&N<=0)),U=self.performance.now();(B||F||_.stats.parsing.start===0)&&(_.stats.parsing.start=U),C&&(N||!H)&&(C.stats.parsing.start=U);var j=!(w&&((b=_.initSegment)===null||b===void 0?void 0:b.url)===((T=w.initSegment)===null||T===void 0?void 0:T.url)),G=new o.TransmuxState(k,H,v,B,R,j);if(!H||k||j){l.logger.log("[transmuxer-interface, "+_.type+"]: Starting new transmux session for sn: "+m.sn+" p: "+m.part+" level: "+m.level+" id: "+m.id+`
        discontinuity: `+k+`
        trackSwitch: `+B+`
        contiguous: `+H+`
        accurateTimeOffset: `+v+`
        timeOffset: `+R+`
        initSegmentChange: `+j);var X=new o.TransmuxConfig(f,E,g,p,A);this.configureTransmuxer(X)}if(this.frag=_,this.part=C,M)M.postMessage({cmd:"demux",data:L,decryptdata:I,chunkMeta:m,state:G},L instanceof ArrayBuffer?[L]:[]);else if(O){var J=O.push(L,I,m,G);Object(o.isPromise)(J)?J.then(function(nt){P.handleTransmuxComplete(nt)}):this.handleTransmuxComplete(J)}},D.flush=function(L){var g=this;L.transmuxing.start=self.performance.now();var f=this.transmuxer,E=this.worker;if(E)E.postMessage({cmd:"flush",chunkMeta:L});else if(f){var _=f.flush(L);Object(o.isPromise)(_)?_.then(function(C){g.handleFlushResult(C,L)}):this.handleFlushResult(_,L)}},D.handleFlushResult=function(L,g){var f=this;L.forEach(function(E){f.handleTransmuxComplete(E)}),this.onFlush(g)},D.onWorkerMessage=function(L){var g=L.data,f=this.hls;switch(g.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(g.data);break}case"flush":{this.onFlush(g.data);break}case"workerLog":l.logger[g.data.logType]&&l.logger[g.data.logType](g.data.message);break;default:{g.data=g.data||{},g.data.frag=this.frag,g.data.id=this.id,f.trigger(g.event,g.data);break}}},D.configureTransmuxer=function(L){var g=this.worker,f=this.transmuxer;g?g.postMessage({cmd:"configure",config:L}):f&&f.configure(L)},D.handleTransmuxComplete=function(L){L.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(L)},x}()},"./src/demux/transmuxer-worker.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return c});var s=r("./src/demux/transmuxer.ts"),a=r("./src/events.ts"),o=r("./src/utils/logger.ts"),l=r("./node_modules/eventemitter3/index.js");function c(x){var D=new l.EventEmitter,S=function(f,E){x.postMessage({event:f,data:E})};D.on(a.Events.FRAG_DECRYPTED,S),D.on(a.Events.ERROR,S);var L=function(){var f=function(C){var p=function(m){S("workerLog",{logType:C,message:m})};o.logger[C]=p};for(var E in o.logger)f(E)};x.addEventListener("message",function(g){var f=g.data;switch(f.cmd){case"init":{var E=JSON.parse(f.config);x.transmuxer=new s.default(D,f.typeSupported,E,f.vendor,f.id),Object(o.enableLogs)(E.debug),L(),S("init",null);break}case"configure":{x.transmuxer.configure(f.config);break}case"demux":{var _=x.transmuxer.push(f.data,f.decryptdata,f.chunkMeta,f.state);Object(s.isPromise)(_)?_.then(function(v){u(x,v)}):u(x,_);break}case"flush":{var C=f.chunkMeta,p=x.transmuxer.flush(C);Object(s.isPromise)(p)?p.then(function(v){d(x,v,C)}):d(x,p,C);break}}})}function u(x,D){if(y(D.remuxResult))return!1;var S=[],L=D.remuxResult,g=L.audio,f=L.video;return g&&h(S,g),f&&h(S,f),x.postMessage({event:"transmuxComplete",data:D},S),!0}function h(x,D){D.data1&&x.push(D.data1.buffer),D.data2&&x.push(D.data2.buffer)}function d(x,D,S){var L=D.reduce(function(g,f){return u(x,f)||g},!1);L||x.postMessage({event:"transmuxComplete",data:D[0]}),x.postMessage({event:"flush",data:S})}function y(x){return!x.audio&&!x.video&&!x.text&&!x.id3&&!x.initSegment}},"./src/demux/transmuxer.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return L}),r.d(i,"isPromise",function(){return E}),r.d(i,"TransmuxConfig",function(){return _}),r.d(i,"TransmuxState",function(){return C});var s=r("./src/events.ts"),a=r("./src/errors.ts"),o=r("./src/crypt/decrypter.ts"),l=r("./src/demux/aacdemuxer.ts"),c=r("./src/demux/mp4demuxer.ts"),u=r("./src/demux/tsdemuxer.ts"),h=r("./src/demux/mp3demuxer.ts"),d=r("./src/remux/mp4-remuxer.ts"),y=r("./src/remux/passthrough-remuxer.ts"),x=r("./src/utils/logger.ts"),D;try{D=self.performance.now.bind(self.performance)}catch{x.logger.debug("Unable to use Performance API on this environment"),D=self.Date.now}var S=[{demux:u.default,remux:d.default},{demux:c.default,remux:y.default},{demux:l.default,remux:d.default},{demux:h.default,remux:d.default}],L=function(){function p(m,A,b,T,P){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=m,this.typeSupported=A,this.config=b,this.vendor=T,this.id=P}var v=p.prototype;return v.configure=function(A){this.transmuxConfig=A,this.decrypter&&this.decrypter.reset()},v.push=function(A,b,T,P){var O=this,M=T.transmuxing;M.executeStart=D();var R=new Uint8Array(A),I=this.config,w=this.currentTransmuxState,k=this.transmuxConfig;P&&(this.currentTransmuxState=P);var B=P||w,F=B.contiguous,N=B.discontinuity,K=B.trackSwitch,H=B.accurateTimeOffset,U=B.timeOffset,j=B.initSegmentChange,G=k.audioCodec,X=k.videoCodec,J=k.defaultInitPts,nt=k.duration,ot=k.initSegmentData;(N||K||j)&&this.resetInitSegment(ot,G,X,nt),(N||j)&&this.resetInitialTimestamp(J),F||this.resetContiguity();var rt=g(R,b);if(rt&&rt.method==="AES-128"){var W=this.getDecrypter();if(I.enableSoftwareAES){var V=W.softwareDecrypt(R,rt.key.buffer,rt.iv.buffer);if(!V)return M.executeEnd=D(),f(T);R=new Uint8Array(V)}else return this.decryptionPromise=W.webCryptoDecrypt(R,rt.key.buffer,rt.iv.buffer).then(function(Q){var Z=O.push(Q,null,T);return O.decryptionPromise=null,Z}),this.decryptionPromise}this.needsProbing(R,N,K)&&this.configureTransmuxer(R,k);var z=this.transmux(R,rt,U,H,T),Y=this.currentTransmuxState;return Y.contiguous=!0,Y.discontinuity=!1,Y.trackSwitch=!1,M.executeEnd=D(),z},v.flush=function(A){var b=this,T=A.transmuxing;T.executeStart=D();var P=this.decrypter,O=this.currentTransmuxState,M=this.decryptionPromise;if(M)return M.then(function(){return b.flush(A)});var R=[],I=O.timeOffset;if(P){var w=P.flush();w&&R.push(this.push(w,null,A))}var k=this.demuxer,B=this.remuxer;if(!k||!B)return this.observer.emit(s.Events.ERROR,s.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),T.executeEnd=D(),[f(A)];var F=k.flush(I);return E(F)?F.then(function(N){return b.flushRemux(R,N,A),R}):(this.flushRemux(R,F,A),R)},v.flushRemux=function(A,b,T){var P=b.audioTrack,O=b.videoTrack,M=b.id3Track,R=b.textTrack,I=this.currentTransmuxState,w=I.accurateTimeOffset,k=I.timeOffset;x.logger.log("[transmuxer.ts]: Flushed fragment "+T.sn+(T.part>-1?" p: "+T.part:"")+" of level "+T.level);var B=this.remuxer.remux(P,O,M,R,k,w,!0,this.id);A.push({remuxResult:B,chunkMeta:T}),T.transmuxing.executeEnd=D()},v.resetInitialTimestamp=function(A){var b=this.demuxer,T=this.remuxer;!b||!T||(b.resetTimeStamp(A),T.resetTimeStamp(A))},v.resetContiguity=function(){var A=this.demuxer,b=this.remuxer;!A||!b||(A.resetContiguity(),b.resetNextTimestamp())},v.resetInitSegment=function(A,b,T,P){var O=this.demuxer,M=this.remuxer;!O||!M||(O.resetInitSegment(A,b,T,P),M.resetInitSegment(A,b,T))},v.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},v.transmux=function(A,b,T,P,O){var M;return b&&b.method==="SAMPLE-AES"?M=this.transmuxSampleAes(A,b,T,P,O):M=this.transmuxUnencrypted(A,T,P,O),M},v.transmuxUnencrypted=function(A,b,T,P){var O=this.demuxer.demux(A,b,!1,!this.config.progressive),M=O.audioTrack,R=O.videoTrack,I=O.id3Track,w=O.textTrack,k=this.remuxer.remux(M,R,I,w,b,T,!1,this.id);return{remuxResult:k,chunkMeta:P}},v.transmuxSampleAes=function(A,b,T,P,O){var M=this;return this.demuxer.demuxSampleAes(A,b,T).then(function(R){var I=M.remuxer.remux(R.audioTrack,R.videoTrack,R.id3Track,R.textTrack,T,P,!1,M.id);return{remuxResult:I,chunkMeta:O}})},v.configureTransmuxer=function(A,b){for(var T=this.config,P=this.observer,O=this.typeSupported,M=this.vendor,R=b.audioCodec,I=b.defaultInitPts,w=b.duration,k=b.initSegmentData,B=b.videoCodec,F,N=0,K=S.length;N<K;N++)if(S[N].demux.probe(A)){F=S[N];break}F||(x.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),F={demux:c.default,remux:y.default});var H=this.demuxer,U=this.remuxer,j=F.remux,G=F.demux;(!U||!(U instanceof j))&&(this.remuxer=new j(P,T,O,M)),(!H||!(H instanceof G))&&(this.demuxer=new G(P,T,O),this.probe=G.probe),this.resetInitSegment(k,R,B,w),this.resetInitialTimestamp(I)},v.needsProbing=function(A,b,T){return!this.demuxer||!this.remuxer||b||T},v.getDecrypter=function(){var A=this.decrypter;return A||(A=this.decrypter=new o.default(this.observer,this.config)),A},p}();function g(p,v){var m=null;return p.byteLength>0&&v!=null&&v.key!=null&&v.iv!==null&&v.method!=null&&(m=v),m}var f=function(v){return{remuxResult:{},chunkMeta:v}};function E(p){return"then"in p&&p.then instanceof Function}var _=function(v,m,A,b,T){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=v,this.videoCodec=m,this.initSegmentData=A,this.duration=b,this.defaultInitPts=T},C=function(v,m,A,b,T,P){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=v,this.contiguous=m,this.accurateTimeOffset=A,this.trackSwitch=b,this.timeOffset=T,this.initSegmentChange=P}},"./src/demux/tsdemuxer.ts":function(n,i,r){r.r(i),r.d(i,"discardEPB",function(){return _});var s=r("./src/demux/adts.ts"),a=r("./src/demux/mpegaudio.ts"),o=r("./src/demux/exp-golomb.ts"),l=r("./src/demux/sample-aes.ts"),c=r("./src/events.ts"),u=r("./src/utils/mp4-tools.ts"),h=r("./src/utils/logger.ts"),d=r("./src/errors.ts"),y=r("./src/types/demuxer.ts");function x(){return x=Object.assign?Object.assign.bind():function(C){for(var p=1;p<arguments.length;p++){var v=arguments[p];for(var m in v)Object.prototype.hasOwnProperty.call(v,m)&&(C[m]=v[m])}return C},x.apply(this,arguments)}var D=function(){function C(v,m,A){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=v,this.config=m,this.typeSupported=A}C.probe=function(m){return m[0]===71&&m[188]===71},C.createTrack=function(m,A){return{container:m==="video"||m==="audio"?"video/mp2t":void 0,type:m,id:u.RemuxerTrackIdConfig[m],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:m==="audio"?A:void 0}};var p=C.prototype;return p.resetInitSegment=function(m,A,b,T){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=C.createTrack("video"),this._audioTrack=C.createTrack("audio",T),this._id3Track=C.createTrack("id3"),this._txtTrack=C.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=A,this.videoCodec=b,this._duration=T},p.resetTimeStamp=function(){},p.resetContiguity=function(){var m=this._audioTrack,A=this._avcTrack,b=this._id3Track;m&&(m.pesData=null),A&&(A.pesData=null),b&&(b.pesData=null),this.aacOverFlow=null},p.demux=function(m,A,b,T){b===void 0&&(b=!1),T===void 0&&(T=!1),b||(this.sampleAes=null);var P,O=this._avcTrack,M=this._audioTrack,R=this._id3Track,I=this._txtTrack,w=O.pid,k=O.pesData,B=M.pid,F=R.pid,N=M.pesData,K=R.pesData,H=null,U=this.pmtParsed,j=this._pmtId,G=m.length;if(this.remainderData&&(m=Object(u.appendUint8Array)(this.remainderData,m),G=m.length,this.remainderData=null),G<188&&!T)return this.remainderData=m,{audioTrack:M,videoTrack:O,id3Track:R,textTrack:I};G-=G%188,G<m.byteLength&&!T&&(this.remainderData=new Uint8Array(m.buffer,G,m.buffer.byteLength-G));for(var X=0,J=0;J<G;J+=188)if(m[J]===71){var nt=!!(m[J+1]&64),ot=((m[J+1]&31)<<8)+m[J+2],rt=(m[J+3]&48)>>4,W=void 0;if(rt>1){if(W=J+5+m[J+4],W===J+188)continue}else W=J+4;switch(ot){case w:nt&&(k&&(P=f(k))&&this.parseAVCPES(O,I,P,!1),k={data:[],size:0}),k&&(k.data.push(m.subarray(W,J+188)),k.size+=J+188-W);break;case B:if(nt){if(N&&(P=f(N)))switch(M.segmentCodec){case"aac":this.parseAACPES(M,P);break;case"mp3":this.parseMPEGPES(M,P);break}N={data:[],size:0}}N&&(N.data.push(m.subarray(W,J+188)),N.size+=J+188-W);break;case F:nt&&(K&&(P=f(K))&&this.parseID3PES(R,P),K={data:[],size:0}),K&&(K.data.push(m.subarray(W,J+188)),K.size+=J+188-W);break;case 0:nt&&(W+=m[W]+1),j=this._pmtId=L(m,W);break;case j:{nt&&(W+=m[W]+1);var V=g(m,W,this.typeSupported,b);w=V.avc,w>0&&(O.pid=w),B=V.audio,B>0&&(M.pid=B,M.segmentCodec=V.segmentCodec),F=V.id3,F>0&&(R.pid=F),H!==null&&!U&&(h.logger.log("unknown PID '"+H+"' in TS found"),H=null),U=this.pmtParsed=!0;break}case 17:case 8191:break;default:H=ot;break}}else X++;X>0&&this.observer.emit(c.Events.ERROR,c.Events.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+X+" TS packet/s that do not start with 0x47"}),O.pesData=k,M.pesData=N,R.pesData=K;var z={audioTrack:M,videoTrack:O,id3Track:R,textTrack:I};return T&&this.extractRemainingSamples(z),z},p.flush=function(){var m=this.remainderData;this.remainderData=null;var A;return m?A=this.demux(m,-1,!1,!0):A={videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(A),this.sampleAes?this.decrypt(A,this.sampleAes):A},p.extractRemainingSamples=function(m){var A=m.audioTrack,b=m.videoTrack,T=m.id3Track,P=m.textTrack,O=b.pesData,M=A.pesData,R=T.pesData,I;if(O&&(I=f(O))?(this.parseAVCPES(b,P,I,!0),b.pesData=null):b.pesData=O,M&&(I=f(M))){switch(A.segmentCodec){case"aac":this.parseAACPES(A,I);break;case"mp3":this.parseMPEGPES(A,I);break}A.pesData=null}else M!=null&&M.size&&h.logger.log("last AAC PES packet truncated,might overlap between fragments"),A.pesData=M;R&&(I=f(R))?(this.parseID3PES(T,I),T.pesData=null):T.pesData=R},p.demuxSampleAes=function(m,A,b){var T=this.demux(m,b,!0,!this.config.progressive),P=this.sampleAes=new l.default(this.observer,this.config,A);return this.decrypt(T,P)},p.decrypt=function(m,A){return new Promise(function(b){var T=m.audioTrack,P=m.videoTrack;T.samples&&T.segmentCodec==="aac"?A.decryptAacSamples(T.samples,0,function(){P.samples?A.decryptAvcSamples(P.samples,0,0,function(){b(m)}):b(m)}):P.samples&&A.decryptAvcSamples(P.samples,0,0,function(){b(m)})})},p.destroy=function(){this._duration=0},p.parseAVCPES=function(m,A,b,T){var P=this,O=this.parseAVCNALu(m,b.data),M=this.avcSample,R,I=!1;b.data=null,M&&O.length&&!m.audFound&&(E(M,m),M=this.avcSample=S(!1,b.pts,b.dts,"")),O.forEach(function(w){switch(w.type){case 1:{R=!0,M||(M=P.avcSample=S(!0,b.pts,b.dts,"")),M.frame=!0;var k=w.data;if(I&&k.length>4){var B=new o.default(k).readSliceType();(B===2||B===4||B===7||B===9)&&(M.key=!0)}break}case 5:R=!0,M||(M=P.avcSample=S(!0,b.pts,b.dts,"")),M.key=!0,M.frame=!0;break;case 6:{R=!0,Object(u.parseSEIMessageFromNALu)(_(w.data),b.pts,A.samples);break}case 7:if(R=!0,I=!0,!m.sps){var F=new o.default(w.data),N=F.readSPS();m.width=N.width,m.height=N.height,m.pixelRatio=N.pixelRatio,m.sps=[w.data],m.duration=P._duration;for(var K=w.data.subarray(1,4),H="avc1.",U=0;U<3;U++){var j=K[U].toString(16);j.length<2&&(j="0"+j),H+=j}m.codec=H}break;case 8:R=!0,m.pps||(m.pps=[w.data]);break;case 9:R=!1,m.audFound=!0,M&&E(M,m),M=P.avcSample=S(!1,b.pts,b.dts,"");break;case 12:R=!0;break;default:R=!1,M&&(M.debug+="unknown NAL "+w.type+" ");break}if(M&&R){var G=M.units;G.push(w)}}),T&&M&&(E(M,m),this.avcSample=null)},p.getLastNalUnit=function(m){var A,b=this.avcSample,T;if((!b||b.units.length===0)&&(b=m[m.length-1]),(A=b)!==null&&A!==void 0&&A.units){var P=b.units;T=P[P.length-1]}return T},p.parseAVCNALu=function(m,A){var b=A.byteLength,T=m.naluState||0,P=T,O=[],M=0,R,I,w,k=-1,B=0;for(T===-1&&(k=0,B=A[0]&31,T=0,M=1);M<b;){if(R=A[M++],!T){T=R?0:1;continue}if(T===1){T=R?0:2;continue}if(!R)T=3;else if(R===1){if(k>=0){var F={data:A.subarray(k,M-T-1),type:B};O.push(F)}else{var N=this.getLastNalUnit(m.samples);if(N&&(P&&M<=4-P&&N.state&&(N.data=N.data.subarray(0,N.data.byteLength-P)),I=M-T-1,I>0)){var K=new Uint8Array(N.data.byteLength+I);K.set(N.data,0),K.set(A.subarray(0,I),N.data.byteLength),N.data=K,N.state=0}}M<b?(w=A[M]&31,k=M,B=w,T=0):T=-1}else T=0}if(k>=0&&T>=0){var H={data:A.subarray(k,b),type:B,state:T};O.push(H)}if(O.length===0){var U=this.getLastNalUnit(m.samples);if(U){var j=new Uint8Array(U.data.byteLength+A.byteLength);j.set(U.data,0),j.set(A,U.data.byteLength),U.data=j}}return m.naluState=T,O},p.parseAACPES=function(m,A){var b=0,T=this.aacOverFlow,P=A.data;if(T){this.aacOverFlow=null;var O=T.missing,M=T.sample.unit.byteLength;if(O===-1){var R=new Uint8Array(M+P.byteLength);R.set(T.sample.unit,0),R.set(P,M),P=R}else{var I=M-O;T.sample.unit.set(P.subarray(0,O),I),m.samples.push(T.sample),b=T.missing}}var w,k;for(w=b,k=P.length;w<k-1&&!s.isHeader(P,w);w++);if(w!==b){var B,F;if(w<k-1?(B="AAC PES did not start with ADTS header,offset:"+w,F=!1):(B="no ADTS header found in AAC PES",F=!0),h.logger.warn("parsing error:"+B),this.observer.emit(c.Events.ERROR,c.Events.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:F,reason:B}),F)return}s.initTrackConfig(m,this.observer,P,w,this.audioCodec);var N;if(A.pts!==void 0)N=A.pts;else if(T){var K=s.getFrameDuration(m.samplerate);N=T.sample.pts+K}else{h.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var H=0,U;w<k;)if(U=s.appendFrame(m,P,w,N,H),w+=U.length,U.missing){this.aacOverFlow=U;break}else for(H++;w<k-1&&!s.isHeader(P,w);w++);},p.parseMPEGPES=function(m,A){var b=A.data,T=b.length,P=0,O=0,M=A.pts;if(M===void 0){h.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;O<T;)if(a.isHeader(b,O)){var R=a.appendFrame(m,b,O,M,P);if(R)O+=R.length,P++;else break}else O++},p.parseID3PES=function(m,A){if(A.pts===void 0){h.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}var b=x({},A,{type:this._avcTrack?y.MetadataSchema.emsg:y.MetadataSchema.audioId3});m.samples.push(b)},C}();function S(C,p,v,m){return{key:C,frame:!1,pts:p,dts:v,units:[],debug:m,length:0}}function L(C,p){return(C[p+10]&31)<<8|C[p+11]}function g(C,p,v,m){var A={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},b=(C[p+1]&15)<<8|C[p+2],T=p+3+b-4,P=(C[p+10]&15)<<8|C[p+11];for(p+=12+P;p<T;){var O=(C[p+1]&31)<<8|C[p+2];switch(C[p]){case 207:if(!m){h.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:A.audio===-1&&(A.audio=O);break;case 21:A.id3===-1&&(A.id3=O);break;case 219:if(!m){h.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:A.avc===-1&&(A.avc=O);break;case 3:case 4:v.mpeg!==!0&&v.mp3!==!0?h.logger.log("MPEG audio found, not supported in this browser"):A.audio===-1&&(A.audio=O,A.segmentCodec="mp3");break;case 36:h.logger.warn("Unsupported HEVC stream type found");break}p+=((C[p+3]&15)<<8|C[p+4])+5}return A}function f(C){var p=0,v,m,A,b,T,P=C.data;if(!C||C.size===0)return null;for(;P[0].length<19&&P.length>1;){var O=new Uint8Array(P[0].length+P[1].length);O.set(P[0]),O.set(P[1],P[0].length),P[0]=O,P.splice(1,1)}v=P[0];var M=(v[0]<<16)+(v[1]<<8)+v[2];if(M===1){if(m=(v[4]<<8)+v[5],m&&m>C.size-6)return null;var R=v[7];R&192&&(b=(v[9]&14)*536870912+(v[10]&255)*4194304+(v[11]&254)*16384+(v[12]&255)*128+(v[13]&254)/2,R&64?(T=(v[14]&14)*536870912+(v[15]&255)*4194304+(v[16]&254)*16384+(v[17]&255)*128+(v[18]&254)/2,b-T>60*9e4&&(h.logger.warn(Math.round((b-T)/9e4)+"s delta between PTS and DTS, align them"),b=T)):T=b),A=v[8];var I=A+9;if(C.size<=I)return null;C.size-=I;for(var w=new Uint8Array(C.size),k=0,B=P.length;k<B;k++){v=P[k];var F=v.byteLength;if(I)if(I>F){I-=F;continue}else v=v.subarray(I),F-=I,I=0;w.set(v,p),p+=F}return m&&(m-=A+3),{data:w,pts:b,dts:T,len:m}}return null}function E(C,p){if(C.units.length&&C.frame){if(C.pts===void 0){var v=p.samples,m=v.length;if(m){var A=v[m-1];C.pts=A.pts,C.dts=A.dts}else{p.dropped++;return}}p.samples.push(C)}C.debug.length&&h.logger.log(C.pts+"/"+C.dts+":"+C.debug)}function _(C){for(var p=C.byteLength,v=[],m=1;m<p-2;)C[m]===0&&C[m+1]===0&&C[m+2]===3?(v.push(m+2),m+=2):m++;if(v.length===0)return C;var A=p-v.length,b=new Uint8Array(A),T=0;for(m=0;m<A;T++,m++)T===v[0]&&(T++,v.shift()),b[m]=C[T];return b}i.default=D},"./src/errors.ts":function(n,i,r){r.r(i),r.d(i,"ErrorTypes",function(){return s}),r.d(i,"ErrorDetails",function(){return a});var s;(function(o){o.NETWORK_ERROR="networkError",o.MEDIA_ERROR="mediaError",o.KEY_SYSTEM_ERROR="keySystemError",o.MUX_ERROR="muxError",o.OTHER_ERROR="otherError"})(s||(s={}));var a;(function(o){o.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",o.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",o.KEY_SYSTEM_NO_SESSION="keySystemNoSession",o.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",o.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",o.MANIFEST_LOAD_ERROR="manifestLoadError",o.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",o.MANIFEST_PARSING_ERROR="manifestParsingError",o.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",o.LEVEL_EMPTY_ERROR="levelEmptyError",o.LEVEL_LOAD_ERROR="levelLoadError",o.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",o.LEVEL_SWITCH_ERROR="levelSwitchError",o.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",o.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",o.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",o.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",o.FRAG_LOAD_ERROR="fragLoadError",o.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",o.FRAG_DECRYPT_ERROR="fragDecryptError",o.FRAG_PARSING_ERROR="fragParsingError",o.REMUX_ALLOC_ERROR="remuxAllocError",o.KEY_LOAD_ERROR="keyLoadError",o.KEY_LOAD_TIMEOUT="keyLoadTimeOut",o.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",o.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",o.BUFFER_APPEND_ERROR="bufferAppendError",o.BUFFER_APPENDING_ERROR="bufferAppendingError",o.BUFFER_STALLED_ERROR="bufferStalledError",o.BUFFER_FULL_ERROR="bufferFullError",o.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",o.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",o.INTERNAL_EXCEPTION="internalException",o.INTERNAL_ABORTED="aborted",o.UNKNOWN="unknown"})(a||(a={}))},"./src/events.ts":function(n,i,r){r.r(i),r.d(i,"Events",function(){return s});var s;(function(a){a.MEDIA_ATTACHING="hlsMediaAttaching",a.MEDIA_ATTACHED="hlsMediaAttached",a.MEDIA_DETACHING="hlsMediaDetaching",a.MEDIA_DETACHED="hlsMediaDetached",a.BUFFER_RESET="hlsBufferReset",a.BUFFER_CODECS="hlsBufferCodecs",a.BUFFER_CREATED="hlsBufferCreated",a.BUFFER_APPENDING="hlsBufferAppending",a.BUFFER_APPENDED="hlsBufferAppended",a.BUFFER_EOS="hlsBufferEos",a.BUFFER_FLUSHING="hlsBufferFlushing",a.BUFFER_FLUSHED="hlsBufferFlushed",a.MANIFEST_LOADING="hlsManifestLoading",a.MANIFEST_LOADED="hlsManifestLoaded",a.MANIFEST_PARSED="hlsManifestParsed",a.LEVEL_SWITCHING="hlsLevelSwitching",a.LEVEL_SWITCHED="hlsLevelSwitched",a.LEVEL_LOADING="hlsLevelLoading",a.LEVEL_LOADED="hlsLevelLoaded",a.LEVEL_UPDATED="hlsLevelUpdated",a.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",a.LEVELS_UPDATED="hlsLevelsUpdated",a.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",a.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",a.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",a.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",a.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",a.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",a.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",a.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",a.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",a.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",a.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",a.CUES_PARSED="hlsCuesParsed",a.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",a.INIT_PTS_FOUND="hlsInitPtsFound",a.FRAG_LOADING="hlsFragLoading",a.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",a.FRAG_LOADED="hlsFragLoaded",a.FRAG_DECRYPTED="hlsFragDecrypted",a.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",a.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",a.FRAG_PARSING_METADATA="hlsFragParsingMetadata",a.FRAG_PARSED="hlsFragParsed",a.FRAG_BUFFERED="hlsFragBuffered",a.FRAG_CHANGED="hlsFragChanged",a.FPS_DROP="hlsFpsDrop",a.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",a.ERROR="hlsError",a.DESTROYING="hlsDestroying",a.KEY_LOADING="hlsKeyLoading",a.KEY_LOADED="hlsKeyLoaded",a.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",a.BACK_BUFFER_REACHED="hlsBackBufferReached"})(s||(s={}))},"./src/hls.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return _});var s=r("./node_modules/url-toolkit/src/url-toolkit.js"),a=r("./src/loader/playlist-loader.ts"),o=r("./src/loader/key-loader.ts"),l=r("./src/controller/id3-track-controller.ts"),c=r("./src/controller/latency-controller.ts"),u=r("./src/controller/level-controller.ts"),h=r("./src/controller/fragment-tracker.ts"),d=r("./src/controller/stream-controller.ts"),y=r("./src/is-supported.ts"),x=r("./src/utils/logger.ts"),D=r("./src/config.ts"),S=r("./node_modules/eventemitter3/index.js"),L=r("./src/events.ts"),g=r("./src/errors.ts");function f(C,p){for(var v=0;v<p.length;v++){var m=p[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(C,m.key,m)}}function E(C,p,v){return p&&f(C.prototype,p),v&&f(C,v),Object.defineProperty(C,"prototype",{writable:!1}),C}var _=function(){C.isSupported=function(){return Object(y.isSupported)()};function C(v){v===void 0&&(v={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new S.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var m=this.config=Object(D.mergeConfig)(C.DefaultConfig,v);this.userConfig=v,Object(x.enableLogs)(m.debug),this._autoLevelCapping=-1,m.progressive&&Object(D.enableStreamingMode)(m);var A=m.abrController,b=m.bufferController,T=m.capLevelController,P=m.fpsController,O=this.abrController=new A(this),M=this.bufferController=new b(this),R=this.capLevelController=new T(this),I=new P(this),w=new a.default(this),k=new o.default(this),B=new l.default(this),F=this.levelController=new u.default(this),N=new h.FragmentTracker(this),K=this.streamController=new d.default(this,N);R.setStreamController(K),I.setStreamController(K);var H=[w,k,F,K];this.networkControllers=H;var U=[O,M,R,I,B,N];this.audioTrackController=this.createController(m.audioTrackController,null,H),this.createController(m.audioStreamController,N,H),this.subtitleTrackController=this.createController(m.subtitleTrackController,null,H),this.createController(m.subtitleStreamController,N,H),this.createController(m.timelineController,null,U),this.emeController=this.createController(m.emeController,null,U),this.cmcdController=this.createController(m.cmcdController,null,U),this.latencyController=this.createController(c.default,null,U),this.coreComponents=U}var p=C.prototype;return p.createController=function(m,A,b){if(m){var T=A?new m(this,A):new m(this);return b&&b.push(T),T}return null},p.on=function(m,A,b){b===void 0&&(b=this),this._emitter.on(m,A,b)},p.once=function(m,A,b){b===void 0&&(b=this),this._emitter.once(m,A,b)},p.removeAllListeners=function(m){this._emitter.removeAllListeners(m)},p.off=function(m,A,b,T){b===void 0&&(b=this),this._emitter.off(m,A,b,T)},p.listeners=function(m){return this._emitter.listeners(m)},p.emit=function(m,A,b){return this._emitter.emit(m,A,b)},p.trigger=function(m,A){if(this.config.debug)return this.emit(m,m,A);try{return this.emit(m,m,A)}catch(b){x.logger.error("An internal error happened while handling event "+m+'. Error message: "'+b.message+'". Here is a stacktrace:',b),this.trigger(L.Events.ERROR,{type:g.ErrorTypes.OTHER_ERROR,details:g.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:m,error:b})}return!1},p.listenerCount=function(m){return this._emitter.listenerCount(m)},p.destroy=function(){x.logger.log("destroy"),this.trigger(L.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(m){return m.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(m){return m.destroy()}),this.coreComponents.length=0},p.attachMedia=function(m){x.logger.log("attachMedia"),this._media=m,this.trigger(L.Events.MEDIA_ATTACHING,{media:m})},p.detachMedia=function(){x.logger.log("detachMedia"),this.trigger(L.Events.MEDIA_DETACHING,void 0),this._media=null},p.loadSource=function(m){this.stopLoad();var A=this.media,b=this.url,T=this.url=s.buildAbsoluteURL(self.location.href,m,{alwaysNormalize:!0});x.logger.log("loadSource:"+T),A&&b&&b!==T&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(A)),this.trigger(L.Events.MANIFEST_LOADING,{url:m})},p.startLoad=function(m){m===void 0&&(m=-1),x.logger.log("startLoad("+m+")"),this.networkControllers.forEach(function(A){A.startLoad(m)})},p.stopLoad=function(){x.logger.log("stopLoad"),this.networkControllers.forEach(function(m){m.stopLoad()})},p.swapAudioCodec=function(){x.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},p.recoverMediaError=function(){x.logger.log("recoverMediaError");var m=this._media;this.detachMedia(),m&&this.attachMedia(m)},p.removeLevel=function(m,A){A===void 0&&(A=0),this.levelController.removeLevel(m,A)},E(C,[{key:"levels",get:function(){var m=this.levelController.levels;return m||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(m){x.logger.log("set currentLevel:"+m),this.loadLevel=m,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(m){x.logger.log("set nextLevel:"+m),this.levelController.manualLevel=m,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(m){x.logger.log("set loadLevel:"+m),this.levelController.manualLevel=m}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(m){this.levelController.nextLoadLevel=m}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(m){x.logger.log("set firstLevel:"+m),this.levelController.firstLevel=m}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(m){x.logger.log("set startLevel:"+m),m!==-1&&(m=Math.max(m,this.minAutoLevel)),this.levelController.startLevel=m}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(m){var A=!!m;A!==this.config.capLevelToPlayerSize&&(A?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=A)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(m){this._autoLevelCapping!==m&&(x.logger.log("set autoLevelCapping:"+m),this._autoLevelCapping=m)}},{key:"bandwidthEstimate",get:function(){var m=this.abrController.bwEstimator;return m?m.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var m=this.levels,A=this.config.minAutoBitrate;if(!m)return 0;for(var b=m.length,T=0;T<b;T++)if(m[T].maxBitrate>=A)return T;return 0}},{key:"maxAutoLevel",get:function(){var m=this.levels,A=this.autoLevelCapping,b;return A===-1&&m&&m.length?b=m.length-1:b=A,b}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(m){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,m)}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"audioTracks",get:function(){var m=this.audioTrackController;return m?m.audioTracks:[]}},{key:"audioTrack",get:function(){var m=this.audioTrackController;return m?m.audioTrack:-1},set:function(m){var A=this.audioTrackController;A&&(A.audioTrack=m)}},{key:"subtitleTracks",get:function(){var m=this.subtitleTrackController;return m?m.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var m=this.subtitleTrackController;return m?m.subtitleTrack:-1},set:function(m){var A=this.subtitleTrackController;A&&(A.subtitleTrack=m)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var m=this.subtitleTrackController;return m?m.subtitleDisplay:!1},set:function(m){var A=this.subtitleTrackController;A&&(A.subtitleDisplay=m)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(m){this.config.lowLatencyMode=m}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.2.3"}},{key:"Events",get:function(){return L.Events}},{key:"ErrorTypes",get:function(){return g.ErrorTypes}},{key:"ErrorDetails",get:function(){return g.ErrorDetails}},{key:"DefaultConfig",get:function(){return C.defaultConfig?C.defaultConfig:D.hlsDefaultConfig},set:function(m){C.defaultConfig=m}}]),C}();_.defaultConfig=void 0},"./src/is-supported.ts":function(n,i,r){r.r(i),r.d(i,"isSupported",function(){return o}),r.d(i,"changeTypeSupported",function(){return l});var s=r("./src/utils/mediasource-helper.ts");function a(){return self.SourceBuffer||self.WebKitSourceBuffer}function o(){var c=Object(s.getMediaSource)();if(!c)return!1;var u=a(),h=c&&typeof c.isTypeSupported=="function"&&c.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),d=!u||u.prototype&&typeof u.prototype.appendBuffer=="function"&&typeof u.prototype.remove=="function";return!!h&&!!d}function l(){var c,u=a();return typeof(u==null||(c=u.prototype)===null||c===void 0?void 0:c.changeType)=="function"}},"./src/loader/date-range.ts":function(n,i,r){r.r(i),r.d(i,"DateRangeAttribute",function(){return h}),r.d(i,"DateRange",function(){return d});var s=r("./src/polyfills/number.ts"),a=r("./src/utils/attr-list.ts"),o=r("./src/utils/logger.ts");function l(){return l=Object.assign?Object.assign.bind():function(y){for(var x=1;x<arguments.length;x++){var D=arguments[x];for(var S in D)Object.prototype.hasOwnProperty.call(D,S)&&(y[S]=D[S])}return y},l.apply(this,arguments)}function c(y,x){for(var D=0;D<x.length;D++){var S=x[D];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(y,S.key,S)}}function u(y,x,D){return x&&c(y.prototype,x),D&&c(y,D),Object.defineProperty(y,"prototype",{writable:!1}),y}var h;(function(y){y.ID="ID",y.CLASS="CLASS",y.START_DATE="START-DATE",y.DURATION="DURATION",y.END_DATE="END-DATE",y.END_ON_NEXT="END-ON-NEXT",y.PLANNED_DURATION="PLANNED-DURATION",y.SCTE35_OUT="SCTE35-OUT",y.SCTE35_IN="SCTE35-IN"})(h||(h={}));var d=function(){function y(x,D){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,D){var S=D.attr;for(var L in S)if(Object.prototype.hasOwnProperty.call(x,L)&&x[L]!==S[L]){o.logger.warn('DATERANGE tag attribute: "'+L+'" does not match for tags with ID: "'+x.ID+'"'),this._badValueForSameId=L;break}x=l(new a.AttrList({}),S,x)}if(this.attr=x,this._startDate=new Date(x[h.START_DATE]),h.END_DATE in this.attr){var g=new Date(this.attr[h.END_DATE]);Object(s.isFiniteNumber)(g.getTime())&&(this._endDate=g)}}return u(y,[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var D=this.duration;return D!==null?new Date(this._startDate.getTime()+D*1e3):null}},{key:"duration",get:function(){if(h.DURATION in this.attr){var D=this.attr.decimalFloatingPoint(h.DURATION);if(Object(s.isFiniteNumber)(D))return D}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return h.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(h.PLANNED_DURATION):null}},{key:"endOnNext",get:function(){return this.attr.bool(h.END_ON_NEXT)}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&Object(s.isFiniteNumber)(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}]),y}()},"./src/loader/fragment-loader.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return D}),r.d(i,"LoadError",function(){return L});var s=r("./src/polyfills/number.ts"),a=r("./src/errors.ts");function o(g,f){g.prototype=Object.create(f.prototype),g.prototype.constructor=g,d(g,f)}function l(g){var f=typeof Map=="function"?new Map:void 0;return l=function(_){if(_===null||!h(_))return _;if(typeof _!="function")throw new TypeError("Super expression must either be null or a function");if(typeof f<"u"){if(f.has(_))return f.get(_);f.set(_,C)}function C(){return c(_,arguments,y(this).constructor)}return C.prototype=Object.create(_.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),d(C,_)},l(g)}function c(g,f,E){return u()?c=Reflect.construct.bind():c=function(C,p,v){var m=[null];m.push.apply(m,p);var A=Function.bind.apply(C,m),b=new A;return v&&d(b,v.prototype),b},c.apply(null,arguments)}function u(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function h(g){return Function.toString.call(g).indexOf("[native code]")!==-1}function d(g,f){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(_,C){return _.__proto__=C,_},d(g,f)}function y(g){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(E){return E.__proto__||Object.getPrototypeOf(E)},y(g)}var x=Math.pow(2,17),D=function(){function g(E){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=E}var f=g.prototype;return f.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},f.abort=function(){this.loader&&this.loader.abort()},f.load=function(_,C){var p=this,v=_.url;if(!v)return Promise.reject(new L({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:_,networkDetails:null},"Fragment does not have a "+(v?"part list":"url")));this.abort();var m=this.config,A=m.fLoader,b=m.loader;return new Promise(function(T,P){p.loader&&p.loader.destroy();var O=p.loader=_.loader=A?new A(m):new b(m),M=S(_),R={timeout:m.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:m.fragLoadingMaxRetryTimeout,highWaterMark:_.sn==="initSegment"?1/0:x};_.stats=O.stats,O.load(M,R,{onSuccess:function(w,k,B,F){p.resetLoader(_,O),T({frag:_,part:null,payload:w.data,networkDetails:F})},onError:function(w,k,B){p.resetLoader(_,O),P(new L({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:_,response:w,networkDetails:B}))},onAbort:function(w,k,B){p.resetLoader(_,O),P(new L({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:_,networkDetails:B}))},onTimeout:function(w,k,B){p.resetLoader(_,O),P(new L({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:_,networkDetails:B}))},onProgress:function(w,k,B,F){C&&C({frag:_,part:null,payload:B,networkDetails:F})}})})},f.loadPart=function(_,C,p){var v=this;this.abort();var m=this.config,A=m.fLoader,b=m.loader;return new Promise(function(T,P){v.loader&&v.loader.destroy();var O=v.loader=_.loader=A?new A(m):new b(m),M=S(_,C),R={timeout:m.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:m.fragLoadingMaxRetryTimeout,highWaterMark:x};C.stats=O.stats,O.load(M,R,{onSuccess:function(w,k,B,F){v.resetLoader(_,O),v.updateStatsFromPart(_,C);var N={frag:_,part:C,payload:w.data,networkDetails:F};p(N),T(N)},onError:function(w,k,B){v.resetLoader(_,O),P(new L({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:_,part:C,response:w,networkDetails:B}))},onAbort:function(w,k,B){_.stats.aborted=C.stats.aborted,v.resetLoader(_,O),P(new L({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:_,part:C,networkDetails:B}))},onTimeout:function(w,k,B){v.resetLoader(_,O),P(new L({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:_,part:C,networkDetails:B}))}})})},f.updateStatsFromPart=function(_,C){var p=_.stats,v=C.stats,m=v.total;if(p.loaded+=v.loaded,m){var A=Math.round(_.duration/C.duration),b=Math.min(Math.round(p.loaded/m),A),T=A-b,P=T*Math.round(p.loaded/b);p.total=p.loaded+P}else p.total=Math.max(p.loaded,p.total);var O=p.loading,M=v.loading;O.start?O.first+=M.first-M.start:(O.start=M.start,O.first=M.first),O.end=M.end},f.resetLoader=function(_,C){_.loader=null,this.loader===C&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),C.destroy()},g}();function S(g,f){f===void 0&&(f=null);var E=f||g,_={frag:g,part:f,responseType:"arraybuffer",url:E.url,headers:{},rangeStart:0,rangeEnd:0},C=E.byteRangeStartOffset,p=E.byteRangeEndOffset;return Object(s.isFiniteNumber)(C)&&Object(s.isFiniteNumber)(p)&&(_.rangeStart=C,_.rangeEnd=p),_}var L=function(g){o(f,g);function f(E){for(var _,C=arguments.length,p=new Array(C>1?C-1:0),v=1;v<C;v++)p[v-1]=arguments[v];return _=g.call.apply(g,[this].concat(p))||this,_.data=void 0,_.data=E,_}return f}(l(Error))},"./src/loader/fragment.ts":function(n,i,r){r.r(i),r.d(i,"ElementaryStreamTypes",function(){return x}),r.d(i,"BaseSegment",function(){return D}),r.d(i,"Fragment",function(){return S}),r.d(i,"Part",function(){return L});var s=r("./src/polyfills/number.ts"),a=r("./node_modules/url-toolkit/src/url-toolkit.js"),o=r("./src/utils/logger.ts"),l=r("./src/loader/level-key.ts"),c=r("./src/loader/load-stats.ts");function u(g,f){g.prototype=Object.create(f.prototype),g.prototype.constructor=g,h(g,f)}function h(g,f){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(_,C){return _.__proto__=C,_},h(g,f)}function d(g,f){for(var E=0;E<f.length;E++){var _=f[E];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(g,_.key,_)}}function y(g,f,E){return f&&d(g.prototype,f),E&&d(g,E),Object.defineProperty(g,"prototype",{writable:!1}),g}var x;(function(g){g.AUDIO="audio",g.VIDEO="video",g.AUDIOVIDEO="audiovideo"})(x||(x={}));var D=function(){function g(E){var _;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(_={},_[x.AUDIO]=null,_[x.VIDEO]=null,_[x.AUDIOVIDEO]=null,_),this.baseurl=E}var f=g.prototype;return f.setByteRange=function(_,C){var p=_.split("@",2),v=[];p.length===1?v[0]=C?C.byteRangeEndOffset:0:v[0]=parseInt(p[1]),v[1]=parseInt(p[0])+v[0],this._byteRange=v},y(g,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(a.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(_){this._url=_}}]),g}(),S=function(g){u(f,g);function f(_,C){var p;return p=g.call(this,C)||this,p._decryptdata=null,p.rawProgramDateTime=null,p.programDateTime=null,p.tagList=[],p.duration=0,p.sn=0,p.levelkey=void 0,p.type=void 0,p.loader=null,p.level=-1,p.cc=0,p.startPTS=void 0,p.endPTS=void 0,p.appendedPTS=void 0,p.startDTS=void 0,p.endDTS=void 0,p.start=0,p.deltaPTS=void 0,p.maxStartPTS=void 0,p.minEndPTS=void 0,p.stats=new c.LoadStats,p.urlId=0,p.data=void 0,p.bitrateTest=!1,p.title=null,p.initSegment=null,p.type=_,p}var E=f.prototype;return E.createInitializationVector=function(C){for(var p=new Uint8Array(16),v=12;v<16;v++)p[v]=C>>8*(15-v)&255;return p},E.setDecryptDataFromLevelKey=function(C,p){var v=C;return(C==null?void 0:C.method)==="AES-128"&&C.uri&&!C.iv&&(v=l.LevelKey.fromURI(C.uri),v.method=C.method,v.iv=this.createInitializationVector(p),v.keyFormat="identity"),v},E.setElementaryStreamInfo=function(C,p,v,m,A,b){b===void 0&&(b=!1);var T=this.elementaryStreams,P=T[C];if(!P){T[C]={startPTS:p,endPTS:v,startDTS:m,endDTS:A,partial:b};return}P.startPTS=Math.min(P.startPTS,p),P.endPTS=Math.max(P.endPTS,v),P.startDTS=Math.min(P.startDTS,m),P.endDTS=Math.max(P.endDTS,A)},E.clearElementaryStreamInfo=function(){var C=this.elementaryStreams;C[x.AUDIO]=null,C[x.VIDEO]=null,C[x.AUDIOVIDEO]=null},y(f,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var C=this.sn;typeof C!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&o.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),C=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,C)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(s.isFiniteNumber)(this.programDateTime))return null;var C=Object(s.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+C*1e3}},{key:"encrypted",get:function(){var C;return!!((C=this.decryptdata)!==null&&C!==void 0&&C.keyFormat&&this.decryptdata.uri)}}]),f}(D),L=function(g){u(f,g);function f(E,_,C,p,v){var m;m=g.call(this,C)||this,m.fragOffset=0,m.duration=0,m.gap=!1,m.independent=!1,m.relurl=void 0,m.fragment=void 0,m.index=void 0,m.stats=new c.LoadStats,m.duration=E.decimalFloatingPoint("DURATION"),m.gap=E.bool("GAP"),m.independent=E.bool("INDEPENDENT"),m.relurl=E.enumeratedString("URI"),m.fragment=_,m.index=p;var A=E.enumeratedString("BYTERANGE");return A&&m.setByteRange(A,v),v&&(m.fragOffset=v.fragOffset+v.duration),m}return y(f,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var _=this.elementaryStreams;return!!(_.audio||_.video||_.audiovideo)}}]),f}(D)},"./src/loader/key-loader.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return l});var s=r("./src/events.ts"),a=r("./src/errors.ts"),o=r("./src/utils/logger.ts"),l=function(){function c(h){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=h,this.registerListeners()}var u=c.prototype;return u.startLoad=function(d){},u.stopLoad=function(){this.destroyInternalLoaders()},u.registerListeners=function(){this.hls.on(s.Events.KEY_LOADING,this.onKeyLoading,this)},u.unregisterListeners=function(){this.hls.off(s.Events.KEY_LOADING,this.onKeyLoading)},u.destroyInternalLoaders=function(){for(var d in this.loaders){var y=this.loaders[d];y&&y.destroy()}this.loaders={}},u.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},u.onKeyLoading=function(d,y){var x=y.frag,D=x.type,S=this.loaders[D];if(!x.decryptdata){o.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var L=x.decryptdata.uri;if(L!==this.decrypturl||this.decryptkey===null){var g=this.hls.config;if(S&&(o.logger.warn("abort previous key loader for type:"+D),S.abort()),!L){o.logger.warn("key uri is falsy");return}var f=g.loader,E=x.loader=this.loaders[D]=new f(g);this.decrypturl=L,this.decryptkey=null;var _={url:L,frag:x,responseType:"arraybuffer"},C={timeout:g.fragLoadingTimeOut,maxRetry:0,retryDelay:g.fragLoadingRetryDelay,maxRetryDelay:g.fragLoadingMaxRetryTimeout,highWaterMark:0},p={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};E.load(_,C,p)}else this.decryptkey&&(x.decryptdata.key=this.decryptkey,this.hls.trigger(s.Events.KEY_LOADED,{frag:x}))},u.loadsuccess=function(d,y,x){var D=x.frag;if(!D.decryptdata){o.logger.error("after key load, decryptdata unset");return}this.decryptkey=D.decryptdata.key=new Uint8Array(d.data),D.loader=null,delete this.loaders[D.type],this.hls.trigger(s.Events.KEY_LOADED,{frag:D})},u.loaderror=function(d,y){var x=y.frag,D=x.loader;D&&D.abort(),delete this.loaders[x.type],this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:x,response:d})},u.loadtimeout=function(d,y){var x=y.frag,D=x.loader;D&&D.abort(),delete this.loaders[x.type],this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:x})},c}()},"./src/loader/level-details.ts":function(n,i,r){r.r(i),r.d(i,"LevelDetails",function(){return c});var s=r("./src/polyfills/number.ts");function a(u,h){for(var d=0;d<h.length;d++){var y=h[d];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(u,y.key,y)}}function o(u,h,d){return h&&a(u.prototype,h),d&&a(u,d),Object.defineProperty(u,"prototype",{writable:!1}),u}var l=10,c=function(){function u(d){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.dateRanges={},this.url=d}var h=u.prototype;return h.reloaded=function(y){if(!y){this.advanced=!0,this.updated=!0;return}var x=this.lastPartSn-y.lastPartSn,D=this.lastPartIndex-y.lastPartIndex;this.updated=this.endSN!==y.endSN||!!D||!!x,this.advanced=this.endSN>y.endSN||x>0||x===0&&D>0,this.updated||this.advanced?this.misses=Math.floor(y.misses*.6):this.misses=y.misses+1,this.availabilityDelay=y.availabilityDelay},o(u,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?Object(s.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||l}},{key:"drift",get:function(){var y=this.driftEndTime-this.driftStartTime;if(y>0){var x=this.driftEnd-this.driftStart;return x*1e3/y}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var y;return(y=this.partList)!==null&&y!==void 0&&y.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var y;return(y=this.fragments)!==null&&y!==void 0&&y.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var y;return(y=this.partList)!==null&&y!==void 0&&y.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var y;return(y=this.partList)!==null&&y!==void 0&&y.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),u}()},"./src/loader/level-key.ts":function(n,i,r){r.r(i),r.d(i,"LevelKey",function(){return l});var s=r("./node_modules/url-toolkit/src/url-toolkit.js");function a(c,u){for(var h=0;h<u.length;h++){var d=u[h];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}function o(c,u,h){return u&&a(c.prototype,u),h&&a(c,h),Object.defineProperty(c,"prototype",{writable:!1}),c}var l=function(){c.fromURL=function(h,d){return new c(h,d)},c.fromURI=function(h){return new c(h)};function c(u,h){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,h?this._uri=Object(s.buildAbsoluteURL)(u,h,{alwaysNormalize:!0}):this._uri=u}return o(c,[{key:"uri",get:function(){return this._uri}}]),c}()},"./src/loader/load-stats.ts":function(n,i,r){r.r(i),r.d(i,"LoadStats",function(){return s});var s=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return E});var s=r("./src/polyfills/number.ts"),a=r("./node_modules/url-toolkit/src/url-toolkit.js"),o=r("./src/loader/date-range.ts"),l=r("./src/loader/fragment.ts"),c=r("./src/loader/level-details.ts"),u=r("./src/loader/level-key.ts"),h=r("./src/utils/attr-list.ts"),d=r("./src/utils/logger.ts"),y=r("./src/utils/codecs.ts"),x=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,D=/#EXT-X-MEDIA:(.*)/g,S=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),L=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),g=/\.(mp4|m4s|m4v|m4a)$/i;function f(A){var b,T;return g.test((b=(T=a.parseURL(A))===null||T===void 0?void 0:T.path)!=null?b:"")}var E=function(){function A(){}return A.findGroup=function(T,P){for(var O=0;O<T.length;O++){var M=T[O];if(M.id===P)return M}},A.convertAVC1ToAVCOTI=function(T){var P=T.split(".");if(P.length>2){var O=P.shift()+".";return O+=parseInt(P.shift()).toString(16),O+=("000"+parseInt(P.shift()).toString(16)).slice(-4),O}return T},A.resolve=function(T,P){return a.buildAbsoluteURL(P,T,{alwaysNormalize:!0})},A.parseMasterPlaylist=function(T,P){var O=[],M={},R=!1;x.lastIndex=0;for(var I;(I=x.exec(T))!=null;)if(I[1]){var w=new h.AttrList(I[1]),k={attrs:w,bitrate:w.decimalInteger("AVERAGE-BANDWIDTH")||w.decimalInteger("BANDWIDTH"),name:w.NAME,url:A.resolve(I[2],P)},B=w.decimalResolution("RESOLUTION");B&&(k.width=B.width,k.height=B.height),_((w.CODECS||"").split(/[ ,]+/).filter(function(N){return N}),k),k.videoCodec&&k.videoCodec.indexOf("avc1")!==-1&&(k.videoCodec=A.convertAVC1ToAVCOTI(k.videoCodec)),O.push(k)}else if(I[3]){var F=new h.AttrList(I[3]);F["DATA-ID"]&&(R=!0,M[F["DATA-ID"]]=F)}return{levels:O,sessionData:R?M:null}},A.parseMasterPlaylistMedia=function(T,P,O,M){M===void 0&&(M=[]);var R,I=[],w=0;for(D.lastIndex=0;(R=D.exec(T))!==null;){var k=new h.AttrList(R[1]);if(k.TYPE===O){var B={attrs:k,bitrate:0,id:w++,groupId:k["GROUP-ID"],instreamId:k["INSTREAM-ID"],name:k.NAME||k.LANGUAGE||"",type:O,default:k.bool("DEFAULT"),autoselect:k.bool("AUTOSELECT"),forced:k.bool("FORCED"),lang:k.LANGUAGE,url:k.URI?A.resolve(k.URI,P):""};if(M.length){var F=A.findGroup(M,B.groupId)||M[0];C(B,F,"audioCodec"),C(B,F,"textCodec")}I.push(B)}}return I},A.parseLevelPlaylist=function(T,P,O,M,R){var I=new c.LevelDetails(P),w=I.fragments,k=null,B=0,F=0,N=0,K=0,H=null,U=new l.Fragment(M,P),j,G,X,J=-1,nt=!1;for(S.lastIndex=0,I.m3u8=T;(j=S.exec(T))!==null;){nt&&(nt=!1,U=new l.Fragment(M,P),U.start=N,U.sn=B,U.cc=K,U.level=O,k&&(U.initSegment=k,U.rawProgramDateTime=k.rawProgramDateTime,k.rawProgramDateTime=null));var ot=j[1];if(ot){U.duration=parseFloat(ot);var rt=(" "+j[2]).slice(1);U.title=rt||null,U.tagList.push(rt?["INF",ot,rt]:["INF",ot])}else if(j[3])Object(s.isFiniteNumber)(U.duration)&&(U.start=N,X&&(U.levelkey=X),U.sn=B,U.level=O,U.cc=K,U.urlId=R,w.push(U),U.relurl=(" "+j[3]).slice(1),v(U,H),H=U,N+=U.duration,B++,F=0,nt=!0);else if(j[4]){var W=(" "+j[4]).slice(1);H?U.setByteRange(W,H):U.setByteRange(W)}else if(j[5])U.rawProgramDateTime=(" "+j[5]).slice(1),U.tagList.push(["PROGRAM-DATE-TIME",U.rawProgramDateTime]),J===-1&&(J=w.length);else{if(j=j[0].match(L),!j){d.logger.warn("No matches on slow regex match for level playlist!");continue}for(G=1;G<j.length&&!(typeof j[G]<"u");G++);var V=(" "+j[G]).slice(1),z=(" "+j[G+1]).slice(1),Y=j[G+2]?(" "+j[G+2]).slice(1):"";switch(V){case"PLAYLIST-TYPE":I.type=z.toUpperCase();break;case"MEDIA-SEQUENCE":B=I.startSN=parseInt(z);break;case"SKIP":{var Q=new h.AttrList(z),Z=Q.decimalInteger("SKIPPED-SEGMENTS");if(Object(s.isFiniteNumber)(Z)){I.skippedSegments=Z;for(var st=Z;st--;)w.unshift(null);B+=Z}var tt=Q.enumeratedString("RECENTLY-REMOVED-DATERANGES");tt&&(I.recentlyRemovedDateranges=tt.split("	"));break}case"TARGETDURATION":I.targetduration=parseFloat(z);break;case"VERSION":I.version=parseInt(z);break;case"EXTM3U":break;case"ENDLIST":I.live=!1;break;case"#":(z||Y)&&U.tagList.push(Y?[z,Y]:[z]);break;case"DISCONTINUITY":K++,U.tagList.push(["DIS"]);break;case"GAP":U.tagList.push([V]);break;case"BITRATE":U.tagList.push([V,z]);break;case"DATERANGE":{var et=new h.AttrList(z),q=new o.DateRange(et,I.dateRanges[et.ID]);q.isValid||I.skippedSegments?I.dateRanges[q.id]=q:d.logger.warn('Ignoring invalid DATERANGE tag: "'+z+'"'),U.tagList.push(["EXT-X-DATERANGE",z]);break}case"DISCONTINUITY-SEQUENCE":K=parseInt(z);break;case"KEY":{var ut,ct=new h.AttrList(z),ft=ct.enumeratedString("METHOD"),dt=ct.URI,vt=ct.hexadecimalInteger("IV"),Et=ct.enumeratedString("KEYFORMATVERSIONS"),yt=ct.enumeratedString("KEYID"),Tt=(ut=ct.enumeratedString("KEYFORMAT"))!=null?ut:"identity",Wt=["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"];if(Wt.indexOf(Tt)>-1){d.logger.warn("Keyformat "+Tt+" is not supported from the manifest");continue}else if(Tt!=="identity")continue;ft&&(X=u.LevelKey.fromURL(P,dt),dt&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(ft)>=0&&(X.method=ft,X.keyFormat=Tt,yt&&(X.keyID=yt),Et&&(X.keyFormatVersions=Et),X.iv=vt));break}case"START":{var ee=new h.AttrList(z),Ht=ee.decimalFloatingPoint("TIME-OFFSET");Object(s.isFiniteNumber)(Ht)&&(I.startTimeOffset=Ht);break}case"MAP":{var jt=new h.AttrList(z);if(U.duration){var le=new l.Fragment(M,P);m(le,jt,O,X),k=le,U.initSegment=k,k.rawProgramDateTime&&!U.rawProgramDateTime&&(U.rawProgramDateTime=k.rawProgramDateTime)}else m(U,jt,O,X),k=U,nt=!0;break}case"SERVER-CONTROL":{var St=new h.AttrList(z);I.canBlockReload=St.bool("CAN-BLOCK-RELOAD"),I.canSkipUntil=St.optionalFloat("CAN-SKIP-UNTIL",0),I.canSkipDateRanges=I.canSkipUntil>0&&St.bool("CAN-SKIP-DATERANGES"),I.partHoldBack=St.optionalFloat("PART-HOLD-BACK",0),I.holdBack=St.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var It=new h.AttrList(z);I.partTarget=It.decimalFloatingPoint("PART-TARGET");break}case"PART":{var ne=I.partList;ne||(ne=I.partList=[]);var Je=F>0?ne[ne.length-1]:void 0,In=F++,ri=new l.Part(new h.AttrList(z),U,P,In,Je);ne.push(ri),U.duration+=ri.duration;break}case"PRELOAD-HINT":{var Ne=new h.AttrList(z);I.preloadHint=Ne;break}case"RENDITION-REPORT":{var Ws=new h.AttrList(z);I.renditionReports=I.renditionReports||[],I.renditionReports.push(Ws);break}default:d.logger.warn("line parsed but not handled: "+j);break}}}H&&!H.relurl?(w.pop(),N-=H.duration,I.partList&&(I.fragmentHint=H)):I.partList&&(v(U,H),U.cc=K,I.fragmentHint=U);var wn=w.length,Ze=w[0],si=w[wn-1];if(N+=I.skippedSegments*I.targetduration,N>0&&wn&&si){I.averagetargetduration=N/wn;var kn=si.sn;I.endSN=kn!=="initSegment"?kn:0,Ze&&(I.startCC=Ze.cc,Ze.initSegment||I.fragments.every(function(Sr){return Sr.relurl&&f(Sr.relurl)})&&(d.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),U=new l.Fragment(M,P),U.relurl=si.relurl,U.level=O,U.sn="initSegment",Ze.initSegment=U,I.needSidxRanges=!0))}else I.endSN=0,I.startCC=0;return I.fragmentHint&&(N+=I.fragmentHint.duration),I.totalduration=N,I.endCC=K,J>0&&p(w,J),I},A}();function _(A,b){["video","audio","text"].forEach(function(T){var P=A.filter(function(M){return Object(y.isCodecType)(M,T)});if(P.length){var O=P.filter(function(M){return M.lastIndexOf("avc1",0)===0||M.lastIndexOf("mp4a",0)===0});b[T+"Codec"]=O.length>0?O[0]:P[0],A=A.filter(function(M){return P.indexOf(M)===-1})}}),b.unknownCodecs=A}function C(A,b,T){var P=b[T];P&&(A[T]=P)}function p(A,b){for(var T=A[b],P=b;P--;){var O=A[P];if(!O)return;O.programDateTime=T.programDateTime-O.duration*1e3,T=O}}function v(A,b){A.rawProgramDateTime?A.programDateTime=Date.parse(A.rawProgramDateTime):b!=null&&b.programDateTime&&(A.programDateTime=b.endProgramDateTime),Object(s.isFiniteNumber)(A.programDateTime)||(A.programDateTime=null,A.rawProgramDateTime=null)}function m(A,b,T,P){A.relurl=b.URI,b.BYTERANGE&&A.setByteRange(b.BYTERANGE),A.level=T,A.sn="initSegment",P&&(A.levelkey=P),A.initSegment=null}},"./src/loader/playlist-loader.ts":function(n,i,r){r.r(i);var s=r("./src/polyfills/number.ts"),a=r("./src/events.ts"),o=r("./src/errors.ts"),l=r("./src/utils/logger.ts"),c=r("./src/utils/mp4-tools.ts"),u=r("./src/loader/m3u8-parser.ts"),h=r("./src/types/loader.ts"),d=r("./src/utils/attr-list.ts");function y(S){var L=S.type;switch(L){case h.PlaylistContextType.AUDIO_TRACK:return h.PlaylistLevelType.AUDIO;case h.PlaylistContextType.SUBTITLE_TRACK:return h.PlaylistLevelType.SUBTITLE;default:return h.PlaylistLevelType.MAIN}}function x(S,L){var g=S.url;return(g===void 0||g.indexOf("data:")===0)&&(g=L.url),g}var D=function(){function S(g){this.hls=void 0,this.loaders=Object.create(null),this.hls=g,this.registerListeners()}var L=S.prototype;return L.startLoad=function(f){},L.stopLoad=function(){this.destroyInternalLoaders()},L.registerListeners=function(){var f=this.hls;f.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.on(a.Events.LEVEL_LOADING,this.onLevelLoading,this),f.on(a.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),f.on(a.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},L.unregisterListeners=function(){var f=this.hls;f.off(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.off(a.Events.LEVEL_LOADING,this.onLevelLoading,this),f.off(a.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),f.off(a.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},L.createInternalLoader=function(f){var E=this.hls.config,_=E.pLoader,C=E.loader,p=_||C,v=new p(E);return f.loader=v,this.loaders[f.type]=v,v},L.getInternalLoader=function(f){return this.loaders[f.type]},L.resetInternalLoader=function(f){this.loaders[f]&&delete this.loaders[f]},L.destroyInternalLoaders=function(){for(var f in this.loaders){var E=this.loaders[f];E&&E.destroy(),this.resetInternalLoader(f)}},L.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},L.onManifestLoading=function(f,E){var _=E.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:h.PlaylistContextType.MANIFEST,url:_,deliveryDirectives:null})},L.onLevelLoading=function(f,E){var _=E.id,C=E.level,p=E.url,v=E.deliveryDirectives;this.load({id:_,groupId:null,level:C,responseType:"text",type:h.PlaylistContextType.LEVEL,url:p,deliveryDirectives:v})},L.onAudioTrackLoading=function(f,E){var _=E.id,C=E.groupId,p=E.url,v=E.deliveryDirectives;this.load({id:_,groupId:C,level:null,responseType:"text",type:h.PlaylistContextType.AUDIO_TRACK,url:p,deliveryDirectives:v})},L.onSubtitleTrackLoading=function(f,E){var _=E.id,C=E.groupId,p=E.url,v=E.deliveryDirectives;this.load({id:_,groupId:C,level:null,responseType:"text",type:h.PlaylistContextType.SUBTITLE_TRACK,url:p,deliveryDirectives:v})},L.load=function(f){var E,_=this.hls.config,C=this.getInternalLoader(f);if(C){var p=C.context;if(p&&p.url===f.url){l.logger.trace("[playlist-loader]: playlist request ongoing");return}l.logger.log("[playlist-loader]: aborting previous loader for type: "+f.type),C.abort()}var v,m,A,b;switch(f.type){case h.PlaylistContextType.MANIFEST:v=_.manifestLoadingMaxRetry,m=_.manifestLoadingTimeOut,A=_.manifestLoadingRetryDelay,b=_.manifestLoadingMaxRetryTimeout;break;case h.PlaylistContextType.LEVEL:case h.PlaylistContextType.AUDIO_TRACK:case h.PlaylistContextType.SUBTITLE_TRACK:v=0,m=_.levelLoadingTimeOut;break;default:v=_.levelLoadingMaxRetry,m=_.levelLoadingTimeOut,A=_.levelLoadingRetryDelay,b=_.levelLoadingMaxRetryTimeout;break}if(C=this.createInternalLoader(f),(E=f.deliveryDirectives)!==null&&E!==void 0&&E.part){var T;if(f.type===h.PlaylistContextType.LEVEL&&f.level!==null?T=this.hls.levels[f.level].details:f.type===h.PlaylistContextType.AUDIO_TRACK&&f.id!==null?T=this.hls.audioTracks[f.id].details:f.type===h.PlaylistContextType.SUBTITLE_TRACK&&f.id!==null&&(T=this.hls.subtitleTracks[f.id].details),T){var P=T.partTarget,O=T.targetduration;P&&O&&(m=Math.min(Math.max(P*3,O*.8)*1e3,m))}}var M={timeout:m,maxRetry:v,retryDelay:A,maxRetryDelay:b,highWaterMark:0},R={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};C.load(f,M,R)},L.loadsuccess=function(f,E,_,C){if(C===void 0&&(C=null),_.isSidxRequest){this.handleSidxRequest(f,_),this.handlePlaylistLoaded(f,E,_,C);return}this.resetInternalLoader(_.type);var p=f.data;if(p.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(f,_,"no EXTM3U delimiter",C);return}E.parsing.start=performance.now(),p.indexOf("#EXTINF:")>0||p.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(f,E,_,C):this.handleMasterPlaylist(f,E,_,C)},L.loaderror=function(f,E,_){_===void 0&&(_=null),this.handleNetworkError(E,_,!1,f)},L.loadtimeout=function(f,E,_){_===void 0&&(_=null),this.handleNetworkError(E,_,!0)},L.handleMasterPlaylist=function(f,E,_,C){var p=this.hls,v=f.data,m=x(f,_),A=u.default.parseMasterPlaylist(v,m),b=A.levels,T=A.sessionData;if(!b.length){this.handleManifestParsingError(f,_,"no level found in manifest",C);return}var P=b.map(function(k){return{id:k.attrs.AUDIO,audioCodec:k.audioCodec}}),O=b.map(function(k){return{id:k.attrs.SUBTITLES,textCodec:k.textCodec}}),M=u.default.parseMasterPlaylistMedia(v,m,"AUDIO",P),R=u.default.parseMasterPlaylistMedia(v,m,"SUBTITLES",O),I=u.default.parseMasterPlaylistMedia(v,m,"CLOSED-CAPTIONS");if(M.length){var w=M.some(function(k){return!k.url});!w&&b[0].audioCodec&&!b[0].attrs.AUDIO&&(l.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),M.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new d.AttrList({}),bitrate:0,url:""}))}p.trigger(a.Events.MANIFEST_LOADED,{levels:b,audioTracks:M,subtitles:R,captions:I,url:m,stats:E,networkDetails:C,sessionData:T})},L.handleTrackOrLevelPlaylist=function(f,E,_,C){var p=this.hls,v=_.id,m=_.level,A=_.type,b=x(f,_),T=Object(s.isFiniteNumber)(v)?v:0,P=Object(s.isFiniteNumber)(m)?m:T,O=y(_),M=u.default.parseLevelPlaylist(f.data,b,P,O,T);if(!M.fragments.length){p.trigger(a.Events.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:b,reason:"no fragments found in level",level:typeof _.level=="number"?_.level:void 0});return}if(A===h.PlaylistContextType.MANIFEST){var R={attrs:new d.AttrList({}),bitrate:0,details:M,name:"",url:b};p.trigger(a.Events.MANIFEST_LOADED,{levels:[R],audioTracks:[],url:b,stats:E,networkDetails:C,sessionData:null})}if(E.parsing.end=performance.now(),M.needSidxRanges){var I,w=(I=M.fragments[0].initSegment)===null||I===void 0?void 0:I.url;this.load({url:w,isSidxRequest:!0,type:A,level:m,levelDetails:M,id:v,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null});return}_.levelDetails=M,this.handlePlaylistLoaded(f,E,_,C)},L.handleSidxRequest=function(f,E){var _=new Uint8Array(f.data),C=Object(c.findBox)(_,["sidx"])[0];if(!!C){var p=Object(c.parseSegmentIndex)(C);if(!!p){var v=p.references,m=E.levelDetails;v.forEach(function(A,b){var T=A.info,P=m.fragments[b];if(P.byteRange.length===0&&P.setByteRange(String(1+T.end-T.start)+"@"+String(T.start)),P.initSegment){var O=Object(c.findBox)(_,["moov"])[0],M=O?O.length:null;P.initSegment.setByteRange(String(M)+"@0")}})}}},L.handleManifestParsingError=function(f,E,_,C){this.hls.trigger(a.Events.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:E.type===h.PlaylistContextType.MANIFEST,url:f.url,reason:_,response:f,context:E,networkDetails:C})},L.handleNetworkError=function(f,E,_,C){_===void 0&&(_=!1),l.logger.warn("[playlist-loader]: A network "+(_?"timeout":"error")+" occurred while loading "+f.type+" level: "+f.level+" id: "+f.id+' group-id: "'+f.groupId+'"');var p=o.ErrorDetails.UNKNOWN,v=!1,m=this.getInternalLoader(f);switch(f.type){case h.PlaylistContextType.MANIFEST:p=_?o.ErrorDetails.MANIFEST_LOAD_TIMEOUT:o.ErrorDetails.MANIFEST_LOAD_ERROR,v=!0;break;case h.PlaylistContextType.LEVEL:p=_?o.ErrorDetails.LEVEL_LOAD_TIMEOUT:o.ErrorDetails.LEVEL_LOAD_ERROR,v=!1;break;case h.PlaylistContextType.AUDIO_TRACK:p=_?o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,v=!1;break;case h.PlaylistContextType.SUBTITLE_TRACK:p=_?o.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:o.ErrorDetails.SUBTITLE_LOAD_ERROR,v=!1;break}m&&this.resetInternalLoader(f.type);var A={type:o.ErrorTypes.NETWORK_ERROR,details:p,fatal:v,url:f.url,loader:m,context:f,networkDetails:E};C&&(A.response=C),this.hls.trigger(a.Events.ERROR,A)},L.handlePlaylistLoaded=function(f,E,_,C){var p=_.type,v=_.level,m=_.id,A=_.groupId,b=_.loader,T=_.levelDetails,P=_.deliveryDirectives;if(!(T!=null&&T.targetduration)){this.handleManifestParsingError(f,_,"invalid target duration",C);return}if(!!b)switch(T.live&&(b.getCacheAge&&(T.ageHeader=b.getCacheAge()||0),(!b.getCacheAge||isNaN(T.ageHeader))&&(T.ageHeader=0)),p){case h.PlaylistContextType.MANIFEST:case h.PlaylistContextType.LEVEL:this.hls.trigger(a.Events.LEVEL_LOADED,{details:T,level:v||0,id:m||0,stats:E,networkDetails:C,deliveryDirectives:P});break;case h.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(a.Events.AUDIO_TRACK_LOADED,{details:T,id:m||0,groupId:A||"",stats:E,networkDetails:C,deliveryDirectives:P});break;case h.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(a.Events.SUBTITLE_TRACK_LOADED,{details:T,id:m||0,groupId:A||"",stats:E,networkDetails:C,deliveryDirectives:P});break}},S}();i.default=D},"./src/polyfills/number.ts":function(n,i,r){r.r(i),r.d(i,"isFiniteNumber",function(){return s}),r.d(i,"MAX_SAFE_INTEGER",function(){return a});var s=Number.isFinite||function(o){return typeof o=="number"&&isFinite(o)},a=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(n,i,r){r.r(i);var s=function(){function a(){}return a.getSilentFrame=function(l,c){switch(l){case"mp4a.40.2":if(c===1)return new Uint8Array([0,200,0,128,35,128]);if(c===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(c===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(c===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(c===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(c===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(c===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(c===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(c===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},a}();i.default=s},"./src/remux/mp4-generator.ts":function(n,i,r){r.r(i);var s=Math.pow(2,32)-1,a=function(){function o(){}return o.init=function(){o.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var c;for(c in o.types)o.types.hasOwnProperty(c)&&(o.types[c]=[c.charCodeAt(0),c.charCodeAt(1),c.charCodeAt(2),c.charCodeAt(3)]);var u=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),h=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);o.HDLR_TYPES={video:u,audio:h};var d=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),y=new Uint8Array([0,0,0,0,0,0,0,0]);o.STTS=o.STSC=o.STCO=y,o.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),o.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),o.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),o.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var x=new Uint8Array([105,115,111,109]),D=new Uint8Array([97,118,99,49]),S=new Uint8Array([0,0,0,1]);o.FTYP=o.box(o.types.ftyp,x,S,x,D),o.DINF=o.box(o.types.dinf,o.box(o.types.dref,d))},o.box=function(c){for(var u=8,h=arguments.length,d=new Array(h>1?h-1:0),y=1;y<h;y++)d[y-1]=arguments[y];for(var x=d.length,D=x;x--;)u+=d[x].byteLength;var S=new Uint8Array(u);for(S[0]=u>>24&255,S[1]=u>>16&255,S[2]=u>>8&255,S[3]=u&255,S.set(c,4),x=0,u=8;x<D;x++)S.set(d[x],u),u+=d[x].byteLength;return S},o.hdlr=function(c){return o.box(o.types.hdlr,o.HDLR_TYPES[c])},o.mdat=function(c){return o.box(o.types.mdat,c)},o.mdhd=function(c,u){u*=c;var h=Math.floor(u/(s+1)),d=Math.floor(u%(s+1));return o.box(o.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,c>>24&255,c>>16&255,c>>8&255,c&255,h>>24,h>>16&255,h>>8&255,h&255,d>>24,d>>16&255,d>>8&255,d&255,85,196,0,0]))},o.mdia=function(c){return o.box(o.types.mdia,o.mdhd(c.timescale,c.duration),o.hdlr(c.type),o.minf(c))},o.mfhd=function(c){return o.box(o.types.mfhd,new Uint8Array([0,0,0,0,c>>24,c>>16&255,c>>8&255,c&255]))},o.minf=function(c){return c.type==="audio"?o.box(o.types.minf,o.box(o.types.smhd,o.SMHD),o.DINF,o.stbl(c)):o.box(o.types.minf,o.box(o.types.vmhd,o.VMHD),o.DINF,o.stbl(c))},o.moof=function(c,u,h){return o.box(o.types.moof,o.mfhd(c),o.traf(h,u))},o.moov=function(c){for(var u=c.length,h=[];u--;)h[u]=o.trak(c[u]);return o.box.apply(null,[o.types.moov,o.mvhd(c[0].timescale,c[0].duration)].concat(h).concat(o.mvex(c)))},o.mvex=function(c){for(var u=c.length,h=[];u--;)h[u]=o.trex(c[u]);return o.box.apply(null,[o.types.mvex].concat(h))},o.mvhd=function(c,u){u*=c;var h=Math.floor(u/(s+1)),d=Math.floor(u%(s+1)),y=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,c>>24&255,c>>16&255,c>>8&255,c&255,h>>24,h>>16&255,h>>8&255,h&255,d>>24,d>>16&255,d>>8&255,d&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return o.box(o.types.mvhd,y)},o.sdtp=function(c){var u=c.samples||[],h=new Uint8Array(4+u.length),d,y;for(d=0;d<u.length;d++)y=u[d].flags,h[d+4]=y.dependsOn<<4|y.isDependedOn<<2|y.hasRedundancy;return o.box(o.types.sdtp,h)},o.stbl=function(c){return o.box(o.types.stbl,o.stsd(c),o.box(o.types.stts,o.STTS),o.box(o.types.stsc,o.STSC),o.box(o.types.stsz,o.STSZ),o.box(o.types.stco,o.STCO))},o.avc1=function(c){var u=[],h=[],d,y,x;for(d=0;d<c.sps.length;d++)y=c.sps[d],x=y.byteLength,u.push(x>>>8&255),u.push(x&255),u=u.concat(Array.prototype.slice.call(y));for(d=0;d<c.pps.length;d++)y=c.pps[d],x=y.byteLength,h.push(x>>>8&255),h.push(x&255),h=h.concat(Array.prototype.slice.call(y));var D=o.box(o.types.avcC,new Uint8Array([1,u[3],u[4],u[5],255,224|c.sps.length].concat(u).concat([c.pps.length]).concat(h))),S=c.width,L=c.height,g=c.pixelRatio[0],f=c.pixelRatio[1];return o.box(o.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,S>>8&255,S&255,L>>8&255,L&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),D,o.box(o.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),o.box(o.types.pasp,new Uint8Array([g>>24,g>>16&255,g>>8&255,g&255,f>>24,f>>16&255,f>>8&255,f&255])))},o.esds=function(c){var u=c.config.length;return new Uint8Array([0,0,0,0,3,23+u,0,1,0,4,15+u,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([u]).concat(c.config).concat([6,1,2]))},o.mp4a=function(c){var u=c.samplerate;return o.box(o.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,c.channelCount,0,16,0,0,0,0,u>>8&255,u&255,0,0]),o.box(o.types.esds,o.esds(c)))},o.mp3=function(c){var u=c.samplerate;return o.box(o.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,c.channelCount,0,16,0,0,0,0,u>>8&255,u&255,0,0]))},o.stsd=function(c){return c.type==="audio"?c.segmentCodec==="mp3"&&c.codec==="mp3"?o.box(o.types.stsd,o.STSD,o.mp3(c)):o.box(o.types.stsd,o.STSD,o.mp4a(c)):o.box(o.types.stsd,o.STSD,o.avc1(c))},o.tkhd=function(c){var u=c.id,h=c.duration*c.timescale,d=c.width,y=c.height,x=Math.floor(h/(s+1)),D=Math.floor(h%(s+1));return o.box(o.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,u>>24&255,u>>16&255,u>>8&255,u&255,0,0,0,0,x>>24,x>>16&255,x>>8&255,x&255,D>>24,D>>16&255,D>>8&255,D&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,d>>8&255,d&255,0,0,y>>8&255,y&255,0,0]))},o.traf=function(c,u){var h=o.sdtp(c),d=c.id,y=Math.floor(u/(s+1)),x=Math.floor(u%(s+1));return o.box(o.types.traf,o.box(o.types.tfhd,new Uint8Array([0,0,0,0,d>>24,d>>16&255,d>>8&255,d&255])),o.box(o.types.tfdt,new Uint8Array([1,0,0,0,y>>24,y>>16&255,y>>8&255,y&255,x>>24,x>>16&255,x>>8&255,x&255])),o.trun(c,h.length+16+20+8+16+8+8),h)},o.trak=function(c){return c.duration=c.duration||4294967295,o.box(o.types.trak,o.tkhd(c),o.mdia(c))},o.trex=function(c){var u=c.id;return o.box(o.types.trex,new Uint8Array([0,0,0,0,u>>24,u>>16&255,u>>8&255,u&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},o.trun=function(c,u){var h=c.samples||[],d=h.length,y=12+16*d,x=new Uint8Array(y),D,S,L,g,f,E;for(u+=8+y,x.set([c.type==="video"?1:0,0,15,1,d>>>24&255,d>>>16&255,d>>>8&255,d&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255],0),D=0;D<d;D++)S=h[D],L=S.duration,g=S.size,f=S.flags,E=S.cts,x.set([L>>>24&255,L>>>16&255,L>>>8&255,L&255,g>>>24&255,g>>>16&255,g>>>8&255,g&255,f.isLeading<<2|f.dependsOn,f.isDependedOn<<6|f.hasRedundancy<<4|f.paddingValue<<1|f.isNonSync,f.degradPrio&240<<8,f.degradPrio&15,E>>>24&255,E>>>16&255,E>>>8&255,E&255],12+16*D);return o.box(o.types.trun,x)},o.initSegment=function(c){o.types||o.init();var u=o.moov(c),h=new Uint8Array(o.FTYP.byteLength+u.byteLength);return h.set(o.FTYP),h.set(u,o.FTYP.byteLength),h},o}();a.types=void 0,a.HDLR_TYPES=void 0,a.STTS=void 0,a.STSC=void 0,a.STCO=void 0,a.STSZ=void 0,a.VMHD=void 0,a.SMHD=void 0,a.STSD=void 0,a.FTYP=void 0,a.DINF=void 0,i.default=a},"./src/remux/mp4-remuxer.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return f}),r.d(i,"normalizePts",function(){return E}),r.d(i,"flushTextTrackMetadataCueSamples",function(){return C}),r.d(i,"flushTextTrackUserdataCueSamples",function(){return p});var s=r("./src/polyfills/number.ts"),a=r("./src/remux/aac-helper.ts"),o=r("./src/remux/mp4-generator.ts"),l=r("./src/events.ts"),c=r("./src/errors.ts"),u=r("./src/utils/logger.ts"),h=r("./src/types/loader.ts"),d=r("./src/utils/timescale-conversion.ts");function y(){return y=Object.assign?Object.assign.bind():function(A){for(var b=1;b<arguments.length;b++){var T=arguments[b];for(var P in T)Object.prototype.hasOwnProperty.call(T,P)&&(A[P]=T[P])}return A},y.apply(this,arguments)}var x=10*1e3,D=1024,S=1152,L=null,g=null,f=function(){function A(T,P,O,M){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=T,this.config=P,this.typeSupported=O,this.ISGenerated=!1,L===null){var R=navigator.userAgent||"",I=R.match(/Chrome\/(\d+)/i);L=I?parseInt(I[1]):0}if(g===null){var w=navigator.userAgent.match(/Safari\/(\d+)/i);g=w?parseInt(w[1]):0}}var b=A.prototype;return b.destroy=function(){},b.resetTimeStamp=function(P){u.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=P},b.resetNextTimestamp=function(){u.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},b.resetInitSegment=function(){u.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},b.getVideoStartPts=function(P){var O=!1,M=P.reduce(function(R,I){var w=I.pts-R;return w<-4294967296?(O=!0,E(R,I.pts)):w>0?R:I.pts},P[0].pts);return O&&u.logger.debug("PTS rollover detected"),M},b.remux=function(P,O,M,R,I,w,k,B){var F,N,K,H,U,j,G=I,X=I,J=P.pid>-1,nt=O.pid>-1,ot=O.samples.length,rt=P.samples.length>0,W=k&&ot>0||ot>1,V=(!J||rt)&&(!nt||W)||this.ISGenerated||k;if(V){this.ISGenerated||(K=this.generateIS(P,O,I));var z=this.isVideoContiguous,Y=-1,Q;if(W&&(Y=_(O.samples),!z&&this.config.forceKeyFrameOnDiscontinuity))if(j=!0,Y>0){u.logger.warn("[mp4-remuxer]: Dropped "+Y+" out of "+ot+" video samples due to a missing keyframe");var Z=this.getVideoStartPts(O.samples);O.samples=O.samples.slice(Y),O.dropped+=Y,X+=(O.samples[0].pts-Z)/O.inputTimeScale,Q=X}else Y===-1&&(u.logger.warn("[mp4-remuxer]: No keyframe found out of "+ot+" video samples"),j=!1);if(this.ISGenerated){if(rt&&W){var st=this.getVideoStartPts(O.samples),tt=E(P.samples[0].pts,st)-st,et=tt/O.inputTimeScale;G+=Math.max(0,et),X+=Math.max(0,-et)}if(rt){if(P.samplerate||(u.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),K=this.generateIS(P,O,I)),N=this.remuxAudio(P,G,this.isAudioContiguous,w,nt||W||B===h.PlaylistLevelType.AUDIO?X:void 0),W){var q=N?N.endPTS-N.startPTS:0;O.inputTimeScale||(u.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),K=this.generateIS(P,O,I)),F=this.remuxVideo(O,X,z,q)}}else W&&(F=this.remuxVideo(O,X,z,0));F&&(F.firstKeyFrame=Y,F.independent=Y!==-1,F.firstKeyFramePTS=Q)}}return this.ISGenerated&&(M.samples.length&&(U=C(M,I,this._initPTS,this._initDTS)),R.samples.length&&(H=p(R,I,this._initPTS))),{audio:N,video:F,initSegment:K,independent:j,text:H,id3:U}},b.generateIS=function(P,O,M){var R=P.samples,I=O.samples,w=this.typeSupported,k={},B=!Object(s.isFiniteNumber)(this._initPTS),F="audio/mp4",N,K,H;if(B&&(N=K=1/0),P.config&&R.length){switch(P.timescale=P.samplerate,P.segmentCodec){case"mp3":w.mpeg?(F="audio/mpeg",P.codec=""):w.mp3&&(P.codec="mp3");break}k.audio={id:"audio",container:F,codec:P.codec,initSegment:P.segmentCodec==="mp3"&&w.mpeg?new Uint8Array(0):o.default.initSegment([P]),metadata:{channelCount:P.channelCount}},B&&(H=P.inputTimeScale,N=K=R[0].pts-Math.round(H*M))}if(O.sps&&O.pps&&I.length&&(O.timescale=O.inputTimeScale,k.video={id:"main",container:"video/mp4",codec:O.codec,initSegment:o.default.initSegment([O]),metadata:{width:O.width,height:O.height}},B)){H=O.inputTimeScale;var U=this.getVideoStartPts(I),j=Math.round(H*M);K=Math.min(K,E(I[0].dts,U)-j),N=Math.min(N,U-j)}if(Object.keys(k).length)return this.ISGenerated=!0,B&&(this._initPTS=N,this._initDTS=K),{tracks:k,initPTS:N,timescale:H}},b.remuxVideo=function(P,O,M,R){var I=P.inputTimeScale,w=P.samples,k=[],B=w.length,F=this._initPTS,N=this.nextAvcDts,K=8,H=this.videoSampleDuration,U,j,G=Number.POSITIVE_INFINITY,X=Number.NEGATIVE_INFINITY,J=!1;if(!M||N===null){var nt=O*I,ot=w[0].pts-E(w[0].dts,w[0].pts);N=nt-ot}for(var rt=0;rt<B;rt++){var W=w[rt];W.pts=E(W.pts-F,N),W.dts=E(W.dts-F,N),W.dts<w[rt>0?rt-1:rt].dts&&(J=!0)}J&&w.sort(function(js,Uo){var Ud=js.dts-Uo.dts,Wd=js.pts-Uo.pts;return Ud||Wd}),U=w[0].dts,j=w[w.length-1].dts;var V=j-U,z=V?Math.round(V/(B-1)):H||P.inputTimeScale/30;if(M){var Y=U-N,Q=Y>z,Z=Y<-1;if(Q||Z){Q?u.logger.warn("AVC: "+Object(d.toMsFromMpegTsClock)(Y,!0)+" ms ("+Y+"dts) hole between fragments detected, filling it"):u.logger.warn("AVC: "+Object(d.toMsFromMpegTsClock)(-Y,!0)+" ms ("+Y+"dts) overlapping between fragments detected"),U=N;var st=w[0].pts-Y;w[0].dts=U,w[0].pts=st,u.logger.log("Video: First PTS/DTS adjusted: "+Object(d.toMsFromMpegTsClock)(st,!0)+"/"+Object(d.toMsFromMpegTsClock)(U,!0)+", delta: "+Object(d.toMsFromMpegTsClock)(Y,!0)+" ms")}}U=Math.max(0,U);for(var tt=0,et=0,q=0;q<B;q++){for(var ut=w[q],ct=ut.units,ft=ct.length,dt=0,vt=0;vt<ft;vt++)dt+=ct[vt].data.length;et+=dt,tt+=ft,ut.length=dt,ut.dts=Math.max(ut.dts,U),G=Math.min(ut.pts,G),X=Math.max(ut.pts,X)}j=w[B-1].dts;var Et=et+4*tt+8,yt;try{yt=new Uint8Array(Et)}catch{this.observer.emit(l.Events.ERROR,l.Events.ERROR,{type:c.ErrorTypes.MUX_ERROR,details:c.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Et,reason:"fail allocating video mdat "+Et});return}var Tt=new DataView(yt.buffer);Tt.setUint32(0,Et),yt.set(o.default.types.mdat,4);for(var Wt=!1,ee=Number.POSITIVE_INFINITY,Ht=Number.POSITIVE_INFINITY,jt=Number.NEGATIVE_INFINITY,le=Number.NEGATIVE_INFINITY,St=0;St<B;St++){for(var It=w[St],ne=It.units,Je=0,In=0,ri=ne.length;In<ri;In++){var Ne=ne[In],Ws=Ne.data,wn=Ne.data.byteLength;Tt.setUint32(K,wn),K+=4,yt.set(Ws,K),K+=wn,Je+=4+wn}var Ze=void 0;if(St<B-1)H=w[St+1].dts-It.dts,Ze=w[St+1].pts-It.pts;else{var si=this.config,kn=St>0?It.dts-w[St-1].dts:z;if(Ze=St>0?It.pts-w[St-1].pts:z,si.stretchShortVideoTrack&&this.nextAudioPts!==null){var Sr=Math.floor(si.maxBufferHole*I),Ks=(R?G+R*I:this.nextAudioPts)-It.pts;Ks>Sr?(H=Ks-kn,H<0?H=kn:Wt=!0,u.logger.log("[mp4-remuxer]: It is approximately "+Ks/90+" ms to the next segment; using duration "+H/90+" ms for the last video frame.")):H=kn}else H=kn}var Id=Math.round(It.pts-It.dts);ee=Math.min(ee,H),jt=Math.max(jt,H),Ht=Math.min(Ht,Ze),le=Math.max(le,Ze),k.push(new v(It.key,H,Je,Id))}if(k.length){if(L){if(L<70){var Fo=k[0].flags;Fo.dependsOn=2,Fo.isNonSync=0}}else if(g&&le-Ht<jt-ee&&z/jt<.025&&k[0].cts===0){u.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var Hs=U,Se=0,Bo=k.length;Se<Bo;Se++){var No=Hs+k[Se].duration,wd=Hs+k[Se].cts;if(Se<Bo-1){var kd=No+k[Se+1].cts;k[Se].duration=kd-wd}else k[Se].duration=Se?k[Se-1].duration:z;k[Se].cts=0,Hs=No}}}console.assert(H!==null,"mp4SampleDuration must be computed"),H=Wt||!H?z:H,this.nextAvcDts=N=j+H,this.videoSampleDuration=H,this.isVideoContiguous=!0;var Fd=o.default.moof(P.sequenceNumber++,U,y({},P,{samples:k})),Bd="video",Nd={data1:Fd,data2:yt,startPTS:G/I,endPTS:(X+H)/I,startDTS:U/I,endDTS:N/I,type:Bd,hasAudio:!1,hasVideo:!0,nb:k.length,dropped:P.dropped};return P.samples=[],P.dropped=0,console.assert(yt.length,"MDAT length must not be zero"),Nd},b.remuxAudio=function(P,O,M,R,I){var w=P.inputTimeScale,k=P.samplerate?P.samplerate:w,B=w/k,F=P.segmentCodec==="aac"?D:S,N=F*B,K=this._initPTS,H=P.segmentCodec==="mp3"&&this.typeSupported.mpeg,U=[],j=I!==void 0,G=P.samples,X=H?0:8,J=this.nextAudioPts||-1,nt=O*w;if(this.isAudioContiguous=M=M||G.length&&J>0&&(R&&Math.abs(nt-J)<9e3||Math.abs(E(G[0].pts-K,nt)-J)<20*N),G.forEach(function(Ne){Ne.pts=E(Ne.pts-K,nt)}),!M||J<0){if(G=G.filter(function(Ne){return Ne.pts>=0}),!G.length)return;I===0?J=0:R&&!j?J=Math.max(0,nt):J=G[0].pts}if(P.segmentCodec==="aac")for(var ot=this.config.maxAudioFramesDrift,rt=0,W=J;rt<G.length;rt++){var V=G[rt],z=V.pts,Y=z-W,Q=Math.abs(1e3*Y/w);if(Y<=-ot*N&&j)rt===0&&(u.logger.warn("Audio frame @ "+(z/w).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*Y/w)+" ms."),this.nextAudioPts=J=W=z);else if(Y>=ot*N&&Q<x&&j){var Z=Math.round(Y/N);W=z-Z*N,W<0&&(Z--,W+=N),rt===0&&(this.nextAudioPts=J=W),u.logger.warn("[mp4-remuxer]: Injecting "+Z+" audio frame @ "+(W/w).toFixed(3)+"s due to "+Math.round(1e3*Y/w)+" ms gap.");for(var st=0;st<Z;st++){var tt=Math.max(W,0),et=a.default.getSilentFrame(P.manifestCodec||P.codec,P.channelCount);et||(u.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),et=V.unit.subarray()),G.splice(rt,0,{unit:et,pts:tt}),W+=N,rt++}}V.pts=W,W+=N}for(var q=null,ut=null,ct,ft=0,dt=G.length;dt--;)ft+=G[dt].unit.byteLength;for(var vt=0,Et=G.length;vt<Et;vt++){var yt=G[vt],Tt=yt.unit,Wt=yt.pts;if(ut!==null){var ee=U[vt-1];ee.duration=Math.round((Wt-ut)/B)}else if(M&&P.segmentCodec==="aac"&&(Wt=J),q=Wt,ft>0){ft+=X;try{ct=new Uint8Array(ft)}catch{this.observer.emit(l.Events.ERROR,l.Events.ERROR,{type:c.ErrorTypes.MUX_ERROR,details:c.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:ft,reason:"fail allocating audio mdat "+ft});return}if(!H){var Ht=new DataView(ct.buffer);Ht.setUint32(0,ft),ct.set(o.default.types.mdat,4)}}else return;ct.set(Tt,X);var jt=Tt.byteLength;X+=jt,U.push(new v(!0,F,jt,0)),ut=Wt}var le=U.length;if(!!le){var St=U[U.length-1];this.nextAudioPts=J=ut+B*St.duration;var It=H?new Uint8Array(0):o.default.moof(P.sequenceNumber++,q/B,y({},P,{samples:U}));P.samples=[];var ne=q/w,Je=J/w,In="audio",ri={data1:It,data2:ct,startPTS:ne,endPTS:Je,startDTS:ne,endDTS:Je,type:In,hasAudio:!0,hasVideo:!1,nb:le};return this.isAudioContiguous=!0,console.assert(ct.length,"MDAT length must not be zero"),ri}},b.remuxEmptyAudio=function(P,O,M,R){var I=P.inputTimeScale,w=P.samplerate?P.samplerate:I,k=I/w,B=this.nextAudioPts,F=(B!==null?B:R.startDTS*I)+this._initDTS,N=R.endDTS*I+this._initDTS,K=k*D,H=Math.ceil((N-F)/K),U=a.default.getSilentFrame(P.manifestCodec||P.codec,P.channelCount);if(u.logger.warn("[mp4-remuxer]: remux empty Audio"),!U){u.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var j=[],G=0;G<H;G++){var X=F+G*K;j.push({unit:U,pts:X,dts:X})}return P.samples=j,this.remuxAudio(P,O,M,!1)},A}();function E(A,b){var T;if(b===null)return A;for(b<A?T=-8589934592:T=8589934592;Math.abs(A-b)>4294967296;)A+=T;return A}function _(A){for(var b=0;b<A.length;b++)if(A[b].key)return b;return-1}function C(A,b,T,P){var O=A.samples.length;if(!!O){for(var M=A.inputTimeScale,R=0;R<O;R++){var I=A.samples[R];I.pts=E(I.pts-T,b*M)/M,I.dts=E(I.dts-P,b*M)/M}var w=A.samples;return A.samples=[],{samples:w}}}function p(A,b,T){var P=A.samples.length;if(!!P){for(var O=A.inputTimeScale,M=0;M<P;M++){var R=A.samples[M];R.pts=E(R.pts-T,b*O)/O}A.samples.sort(function(w,k){return w.pts-k.pts});var I=A.samples;return A.samples=[],{samples:I}}}var v=function(b,T,P,O){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=T,this.size=P,this.cts=O,this.flags=new m(b)},m=function(b){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=b?2:1,this.isNonSync=b?0:1}},"./src/remux/passthrough-remuxer.ts":function(n,i,r){r.r(i);var s=r("./src/polyfills/number.ts"),a=r("./src/remux/mp4-remuxer.ts"),o=r("./src/utils/mp4-tools.ts"),l=r("./src/loader/fragment.ts"),c=r("./src/utils/logger.ts"),u=function(){function d(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndTime=null}var y=d.prototype;return y.destroy=function(){},y.resetTimeStamp=function(D){this.initPTS=D,this.lastEndTime=null},y.resetNextTimestamp=function(){this.lastEndTime=null},y.resetInitSegment=function(D,S,L){this.audioCodec=S,this.videoCodec=L,this.generateInitSegment(D),this.emitInitSegment=!0},y.generateInitSegment=function(D){var S=this.audioCodec,L=this.videoCodec;if(!D||!D.byteLength){this.initTracks=void 0,this.initData=void 0;return}var g=this.initData=Object(o.parseInitSegment)(D);S||(S=h(g.audio,l.ElementaryStreamTypes.AUDIO)),L||(L=h(g.video,l.ElementaryStreamTypes.VIDEO));var f={};g.audio&&g.video?f.audiovideo={container:"video/mp4",codec:S+","+L,initSegment:D,id:"main"}:g.audio?f.audio={container:"audio/mp4",codec:S,initSegment:D,id:"audio"}:g.video?f.video={container:"video/mp4",codec:L,initSegment:D,id:"main"}:c.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=f},y.remux=function(D,S,L,g,f){var E,_=this.initPTS,C=this.lastEndTime,p={audio:void 0,video:void 0,text:g,id3:L,initSegment:void 0};Object(s.isFiniteNumber)(C)||(C=this.lastEndTime=f||0);var v=S.samples;if(!v||!v.length)return p;var m={initPTS:void 0,timescale:1},A=this.initData;if((!A||!A.length)&&(this.generateInitSegment(v),A=this.initData),!A||!A.length)return c.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),p;this.emitInitSegment&&(m.tracks=this.initTracks,this.emitInitSegment=!1);var b=Object(o.getStartDTS)(A,v);Object(s.isFiniteNumber)(_)||(this.initPTS=m.initPTS=_=b-f);var T=Object(o.getDuration)(v,A),P=D?b-_:C,O=P+T;Object(o.offsetStartDTS)(A,v,_),T>0?this.lastEndTime=O:(c.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var M=!!A.audio,R=!!A.video,I="";M&&(I+="audio"),R&&(I+="video");var w={data1:v,startPTS:P,startDTS:P,endPTS:O,endDTS:O,type:I,hasAudio:M,hasVideo:R,nb:1,dropped:0};p.audio=w.type==="audio"?w:void 0,p.video=w.type!=="audio"?w:void 0,p.initSegment=m;var k=(E=this.initPTS)!=null?E:0;return p.id3=Object(a.flushTextTrackMetadataCueSamples)(L,f,k,k),g.samples.length&&(p.text=Object(a.flushTextTrackUserdataCueSamples)(g,f,k)),p},d}();function h(d,y){var x=d==null?void 0:d.codec;return x&&x.length>4?x:x==="hvc1"||x==="hev1"?"hvc1.1.c.L120.90":x==="av01"?"av01.0.04M.08":x==="avc1"||y===l.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}i.default=u},"./src/task-loop.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return s});var s=function(){function a(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var o=a.prototype;return o.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},o.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},o.onHandlerDestroyed=function(){},o.hasInterval=function(){return!!this._tickInterval},o.hasNextTick=function(){return!!this._tickTimer},o.setInterval=function(c){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,c),!0)},o.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},o.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},o.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},o.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},o.doTick=function(){},a}()},"./src/types/cmcd.ts":function(n,i,r){r.r(i),r.d(i,"CMCDVersion",function(){return s}),r.d(i,"CMCDObjectType",function(){return a}),r.d(i,"CMCDStreamingFormat",function(){return o}),r.d(i,"CMCDStreamType",function(){return l});var s=1,a;(function(c){c.MANIFEST="m",c.AUDIO="a",c.VIDEO="v",c.MUXED="av",c.INIT="i",c.CAPTION="c",c.TIMED_TEXT="tt",c.KEY="k",c.OTHER="o"})(a||(a={}));var o;(function(c){c.DASH="d",c.HLS="h",c.SMOOTH="s",c.OTHER="o"})(o||(o={}));var l;(function(c){c.VOD="v",c.LIVE="l"})(l||(l={}))},"./src/types/demuxer.ts":function(n,i,r){r.r(i),r.d(i,"MetadataSchema",function(){return s});var s;(function(a){a.audioId3="org.id3",a.dateRange="com.apple.quicktime.HLS",a.emsg="https://aomedia.org/emsg/ID3"})(s||(s={}))},"./src/types/level.ts":function(n,i,r){r.r(i),r.d(i,"HlsSkip",function(){return o}),r.d(i,"getSkipValue",function(){return l}),r.d(i,"HlsUrlParameters",function(){return c}),r.d(i,"Level",function(){return u});function s(h,d){for(var y=0;y<d.length;y++){var x=d[y];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(h,x.key,x)}}function a(h,d,y){return d&&s(h.prototype,d),y&&s(h,y),Object.defineProperty(h,"prototype",{writable:!1}),h}var o;(function(h){h.No="",h.Yes="YES",h.v2="v2"})(o||(o={}));function l(h,d){var y=h.canSkipUntil,x=h.canSkipDateRanges,D=h.endSN,S=d!==void 0?d-D:0;return y&&S<y?x?o.v2:o.Yes:o.No}var c=function(){function h(y,x,D){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=y,this.part=x,this.skip=D}var d=h.prototype;return d.addDirectives=function(x){var D=new self.URL(x);return this.msn!==void 0&&D.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&D.searchParams.set("_HLS_part",this.part.toString()),this.skip&&D.searchParams.set("_HLS_skip",this.skip),D.toString()},h}(),u=function(){function h(d){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[d.url],this.attrs=d.attrs,this.bitrate=d.bitrate,d.details&&(this.details=d.details),this.id=d.id||0,this.name=d.name,this.width=d.width||0,this.height=d.height||0,this.audioCodec=d.audioCodec,this.videoCodec=d.videoCodec,this.unknownCodecs=d.unknownCodecs,this.codecSet=[d.videoCodec,d.audioCodec].filter(function(y){return y}).join(",").replace(/\.[^.,]+/g,"")}return a(h,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(y){var x=y%this.url.length;this._urlId!==x&&(this.details=void 0,this._urlId=x)}}]),h}()},"./src/types/loader.ts":function(n,i,r){r.r(i),r.d(i,"PlaylistContextType",function(){return s}),r.d(i,"PlaylistLevelType",function(){return a});var s;(function(o){o.MANIFEST="manifest",o.LEVEL="level",o.AUDIO_TRACK="audioTrack",o.SUBTITLE_TRACK="subtitleTrack"})(s||(s={}));var a;(function(o){o.MAIN="main",o.AUDIO="audio",o.SUBTITLE="subtitle"})(a||(a={}))},"./src/types/transmuxer.ts":function(n,i,r){r.r(i),r.d(i,"ChunkMetadata",function(){return s});var s=function(l,c,u,h,d,y){h===void 0&&(h=0),d===void 0&&(d=-1),y===void 0&&(y=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=a(),this.buffering={audio:a(),video:a(),audiovideo:a()},this.level=l,this.sn=c,this.id=u,this.size=h,this.part=d,this.partial=y};function a(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":function(n,i,r){r.r(i),r.d(i,"AttrList",function(){return o});var s=/^(\d+)x(\d+)$/,a=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,o=function(){function l(u){typeof u=="string"&&(u=l.parseAttrList(u));for(var h in u)u.hasOwnProperty(h)&&(this[h]=u[h])}var c=l.prototype;return c.decimalInteger=function(h){var d=parseInt(this[h],10);return d>Number.MAX_SAFE_INTEGER?1/0:d},c.hexadecimalInteger=function(h){if(this[h]){var d=(this[h]||"0x").slice(2);d=(d.length&1?"0":"")+d;for(var y=new Uint8Array(d.length/2),x=0;x<d.length/2;x++)y[x]=parseInt(d.slice(x*2,x*2+2),16);return y}else return null},c.hexadecimalIntegerAsNumber=function(h){var d=parseInt(this[h],16);return d>Number.MAX_SAFE_INTEGER?1/0:d},c.decimalFloatingPoint=function(h){return parseFloat(this[h])},c.optionalFloat=function(h,d){var y=this[h];return y?parseFloat(y):d},c.enumeratedString=function(h){return this[h]},c.bool=function(h){return this[h]==="YES"},c.decimalResolution=function(h){var d=s.exec(this[h]);if(d!==null)return{width:parseInt(d[1],10),height:parseInt(d[2],10)}},l.parseAttrList=function(h){var d,y={},x='"';for(a.lastIndex=0;(d=a.exec(h))!==null;){var D=d[2];D.indexOf(x)===0&&D.lastIndexOf(x)===D.length-1&&(D=D.slice(1,-1)),y[d[1]]=D}return y},l}()},"./src/utils/binary-search.ts":function(n,i,r){r.r(i);var s={search:function(o,l){for(var c=0,u=o.length-1,h=null,d=null;c<=u;){h=(c+u)/2|0,d=o[h];var y=l(d);if(y>0)c=h+1;else if(y<0)u=h-1;else return d}return null}};i.default=s},"./src/utils/buffer-helper.ts":function(n,i,r){r.r(i),r.d(i,"BufferHelper",function(){return o});var s=r("./src/utils/logger.ts"),a={length:0,start:function(){return 0},end:function(){return 0}},o=function(){function l(){}return l.isBuffered=function(u,h){try{if(u){for(var d=l.getBuffered(u),y=0;y<d.length;y++)if(h>=d.start(y)&&h<=d.end(y))return!0}}catch{}return!1},l.bufferInfo=function(u,h,d){try{if(u){var y=l.getBuffered(u),x=[],D;for(D=0;D<y.length;D++)x.push({start:y.start(D),end:y.end(D)});return this.bufferedInfo(x,h,d)}}catch{}return{len:0,start:h,end:h,nextStart:void 0}},l.bufferedInfo=function(u,h,d){h=Math.max(0,h),u.sort(function(v,m){var A=v.start-m.start;return A||m.end-v.end});var y=[];if(d)for(var x=0;x<u.length;x++){var D=y.length;if(D){var S=y[D-1].end;u[x].start-S<d?u[x].end>S&&(y[D-1].end=u[x].end):y.push(u[x])}else y.push(u[x])}else y=u;for(var L=0,g,f=h,E=h,_=0;_<y.length;_++){var C=y[_].start,p=y[_].end;if(h+d>=C&&h<p)f=C,E=p,L=E-h;else if(h+d<C){g=C;break}}return{len:L,start:f||0,end:E||0,nextStart:g}},l.getBuffered=function(u){try{return u.buffered}catch(h){return s.logger.log("failed to get media.buffered",h),a}},l}()},"./src/utils/cea-608-parser.ts":function(n,i,r){r.r(i),r.d(i,"Row",function(){return E}),r.d(i,"CaptionScreen",function(){return _});var s=r("./src/utils/logger.ts"),a={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},o=function(T){var P=T;return a.hasOwnProperty(T)&&(P=a[T]),String.fromCharCode(P)},l=15,c=100,u={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},h={17:2,18:4,21:6,22:8,23:10,19:13,20:15},d={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},y={25:2,26:4,29:6,30:8,31:10,27:13,28:15},x=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],D;(function(b){b[b.ERROR=0]="ERROR",b[b.TEXT=1]="TEXT",b[b.WARNING=2]="WARNING",b[b.INFO=2]="INFO",b[b.DEBUG=3]="DEBUG",b[b.DATA=3]="DATA"})(D||(D={}));var S=function(){function b(){this.time=null,this.verboseLevel=D.ERROR}var T=b.prototype;return T.log=function(O,M){this.verboseLevel>=O&&s.logger.log(this.time+" ["+O+"] "+M)},b}(),L=function(T){for(var P=[],O=0;O<T.length;O++)P.push(T[O].toString(16));return P},g=function(){function b(P,O,M,R,I){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=P||"white",this.underline=O||!1,this.italics=M||!1,this.background=R||"black",this.flash=I||!1}var T=b.prototype;return T.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},T.setStyles=function(O){for(var M=["foreground","underline","italics","background","flash"],R=0;R<M.length;R++){var I=M[R];O.hasOwnProperty(I)&&(this[I]=O[I])}},T.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},T.equals=function(O){return this.foreground===O.foreground&&this.underline===O.underline&&this.italics===O.italics&&this.background===O.background&&this.flash===O.flash},T.copy=function(O){this.foreground=O.foreground,this.underline=O.underline,this.italics=O.italics,this.background=O.background,this.flash=O.flash},T.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},b}(),f=function(){function b(P,O,M,R,I,w){this.uchar=void 0,this.penState=void 0,this.uchar=P||" ",this.penState=new g(O,M,R,I,w)}var T=b.prototype;return T.reset=function(){this.uchar=" ",this.penState.reset()},T.setChar=function(O,M){this.uchar=O,this.penState.copy(M)},T.setPenState=function(O){this.penState.copy(O)},T.equals=function(O){return this.uchar===O.uchar&&this.penState.equals(O.penState)},T.copy=function(O){this.uchar=O.uchar,this.penState.copy(O.penState)},T.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},b}(),E=function(){function b(P){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var O=0;O<c;O++)this.chars.push(new f);this.logger=P,this.pos=0,this.currPenState=new g}var T=b.prototype;return T.equals=function(O){for(var M=!0,R=0;R<c;R++)if(!this.chars[R].equals(O.chars[R])){M=!1;break}return M},T.copy=function(O){for(var M=0;M<c;M++)this.chars[M].copy(O.chars[M])},T.isEmpty=function(){for(var O=!0,M=0;M<c;M++)if(!this.chars[M].isEmpty()){O=!1;break}return O},T.setCursor=function(O){this.pos!==O&&(this.pos=O),this.pos<0?(this.logger.log(D.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>c&&(this.logger.log(D.DEBUG,"Too large cursor position "+this.pos),this.pos=c)},T.moveCursor=function(O){var M=this.pos+O;if(O>1)for(var R=this.pos+1;R<M+1;R++)this.chars[R].setPenState(this.currPenState);this.setCursor(M)},T.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},T.insertChar=function(O){O>=144&&this.backSpace();var M=o(O);if(this.pos>=c){this.logger.log(D.ERROR,"Cannot insert "+O.toString(16)+" ("+M+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(M,this.currPenState),this.moveCursor(1)},T.clearFromPos=function(O){var M;for(M=O;M<c;M++)this.chars[M].reset()},T.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},T.clearToEndOfRow=function(){this.clearFromPos(this.pos)},T.getTextString=function(){for(var O=[],M=!0,R=0;R<c;R++){var I=this.chars[R].uchar;I!==" "&&(M=!1),O.push(I)}return M?"":O.join("")},T.setPenStyles=function(O){this.currPenState.setStyles(O);var M=this.chars[this.pos];M.setPenState(this.currPenState)},b}(),_=function(){function b(P){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var O=0;O<l;O++)this.rows.push(new E(P));this.logger=P,this.currRow=l-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var T=b.prototype;return T.reset=function(){for(var O=0;O<l;O++)this.rows[O].clear();this.currRow=l-1},T.equals=function(O){for(var M=!0,R=0;R<l;R++)if(!this.rows[R].equals(O.rows[R])){M=!1;break}return M},T.copy=function(O){for(var M=0;M<l;M++)this.rows[M].copy(O.rows[M])},T.isEmpty=function(){for(var O=!0,M=0;M<l;M++)if(!this.rows[M].isEmpty()){O=!1;break}return O},T.backSpace=function(){var O=this.rows[this.currRow];O.backSpace()},T.clearToEndOfRow=function(){var O=this.rows[this.currRow];O.clearToEndOfRow()},T.insertChar=function(O){var M=this.rows[this.currRow];M.insertChar(O)},T.setPen=function(O){var M=this.rows[this.currRow];M.setPenStyles(O)},T.moveCursor=function(O){var M=this.rows[this.currRow];M.moveCursor(O)},T.setCursor=function(O){this.logger.log(D.INFO,"setCursor: "+O);var M=this.rows[this.currRow];M.setCursor(O)},T.setPAC=function(O){this.logger.log(D.INFO,"pacData = "+JSON.stringify(O));var M=O.row-1;if(this.nrRollUpRows&&M<this.nrRollUpRows-1&&(M=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==M){for(var R=0;R<l;R++)this.rows[R].clear();var I=this.currRow+1-this.nrRollUpRows,w=this.lastOutputScreen;if(w){var k=w.rows[I].cueStartTime,B=this.logger.time;if(k&&B!==null&&k<B)for(var F=0;F<this.nrRollUpRows;F++)this.rows[M-this.nrRollUpRows+F+1].copy(w.rows[I+F])}}this.currRow=M;var N=this.rows[this.currRow];if(O.indent!==null){var K=O.indent,H=Math.max(K-1,0);N.setCursor(O.indent),O.color=N.chars[H].penState.foreground}var U={foreground:O.color,underline:O.underline,italics:O.italics,background:"black",flash:!1};this.setPen(U)},T.setBkgData=function(O){this.logger.log(D.INFO,"bkgData = "+JSON.stringify(O)),this.backSpace(),this.setPen(O),this.insertChar(32)},T.setRollUpRows=function(O){this.nrRollUpRows=O},T.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(D.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(D.TEXT,this.getDisplayText());var O=this.currRow+1-this.nrRollUpRows,M=this.rows.splice(O,1)[0];M.clear(),this.rows.splice(this.currRow,0,M),this.logger.log(D.INFO,"Rolling up")},T.getDisplayText=function(O){O=O||!1;for(var M=[],R="",I=-1,w=0;w<l;w++){var k=this.rows[w].getTextString();k&&(I=w+1,O?M.push("Row "+I+": '"+k+"'"):M.push(k.trim()))}return M.length>0&&(O?R="["+M.join(" | ")+"]":R=M.join(`
`)),R},T.getTextAndFormat=function(){return this.rows},b}(),C=function(){function b(P,O,M){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=P,this.outputFilter=O,this.mode=null,this.verbose=0,this.displayedMemory=new _(M),this.nonDisplayedMemory=new _(M),this.lastOutputScreen=new _(M),this.currRollUpRow=this.displayedMemory.rows[l-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=M}var T=b.prototype;return T.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[l-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},T.getHandler=function(){return this.outputFilter},T.setHandler=function(O){this.outputFilter=O},T.setPAC=function(O){this.writeScreen.setPAC(O)},T.setBkgData=function(O){this.writeScreen.setBkgData(O)},T.setMode=function(O){O!==this.mode&&(this.mode=O,this.logger.log(D.INFO,"MODE="+O),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=O)},T.insertChars=function(O){for(var M=0;M<O.length;M++)this.writeScreen.insertChar(O[M]);var R=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(D.INFO,R+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(D.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},T.ccRCL=function(){this.logger.log(D.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},T.ccBS=function(){this.logger.log(D.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},T.ccAOF=function(){},T.ccAON=function(){},T.ccDER=function(){this.logger.log(D.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},T.ccRU=function(O){this.logger.log(D.INFO,"RU("+O+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(O)},T.ccFON=function(){this.logger.log(D.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},T.ccRDC=function(){this.logger.log(D.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},T.ccTR=function(){this.logger.log(D.INFO,"TR"),this.setMode("MODE_TEXT")},T.ccRTD=function(){this.logger.log(D.INFO,"RTD"),this.setMode("MODE_TEXT")},T.ccEDM=function(){this.logger.log(D.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},T.ccCR=function(){this.logger.log(D.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},T.ccENM=function(){this.logger.log(D.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},T.ccEOC=function(){if(this.logger.log(D.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var O=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=O,this.writeScreen=this.nonDisplayedMemory,this.logger.log(D.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},T.ccTO=function(O){this.logger.log(D.INFO,"TO("+O+") - Tab Offset"),this.writeScreen.moveCursor(O)},T.ccMIDROW=function(O){var M={flash:!1};if(M.underline=O%2===1,M.italics=O>=46,M.italics)M.foreground="white";else{var R=Math.floor(O/2)-16,I=["white","green","blue","cyan","red","yellow","magenta"];M.foreground=I[R]}this.logger.log(D.INFO,"MIDROW: "+JSON.stringify(M)),this.writeScreen.setPen(M)},T.outputDataUpdate=function(O){O===void 0&&(O=!1);var M=this.logger.time;M!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=M:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,M,this.lastOutputScreen),O&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:M),this.lastOutputScreen.copy(this.displayedMemory))},T.cueSplitAtTime=function(O){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,O,this.displayedMemory),this.cueStartTime=O))},b}(),p=function(){function b(P,O,M){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var R=new S;this.channels=[null,new C(P,O,R),new C(P+1,M,R)],this.cmdHistory=A(),this.logger=R}var T=b.prototype;return T.getHandler=function(O){return this.channels[O].getHandler()},T.setHandler=function(O,M){this.channels[O].setHandler(M)},T.addData=function(O,M){var R,I,w,k=!1;this.logger.time=O;for(var B=0;B<M.length;B+=2)if(I=M[B]&127,w=M[B+1]&127,!(I===0&&w===0)){if(this.logger.log(D.DATA,"["+L([M[B],M[B+1]])+"] -> ("+L([I,w])+")"),R=this.parseCmd(I,w),R||(R=this.parseMidrow(I,w)),R||(R=this.parsePAC(I,w)),R||(R=this.parseBackgroundAttributes(I,w)),!R&&(k=this.parseChars(I,w),k)){var F=this.currentChannel;if(F&&F>0){var N=this.channels[F];N.insertChars(k)}else this.logger.log(D.WARNING,"No channel found yet. TEXT-MODE?")}!R&&!k&&this.logger.log(D.WARNING,"Couldn't parse cleaned data "+L([I,w])+" orig: "+L([M[B],M[B+1]]))}},T.parseCmd=function(O,M){var R=this.cmdHistory,I=(O===20||O===28||O===21||O===29)&&M>=32&&M<=47,w=(O===23||O===31)&&M>=33&&M<=35;if(!(I||w))return!1;if(m(O,M,R))return v(null,null,R),this.logger.log(D.DEBUG,"Repeated command ("+L([O,M])+") is dropped"),!0;var k=O===20||O===21||O===23?1:2,B=this.channels[k];return O===20||O===21||O===28||O===29?M===32?B.ccRCL():M===33?B.ccBS():M===34?B.ccAOF():M===35?B.ccAON():M===36?B.ccDER():M===37?B.ccRU(2):M===38?B.ccRU(3):M===39?B.ccRU(4):M===40?B.ccFON():M===41?B.ccRDC():M===42?B.ccTR():M===43?B.ccRTD():M===44?B.ccEDM():M===45?B.ccCR():M===46?B.ccENM():M===47&&B.ccEOC():B.ccTO(M-32),v(O,M,R),this.currentChannel=k,!0},T.parseMidrow=function(O,M){var R=0;if((O===17||O===25)&&M>=32&&M<=47){if(O===17?R=1:R=2,R!==this.currentChannel)return this.logger.log(D.ERROR,"Mismatch channel in midrow parsing"),!1;var I=this.channels[R];return I?(I.ccMIDROW(M),this.logger.log(D.DEBUG,"MIDROW ("+L([O,M])+")"),!0):!1}return!1},T.parsePAC=function(O,M){var R,I=this.cmdHistory,w=(O>=17&&O<=23||O>=25&&O<=31)&&M>=64&&M<=127,k=(O===16||O===24)&&M>=64&&M<=95;if(!(w||k))return!1;if(m(O,M,I))return v(null,null,I),!0;var B=O<=23?1:2;M>=64&&M<=95?R=B===1?u[O]:d[O]:R=B===1?h[O]:y[O];var F=this.channels[B];return F?(F.setPAC(this.interpretPAC(R,M)),v(O,M,I),this.currentChannel=B,!0):!1},T.interpretPAC=function(O,M){var R,I={color:null,italics:!1,indent:null,underline:!1,row:O};return M>95?R=M-96:R=M-64,I.underline=(R&1)===1,R<=13?I.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(R/2)]:R<=15?(I.italics=!0,I.color="white"):I.indent=Math.floor((R-16)/2)*4,I},T.parseChars=function(O,M){var R,I=null,w=null;if(O>=25?(R=2,w=O-8):(R=1,w=O),w>=17&&w<=19){var k;w===17?k=M+80:w===18?k=M+112:k=M+144,this.logger.log(D.INFO,"Special char '"+o(k)+"' in channel "+R),I=[k]}else O>=32&&O<=127&&(I=M===0?[O]:[O,M]);if(I){var B=L(I);this.logger.log(D.DEBUG,"Char codes =  "+B.join(",")),v(O,M,this.cmdHistory)}return I},T.parseBackgroundAttributes=function(O,M){var R=(O===16||O===24)&&M>=32&&M<=47,I=(O===23||O===31)&&M>=45&&M<=47;if(!(R||I))return!1;var w,k={};O===16||O===24?(w=Math.floor((M-32)/2),k.background=x[w],M%2===1&&(k.background=k.background+"_semi")):M===45?k.background="transparent":(k.foreground="black",M===47&&(k.underline=!0));var B=O<=23?1:2,F=this.channels[B];return F.setBkgData(k),v(O,M,this.cmdHistory),!0},T.reset=function(){for(var O=0;O<Object.keys(this.channels).length;O++){var M=this.channels[O];M&&M.reset()}this.cmdHistory=A()},T.cueSplitAtTime=function(O){for(var M=0;M<this.channels.length;M++){var R=this.channels[M];R&&R.cueSplitAtTime(O)}},b}();function v(b,T,P){P.a=b,P.b=T}function m(b,T,P){return P.a===b&&P.b===T}function A(){return{a:null,b:null}}i.default=p},"./src/utils/codecs.ts":function(n,i,r){r.r(i),r.d(i,"isCodecType",function(){return a}),r.d(i,"isCodecSupportedInMp4",function(){return o});var s={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function a(l,c){var u=s[c];return!!u&&u[l.slice(0,4)]===!0}function o(l,c){return MediaSource.isTypeSupported((c||"video")+'/mp4;codecs="'+l+'"')}},"./src/utils/cues.ts":function(n,i,r){r.r(i);var s=r("./src/utils/vttparser.ts"),a=r("./src/utils/webvtt-parser.ts"),o=r("./src/utils/texttrack-utils.ts"),l=/\s/,c={newCue:function(h,d,y,x){for(var D=[],S,L,g,f,E,_=self.VTTCue||self.TextTrackCue,C=0;C<x.rows.length;C++)if(S=x.rows[C],g=!0,f=0,E="",!S.isEmpty()){for(var p=0;p<S.chars.length;p++)l.test(S.chars[p].uchar)&&g?f++:(E+=S.chars[p].uchar,g=!1);S.cueStartTime=d,d===y&&(y+=1e-4),f>=16?f--:f++;var v=Object(s.fixLineBreaks)(E.trim()),m=Object(a.generateCueId)(d,y,v);(!h||!h.cues||!h.cues.getCueById(m))&&(L=new _(d,y,v),L.id=m,L.line=C+1,L.align="left",L.position=10+Math.min(80,Math.floor(f*8/32)*10),D.push(L))}return h&&D.length&&(D.sort(function(A,b){return A.line==="auto"||b.line==="auto"?0:A.line>8&&b.line>8?b.line-A.line:A.line-b.line}),D.forEach(function(A){return Object(o.addCueToTrack)(h,A)})),D}};i.default=c},"./src/utils/discontinuities.ts":function(n,i,r){r.r(i),r.d(i,"findFirstFragWithCC",function(){return l}),r.d(i,"shouldAlignOnDiscontinuities",function(){return c}),r.d(i,"findDiscontinuousReferenceFrag",function(){return u}),r.d(i,"adjustSlidingStart",function(){return d}),r.d(i,"alignStream",function(){return y}),r.d(i,"alignPDT",function(){return D}),r.d(i,"alignFragmentByPDTDelta",function(){return S}),r.d(i,"alignMediaPlaylistByPDT",function(){return L});var s=r("./src/polyfills/number.ts"),a=r("./src/utils/logger.ts"),o=r("./src/controller/level-helper.ts");function l(g,f){for(var E=null,_=0,C=g.length;_<C;_++){var p=g[_];if(p&&p.cc===f){E=p;break}}return E}function c(g,f,E){return!!(f.details&&(E.endCC>E.startCC||g&&g.cc<E.startCC))}function u(g,f){var E=g.fragments,_=f.fragments;if(!_.length||!E.length){a.logger.log("No fragments to align");return}var C=l(E,_[0].cc);if(!C||C&&!C.startPTS){a.logger.log("No frag in previous level to align on");return}return C}function h(g,f){if(g){var E=g.start+f;g.start=g.startPTS=E,g.endPTS=E+g.duration}}function d(g,f){for(var E=f.fragments,_=0,C=E.length;_<C;_++)h(E[_],g);f.fragmentHint&&h(f.fragmentHint,g),f.alignedSliding=!0}function y(g,f,E){!f||(x(g,E,f),!E.alignedSliding&&f.details&&D(E,f.details),!E.alignedSliding&&f.details&&!E.skippedSegments&&Object(o.adjustSliding)(f.details,E))}function x(g,f,E){if(c(g,E,f)){var _=u(E.details,f);_&&Object(s.isFiniteNumber)(_.start)&&(a.logger.log("Adjusting PTS using last level due to CC increase within current level "+f.url),d(_.start,f))}}function D(g,f){if(!(!f.fragments.length||!g.hasProgramDateTime||!f.hasProgramDateTime)){var E=f.fragments[0].programDateTime,_=g.fragments[0].programDateTime,C=(_-E)/1e3+f.fragments[0].start;C&&Object(s.isFiniteNumber)(C)&&(a.logger.log("Adjusting PTS using programDateTime delta "+(_-E)+"ms, sliding:"+C.toFixed(3)+" "+g.url+" "),d(C,g))}}function S(g,f){var E=g.programDateTime;if(!!E){var _=(E-f)/1e3;g.start=g.startPTS=_,g.endPTS=_+g.duration}}function L(g,f){if(!(!f.fragments.length||!g.hasProgramDateTime||!f.hasProgramDateTime)){var E=f.fragments[0].programDateTime,_=f.fragments[0].start,C=E-_*1e3;g.fragments.forEach(function(p){S(p,C)}),g.fragmentHint&&S(g.fragmentHint,C),g.alignedSliding=!0}}},"./src/utils/ewma-bandwidth-estimator.ts":function(n,i,r){r.r(i);var s=r("./src/utils/ewma.ts"),a=function(){function o(c,u,h){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=h,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new s.default(c),this.fast_=new s.default(u)}var l=o.prototype;return l.update=function(u,h){var d=this.slow_,y=this.fast_;this.slow_.halfLife!==u&&(this.slow_=new s.default(u,d.getEstimate(),d.getTotalWeight())),this.fast_.halfLife!==h&&(this.fast_=new s.default(h,y.getEstimate(),y.getTotalWeight()))},l.sample=function(u,h){u=Math.max(u,this.minDelayMs_);var d=8*h,y=u/1e3,x=d/y;this.fast_.sample(y,x),this.slow_.sample(y,x)},l.canEstimate=function(){var u=this.fast_;return u&&u.getTotalWeight()>=this.minWeight_},l.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},l.destroy=function(){},o}();i.default=a},"./src/utils/ewma.ts":function(n,i,r){r.r(i);var s=function(){function a(l,c,u){c===void 0&&(c=0),u===void 0&&(u=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=l,this.alpha_=l?Math.exp(Math.log(.5)/l):0,this.estimate_=c,this.totalWeight_=u}var o=a.prototype;return o.sample=function(c,u){var h=Math.pow(this.alpha_,c);this.estimate_=u*(1-h)+h*this.estimate_,this.totalWeight_+=c},o.getTotalWeight=function(){return this.totalWeight_},o.getEstimate=function(){if(this.alpha_){var c=1-Math.pow(this.alpha_,this.totalWeight_);if(c)return this.estimate_/c}return this.estimate_},a}();i.default=s},"./src/utils/fetch-loader.ts":function(n,i,r){r.r(i),r.d(i,"fetchSupported",function(){return S});var s=r("./src/polyfills/number.ts"),a=r("./src/loader/load-stats.ts"),o=r("./src/demux/chunk-cache.ts");function l(_,C){_.prototype=Object.create(C.prototype),_.prototype.constructor=_,y(_,C)}function c(_){var C=typeof Map=="function"?new Map:void 0;return c=function(v){if(v===null||!d(v))return v;if(typeof v!="function")throw new TypeError("Super expression must either be null or a function");if(typeof C<"u"){if(C.has(v))return C.get(v);C.set(v,m)}function m(){return u(v,arguments,x(this).constructor)}return m.prototype=Object.create(v.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),y(m,v)},c(_)}function u(_,C,p){return h()?u=Reflect.construct.bind():u=function(m,A,b){var T=[null];T.push.apply(T,A);var P=Function.bind.apply(m,T),O=new P;return b&&y(O,b.prototype),O},u.apply(null,arguments)}function h(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function d(_){return Function.toString.call(_).indexOf("[native code]")!==-1}function y(_,C){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(v,m){return v.__proto__=m,v},y(_,C)}function x(_){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(p){return p.__proto__||Object.getPrototypeOf(p)},x(_)}function D(){return D=Object.assign?Object.assign.bind():function(_){for(var C=1;C<arguments.length;C++){var p=arguments[C];for(var v in p)Object.prototype.hasOwnProperty.call(p,v)&&(_[v]=p[v])}return _},D.apply(this,arguments)}function S(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var L=function(){function _(p){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=p.fetchSetup||f,this.controller=new self.AbortController,this.stats=new a.LoadStats}var C=_.prototype;return C.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},C.abortInternal=function(){var v=this.response;(!v||!v.ok)&&(this.stats.aborted=!0,this.controller.abort())},C.abort=function(){var v;this.abortInternal(),(v=this.callbacks)!==null&&v!==void 0&&v.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},C.load=function(v,m,A){var b=this,T=this.stats;if(T.loading.start)throw new Error("Loader can only be used once.");T.loading.start=self.performance.now();var P=g(v,this.controller.signal),O=A.onProgress,M=v.responseType==="arraybuffer",R=M?"byteLength":"length";this.context=v,this.config=m,this.callbacks=A,this.request=this.fetchSetup(v,P),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){b.abortInternal(),A.onTimeout(T,v,b.response)},m.timeout),self.fetch(this.request).then(function(I){if(b.response=b.loader=I,!I.ok){var w=I.status,k=I.statusText;throw new E(k||"fetch, bad network response",w,I)}return T.loading.first=Math.max(self.performance.now(),T.loading.start),T.total=parseInt(I.headers.get("Content-Length")||"0"),O&&Object(s.isFiniteNumber)(m.highWaterMark)?b.loadProgressively(I,T,v,m.highWaterMark,O):M?I.arrayBuffer():I.text()}).then(function(I){var w=b.response;self.clearTimeout(b.requestTimeout),T.loading.end=Math.max(self.performance.now(),T.loading.first),T.loaded=T.total=I[R];var k={url:w.url,data:I};O&&!Object(s.isFiniteNumber)(m.highWaterMark)&&O(T,v,I,w),A.onSuccess(k,T,v,w)}).catch(function(I){if(self.clearTimeout(b.requestTimeout),!T.aborted){var w=I&&I.code||0,k=I?I.message:null;A.onError({code:w,text:k},v,I?I.details:null)}})},C.getCacheAge=function(){var v=null;if(this.response){var m=this.response.headers.get("age");v=m?parseFloat(m):null}return v},C.loadProgressively=function(v,m,A,b,T){b===void 0&&(b=0);var P=new o.default,O=v.body.getReader(),M=function R(){return O.read().then(function(I){if(I.done)return P.dataLength&&T(m,A,P.flush(),v),Promise.resolve(new ArrayBuffer(0));var w=I.value,k=w.length;return m.loaded+=k,k<b||P.dataLength?(P.push(w),P.dataLength>=b&&T(m,A,P.flush(),v)):T(m,A,w,v),R()}).catch(function(){return Promise.reject()})};return M()},_}();function g(_,C){var p={method:"GET",mode:"cors",credentials:"same-origin",signal:C,headers:new self.Headers(D({},_.headers))};return _.rangeEnd&&p.headers.set("Range","bytes="+_.rangeStart+"-"+String(_.rangeEnd-1)),p}function f(_,C){return new self.Request(_.url,C)}var E=function(_){l(C,_);function C(p,v,m){var A;return A=_.call(this,p)||this,A.code=void 0,A.details=void 0,A.code=v,A.details=m,A}return C}(c(Error));i.default=L},"./src/utils/imsc1-ttml-parser.ts":function(n,i,r){r.r(i),r.d(i,"IMSC1_CODEC",function(){return d}),r.d(i,"parseIMSC1",function(){return S});var s=r("./src/utils/mp4-tools.ts"),a=r("./src/utils/vttparser.ts"),o=r("./src/utils/vttcue.ts"),l=r("./src/demux/id3.ts"),c=r("./src/utils/timescale-conversion.ts"),u=r("./src/utils/webvtt-parser.ts");function h(){return h=Object.assign?Object.assign.bind():function(b){for(var T=1;T<arguments.length;T++){var P=arguments[T];for(var O in P)Object.prototype.hasOwnProperty.call(P,O)&&(b[O]=P[O])}return b},h.apply(this,arguments)}var d="stpp.ttml.im1t",y=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,x=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,D={left:"start",center:"center",right:"end",start:"start",end:"end"};function S(b,T,P,O,M){var R=Object(s.findBox)(new Uint8Array(b),["mdat"]);if(R.length===0){M(new Error("Could not parse IMSC1 mdat"));return}var I=R.map(function(k){return Object(l.utf8ArrayToStr)(k)}),w=Object(c.toTimescaleFromScale)(T,1,P);try{I.forEach(function(k){return O(L(k,w))})}catch(k){M(k)}}function L(b,T){var P=new DOMParser,O=P.parseFromString(b,"text/xml"),M=O.getElementsByTagName("tt")[0];if(!M)throw new Error("Invalid ttml");var R={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},I=Object.keys(R).reduce(function(N,K){return N[K]=M.getAttribute("ttp:"+K)||R[K],N},{}),w=M.getAttribute("xml:space")!=="preserve",k=f(g(M,"styling","style")),B=f(g(M,"layout","region")),F=g(M,"body","[begin]");return[].map.call(F,function(N){var K=E(N,w);if(!K||!N.hasAttribute("begin"))return null;var H=v(N.getAttribute("begin"),I),U=v(N.getAttribute("dur"),I),j=v(N.getAttribute("end"),I);if(H===null)throw p(N);if(j===null){if(U===null)throw p(N);j=H+U}var G=new o.default(H-T,j-T,K);G.id=Object(u.generateCueId)(G.startTime,G.endTime,G.text);var X=B[N.getAttribute("region")],J=k[N.getAttribute("style")];G.position=10,G.size=80;var nt=_(X,J,k),ot=nt.textAlign;if(ot){var rt=D[ot];rt&&(G.lineAlign=rt),G.align=ot}return h(G,nt),G}).filter(function(N){return N!==null})}function g(b,T,P){var O=b.getElementsByTagName(T)[0];return O?[].slice.call(O.querySelectorAll(P)):[]}function f(b){return b.reduce(function(T,P){var O=P.getAttribute("xml:id");return O&&(T[O]=P),T},{})}function E(b,T){return[].slice.call(b.childNodes).reduce(function(P,O,M){var R;return O.nodeName==="br"&&M?P+`
`:(R=O.childNodes)!==null&&R!==void 0&&R.length?E(O,T):T?P+O.textContent.trim().replace(/\s+/g," "):P+O.textContent},"")}function _(b,T,P){var O="http://www.w3.org/ns/ttml#styling",M=null,R=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],I=b!=null&&b.hasAttribute("style")?b.getAttribute("style"):null;return I&&P.hasOwnProperty(I)&&(M=P[I]),R.reduce(function(w,k){var B=C(T,O,k)||C(b,O,k)||C(M,O,k);return B&&(w[k]=B),w},{})}function C(b,T,P){return b&&b.hasAttributeNS(T,P)?b.getAttributeNS(T,P):null}function p(b){return new Error("Could not parse ttml timestamp "+b)}function v(b,T){if(!b)return null;var P=Object(a.parseTimeStamp)(b);return P===null&&(y.test(b)?P=m(b,T):x.test(b)&&(P=A(b,T))),P}function m(b,T){var P=y.exec(b),O=(P[4]|0)+(P[5]|0)/T.subFrameRate;return(P[1]|0)*3600+(P[2]|0)*60+(P[3]|0)+O/T.frameRate}function A(b,T){var P=x.exec(b),O=Number(P[1]),M=P[2];switch(M){case"h":return O*3600;case"m":return O*60;case"ms":return O*1e3;case"f":return O/T.frameRate;case"t":return O/T.tickRate}return O}},"./src/utils/logger.ts":function(n,i,r){r.r(i),r.d(i,"enableLogs",function(){return u}),r.d(i,"logger",function(){return h});var s=function(){},a={trace:s,debug:s,log:s,warn:s,info:s,error:s},o=a;function l(d){var y=self.console[d];return y?y.bind(self.console,"["+d+"] >"):s}function c(d){for(var y=arguments.length,x=new Array(y>1?y-1:0),D=1;D<y;D++)x[D-1]=arguments[D];x.forEach(function(S){o[S]=d[S]?d[S].bind(d):l(S)})}function u(d){if(self.console&&d===!0||typeof d=="object"){c(d,"debug","log","info","warn","error");try{o.log()}catch{o=a}}else o=a}var h=o},"./src/utils/mediakeys-helper.ts":function(n,i,r){r.r(i),r.d(i,"KeySystems",function(){return s}),r.d(i,"requestMediaKeySystemAccess",function(){return a});var s;(function(o){o.WIDEVINE="com.widevine.alpha",o.PLAYREADY="com.microsoft.playready"})(s||(s={}));var a=function(){return typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}()},"./src/utils/mediasource-helper.ts":function(n,i,r){r.r(i),r.d(i,"getMediaSource",function(){return s});function s(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":function(n,i,r){r.r(i),r.d(i,"RemuxerTrackIdConfig",function(){return u}),r.d(i,"bin2str",function(){return h}),r.d(i,"readUint16",function(){return d}),r.d(i,"readUint32",function(){return y}),r.d(i,"readSint32",function(){return x}),r.d(i,"writeUint32",function(){return D}),r.d(i,"findBox",function(){return S}),r.d(i,"parseSegmentIndex",function(){return L}),r.d(i,"parseInitSegment",function(){return g}),r.d(i,"getStartDTS",function(){return f}),r.d(i,"getDuration",function(){return E}),r.d(i,"computeRawDurationFromSamples",function(){return _}),r.d(i,"offsetStartDTS",function(){return C}),r.d(i,"segmentValidRange",function(){return p}),r.d(i,"appendUint8Array",function(){return v}),r.d(i,"parseSamples",function(){return m}),r.d(i,"parseSEIMessageFromNALu",function(){return T}),r.d(i,"parseEmsg",function(){return O});var s=r("./src/utils/typed-array.ts"),a=r("./src/loader/fragment.ts"),o=r("./src/demux/id3.ts"),l=Math.pow(2,32)-1,c=[].push,u={video:1,audio:2,id3:3,text:4};function h(M){return String.fromCharCode.apply(null,M)}function d(M,R){var I=M[R]<<8|M[R+1];return I<0?65536+I:I}function y(M,R){var I=x(M,R);return I<0?4294967296+I:I}function x(M,R){return M[R]<<24|M[R+1]<<16|M[R+2]<<8|M[R+3]}function D(M,R,I){M[R]=I>>24,M[R+1]=I>>16&255,M[R+2]=I>>8&255,M[R+3]=I&255}function S(M,R){var I=[];if(!R.length)return I;for(var w=M.byteLength,k=0;k<w;){var B=y(M,k),F=h(M.subarray(k+4,k+8)),N=B>1?k+B:w;if(F===R[0])if(R.length===1)I.push(M.subarray(k+8,N));else{var K=S(M.subarray(k+8,N),R.slice(1));K.length&&c.apply(I,K)}k=N}return I}function L(M){var R=[],I=M[0],w=8,k=y(M,w);w+=4;var B=0,F=0;I===0?w+=8:w+=16,w+=2;var N=M.length+F,K=d(M,w);w+=2;for(var H=0;H<K;H++){var U=w,j=y(M,U);U+=4;var G=j&2147483647,X=(j&2147483648)>>>31;if(X===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var J=y(M,U);U+=4,R.push({referenceSize:G,subsegmentDuration:J,info:{duration:J/k,start:N,end:N+G-1}}),N+=G,U+=4,w=U}return{earliestPresentationTime:B,timescale:k,version:I,referencesCount:K,references:R}}function g(M){for(var R=[],I=S(M,["moov","trak"]),w=0;w<I.length;w++){var k=I[w],B=S(k,["tkhd"])[0];if(B){var F=B[0],N=F===0?12:20,K=y(B,N),H=S(k,["mdia","mdhd"])[0];if(H){F=H[0],N=F===0?12:20;var U=y(H,N),j=S(k,["mdia","hdlr"])[0];if(j){var G=h(j.subarray(8,12)),X={soun:a.ElementaryStreamTypes.AUDIO,vide:a.ElementaryStreamTypes.VIDEO}[G];if(X){var J=S(k,["mdia","minf","stbl","stsd"])[0],nt=void 0;J&&(nt=h(J.subarray(12,16))),R[K]={timescale:U,type:X},R[X]={timescale:U,id:K,codec:nt}}}}}}var ot=S(M,["moov","mvex","trex"]);return ot.forEach(function(rt){var W=y(rt,4),V=R[W];V&&(V.default={duration:y(rt,12),flags:y(rt,20)})}),R}function f(M,R){return S(R,["moof","traf"]).reduce(function(I,w){var k=S(w,["tfdt"])[0],B=k[0],F=S(w,["tfhd"]).reduce(function(N,K){var H=y(K,4),U=M[H];if(U){var j=y(k,4);B===1&&(j*=Math.pow(2,32),j+=y(k,8));var G=U.timescale||9e4,X=j/G;if(isFinite(X)&&(N===null||X<N))return X}return N},null);return F!==null&&isFinite(F)&&(I===null||F<I)?F:I},null)||0}function E(M,R){for(var I=0,w=0,k=0,B=S(M,["moof","traf"]),F=0;F<B.length;F++){var N=B[F],K=S(N,["tfhd"])[0],H=y(K,4),U=R[H];if(!!U){var j=U.default,G=y(K,0)|(j==null?void 0:j.flags),X=j==null?void 0:j.duration;G&8&&(G&2?X=y(K,12):X=y(K,8));for(var J=U.timescale||9e4,nt=S(N,["trun"]),ot=0;ot<nt.length;ot++){if(I=_(nt[ot]),!I&&X){var rt=y(nt[ot],4);I=X*rt}U.type===a.ElementaryStreamTypes.VIDEO?w+=I/J:U.type===a.ElementaryStreamTypes.AUDIO&&(k+=I/J)}}}if(w===0&&k===0){for(var W=0,V=S(M,["sidx"]),z=0;z<V.length;z++){var Y=L(V[z]);Y!=null&&Y.references&&(W+=Y.references.reduce(function(Q,Z){return Q+Z.info.duration||0},0))}return W}return w||k}function _(M){var R=y(M,0),I=8;R&1&&(I+=4),R&4&&(I+=4);for(var w=0,k=y(M,4),B=0;B<k;B++){if(R&256){var F=y(M,I);w+=F,I+=4}R&512&&(I+=4),R&1024&&(I+=4),R&2048&&(I+=4)}return w}function C(M,R,I){S(R,["moof","traf"]).forEach(function(w){S(w,["tfhd"]).forEach(function(k){var B=y(k,4),F=M[B];if(!!F){var N=F.timescale||9e4;S(w,["tfdt"]).forEach(function(K){var H=K[0],U=y(K,4);if(H===0)U-=I*N,U=Math.max(U,0),D(K,4,U);else{U*=Math.pow(2,32),U+=y(K,8),U-=I*N,U=Math.max(U,0);var j=Math.floor(U/(l+1)),G=Math.floor(U%(l+1));D(K,4,j),D(K,8,G)}})}})})}function p(M){var R={valid:null,remainder:null},I=S(M,["moof"]);if(I){if(I.length<2)return R.remainder=M,R}else return R;var w=I[I.length-1];return R.valid=Object(s.sliceUint8)(M,0,w.byteOffset-8),R.remainder=Object(s.sliceUint8)(M,w.byteOffset-8),R}function v(M,R){var I=new Uint8Array(M.length+R.length);return I.set(M),I.set(R,M.length),I}function m(M,R){var I=[],w=R.samples,k=R.timescale,B=R.id,F=!1,N=S(w,["moof"]);return N.map(function(K){var H=K.byteOffset-8,U=S(K,["traf"]);U.map(function(j){var G=S(j,["tfdt"]).map(function(X){var J=X[0],nt=y(X,4);return J===1&&(nt*=Math.pow(2,32),nt+=y(X,8)),nt/k})[0];return G!==void 0&&(M=G),S(j,["tfhd"]).map(function(X){var J=y(X,4),nt=y(X,0)&16777215,ot=(nt&1)!==0,rt=(nt&2)!==0,W=(nt&8)!==0,V=0,z=(nt&16)!==0,Y=0,Q=(nt&32)!==0,Z=8;J===B&&(ot&&(Z+=8),rt&&(Z+=4),W&&(V=y(X,Z),Z+=4),z&&(Y=y(X,Z),Z+=4),Q&&(Z+=4),R.type==="video"&&(F=A(R.codec)),S(j,["trun"]).map(function(st){var tt=st[0],et=y(st,0)&16777215,q=(et&1)!==0,ut=0,ct=(et&4)!==0,ft=(et&256)!==0,dt=0,vt=(et&512)!==0,Et=0,yt=(et&1024)!==0,Tt=(et&2048)!==0,Wt=0,ee=y(st,4),Ht=8;q&&(ut=y(st,Ht),Ht+=4),ct&&(Ht+=4);for(var jt=ut+H,le=0;le<ee;le++){if(ft?(dt=y(st,Ht),Ht+=4):dt=V,vt?(Et=y(st,Ht),Ht+=4):Et=Y,yt&&(Ht+=4),Tt&&(tt===0?Wt=y(st,Ht):Wt=x(st,Ht),Ht+=4),R.type===a.ElementaryStreamTypes.VIDEO)for(var St=0;St<Et;){var It=y(w,jt);jt+=4;var ne=w[jt]&31;if(b(F,ne)){var Je=w.subarray(jt,jt+It);T(Je,M+Wt/k,I)}jt+=It,St+=It+4}M+=dt/k}}))})})}),I}function A(M){if(!M)return!1;var R=M.indexOf("."),I=R<0?M:M.substring(0,R);return I==="hvc1"||I==="hev1"||I==="dvh1"||I==="dvhe"}function b(M,R){return M?R===39||R===40:R===6}function T(M,R,I){var w=P(M),k=0;k++;for(var B=0,F=0,N=!1,K=0;k<w.length;){B=0;do{if(k>=w.length)break;K=w[k++],B+=K}while(K===255);F=0;do{if(k>=w.length)break;K=w[k++],F+=K}while(K===255);var H=w.length-k;if(!N&&B===4&&k<w.length){N=!0;var U=w[k++];if(U===181){var j=d(w,k);if(k+=2,j===49){var G=y(w,k);if(k+=4,G===1195456820){var X=w[k++];if(X===3){var J=w[k++],nt=31&J,ot=64&J,rt=ot?2+nt*3:0,W=new Uint8Array(rt);if(ot){W[0]=J;for(var V=1;V<rt;V++)W[V]=w[k++]}I.push({type:X,payloadType:B,pts:R,bytes:W})}}}}}else if(B===5&&F<H){if(N=!0,F>16){for(var z=[],Y=0;Y<16;Y++){var Q=w[k++].toString(16);z.push(Q.length==1?"0"+Q:Q),(Y===3||Y===5||Y===7||Y===9)&&z.push("-")}for(var Z=F-16,st=new Uint8Array(Z),tt=0;tt<Z;tt++)st[tt]=w[k++];I.push({payloadType:B,pts:R,uuid:z.join(""),userData:Object(o.utf8ArrayToStr)(st),userDataBytes:st})}}else if(F<H)k+=F;else if(F>H)break}}function P(M){for(var R=M.byteLength,I=[],w=1;w<R-2;)M[w]===0&&M[w+1]===0&&M[w+2]===3?(I.push(w+2),w+=2):w++;if(I.length===0)return M;var k=R-I.length,B=new Uint8Array(k),F=0;for(w=0;w<k;F++,w++)F===I[0]&&(F++,I.shift()),B[w]=M[F];return B}function O(M){var R=M[0],I="",w="",k=0,B=0,F=0,N=0,K=0,H=0;if(R===0){for(;h(M.subarray(H,H+1))!=="\0";)I+=h(M.subarray(H,H+1)),H+=1;for(I+=h(M.subarray(H,H+1)),H+=1;h(M.subarray(H,H+1))!=="\0";)w+=h(M.subarray(H,H+1)),H+=1;w+=h(M.subarray(H,H+1)),H+=1,k=y(M,12),B=y(M,16),N=y(M,20),K=y(M,24),H=28}else if(R===1){H+=4,k=y(M,H),H+=4;var U=y(M,H);H+=4;var j=y(M,H);for(H+=4,F=Math.pow(2,32)*U+j,Number.isSafeInteger(F)||(F=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),N=y(M,H),H+=4,K=y(M,H),H+=4;h(M.subarray(H,H+1))!=="\0";)I+=h(M.subarray(H,H+1)),H+=1;for(I+=h(M.subarray(H,H+1)),H+=1;h(M.subarray(H,H+1))!=="\0";)w+=h(M.subarray(H,H+1)),H+=1;w+=h(M.subarray(H,H+1)),H+=1}var G=M.subarray(H,M.byteLength);return{schemeIdUri:I,value:w,timeScale:k,presentationTime:F,presentationTimeDelta:B,eventDuration:N,id:K,payload:G}}},"./src/utils/output-filter.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return s});var s=function(){function a(l,c){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=l,this.trackName=c}var o=a.prototype;return o.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},o.newCue=function(c,u,h){(this.startTime===null||this.startTime>c)&&(this.startTime=c),this.endTime=u,this.screen=h,this.timelineController.createCaptionsTrack(this.trackName)},o.reset=function(){this.cueRanges=[],this.startTime=null},a}()},"./src/utils/texttrack-utils.ts":function(n,i,r){r.r(i),r.d(i,"sendAddTrackEvent",function(){return a}),r.d(i,"addCueToTrack",function(){return o}),r.d(i,"clearCurrentCues",function(){return l}),r.d(i,"removeCuesInRange",function(){return c}),r.d(i,"getCuesInRange",function(){return h});var s=r("./src/utils/logger.ts");function a(d,y){var x;try{x=new Event("addtrack")}catch{x=document.createEvent("Event"),x.initEvent("addtrack",!1,!1)}x.track=d,y.dispatchEvent(x)}function o(d,y){var x=d.mode;if(x==="disabled"&&(d.mode="hidden"),d.cues&&!d.cues.getCueById(y.id))try{if(d.addCue(y),!d.cues.getCueById(y.id))throw new Error("addCue is failed for: "+y)}catch(S){s.logger.debug("[texttrack-utils]: "+S);var D=new self.TextTrackCue(y.startTime,y.endTime,y.text);D.id=y.id,d.addCue(D)}x==="disabled"&&(d.mode=x)}function l(d){var y=d.mode;if(y==="disabled"&&(d.mode="hidden"),d.cues)for(var x=d.cues.length;x--;)d.removeCue(d.cues[x]);y==="disabled"&&(d.mode=y)}function c(d,y,x,D){var S=d.mode;if(S==="disabled"&&(d.mode="hidden"),d.cues&&d.cues.length>0)for(var L=h(d.cues,y,x),g=0;g<L.length;g++)(!D||D(L[g]))&&d.removeCue(L[g]);S==="disabled"&&(d.mode=S)}function u(d,y){if(y<d[0].startTime)return 0;var x=d.length-1;if(y>d[x].endTime)return-1;for(var D=0,S=x;D<=S;){var L=Math.floor((S+D)/2);if(y<d[L].startTime)S=L-1;else if(y>d[L].startTime&&D<x)D=L+1;else return L}return d[D].startTime-y<y-d[S].startTime?D:S}function h(d,y,x){var D=[],S=u(d,y);if(S>-1)for(var L=S,g=d.length;L<g;L++){var f=d[L];if(f.startTime>=y&&f.endTime<=x)D.push(f);else if(f.startTime>x)return D}return D}},"./src/utils/time-ranges.ts":function(n,i,r){r.r(i);var s={toString:function(o){for(var l="",c=o.length,u=0;u<c;u++)l+="["+o.start(u).toFixed(3)+","+o.end(u).toFixed(3)+"]";return l}};i.default=s},"./src/utils/timescale-conversion.ts":function(n,i,r){r.r(i),r.d(i,"toTimescaleFromBase",function(){return a}),r.d(i,"toTimescaleFromScale",function(){return o}),r.d(i,"toMsFromMpegTsClock",function(){return l}),r.d(i,"toMpegTsClockFromTimescale",function(){return c});var s=9e4;function a(u,h,d,y){d===void 0&&(d=1),y===void 0&&(y=!1);var x=u*h*d;return y?Math.round(x):x}function o(u,h,d,y){return d===void 0&&(d=1),y===void 0&&(y=!1),a(u,h,1/d,y)}function l(u,h){return h===void 0&&(h=!1),a(u,1e3,1/s,h)}function c(u,h){return h===void 0&&(h=1),a(u,s,1/h)}},"./src/utils/typed-array.ts":function(n,i,r){r.r(i),r.d(i,"sliceUint8",function(){return s});function s(a,o,l){return Uint8Array.prototype.slice?a.slice(o,l):new Uint8Array(Array.prototype.slice.call(a,o,l))}},"./src/utils/vttcue.ts":function(n,i,r){r.r(i),i.default=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;var s=["","lr","rl"],a=["start","middle","end","left","right"];function o(d,y){if(typeof y!="string"||!Array.isArray(d))return!1;var x=y.toLowerCase();return~d.indexOf(x)?x:!1}function l(d){return o(s,d)}function c(d){return o(a,d)}function u(d){for(var y=arguments.length,x=new Array(y>1?y-1:0),D=1;D<y;D++)x[D-1]=arguments[D];for(var S=1;S<arguments.length;S++){var L=arguments[S];for(var g in L)d[g]=L[g]}return d}function h(d,y,x){var D=this,S={enumerable:!0};D.hasBeenReset=!1;var L="",g=!1,f=d,E=y,_=x,C=null,p="",v=!0,m="auto",A="start",b=50,T="middle",P=50,O="middle";Object.defineProperty(D,"id",u({},S,{get:function(){return L},set:function(R){L=""+R}})),Object.defineProperty(D,"pauseOnExit",u({},S,{get:function(){return g},set:function(R){g=!!R}})),Object.defineProperty(D,"startTime",u({},S,{get:function(){return f},set:function(R){if(typeof R!="number")throw new TypeError("Start time must be set to a number.");f=R,this.hasBeenReset=!0}})),Object.defineProperty(D,"endTime",u({},S,{get:function(){return E},set:function(R){if(typeof R!="number")throw new TypeError("End time must be set to a number.");E=R,this.hasBeenReset=!0}})),Object.defineProperty(D,"text",u({},S,{get:function(){return _},set:function(R){_=""+R,this.hasBeenReset=!0}})),Object.defineProperty(D,"region",u({},S,{get:function(){return C},set:function(R){C=R,this.hasBeenReset=!0}})),Object.defineProperty(D,"vertical",u({},S,{get:function(){return p},set:function(R){var I=l(R);if(I===!1)throw new SyntaxError("An invalid or illegal string was specified.");p=I,this.hasBeenReset=!0}})),Object.defineProperty(D,"snapToLines",u({},S,{get:function(){return v},set:function(R){v=!!R,this.hasBeenReset=!0}})),Object.defineProperty(D,"line",u({},S,{get:function(){return m},set:function(R){if(typeof R!="number"&&R!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");m=R,this.hasBeenReset=!0}})),Object.defineProperty(D,"lineAlign",u({},S,{get:function(){return A},set:function(R){var I=c(R);if(!I)throw new SyntaxError("An invalid or illegal string was specified.");A=I,this.hasBeenReset=!0}})),Object.defineProperty(D,"position",u({},S,{get:function(){return b},set:function(R){if(R<0||R>100)throw new Error("Position must be between 0 and 100.");b=R,this.hasBeenReset=!0}})),Object.defineProperty(D,"positionAlign",u({},S,{get:function(){return T},set:function(R){var I=c(R);if(!I)throw new SyntaxError("An invalid or illegal string was specified.");T=I,this.hasBeenReset=!0}})),Object.defineProperty(D,"size",u({},S,{get:function(){return P},set:function(R){if(R<0||R>100)throw new Error("Size must be between 0 and 100.");P=R,this.hasBeenReset=!0}})),Object.defineProperty(D,"align",u({},S,{get:function(){return O},set:function(R){var I=c(R);if(!I)throw new SyntaxError("An invalid or illegal string was specified.");O=I,this.hasBeenReset=!0}})),D.displayState=void 0}return h.prototype.getCueAsHTML=function(){var d=self.WebVTT;return d.convertCueToDOMTree(self,this.text)},h}()},"./src/utils/vttparser.ts":function(n,i,r){r.r(i),r.d(i,"parseTimeStamp",function(){return o}),r.d(i,"fixLineBreaks",function(){return y}),r.d(i,"VTTParser",function(){return x});var s=r("./src/utils/vttcue.ts"),a=function(){function D(){}var S=D.prototype;return S.decode=function(g,f){if(!g)return"";if(typeof g!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(g))},D}();function o(D){function S(g,f,E,_){return(g|0)*3600+(f|0)*60+(E|0)+parseFloat(_||0)}var L=D.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return L?parseFloat(L[2])>59?S(L[2],L[3],0,L[4]):S(L[1],L[2],L[3],L[4]):null}var l=function(){function D(){this.values=Object.create(null)}var S=D.prototype;return S.set=function(g,f){!this.get(g)&&f!==""&&(this.values[g]=f)},S.get=function(g,f,E){return E?this.has(g)?this.values[g]:f[E]:this.has(g)?this.values[g]:f},S.has=function(g){return g in this.values},S.alt=function(g,f,E){for(var _=0;_<E.length;++_)if(f===E[_]){this.set(g,f);break}},S.integer=function(g,f){/^-?\d+$/.test(f)&&this.set(g,parseInt(f,10))},S.percent=function(g,f){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(f)){var E=parseFloat(f);if(E>=0&&E<=100)return this.set(g,E),!0}return!1},D}();function c(D,S,L,g){var f=g?D.split(g):[D];for(var E in f)if(typeof f[E]=="string"){var _=f[E].split(L);if(_.length===2){var C=_[0],p=_[1];S(C,p)}}}var u=new s.default(0,0,""),h=u.align==="middle"?"middle":"center";function d(D,S,L){var g=D;function f(){var C=o(D);if(C===null)throw new Error("Malformed timestamp: "+g);return D=D.replace(/^[^\sa-zA-Z-]+/,""),C}function E(C,p){var v=new l;c(C,function(b,T){var P;switch(b){case"region":for(var O=L.length-1;O>=0;O--)if(L[O].id===T){v.set(b,L[O].region);break}break;case"vertical":v.alt(b,T,["rl","lr"]);break;case"line":P=T.split(","),v.integer(b,P[0]),v.percent(b,P[0])&&v.set("snapToLines",!1),v.alt(b,P[0],["auto"]),P.length===2&&v.alt("lineAlign",P[1],["start",h,"end"]);break;case"position":P=T.split(","),v.percent(b,P[0]),P.length===2&&v.alt("positionAlign",P[1],["start",h,"end","line-left","line-right","auto"]);break;case"size":v.percent(b,T);break;case"align":v.alt(b,T,["start",h,"end","left","right"]);break}},/:/,/\s/),p.region=v.get("region",null),p.vertical=v.get("vertical","");var m=v.get("line","auto");m==="auto"&&u.line===-1&&(m=-1),p.line=m,p.lineAlign=v.get("lineAlign","start"),p.snapToLines=v.get("snapToLines",!0),p.size=v.get("size",100),p.align=v.get("align",h);var A=v.get("position","auto");A==="auto"&&u.position===50&&(A=p.align==="start"||p.align==="left"?0:p.align==="end"||p.align==="right"?100:50),p.position=A}function _(){D=D.replace(/^\s+/,"")}if(_(),S.startTime=f(),_(),D.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+g);D=D.slice(3),_(),S.endTime=f(),_(),E(D,S)}function y(D){return D.replace(/<br(?: \/)?>/gi,`
`)}var x=function(){function D(){this.state="INITIAL",this.buffer="",this.decoder=new a,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var S=D.prototype;return S.parse=function(g){var f=this;g&&(f.buffer+=f.decoder.decode(g,{stream:!0}));function E(){var A=f.buffer,b=0;for(A=y(A);b<A.length&&A[b]!=="\r"&&A[b]!==`
`;)++b;var T=A.slice(0,b);return A[b]==="\r"&&++b,A[b]===`
`&&++b,f.buffer=A.slice(b),T}function _(A){c(A,function(b,T){},/:/)}try{var C="";if(f.state==="INITIAL"){if(!/\r\n|\n/.test(f.buffer))return this;C=E();var p=C.match(/^(ï»¿)?WEBVTT([ \t].*)?$/);if(!p||!p[0])throw new Error("Malformed WebVTT signature.");f.state="HEADER"}for(var v=!1;f.buffer;){if(!/\r\n|\n/.test(f.buffer))return this;switch(v?v=!1:C=E(),f.state){case"HEADER":/:/.test(C)?_(C):C||(f.state="ID");continue;case"NOTE":C||(f.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(C)){f.state="NOTE";break}if(!C)continue;if(f.cue=new s.default(0,0,""),f.state="CUE",C.indexOf("-->")===-1){f.cue.id=C;continue}case"CUE":if(!f.cue){f.state="BADCUE";continue}try{d(C,f.cue,f.regionList)}catch{f.cue=null,f.state="BADCUE";continue}f.state="CUETEXT";continue;case"CUETEXT":{var m=C.indexOf("-->")!==-1;if(!C||m&&(v=!0)){f.oncue&&f.cue&&f.oncue(f.cue),f.cue=null,f.state="ID";continue}if(f.cue===null)continue;f.cue.text&&(f.cue.text+=`
`),f.cue.text+=C}continue;case"BADCUE":C||(f.state="ID")}}}catch{f.state==="CUETEXT"&&f.cue&&f.oncue&&f.oncue(f.cue),f.cue=null,f.state=f.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},S.flush=function(){var g=this;try{if((g.cue||g.state==="HEADER")&&(g.buffer+=`

`,g.parse()),g.state==="INITIAL"||g.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(f){g.onparsingerror&&g.onparsingerror(f)}return g.onflush&&g.onflush(),this},D}()},"./src/utils/webvtt-parser.ts":function(n,i,r){r.r(i),r.d(i,"generateCueId",function(){return x}),r.d(i,"parseWebVTT",function(){return S});var s=r("./src/polyfills/number.ts"),a=r("./src/utils/vttparser.ts"),o=r("./src/demux/id3.ts"),l=r("./src/utils/timescale-conversion.ts"),c=r("./src/remux/mp4-remuxer.ts"),u=/\r\n|\n\r|\n|\r/g,h=function(g,f,E){return E===void 0&&(E=0),g.slice(E,E+f.length)===f},d=function(g){var f=parseInt(g.slice(-3)),E=parseInt(g.slice(-6,-4)),_=parseInt(g.slice(-9,-7)),C=g.length>9?parseInt(g.substring(0,g.indexOf(":"))):0;if(!Object(s.isFiniteNumber)(f)||!Object(s.isFiniteNumber)(E)||!Object(s.isFiniteNumber)(_)||!Object(s.isFiniteNumber)(C))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+g);return f+=1e3*E,f+=60*1e3*_,f+=60*60*1e3*C,f},y=function(g){for(var f=5381,E=g.length;E;)f=f*33^g.charCodeAt(--E);return(f>>>0).toString()};function x(L,g,f){return y(L.toString())+y(g.toString())+y(f)}var D=function(g,f,E){var _=g[f],C=g[_.prevCC];if(!C||!C.new&&_.new){g.ccOffset=g.presentationOffset=_.start,_.new=!1;return}for(;(p=C)!==null&&p!==void 0&&p.new;){var p;g.ccOffset+=_.start-C.start,_.new=!1,_=C,C=g[_.prevCC]}g.presentationOffset=E};function S(L,g,f,E,_,C,p,v){var m=new a.VTTParser,A=Object(o.utf8ArrayToStr)(new Uint8Array(L)).trim().replace(u,`
`).split(`
`),b=[],T=Object(l.toMpegTsClockFromTimescale)(g,f),P="00:00.000",O=0,M=0,R,I=!0;m.oncue=function(w){var k=E[_],B=E.ccOffset,F=(O-T)/9e4;k!=null&&k.new&&(M!==void 0?B=E.ccOffset=k.start:D(E,_,F)),F&&(B=F-E.presentationOffset);var N=w.endTime-w.startTime,K=Object(c.normalizePts)((w.startTime+B-M)*9e4,C*9e4)/9e4;w.startTime=Math.max(K,0),w.endTime=Math.max(K+N,0);var H=w.text.trim();w.text=decodeURIComponent(encodeURIComponent(H)),w.id||(w.id=x(w.startTime,w.endTime,H)),w.endTime>0&&b.push(w)},m.onparsingerror=function(w){R=w},m.onflush=function(){if(R){v(R);return}p(b)},A.forEach(function(w){if(I)if(h(w,"X-TIMESTAMP-MAP=")){I=!1,w.slice(16).split(",").forEach(function(k){h(k,"LOCAL:")?P=k.slice(6):h(k,"MPEGTS:")&&(O=parseInt(k.slice(7)))});try{M=d(P)/1e3}catch(k){R=k}return}else w===""&&(I=!1);m.parse(w+`
`)}),m.flush()}},"./src/utils/xhr-loader.ts":function(n,i,r){r.r(i);var s=r("./src/utils/logger.ts"),a=r("./src/loader/load-stats.ts"),o=/^age:\s*[\d.]+\s*$/m,l=function(){function c(h){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=h?h.xhrSetup:null,this.stats=new a.LoadStats,this.retryDelay=0}var u=c.prototype;return u.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},u.abortInternal=function(){var d=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),d&&(d.onreadystatechange=null,d.onprogress=null,d.readyState!==4&&(this.stats.aborted=!0,d.abort()))},u.abort=function(){var d;this.abortInternal(),(d=this.callbacks)!==null&&d!==void 0&&d.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},u.load=function(d,y,x){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=d,this.config=y,this.callbacks=x,this.retryDelay=y.retryDelay,this.loadInternal()},u.loadInternal=function(){var d=this.config,y=this.context;if(!!d){var x=this.loader=new self.XMLHttpRequest,D=this.stats;D.loading.first=0,D.loaded=0;var S=this.xhrSetup;try{if(S)try{S(x,y.url)}catch{x.open("GET",y.url,!0),S(x,y.url)}x.readyState||x.open("GET",y.url,!0);var L=this.context.headers;if(L)for(var g in L)x.setRequestHeader(g,L[g])}catch(f){this.callbacks.onError({code:x.status,text:f.message},y,x);return}y.rangeEnd&&x.setRequestHeader("Range","bytes="+y.rangeStart+"-"+(y.rangeEnd-1)),x.onreadystatechange=this.readystatechange.bind(this),x.onprogress=this.loadprogress.bind(this),x.responseType=y.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),d.timeout),x.send()}},u.readystatechange=function(){var d=this.context,y=this.loader,x=this.stats;if(!(!d||!y)){var D=y.readyState,S=this.config;if(!x.aborted&&D>=2)if(self.clearTimeout(this.requestTimeout),x.loading.first===0&&(x.loading.first=Math.max(self.performance.now(),x.loading.start)),D===4){y.onreadystatechange=null,y.onprogress=null;var L=y.status;if(L>=200&&L<300){x.loading.end=Math.max(self.performance.now(),x.loading.first);var g,f;if(d.responseType==="arraybuffer"?(g=y.response,f=g.byteLength):(g=y.responseText,f=g.length),x.loaded=x.total=f,!this.callbacks)return;var E=this.callbacks.onProgress;if(E&&E(x,d,g,y),!this.callbacks)return;var _={url:y.responseURL,data:g};this.callbacks.onSuccess(_,x,d,y)}else x.retry>=S.maxRetry||L>=400&&L<499?(s.logger.error(L+" while loading "+d.url),this.callbacks.onError({code:L,text:y.statusText},d,y)):(s.logger.warn(L+" while loading "+d.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,S.maxRetryDelay),x.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),S.timeout)}},u.loadtimeout=function(){s.logger.warn("timeout while loading "+this.context.url);var d=this.callbacks;d&&(this.abortInternal(),d.onTimeout(this.stats,this.context,this.loader))},u.loadprogress=function(d){var y=this.stats;y.loaded=d.loaded,d.lengthComputable&&(y.total=d.total)},u.getCacheAge=function(){var d=null;if(this.loader&&o.test(this.loader.getAllResponseHeaders())){var y=this.loader.getResponseHeader("age");d=y?parseFloat(y):null}return d},c}();i.default=l}}).default})})(_f);const xn=_m(_f.exports),Xt=e=>({headers:{"client-id":"kimne78kx3ncx6brgo4mv6wki5h1ko"},body:JSON.stringify(e),method:"POST"}),Sm="https://badges.twitch.tv/v1/badges/global/display?language=en",de="https://gql.twitch.tv/gql",Sf=e=>({operationName:"BrowsePage_Popular",variables:{imageWidth:50,limit:30,platformType:"all",options:{sort:"VIEWER_COUNT",freeformTags:null,tags:[],recommendationsContext:{platform:"web"},requestID:"JIRA-VXP-2397"},sortTypeIsRecency:!1,freeformTagsEnabled:!0,...e&&{cursor:e}},extensions:{persistedQuery:{version:1,sha256Hash:"267d2d2a64e0a0d6206c039ea9948d14a9b300a927d52b2efc52d2486ff0ec65"}}}),Lf=e=>({operationName:"SearchTray_SearchSuggestions",variables:{requestID:"3da37623-8425-4a8a-bbcc-130552a009bc",queryFragment:e,withOfflineChannelContent:!0},extensions:{persistedQuery:{version:1,sha256Hash:"b71566f2c593dd906493b0ab2012e5626c7f277d3e435504d4454de2ff15788a"}}}),Df=(e,t)=>({operationName:"FilterableVideoTower_Videos",variables:{limit:30,channelOwnerLogin:e,broadcastType:"ARCHIVE",videoSort:"TIME",...t&&{cursor:t}},extensions:{persistedQuery:{version:1,sha256Hash:"a937f1d22e269e39a03b509f65a7490f9fc247d7f83d6ac1421523e3b68042cb"}}}),Ul=(e,t,n)=>({operationName:"VideoCommentsByOffsetOrCursor",variables:{videoID:e,...t&&{contentOffsetSeconds:t},...n&&{cursor:n}},extensions:{persistedQuery:{version:1,sha256Hash:"b70a3591ff0f4e0313d126c6a1502d79a1c02baebb288227c582044aa76adf6a"}}}),Af=e=>({operationName:"ChannelShell",variables:{login:e},extensions:{persistedQuery:{version:1,sha256Hash:"580ab410bcd0c1ad194224957ae2241e5d252b2c5173d8e0cce9d32d5bb14efe"}}}),Cf=e=>({operationName:"NielsenContentMetadata",variables:{isCollectionContent:!1,isLiveContent:!0,isVODContent:!1,collectionID:"",login:e,vodID:""},extensions:{persistedQuery:{version:1,sha256Hash:"2dbf505ee929438369e68e72319d1106bb3c142e295332fac157c90638968586"}}}),Lm=e=>({operationName:"NielsenContentMetadata",variables:{isCollectionContent:!1,isLiveContent:!1,isVODContent:!0,collectionID:"",login:"",vodID:e},extensions:{persistedQuery:{version:1,sha256Hash:"2dbf505ee929438369e68e72319d1106bb3c142e295332fac157c90638968586"}}}),Dm=(e,t)=>({operationName:"VideoMetadata",variables:{channelLogin:t,videoID:e},extensions:{persistedQuery:{version:1,sha256Hash:"49b5b8f268cdeb259d75b58dcb0c1a748e3b575003448a2333dc5cdafd49adad"}}}),Am=e=>({operationName:"DirectoryPage_Game",variables:{imageWidth:50,name:e,options:{sort:"VIEWER_COUNT",recommendationsContext:{platform:"web"},requestID:"JIRA-VXP-2397",freeformTags:null,tags:[]},sortTypeIsRecency:!1,limit:30},extensions:{persistedQuery:{version:1,sha256Hash:"df4bb6cc45055237bfaf3ead608bbafb79815c7100b6ee126719fac3762ddf8b"}}}),Cm=()=>({operationName:"BrowsePage_AllDirectories",variables:{limit:30,options:{recommendationsContext:{platform:"web"},requestID:"JIRA-VXP-2397",sort:"VIEWER_COUNT",tags:[]}},extensions:{persistedQuery:{version:1,sha256Hash:"78957de9388098820e222c88ec14e85aaf6cf844adf44c8319c545c75fd63203"}}}),Mm=(e,t)=>({operationName:"ViewerCard",variables:{channelLogin:e,hasChannelID:!0,giftRecipientLogin:t,isViewerBadgeCollectionEnabled:!0,withStandardGifting:!0},extensions:{persistedQuery:{version:1,sha256Hash:"20e51233313878f971daa32dfc039b2e2183822e62c13f47c48448d5d5e4f5e9"}}}),Wl=(e,t=null)=>({operationName:"ClipsCards__User",variables:{login:e,limit:20,criteria:{filter:"ALL_TIME"},...t&&{cursor:t}},extensions:{persistedQuery:{version:1,sha256Hash:"b73ad2bfaecfd30a9e6c28fada15bd97032c83ec77a0440766a56fe0bd632777"}}}),Om=e=>({operationName:"ClipsDownloadButton",variables:{slug:e},extensions:{persistedQuery:{version:1,sha256Hash:"6e465bb8446e2391644cf079851c0cb1b96928435a240f07ed4b240f0acc6f1b"}}}),Kl={showChat:!0,showMessages:!0,showBadges:!0,showEmotes:!0,showUsernames:!0,showTimestamps:!0,smoothChatFlow:!1,fontSize:13,fontType:"inherit",chatBackground:"#18181a",chatText:"#efeff1",chatSpeed:100};const Ut=(e,t)=>{const n=e.__vccOpts||e;for(const[i,r]of t)n[i]=r;return n},Pm={key:0,class:"chat-width-holder"},Rm={class:"chats-positioner"},Im={class:"flex-time"},wm={key:0,class:"chat-timestamp"},km=["innerHTML"],Fm={key:0},Bm=["innerHTML"],Nm={__name:"ChatBox",props:["channel","channelId","settings"],setup(e,{expose:t}){const n=e,i=100,r=at(null),s=at({}),a=at({}),o=at([]),l=at(!1);he(()=>{console.log("mounting chatbox"),window.addEventListener("resize",c),c(),L(),g()}),Ci(()=>{document.body.style.overflow="initial",window.removeEventListener("resize",c)});const c=()=>{(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<=720?document.body.style.overflow="clip":document.body.style.overflow="initial"},u=A=>{const b=A.data;!b||!b.includes("@badge-info")||b.split("@badge-info").forEach(T=>h("@badge-info"+T))},h=A=>{if(l.value||A=="@badge-info"||n.settings.chatSpeed<100&&Math.random()*100>n.settings.chatSpeed)return;const b=A.match(/display-name=[^;]*;/),T=b&&b[0].substring(13,b[0].length-1),P=A.match(/color=[^;]*;/),O=P&&P[0].substring(6,P[0].length-1);let M=A.split(`PRIVMSG #${n.channel} :`)[1];M||(M=A.split(`USERNOTICE #${n.channel} :`)[1]),!M&&A.match(/system-msg=[^;]*;/)&&(M=String.raw`${A.match(/system-msg=[^;]*;/)[0].substring(11,A.match(/system-msg=[^;]*;/)[0].length-1)}`.replaceAll("\\s"," ")),M||console.log("ERR: no message",A);const R=d(A,M.replace(/(?:\\[rn]|[\r\n]+)+/g,"")),I=x(A);o.value.unshift({user:T,message:R,color:O,badges:I,key:Math.floor(Math.random()*10**9)}),o.value.length>i&&(o.value.length=i)},d=(A,b)=>{if(!n.settings.showEmotes||!b)return b;const T=A.match(/;emotes=[^;]*;/),P=T?T[0].substring(8,T[0].length-1):"",O=[];for(const k of P.split("/")){if(!k.includes(":"))break;const B=k.split(":")[0],F=k.split(":")[1];for(const N of F.split(","))O.push({start:N.split("-")[0],end:N.split("-")[1],emoteId:B})}O.sort((k,B)=>k.start-B.start);let M="",R=0;for(let k=0;k<b.length;k++)O[R]&&O[R].start==k?(M+=`<span class="badge-holder"><img src="https://static-cdn.jtvnw.net/emoticons/v2/${O[R].emoteId}/default/dark/1.0" class="emoticon" /><span class="badge-tooltip tooltip-raise">${b.substring(parseInt(O[R].start),parseInt(O[R].end)+1)} </span></span>`,k=O[R].end,R++):M+=b[k];const I=M.replace(/<\/?[^>]+(>|$)/g,"");if(!I)return M;const w=[];for(const k of I.split(" "))a.value[k]&&!w.includes(k)&&(M=M.replaceAll(k,y(k,a.value[k])),w.push(k));return M},y=(A,b)=>`<span class="badge-holder"><img src="${b}" class="emoticon" /><span class="badge-tooltip tooltip-raise">${A} </span></span>`,x=A=>{var O;let b="";const T=A.match(/badges=[^;]*;/);if(!T||T[0].length<=8)return b;const P=T[0].substring(7,T[0].length-1);for(const M of P.split(",")){const R=M.split("/")[0],I=M.split("/")[1],w=(O=s.value[R])==null?void 0:O.versions[I];if(!w)continue;b=`<span class="badge-holder"><img src="${w.image_url_1x||w.image_url_2x}" class="badge" /><span class="badge-tooltip">${w.title}</span></span>`+b}return b},D=A=>{if(l.value||n.settings.chatSpeed<100&&Math.random()*100>n.settings.chatSpeed)return;let b="";console.log(),A.badges.forEach(M=>b+=`<span class="badge-holder"><img src="${s.value[M.setID].versions[M.version].image_url_1x}" class="badge" /><span class="badge-tooltip">${M.setID}</span></span>`);let T=S(A.fragments);const P=T.replace(/<\/?[^>]+(>|$)/g,""),O=[];for(const M of P.split(" "))a.value[M]&&!O.includes(M)&&(T=T.replaceAll(M,y(M,a.value[M])),O.push(M));o.value.unshift({user:A.user,message:T,color:A.color,badges:b,timestamp:f(A.offset),key:Math.floor(Math.random()*10**9)}),o.value.length>i&&(o.value.length=i)},S=A=>{let b="";for(let T of A)T.emote?b+=y(T.text,`https://static-cdn.jtvnw.net/emoticons/v2/${T.emote.emoteID}/default/dark/1.0"`):b+=T.text;return b},L=async()=>{const A=await fetch(Sm).then(b=>b.json());s.value=A.badge_sets},g=(A=0)=>{if(console.log(n.channelId,"get third party emotes"),A!=5){if(!n.channelId)return setTimeout(()=>g(A+1),500);fetch(`https://api.7tv.app/v2/users/${n.channel}/emotes`).then(b=>b.json()).then(b=>{b.error||b.forEach(T=>{a.value[T.name]=T.urls[0][1]})}).catch(b=>console.log(b)),fetch(`https://api.frankerfacez.com/v1/room/id/${n.channelId}`).then(b=>b.json()).then(b=>{var T,P;if(!b.error){const O=(T=b.room)==null?void 0:T.set;(P=b.sets[O])==null||P.emoticons.forEach(M=>{a.value[M.name]=M.urls[1]})}}),fetch(`https://api.betterttv.net/3/cached/users/twitch/${n.channelId}`).then(b=>b.json()).then(b=>{!b.error&&b.message!="user not found"&&(b.channelEmotes.forEach(T=>{a.value[T.code]=`https://cdn.betterttv.net/emote/${T.id}/1x`}),b.sharedEmotes.forEach(T=>{a.value[T.code]=`https://cdn.betterttv.net/emote/${T.id}/1x`}))})}},f=A=>{let b=Math.floor(A/3600);A=A%3600;let T=Math.floor(A/60);A=A%60;let P=A;return P<10&&(P="0"+P),T<10&&b!=0&&(T="0"+T),b==0?`${T}:${P}`:`${b}:${T}:${P}`},E=A=>{if(!A)return 0;let b=0;for(let T=0,P=A.length;T<P;T++){let O=A.charCodeAt(T);b=(b<<5)-b+O,b|=0}return b},_=["#ff0000","#319a24","#ff4500","#f7ff00","#8b58ff","#9acd32","#1e90ff"],C=A=>_[Math.abs(E(A))%_.length],p=()=>{l.value=r.value.scrollTop<-20},v=()=>{r.value.scrollTop=0};return t({handleNewMessage:u,handleNewVodMessage:D,clearAllChat:()=>{o.value.length=0}}),(A,b)=>e.settings.showChat?(it(),lt("div",Pm,[$("div",Rm,[$("div",{ref_key:"chatContainer",ref:r,class:"chats-container",style:Dn(`background-color: ${e.settings.chatBackground}; color: ${e.settings.chatText}; font-family: ${e.settings.fontType}; font-size: ${e.settings.fontSize}px;`),onScroll:p},[pt(cf,{name:e.settings.smoothChatFlow?"chatbox":""},{default:Qn(()=>[(it(!0),lt(Rt,null,ze(o.value,T=>(it(),lt("div",{class:"chat-each",key:T.key},[$("div",Im,[e.settings.showTimestamps&&T.timestamp?(it(),lt("span",wm,mt(T.timestamp),1)):At("",!0),$("span",null,[$("span",{style:Dn(`color: ${T.color||C(T.user)}; font-weight: 600`)},[e.settings.showBadges?(it(),lt("span",{key:0,innerHTML:T.badges},null,8,km)):At("",!0),we(mt(e.settings.showUsernames?T.user:""),1)],4),e.settings.showUsernames?(it(),lt("span",Fm,": ")):At("",!0),e.settings.showMessages?(it(),lt("span",{key:1,innerHTML:T.message},null,8,Bm)):At("",!0)])])]))),128))]),_:1},8,["name"])],36),l.value?(it(),lt("div",{key:0,class:"resume-chat",onClick:v}," Resume Auto Scroll ")):At("",!0)])])):At("",!0)}},Mf=Ut(Nm,[["__scopeId","data-v-563da9d1"]]);const Um={},Wm=e=>(Xe("data-v-b7bfb10d"),e=e(),Qe(),e),Km={type:"color-fill-current",width:"18px",height:"18px",version:"1.1",viewBox:"0 0 20 20",x:"0px",y:"0px",class:"fill-purple"},Hm=Wm(()=>$("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10 2l6 2 2 6-2 6-6 2-6-2-2-6 2-6 6-2zM8.889 13.636l5.43-5.429-1.415-1.414-4.015 4.015-2.015-2.015-1.414 1.414 3.429 3.43z"},null,-1)),jm=[Hm];function Vm(e,t){return it(),lt("svg",Km,jm)}const co=Ut(Um,[["render",Vm],["__scopeId","data-v-b7bfb10d"]]);const $m={},Gm=e=>(Xe("data-v-1bda0ed2"),e=e(),Qe(),e),zm={type:"color-text-accessible-red",width:"20px",height:"20px",version:"1.1",viewBox:"0 0 20 20",x:"0px",y:"0px",class:"red"},Ym=Gm(()=>$("g",null,[$("path",{"fill-rule":"evenodd",d:"M5 7a5 5 0 116.192 4.857A2 2 0 0013 13h1a3 3 0 013 3v2h-2v-2a1 1 0 00-1-1h-1a3.99 3.99 0 01-3-1.354A3.99 3.99 0 017 15H6a1 1 0 00-1 1v2H3v-2a3 3 0 013-3h1a2 2 0 001.808-1.143A5.002 5.002 0 015 7zm5 3a3 3 0 110-6 3 3 0 010 6z","clip-rule":"evenodd"})],-1)),Xm=[Ym];function Qm(e,t){return it(),lt("svg",zm,Xm)}const Jm=Ut($m,[["render",Qm],["__scopeId","data-v-1bda0ed2"]]),De=e=>{if(e<1e3)return e;if(e<1e5){const t=Math.floor(e/1e3),n=Math.round(e%1e3/100);return n==10?t+1+"K":n==0?t+"K":t+"."+n+"K"}if(e<1e6)return Math.round(e/1e3)+"K";{const t=Math.floor(e/1e6),n=Math.round(e%1e6/1e5);return n==10?t+1+"M":n==0?t+"M":t+"."+n+"M"}},uo=e=>{let t=Math.floor(e/3600);e=e%3600;let n=Math.floor(e/60);return e=e%60,n<10&&(n="0"+n),e<10&&(e="0"+e),t?`${t}:${n}:${e}`:`${n}:${e}`},wi=e=>{let t=Math.floor(e/3600);e=e%3600;let n=Math.floor(e/60);return t<10&&(t="0"+t),n<10&&(n="0"+n),`${t}:${n}`},fo=e=>{const t=(new Date-new Date(e))/1e3,n=Math.round(t/3600);if(n<24)return n==1?"1 hour ago":`${n} hours ago`;const i=Math.round(n/24);if(i<30)return i==1?"Yesterday":`${i} days ago`;const r=Math.round(i/30);if(r<12)return r==1?"Last month":`${r} months ago`;const s=Math.round(r/12);return s==1?"Last year":`${s} years ago`},Zm={},qm={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor"},tp=$("path",{d:"M15 4a1 1 0 1 0 0 2V4zm0 11v-1a1 1 0 0 0-1 1h1zm0 4l-.707.707A1 1 0 0 0 16 19h-1zm-4-4l.707-.707A1 1 0 0 0 11 14v1zm-4.707-1.293a1 1 0 0 0-1.414 1.414l1.414-1.414zm-.707.707l-.707-.707.707.707zM9 11v-1a1 1 0 0 0-.707.293L9 11zm-4 0h1a1 1 0 0 0-1-1v1zm0 4H4a1 1 0 0 0 1.707.707L5 15zm10-9h2V4h-2v2zm2 0a1 1 0 0 1 1 1h2a3 3 0 0 0-3-3v2zm1 1v6h2V7h-2zm0 6a1 1 0 0 1-1 1v2a3 3 0 0 0 3-3h-2zm-1 1h-2v2h2v-2zm-3 1v4h2v-4h-2zm1.707 3.293l-4-4-1.414 1.414 4 4 1.414-1.414zM11 14H7v2h4v-2zm-4 0c-.276 0-.525-.111-.707-.293l-1.414 1.414C5.42 15.663 6.172 16 7 16v-2zm-.707 1.121l3.414-3.414-1.414-1.414-3.414 3.414 1.414 1.414zM9 12h4v-2H9v2zm4 0a3 3 0 0 0 3-3h-2a1 1 0 0 1-1 1v2zm3-3V3h-2v6h2zm0-6a3 3 0 0 0-3-3v2a1 1 0 0 1 1 1h2zm-3-3H3v2h10V0zM3 0a3 3 0 0 0-3 3h2a1 1 0 0 1 1-1V0zM0 3v6h2V3H0zm0 6a3 3 0 0 0 3 3v-2a1 1 0 0 1-1-1H0zm3 3h2v-2H3v2zm1-1v4h2v-4H4zm1.707 4.707l.586-.586-1.414-1.414-.586.586 1.414 1.414z"},null,-1),ep=[tp];function np(e,t){return it(),lt("svg",qm,ep)}const Of=Ut(Zm,[["render",np]]),ip={},rp={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"17",fill:"currentColor"},sp=$("path",{d:"M11 2.253a1 1 0 1 0-2 0h2zm-2 13a1 1 0 1 0 2 0H9zm.447-12.167a1 1 0 1 0 1.107-1.666L9.447 3.086zM1 2.253L.447 1.42A1 1 0 0 0 0 2.253h1zm0 13H0a1 1 0 0 0 1.553.833L1 15.253zm8.447.833a1 1 0 1 0 1.107-1.666l-1.107 1.666zm0-14.666a1 1 0 1 0 1.107 1.666L9.447 1.42zM19 2.253h1a1 1 0 0 0-.447-.833L19 2.253zm0 13l-.553.833A1 1 0 0 0 20 15.253h-1zm-9.553-.833a1 1 0 1 0 1.107 1.666L9.447 14.42zM9 2.253v13h2v-13H9zm1.553-.833C9.203.523 7.42 0 5.5 0v2c1.572 0 2.961.431 3.947 1.086l1.107-1.666zM5.5 0C3.58 0 1.797.523.447 1.42l1.107 1.666C2.539 2.431 3.928 2 5.5 2V0zM0 2.253v13h2v-13H0zm1.553 13.833C2.539 15.431 3.928 15 5.5 15v-2c-1.92 0-3.703.523-5.053 1.42l1.107 1.666zM5.5 15c1.572 0 2.961.431 3.947 1.086l1.107-1.666C9.203 13.523 7.42 13 5.5 13v2zm5.053-11.914C11.539 2.431 12.928 2 14.5 2V0c-1.92 0-3.703.523-5.053 1.42l1.107 1.666zM14.5 2c1.573 0 2.961.431 3.947 1.086l1.107-1.666C18.203.523 16.421 0 14.5 0v2zm3.5.253v13h2v-13h-2zm1.553 12.167C18.203 13.523 16.421 13 14.5 13v2c1.573 0 2.961.431 3.947 1.086l1.107-1.666zM14.5 13c-1.92 0-3.703.523-5.053 1.42l1.107 1.666C11.539 15.431 12.928 15 14.5 15v-2z"},null,-1),ap=[sp];function op(e,t){return it(),lt("svg",rp,ap)}const lp=Ut(ip,[["render",op]]);const cp={},ho=e=>(Xe("data-v-ac322f5f"),e=e(),Qe(),e),up={id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 122.88 66.49"},fp=ho(()=>$("defs",null,null,-1)),dp=ho(()=>$("title",null,"leaderboard",-1)),hp=ho(()=>$("path",{class:"cls-1",d:"M2.27,18.3H34.05a2.27,2.27,0,0,1,2.27,2.27V64.22a2.27,2.27,0,0,1-2.27,2.27H2.27A2.27,2.27,0,0,1,0,64.22V20.57A2.27,2.27,0,0,1,2.27,18.3ZM68.4,9.44V31H61V17.39l-4.52,1.8-2-5.3,7.66-4.45ZM26,49.45H11V43.81l2.84-2.75c.62-.57,1.21-1.13,1.77-1.7L17,38a7.69,7.69,0,0,0,1-1.24,3.52,3.52,0,0,0,.54-1,2.82,2.82,0,0,0,.09-.71,1.08,1.08,0,0,0-.5-1.08,4.54,4.54,0,0,0-1.73-.23,24,24,0,0,0-4.32.36l-.69.13L11,28.58a21.3,21.3,0,0,1,7.12-1.21A9.13,9.13,0,0,1,24,29.06a5.64,5.64,0,0,1,2.12,4.68,9.36,9.36,0,0,1-1,4.7A11.9,11.9,0,0,1,21.45,42l-2.19,1.54H26v5.9ZM103.1,37.19q4.82,0,7,1.37t2.18,4.85a6.81,6.81,0,0,1-.44,2.75,4.59,4.59,0,0,1-1.56,1.74A6.49,6.49,0,0,1,112,49.78a5.44,5.44,0,0,1,.52,2.64q0,4.09-2.13,5.65t-6.58,1.55A28.12,28.12,0,0,1,98,59l-1.08-.23L97.07,53q3.77.33,5.37.33a8,8,0,0,0,2.13-.18.76.76,0,0,0,.53-.79.91.91,0,0,0-.37-.83,2.48,2.48,0,0,0-1.37-.33H98.74v-5.8h4.32c1.18,0,1.77-.33,1.77-1s-.75-1-2.26-1c-1,0-2.53.08-4.52.23l-.85.07L97,38.14a26.29,26.29,0,0,1,6.06-1ZM45.55,0H77.33A2.27,2.27,0,0,1,79.6,2.27v62a2.27,2.27,0,0,1-2.27,2.27H45.55a2.27,2.27,0,0,1-2.27-2.27V2.27A2.27,2.27,0,0,1,45.55,0ZM88.83,30.35h31.78a2.28,2.28,0,0,1,2.27,2.27v31.6a2.27,2.27,0,0,1-2.27,2.27H88.83a2.27,2.27,0,0,1-2.27-2.27V32.62a2.27,2.27,0,0,1,2.27-2.27Z"},null,-1)),gp=[fp,dp,hp];function vp(e,t){return it(),lt("svg",up,gp)}const go=Ut(cp,[["render",vp],["__scopeId","data-v-ac322f5f"]]);const mp={class:"live-info-full"},pp={class:"info-left"},yp={class:"pfp-holder"},Ep=["src"],xp={class:"long-info-holder"},bp={class:"stream-title"},Tp={class:"info-right"},_p={class:"stream-uptime"},Sp={class:"icons-holder"},Lp={__name:"LiveInfo",props:{channel:String},emits:["settingsClick","leaderboardClick","setId"],setup(e,{emit:t}){const n=e,i=me(),r=at(""),s=at(null),a=at(""),o=at(""),l=at(""),c=at(0),u=at("");he(()=>{h()});const h=async()=>{var L,g,f,E,_,C,p,v,m,A,b,T,P,O,M,R,I,w;const x=[Af(n.channel),Cf(n.channel)],D=Xt(x),S=await fetch(de,D).then(k=>k.json());r.value=(f=(g=(L=S[1].data)==null?void 0:L.user)==null?void 0:g.broadcastSettings)==null?void 0:f.title,s.value=(C=(_=(E=S[1].data)==null?void 0:E.user)==null?void 0:_.stream)==null?void 0:C.createdAt,a.value=(A=(m=(v=(p=S[1].data)==null?void 0:p.user)==null?void 0:v.stream)==null?void 0:m.game)==null?void 0:A.displayName,o.value=(T=(b=S[0].data)==null?void 0:b.userOrError)==null?void 0:T.profileImageURL,l.value=(O=(P=S[0].data)==null?void 0:P.userOrError)==null?void 0:O.displayName,c.value=(R=(M=S[0].data)==null?void 0:M.userOrError)==null?void 0:R.stream.viewersCount,t("setId",(w=(I=S[0].data)==null?void 0:I.userOrError)==null?void 0:w.id),setInterval(d,1e3)},d=()=>{if(!s.value)return;const x=new Date-new Date(s.value);u.value=uo(Math.round(x/1e3))},y=()=>{i.push(`/twitch/${n.channel}`)};return(x,D)=>(it(),lt("div",mp,[$("div",pp,[$("div",yp,[$("img",{class:"pfp",src:o.value,onClick:y},null,8,Ep)]),$("div",xp,[$("div",{class:"channel-name",onClick:y},[we(mt(l.value),1),pt(co,{class:"icon-check"})]),$("div",bp,mt(r.value),1),$("div",{class:"stream-game",onClick:D[0]||(D[0]=S=>ht(i).push(`/twitch/directory-search-${a.value}`))},mt(a.value),1)])]),$("div",Tp,[$("div",{class:"view-count",onClick:D[1]||(D[1]=S=>ht(i).push("/"))},[pt(Jm),we(mt(c.value.toLocaleString()),1)]),$("div",_p,mt(u.value),1),$("div",Sp,[pt(Of,{class:"analyze-button",onClick:D[2]||(D[2]=S=>x.$emit("settingsClick"))}),pt(go,{class:"analyze-button",onClick:D[3]||(D[3]=S=>x.$emit("leaderboardClick")),style:{width:"36px"}}),pt(lp,{class:"analyze-button",onClick:D[4]||(D[4]=S=>ht(i).push(`/twitch/${n.channel}/analyzeLive`))})])])]))}},Dp=Ut(Lp,[["__scopeId","data-v-df2234ce"]]);const Ap={class:"live-info-full"},Cp={class:"info-left"},Mp={class:"pfp-holder"},Op=["src"],Pp={class:"long-info-holder"},Rp={class:"vod-title"},Ip={class:"info-right"},wp={class:"view-count"},kp={class:"vod-uptime"},Fp={class:"icons-holder"},Bp={__name:"VodInfo",props:{vodId:String},emits:["settingsClick","leaderboardClick","setId"],setup(e,{emit:t}){const n=e,i=me(),r=at(""),s=at(""),a=at(null),o=at(0),l=at(""),c=at(""),u=at(!1),h=at("");he(()=>{d()});const d=async()=>{var E,_,C,p,v,m,A,b,T,P,O,M,R,I,w,k,B,F,N,K,H;const x=Lm(n.vodId),D=Xt(x),S=await fetch(de,D).then(U=>U.json()),L=(C=(_=(E=S==null?void 0:S.data)==null?void 0:E.video)==null?void 0:_.owner)==null?void 0:C.login,g=Xt(Dm(n.vodId,L)),f=await fetch(de,g).then(U=>U.json());console.log(f),r.value=(m=(v=(p=f==null?void 0:f.data)==null?void 0:p.video)==null?void 0:v.game)==null?void 0:m.name,s.value=(b=(A=f==null?void 0:f.data)==null?void 0:A.video)==null?void 0:b.title,a.value=(P=(T=f==null?void 0:f.data)==null?void 0:T.video)==null?void 0:P.createdAt,o.value=(M=(O=f==null?void 0:f.data)==null?void 0:O.video)==null?void 0:M.viewCount,c.value=(w=(I=(R=f==null?void 0:f.data)==null?void 0:R.video)==null?void 0:I.owner)==null?void 0:w.displayName,l.value=(B=(k=f==null?void 0:f.data)==null?void 0:k.user)==null?void 0:B.profileImageURL,u.value=(N=(F=f==null?void 0:f.data)==null?void 0:F.user)==null?void 0:N.isPartner,h.value=L,t("setId",(H=(K=f==null?void 0:f.data)==null?void 0:K.user)==null?void 0:H.id)},y=()=>{i.push(`/twitch/${h.value}`)};return(x,D)=>(it(),lt("div",Ap,[$("div",Cp,[$("div",Mp,[$("img",{class:"pfp",src:l.value,onClick:y},null,8,Op)]),$("div",Pp,[$("div",{class:"channel-name",onClick:y},[we(mt(c.value),1),u.value?(it(),Yt(co,{key:0,class:"icon-check"})):At("",!0)]),$("div",Rp,mt(s.value),1),$("div",{class:"vod-game",onClick:D[0]||(D[0]=S=>ht(i).push(`/twitch/directory-search-${r.value}`))},mt(r.value),1)])]),$("div",Ip,[$("div",wp,mt(o.value.toLocaleString())+"\xA0views",1),$("div",kp,mt(ht(fo)(a.value)),1),$("div",Fp,[pt(Of,{class:"analyze-button",onClick:D[1]||(D[1]=S=>x.$emit("settingsClick"))}),pt(go,{class:"analyze-button",onClick:D[2]||(D[2]=S=>x.$emit("leaderboardClick")),style:{width:"36px"}})])])]))}},Np=Ut(Bp,[["__scopeId","data-v-88a72d68"]]),Up={},Wp={type:"color-fill-current",width:"20px",height:"20px",version:"1.1",viewBox:"0 0 20 20",x:"0px",y:"0px"},Kp=$("g",null,[$("path",{"fill-rule":"evenodd",d:"M13.192 14.606a7 7 0 111.414-1.414l3.101 3.1-1.414 1.415-3.1-3.1zM14 9A5 5 0 114 9a5 5 0 0110 0z","clip-rule":"evenodd"})],-1),Hp=[Kp];function jp(e,t){return it(),lt("svg",Wp,Hp)}const Hl=Ut(Up,[["render",jp]]);const Vp=e=>(Xe("data-v-e9f14ec0"),e=e(),Qe(),e),$p=Vp(()=>$("div",{class:"search-spaceholder"},null,-1)),Gp={class:"search-container"},zp={key:0,class:"suggestions-container"},Yp=["onClick"],Xp={class:"channel-row"},Qp=["src"],Jp=["src"],Zp={class:"channel-info"},qp={class:"suggestion-text"},t0={key:0,class:"channel-verified"},e0={key:3,class:"channel-is-live"},n0={key:0},i0={__name:"SearchBox",props:{getQuerySuggestions:Function},emits:["queryClick"],setup(e,{emit:t}){const n=e,i=me(),r=at(""),s=at([]),a=at(null),o=at(null),l=at(!1);he(()=>{a.value.addEventListener("focusin",()=>l.value=!0),a.value.addEventListener("focusout",()=>l.value=!1)});const c=async()=>{r.value?s.value=await n.getQuerySuggestions(r.value):s.value=[]},u=h=>{!h.content&&h.text&&(h=h.text),t("queryClick",h),l.value=!1,o.value.blur()};return(h,d)=>(it(),lt(Rt,null,[$p,$("div",{class:"home-button",onClick:d[0]||(d[0]=y=>ht(i).push("/"))},"Home"),$("div",Gp,[$("div",{class:"search-box-container",tabindex:"-1",ref_key:"inputDiv",ref:a},[zt($("input",{type:"text",class:"query-input","onUpdate:modelValue":d[1]||(d[1]=y=>r.value=y),autocapitalize:"none",autocomplete:"off",autocorrect:"off",spellcheck:"false",placeholder:"Search",maxlength:"150",onInput:c,onKeypress:d[2]||(d[2]=uv(()=>u(r.value),["enter"])),ref_key:"inputElement",ref:o},null,544),[[on,r.value]]),pt(gi,{name:"container"},{default:Qn(()=>[r.value&&l.value?(it(),lt("div",zp,[(it(!0),lt(Rt,null,ze(s.value,y=>{var x,D,S,L;return it(),lt("div",{class:"suggestion-each",key:y,onMousedown:d[3]||(d[3]=lv(()=>{},["prevent"])),onClick:()=>u(y)},[$("div",Xp,[(x=y.content)!=null&&x.profileImageURL?(it(),lt("img",{key:0,class:"profile-image",src:y.content.profileImageURL},null,8,Qp)):(D=y.content)!=null&&D.boxArtURL?(it(),lt("img",{key:1,class:"profile-image-box",src:y.content.boxArtURL},null,8,Jp)):(it(),Yt(Hl,{key:2,class:"search-icon"})),$("div",Zp,[$("span",qp,mt(y.text),1),(S=y.content)!=null&&S.isVerified?(it(),lt("span",t0,[pt(co)])):At("",!0)]),(L=y.content)!=null&&L.isLive?(it(),lt("div",e0,"LIVE")):At("",!0)])],40,Yp)}),128)),s.value.length?At("",!0):(it(),lt("div",n0," No results "))])):At("",!0)]),_:1})],512),$("div",{class:"search-button",onClick:d[4]||(d[4]=()=>u(r.value))},[pt(Hl,{class:"search-icon"})])])],64))}},vo=Ut(i0,[["__scopeId","data-v-e9f14ec0"]]),Pf={__name:"TwitchSearchBox",setup(e){const t=me(),n=async r=>{const s=Xt(Lf(r));return(await fetch(de,s).then(l=>l.json())).data.searchSuggestions.edges.map(l=>l.node).filter(l=>l.content)},i=r=>{var c,u,h;console.log(r);const s=(c=r==null?void 0:r.content)==null?void 0:c.login,a=(u=r==null?void 0:r.content)==null?void 0:u.isLive,o=(h=r==null?void 0:r.content)==null?void 0:h.boxArtURL,l=r==null?void 0:r.text;s&&a?t.push(`/hls/twitch/${s}`):s&&!a?t.push(`/twitch/${s}`):o&&l?t.push(`/twitch/directory-search-${l}`):console.log("normal query search, wip")};return(r,s)=>(it(),Yt(vo,{"get-query-suggestions":n,onQueryClick:i}))}};const te=e=>(Xe("data-v-ce0bc96c"),e=e(),Qe(),e),r0={class:"modal"},s0=te(()=>$("div",{class:"section"}," Chat ",-1)),a0={class:"row"},o0=te(()=>$("span",{class:"label"},"Show Chat",-1)),l0={class:"row"},c0=te(()=>$("span",{class:"label"},"Show Messages",-1)),u0={class:"row"},f0=te(()=>$("span",{class:"label"},"Show Badges",-1)),d0={class:"row"},h0=te(()=>$("span",{class:"label"},"Show Emotes",-1)),g0={class:"row"},v0=te(()=>$("span",{class:"label"},"Show Usernames",-1)),m0={class:"row"},p0=te(()=>$("span",{class:"label"},"Show Timestamps (vod only)",-1)),y0={class:"row"},E0=te(()=>$("span",{class:"label"},"Smooth Chat Flow",-1)),x0={class:"row"},b0=te(()=>$("span",{class:"label"},"Font Size",-1)),T0={class:"row"},_0=te(()=>$("span",{class:"label"},"Font Type",-1)),S0=te(()=>$("option",{value:"inherit"},"normal",-1)),L0=te(()=>$("option",{value:"monospace"},"monospace",-1)),D0=te(()=>$("option",{value:"cursive"},"cursive",-1)),A0=[S0,L0,D0],C0={class:"row"},M0=te(()=>$("span",{class:"label"},"Background Color",-1)),O0={class:"row"},P0=te(()=>$("span",{class:"label"},"Text Color",-1)),R0={class:"row"},I0=te(()=>$("span",{class:"label"},"Speed",-1)),w0=te(()=>$("span",{class:"info"},"1% - 100%",-1)),k0={__name:"StreamSettingsPage",props:["settings"],emits:["settingsUpdated","resetSettings"],setup(e,{emit:t}){const n=e,i=()=>t("settingsUpdated"),r=()=>t("resetSettings");return(s,a)=>(it(),lt("div",null,[$("div",r0,[s0,$("div",a0,[o0,zt($("input",{class:"input",type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=o=>n.settings.showChat=o)},null,512),[[Un,n.settings.showChat]])]),$("div",l0,[c0,zt($("input",{class:"input",type:"checkbox","onUpdate:modelValue":a[1]||(a[1]=o=>n.settings.showMessages=o)},null,512),[[Un,n.settings.showMessages]])]),$("div",u0,[f0,zt($("input",{class:"input",type:"checkbox","onUpdate:modelValue":a[2]||(a[2]=o=>n.settings.showBadges=o)},null,512),[[Un,n.settings.showBadges]])]),$("div",d0,[h0,zt($("input",{class:"input",type:"checkbox","onUpdate:modelValue":a[3]||(a[3]=o=>n.settings.showEmotes=o)},null,512),[[Un,n.settings.showEmotes]])]),$("div",g0,[v0,zt($("input",{class:"input",type:"checkbox","onUpdate:modelValue":a[4]||(a[4]=o=>n.settings.showUsernames=o)},null,512),[[Un,n.settings.showUsernames]])]),$("div",m0,[p0,zt($("input",{class:"input",type:"checkbox","onUpdate:modelValue":a[5]||(a[5]=o=>n.settings.showTimestamps=o)},null,512),[[Un,n.settings.showTimestamps]])]),$("div",y0,[E0,zt($("input",{class:"input",type:"checkbox","onUpdate:modelValue":a[6]||(a[6]=o=>n.settings.smoothChatFlow=o)},null,512),[[Un,n.settings.smoothChatFlow]])]),$("div",x0,[b0,zt($("input",{class:"input",type:"number",min:"2",max:"30","onUpdate:modelValue":a[7]||(a[7]=o=>n.settings.fontSize=o)},null,512),[[on,n.settings.fontSize]])]),$("div",T0,[_0,zt($("select",{class:"input","onUpdate:modelValue":a[8]||(a[8]=o=>n.settings.fontType=o)},A0,512),[[uf,n.settings.fontType]])]),$("div",C0,[M0,zt($("input",{class:"input",type:"color","onUpdate:modelValue":a[9]||(a[9]=o=>n.settings.chatBackground=o)},null,512),[[on,n.settings.chatBackground]])]),$("div",O0,[P0,zt($("input",{class:"input",type:"color","onUpdate:modelValue":a[10]||(a[10]=o=>n.settings.chatText=o)},null,512),[[on,n.settings.chatText]])]),$("div",R0,[I0,zt($("input",{class:"input",type:"number",min:"1",max:"100","onUpdate:modelValue":a[11]||(a[11]=o=>n.settings.chatSpeed=o)},null,512),[[on,n.settings.chatSpeed]])]),w0,$("div",{class:"row center"},[$("button",{class:"button",onClick:r},"Reset")])]),$("div",{class:"modal-outer",onClick:i})]))}},F0=Ut(k0,[["__scopeId","data-v-ce0bc96c"]]);const mo=e=>(Xe("data-v-d9f6aa0f"),e=e(),Qe(),e),B0={class:"modal"},N0={class:"section row"},U0=Ju('<option value="3" data-v-d9f6aa0f>Last 3 days</option><option value="7" data-v-d9f6aa0f>Last week</option><option value="14" data-v-d9f6aa0f>Last 2 weeks</option><option value="30" data-v-d9f6aa0f>Last month</option><option value="180" data-v-d9f6aa0f>Last 6 months</option><option value="365" data-v-d9f6aa0f>Last year</option>',6),W0=[U0],K0={class:"row"},H0=mo(()=>$("span",{class:"label"}," Average View Count ",-1)),j0={class:"row"},V0=mo(()=>$("span",{class:"label"}," Peak View Count ",-1)),$0={class:"row"},G0=mo(()=>$("span",{class:"label"}," Hours Streamed ",-1)),z0={__name:"LeaderboardModal",props:["channel"],emits:["closePage"],setup(e){const t=e,n=at({}),i=at(!0),r=at(14);return Pe(r,()=>{i.value=!0,fetch(Ie+`/twitchChannelViewsData/${t.channel}/${r.value}`).then(s=>s.json()).then(s=>{console.log(s),i.value=!1,n.value=s})},{immediate:!0}),(s,a)=>(it(),lt(Rt,null,[$("div",B0,[$("div",N0,[we(mt(t.channel),1),zt($("select",{class:"days-active","onUpdate:modelValue":a[0]||(a[0]=o=>r.value=o)},W0,512),[[uf,r.value]])]),$("div",K0,[H0,pt(gi,{name:"slide-fade",mode:"out-in"},{default:Qn(()=>[(it(),lt("span",{class:"answer",key:n.value.avgViews},mt(n.value.avgViews)+" "+mt(n.value.avgViewsRank&&`(${n.value.avgViewsRank})`),1))]),_:1})]),$("div",j0,[V0,pt(gi,{name:"slide-fade",mode:"out-in"},{default:Qn(()=>[(it(),lt("span",{class:"answer",key:n.value.peakViews},mt(n.value.peakViews)+" "+mt(n.value.peakViewsRank&&`(${n.value.peakViewsRank})`),1))]),_:1})]),$("div",$0,[G0,pt(gi,{name:"slide-fade",mode:"out-in"},{default:Qn(()=>[(it(),lt("span",{class:"answer",key:n.value.hoursStreamed},mt(n.value.hoursStreamed),1))]),_:1})])]),$("div",{class:"modal-outer",onClick:a[1]||(a[1]=o=>s.$emit("closePage"))})],64))}},Rf=Ut(z0,[["__scopeId","data-v-d9f6aa0f"]]);const Y0={id:"page-container"},X0={class:"video-and-chat-container"},Q0={class:"video-section"},J0={__name:"HlsView",setup(e){const t=Mi(),n=at(""),i=at(0),r=at(!1),s=at(!1),a=at([]),o=at(null),l=at(null),c=at(null),u=at(null),h=at(Object.assign({},Kl)),d=at("");he(()=>{t.params.twitchChannelName?(n.value=`https://twitch.tv/${t.params.twitchChannelName}`,y()):t.params.ytWatchId?(n.value=`https://youtube.com/watch?v=${t.params.ytWatchId}`,y()):t.params.twitchVodId&&(n.value=`https://twitch.tv/videos/${t.params.twitchVodId}`,y()),c.value.ontimeupdate=S,c.value.onseeked=L,document.addEventListener("keydown",g);const _=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(C,p,v,m,A){!p.includes(Ie)&&!p.includes(ym)?_.call(this,C,Ie+"/corsproxy/"+p,v,m,A):_.call(this,C,p,v,m,A)}}),Ci(()=>{document.removeEventListener("keydown",g),l.value&&l.value.destroy(),o.value&&o.value.close()}),Pe(()=>t.params,()=>{t.params.twitchChannelName?(n.value=`https://api.ttv.lol/playlist/${t.params.twitchChannelName}.m3u8%3Fallow_source%3Dtrue`,y("_bypass_")):t.params.ytWatchId?(n.value=`https://youtube.com/watch?v=${t.params.ytWatchId}`,y()):t.params.twitchVodId&&(n.value=`https://twitch.tv/videos/${t.params.twitchVodId}`,y())},{deep:!0});const y=async _=>{n.value||(n.value="https://www.twitch.tv/videos/1590984204");let C=_==="_bypass_"?n.value:await fetch(`${Ie}/twitch/getVodSource/${encodeURIComponent(n.value)}`).then(v=>v.text());const p=new xn({xhrSetup:v=>{v.setRequestHeader("x-donate-to","https://ttv.lol/donate")}});l.value=p,xn.isSupported()?(p.loadSource(C),p.attachMedia(c.value),p.on(xn.Events.ERROR,async(v,m)=>{console.log("Hls error"),console.log(v,m)}),p.on(xn.Events.MANIFEST_PARSED,()=>{c.value.play().catch(v=>{!c.value||(c.value.muted=!0,c.value.play())}),i.value=1})):c.value.canPlayType("application/vnd.apple.mpegurl")?(console.log("direct play"),c.value.src=ns(C),c.value.addEventListener("canplay",()=>{c.value.play(),i.value=1})):console.log("device unable to play stream"),t.params.twitchChannelName?x(t.params.twitchChannelName):t.params.twitchVodId&&D()},x=_=>{o.value&&(o.value.close(),u.value.clearAllChat());const C="wss://irc-ws.chat.twitch.tv/",p=new WebSocket(C);o.value=p;const v=Math.floor(Math.random()*99999);p.onopen=()=>{p.send("CAP REQ :twitch.tv/tags twitch.tv/commands"),p.send("PASS SCHMOOPIIE"),p.send(`NICK justinfan${v}`),p.send(`USER justinfan${v} 8 * :justinfan${v}`),p.send(`JOIN #${_}`)},p.onmessage=u.value.handleNewMessage},D=async()=>{var m,A,b;const _=t.params.twitchVodId;if(!_)return;const C=Math.floor(c.value.currentTime),p=Xt(Ul(_,C,null)),v=await fetch(de,p).then(T=>T.json());console.log("joining vod twitch chat: ",v),a.value=(b=(A=(m=v==null?void 0:v.data)==null?void 0:m.video)==null?void 0:A.comments)==null?void 0:b.edges},S=_=>{var p,v;if(!t.params.twitchVodId)return;const C=a.value[a.value.length-1];if(((p=C==null?void 0:C.node)==null?void 0:p.contentOffsetSeconds)<c.value.currentTime+5){const m=t.params.twitchVodId,A=Xt(Ul(m,null,C.cursor));fetch(de,A).then(b=>b.json()).then(b=>{var T,P,O;return a.value.push(...(O=(P=(T=b==null?void 0:b.data)==null?void 0:T.video)==null?void 0:P.comments)==null?void 0:O.edges)})}for(let m=0;m<a.value.length;m++){const A=a.value[m];if(((v=A==null?void 0:A.node)==null?void 0:v.contentOffsetSeconds)<c.value.currentTime)u.value.handleNewVodMessage({user:A.node.commenter.displayName,fragments:A.node.message.fragments,badges:A.node.message.userBadges,color:A.node.message.userColor,offset:A.node.contentOffsetSeconds}),a.value.shift();else break}},L=_=>{!t.params.twitchVodId||D()},g=_=>{var p;if(((p=_.target)==null?void 0:p.className)=="query-input")return;const C=_.key;C=="j"?c.value.currentTime-=10:C=="l"?c.value.currentTime+=10:C=="k"&&(c.value.paused?c.value.play():c.value.pause())},f=_=>{r.value=!1},E=()=>{h.value=Object.assign({},Kl)};return(_,C)=>(it(),lt("div",Y0,[ht(t).params.twitchChannelName||ht(t).params.twitchVodId?(it(),Yt(Pf,{key:0})):At("",!0),$("div",X0,[$("div",Q0,[$("video",{ref_key:"video",ref:c,class:"video-player",controls:"",autoplay:"",type:"application/x-mpegURL"},null,512),ht(t).params.twitchChannelName?(it(),Yt(Dp,{channel:ht(t).params.twitchChannelName,key:ht(t).params.twitchChannelName,onSettingsClick:C[0]||(C[0]=p=>r.value=!0),onLeaderboardClick:C[1]||(C[1]=p=>s.value=!0),onSetId:C[2]||(C[2]=p=>d.value=p)},null,8,["channel"])):ht(t).params.twitchVodId?(it(),Yt(Np,{vodId:ht(t).params.twitchVodId,key:ht(t).params.twitchVodId,onSettingsClick:C[3]||(C[3]=p=>r.value=!0),onLeaderboardClick:C[4]||(C[4]=p=>s.value=!0),onSetId:C[5]||(C[5]=p=>d.value=p)},null,8,["vodId"])):At("",!0)]),pt(Mf,{ref_key:"chatbox",ref:u,channel:ht(t).params.twitchChannelName,channelId:d.value,settings:h.value},null,8,["channel","channelId","settings"]),r.value?(it(),Yt(F0,{key:0,settings:h.value,onSettingsUpdated:f,onResetSettings:E},null,8,["settings"])):s.value?(it(),Yt(Rf,{key:1,channel:ht(t).params.twitchChannelName,onClosePage:C[6]||(C[6]=p=>s.value=!1)},null,8,["channel"])):At("",!0)])]))}},Z0=Ut(J0,[["__scopeId","data-v-a78200f3"]]);const q0=["onClick"],ty={class:"view-count"},ey={class:"mobile-bar-info"},ny={class:"rotation-wrapper-outer"},iy={class:"rotation-wrapper-inner"},ry=["height"],sy={class:"bar-tooltip"},ay={class:"tooltip-displayname"},oy=["src"],ly={__name:"LeaderboardChart",props:{liveChannelsList:Array,numShown:Number},setup(e){const t=e,n=me(),i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=Math.min(500,i-70),s=at(null),a=at([]),o=at([]),l=async(u=0)=>{if(!(!a.value.length||u==20)){if(!o.value.length)return setTimeout(()=>l(u+1),250);for(const h of o.value.reverse()){const d=h.getAttribute("height");h.style.height=`${d}px`,await new Promise(y=>setTimeout(y,75))}}};Pe(()=>t.liveChannelsList,()=>{console.log(t.liveChannelsList,t.numShown),t.liveChannelsList.length&&(s.value=t.liveChannelsList[0].node.viewersCount,a.value=t.liveChannelsList.slice(0,t.numShown).map(u=>({viewersCount:u.node.viewersCount,title:u.node.title,profileImage:u.node.broadcaster.profileImageURL,channelLogin:u.node.broadcaster.login,displayName:u.node.broadcaster.displayName,length:u.node.viewersCount/s.value*r})),l())},{immediate:!0});const c=u=>{console.log(u);for(let h=0;h<o.value.length;h++){const d=o.value[h].getBoundingClientRect();if(console.log(d,a.value[h].channelLogin),u.y>d.y&&u.y<d.y+d.height&&u.x>d.x&&u.x<d.x+d.width)return n.push(`/hls/twitch/${a.value[a.value.length-h-1].channelLogin}`)}};return(u,h)=>(it(),lt("div",{class:"channels-container",onClick:c},[(it(!0),lt(Rt,null,ze(a.value,d=>(it(),lt("div",{class:"channel-each",onClick:y=>ht(n).push(`/hls/twitch/${d.channelLogin}`)},[$("div",ty,[we(mt(ht(De)(d.viewersCount))+"\xA0 ",1),$("span",ey,mt(d.displayName),1)]),$("div",ny,[$("div",iy,[$("div",{class:"bar-each",ref_for:!0,ref_key:"barElements",ref:o,height:d.length},[$("div",sy,[$("div",ay,mt(d.displayName),1),we(" "+mt(d.title),1)])],8,ry)])]),$("img",{class:"profile-image",src:d.profileImage},null,8,oy)],8,q0))),256))]))}},cy=Ut(ly,[["__scopeId","data-v-b8e15dd1"]]);const uy=["onClick"],fy={class:"view-count"},dy={class:"mobile-bar-info"},hy={class:"rotation-wrapper-outer"},gy={class:"rotation-wrapper-inner"},vy=["height"],my={class:"bar-tooltip"},py={class:"tooltip-displayname"},yy=["src"],Ey={__name:"DirectoryLeaderboardChart",props:{curDirectoryList:Array,numShown:Number},setup(e){const t=e,n=me(),i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=Math.min(500,i-70),s=at(null),a=at([]),o=at([]),l=async(u=0)=>{if(!(!a.value.length||u==20)){if(!o.value.length)return setTimeout(()=>l(u+1),250);for(const h of o.value.reverse()){const d=h.getAttribute("height");h.style.height=`${d}px`,await new Promise(y=>setTimeout(y,75))}}};Pe(()=>t.curDirectoryList,()=>{console.log(t.curDirectoryList),t.curDirectoryList.length&&(s.value=t.curDirectoryList[0].node.viewersCount,a.value=t.curDirectoryList.slice(0,t.numShown).map(u=>({viewersCount:u.node.viewersCount,title:u.node.name,directoryImage:u.node.avatarURL,length:u.node.viewersCount/s.value*r})),l())},{immediate:!0});const c=u=>{console.log(u);for(let h=0;h<o.value.length;h++){const d=o.value[h].getBoundingClientRect();if(console.log(d,a.value[h].title),u.y>d.y&&u.y<d.y+d.height&&u.x>d.x&&u.x<d.x+d.width)return n.push(`twitch/directory-search-${a.value[a.value.length-h-1].title}`)}};return(u,h)=>(it(),lt("div",{class:"channels-container",onClick:c},[(it(!0),lt(Rt,null,ze(a.value,d=>(it(),lt("div",{class:"channel-each",onClick:y=>ht(n).push(`/twitch/directory-search-${d.title}`)},[$("div",fy,[we(mt(ht(De)(d.viewersCount))+"\xA0 ",1),$("span",dy,mt(d.title),1)]),$("div",hy,[$("div",gy,[$("div",{class:"bar-each",ref_for:!0,ref_key:"barElements",ref:o,height:d.length},[$("div",my,[$("div",py,mt(d.title),1)])],8,vy)])]),$("img",{class:"profile-image",src:d.directoryImage},null,8,yy)],8,uy))),256))]))}},xy=Ut(Ey,[["__scopeId","data-v-55941406"]]);const by={class:"home-view"},Ty={class:"route-buttons"},_y={class:"route-buttons"},Sy={__name:"HomeView",setup(e){const t="https://gql.twitch.tv/gql",n=me(),i=at([]),r=at([]),s=at(!0),a=at(10);return he(async()=>{var h,d;const o=Xt(Sf()),l=await fetch(t,o).then(y=>y.json());i.value=l.data.streams.edges,console.log(i.value);const c=Xt(Cm()),u=await fetch(t,c).then(y=>y.json());r.value=(d=(h=u==null?void 0:u.data)==null?void 0:h.directoriesWithTags)==null?void 0:d.edges,console.log(u)}),(o,l)=>(it(),lt(Rt,null,[pt(Pf),$("div",by,[$("div",Ty,[$("button",{onClick:l[0]||(l[0]=c=>s.value=!0),class:"change-leaderboard-type",style:Dn(s.value&&"color: #a970ff;")}," Channels ",4),$("button",{onClick:l[1]||(l[1]=c=>s.value=!1),class:"change-leaderboard-type",style:Dn(!s.value&&"color: #a970ff;")}," Categories ",4)]),s.value?(it(),Yt(cy,{key:0,liveChannelsList:i.value,numShown:a.value},null,8,["liveChannelsList","numShown"])):(it(),Yt(xy,{key:1,curDirectoryList:r.value,numShown:a.value},null,8,["curDirectoryList","numShown"])),$("div",_y,[$("button",{onClick:l[2]||(l[2]=c=>ht(n).push("/twitch")),class:"twitch-route"}," All Channels ")])])],64))}},If="/assets/live-stream-thumbnail.09efb82b.png";const Ly=e=>(Xe("data-v-68d2a889"),e=e(),Qe(),e),Dy={class:"live-channel-each"},Ay={class:"thumbnail-holder"},Cy=["src"],My=["src"],Oy={key:2,class:"live-message-holder"},Py=Ly(()=>$("div",{class:"live-message"}," LIVE ",-1)),Ry=[Py],Iy={class:"viewer-count-holder"},wy={class:"viewer-count"},ky={key:3,class:"vod-length"},Fy={key:4,class:"vod-upload"},By={class:"channel-lower-info"},Ny=["src"],Uy={class:"channel-info-container"},Wy={__name:"StreamCard",props:{thumbnail:String,title:String,viewCount:String,channelLogo:String,channelName:String,route:String,byRoute:{type:String,default:""},live:{type:Boolean,default:!0},vodLength:{type:String,default:""},vodUploadTimeAgo:{type:String,default:""}},setup(e){const t=e,n=me();return(i,r)=>(it(),lt("div",Dy,[$("div",Ay,[t.thumbnail!=="https://vod-secure.twitch.tv/_404/404_processing_320x180.png"?(it(),lt("img",{key:0,class:"channel-thumbnail",src:t.thumbnail,onClick:r[0]||(r[0]=s=>ht(n).push(t.route))},null,8,Cy)):(it(),lt("img",{key:1,class:"channel-thumbnail",src:ht(If),onClick:r[1]||(r[1]=s=>ht(n).push(t.route))},null,8,My)),t.live?(it(),lt("div",Oy,Ry)):At("",!0),$("div",Iy,[$("div",wy,mt(t.viewCount||"0 watching"),1)]),t.vodLength?(it(),lt("div",ky,mt(t.vodLength),1)):At("",!0),t.vodUploadTimeAgo?(it(),lt("div",Fy,mt(t.vodUploadTimeAgo),1)):At("",!0)]),$("div",By,[$("img",{class:"channel-logo",src:t.channelLogo,onClick:r[2]||(r[2]=s=>ht(n).push(t.route))},null,8,Ny),$("div",Uy,[$("div",{class:"channel-title",onClick:r[3]||(r[3]=s=>ht(n).push(t.route))},mt(t.title),1),$("div",{class:"channel-by",onClick:r[4]||(r[4]=s=>ht(n).push(t.byRoute||t.route))},mt(t.channelName),1)])])]))}},Yr=Ut(Wy,[["__scopeId","data-v-68d2a889"]]);const Ky={},Hy={class:"placeholder-empty-card"};function jy(e,t){return it(),lt("div",Hy)}const wf=Ut(Ky,[["render",jy],["__scopeId","data-v-9eca3e80"]]);const Vy={},$y={class:"container"},Gy=Ju('<div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div>',16),zy=[Gy];function Yy(e,t){return it(),lt("div",$y,zy)}const po=Ut(Vy,[["render",Yy],["__scopeId","data-v-b86efe59"]]),Xy={},Qy={width:"100%",height:"100%",version:"1.1",viewBox:"0 0 20 20",x:"0px",y:"0px",class:"cancel-icon"},Jy=$("g",null,[$("path",{d:"M8.5 10L4 5.5 5.5 4 10 8.5 14.5 4 16 5.5 11.5 10l4.5 4.5-1.5 1.5-4.5-4.5L5.5 16 4 14.5 8.5 10z"})],-1),Zy=[Jy];function qy(e,t){return it(),lt("svg",Qy,Zy)}const tE=Ut(Xy,[["render",qy]]);const eE={class:"search-space"},nE={key:0,class:"card-message"},iE={key:1,class:"channel-options-row"},rE={class:"live-channels-container"},sE={key:3,class:"card-message"},aE={__name:"TwitchView",setup(e){const t=me(),n=Mi(),i=at([]),r=at(""),s=at(!0),a=at(!1),o=at(null),l=at(!1),c=at(!1);he(()=>{window.addEventListener("scroll",x)}),Ci(()=>{window.removeEventListener("scroll",x)});const u=async(D=null)=>{if(a.value)return;s.value=!0;let S=null;D&&D.startsWith("directory-search-")?S=Xt(Am(D.split("directory-search-")[1])):D?S=Xt(Df(D,r.value)):S=Xt(Sf(r.value));const L=await fetch(de,S).then(g=>g.json());console.log(L),D&&D.startsWith("directory-search-")?i.value.push(...L.data.game.streams.edges):D?i.value.push(...L.data.user.videos.edges):i.value.push(...L.data.streams.edges),i.value.length?r.value=i.value[i.value.length-1].cursor:a.value=!0,r.value==null&&(a.value=!0),console.log(i.value),s.value=!1},h=async D=>{const S=Xt(Lf(D)),g=(await fetch(de,S).then(f=>f.json())).data.searchSuggestions.edges.map(f=>f.node);return console.log(g),g},d=async D=>{var f,E,_,C,p,v,m,A,b,T;if(console.log(D),!D)return;const S=[Af(D),Cf(D)],L=Xt(S),g=await fetch(de,L).then(P=>P.json());!((E=(f=g[0].data)==null?void 0:f.userOrError)!=null&&E.stream)||(o.value={viewers:(p=(C=(_=g[0].data)==null?void 0:_.userOrError)==null?void 0:C.stream)==null?void 0:p.viewersCount,title:(A=(m=(v=g[1].data)==null?void 0:v.user)==null?void 0:m.broadcastSettings)==null?void 0:A.title,pfp:(T=(b=g[0].data)==null?void 0:b.userOrError)==null?void 0:T.profileImageURL,login:D})};Pe(()=>{var D;return(D=n.params)==null?void 0:D.twitchChannelName},async(D,S)=>{var L;console.log("channel: ",D,(L=n.params)==null?void 0:L.twitchChannelName),i.value=[],r.value="",a.value=!1,o.value=null,l.value=!n.params.twitchChannelName||n.params.twitchChannelName.startsWith("directory-search-"),u(D),d(D)},{immediate:!0});const y=D=>{var E,_,C;console.log(D);const S=(E=D==null?void 0:D.content)==null?void 0:E.login,L=(_=D==null?void 0:D.content)==null?void 0:_.isLive,g=(C=D==null?void 0:D.content)==null?void 0:C.boxArtURL,f=D==null?void 0:D.text;S&&L?t.push(`/hls/twitch/${S}`):S&&!L?t.push(`/twitch/${S}`):g&&f?t.push(`/twitch/directory-search-${f}`):console.log("normal query search, wip")},x=()=>{var g;const D=document.height||document.body.offsetHeight,S=window.scrollY+(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight);D-S<500&&!s.value&&u((g=n.params)==null?void 0:g.twitchChannelName)};return(D,S)=>{var L;return it(),lt(Rt,null,[$("div",eE,[pt(vo,{"get-query-suggestions":h,onQueryClick:y})]),s.value?(it(),lt("div",nE,[pt(po)])):l.value?(L=ht(n).params)!=null&&L.twitchChannelName?(it(),lt("div",{key:2,class:"category-display",onClick:S[3]||(S[3]=g=>ht(t).push("/twitch"))},[we(" Category: "+mt(ht(n).params.twitchChannelName.split("directory-search-")[1])+" ",1),pt(tE,{class:"icon-cancel"})])):At("",!0):(it(),lt("div",iE,[pt(go,{onClick:S[0]||(S[0]=g=>c.value=!0),class:"analyze-icon"}),$("div",{class:"analyze-option",onClick:S[1]||(S[1]=g=>ht(t).push(`/twitch/${ht(n).params.twitchChannelName}/analyze`))}," Analyze Vods "),$("div",{class:"analyze-option",onClick:S[2]||(S[2]=g=>ht(t).push(`/twitch/${ht(n).params.twitchChannelName}/clips`))}," Top Clips ")])),$("div",rE,[l.value?(it(!0),lt(Rt,{key:0},ze(i.value,g=>{var f,E;return it(),Yt(Yr,{key:g.cursor,thumbnail:g.node.previewImageURL,title:g.node.title,"view-count":ht(De)(g.node.viewersCount)+" watching","channel-logo":(f=g.node.broadcaster)==null?void 0:f.profileImageURL,"channel-name":(E=g.node.broadcaster)==null?void 0:E.displayName,route:`/hls/twitch/${g.node.broadcaster.login}`,"by-route":`/twitch/${g.node.broadcaster.login}`},null,8,["thumbnail","title","view-count","channel-logo","channel-name","route","by-route"])}),128)):o.value?(it(),Yt(Yr,{key:o.value.login,thumbnail:ht(If),title:o.value.title,"view-count":ht(De)(o.value.viewers)+" watching","channel-logo":o.value.pfp,"channel-name":o.value.login,route:`/hls/twitch/${o.value.login}`,"by-route":`/hls/twitch/${o.value.login}`},null,8,["thumbnail","title","view-count","channel-logo","channel-name","route","by-route"])):At("",!0),l.value?At("",!0):(it(!0),lt(Rt,{key:2},ze(i.value,g=>{var f,E;return it(),Yt(Yr,{key:g.node.id,thumbnail:g.node.previewThumbnailURL,title:g.node.title,"view-count":ht(De)(g.node.viewCount)+" views","channel-logo":(f=g.node.owner)==null?void 0:f.profileImageURL,"channel-name":(E=g.node.owner)==null?void 0:E.displayName,route:`/hls/twitchvod/${g.node.id}`,live:!1,"vod-length":ht(uo)(g.node.lengthSeconds),"vod-upload-time-ago":ht(fo)(g.node.publishedAt)},null,8,["thumbnail","title","view-count","channel-logo","channel-name","route","vod-length","vod-upload-time-ago"])}),128)),(it(),lt(Rt,null,ze(5,g=>pt(wf,{key:g})),64))]),a.value?(it(),lt("div",sE," No more results found ")):At("",!0),c.value?(it(),Yt(Rf,{key:4,channel:ht(n).params.twitchChannelName,onClosePage:S[4]||(S[4]=g=>c.value=!1)},null,8,["channel"])):At("",!0)],64)}}},oE=e=>({headers:{"Content-Type":"application/json"},body:JSON.stringify(e),method:"POST"}),lE="https://www.youtube.com/youtubei/v1/search?key=AIzaSyAO_FJ2SlqU8Q4STEHLGCilw_Y9_11qcW8&prettyPrint=false",cE=e=>`https://suggestqueries-clients6.youtube.com/complete/search?client=youtube&q=${e}`,uE=e=>({context:{client:{hl:"en",gl:"US",clientName:"ANDROID",clientVersion:"16.02"}},query:e,params:"CAMSAkAB"});const fE={class:"live-channels-container"},dE={key:0,class:"no-results"},hE={__name:"YoutubeLiveView",setup(e){me();const t=at([]),n=async a=>{console.log(a);const o=oE(uE(a)),l=await fetch(ns(lE),o).then(u=>u.json()),c=[];for(const u of l.contents.sectionListRenderer.contents)for(const h of u.itemSectionRenderer.contents)h.compactVideoRenderer&&c.push(h.compactVideoRenderer);t.value=c,console.log(t.value)};he(n);const i=async a=>{const o=ns(cE(a)),l=await fetch(o).then(u=>u.text()),c=JSON.parse(l.split("window.google.ac.h(")[1].slice(0,-1))[1].map(u=>({text:u[0]}));return console.log(c),c},r=a=>a[1]||a[0],s=a=>a?a.map(o=>o.text).join(""):"";return(a,o)=>(it(),lt(Rt,null,[pt(vo,{"get-query-suggestions":i,onQueryClick:n}),$("div",fE,[(it(!0),lt(Rt,null,ze(t.value,l=>{var c,u;return it(),Yt(Yr,{key:l.videoId,thumbnail:(c=r(l.thumbnail.thumbnails))==null?void 0:c.url,title:s(l.title.runs),"view-count":s((u=l.shortViewCountText)==null?void 0:u.runs)||"0 watching","channel-logo":l.channelThumbnail.thumbnails[0].url,"channel-name":s(l.longBylineText.runs),route:`/hls/yt/${l.videoId}`},null,8,["thumbnail","title","view-count","channel-logo","channel-name","route"])}),128)),(it(),lt(Rt,null,ze(5,l=>pt(wf,{key:l})),64)),t.value.length?At("",!0):(it(),lt("div",dE," No results "))])],64))}},gE=Ut(hE,[["__scopeId","data-v-135ed4c7"]]);const vE=e=>(Xe("data-v-0e2225d9"),e=e(),Qe(),e),mE={id:"page-container"},pE={class:"search-row"},yE={key:0,class:"search-row"},EE=["controls"],xE=vE(()=>$("div",{id:"crop-mask"},null,-1)),bE={__name:"OverrideSourceView",setup(e){Mi();const t=at(""),n=at(""),i=at(0),r=at({}),s=at(""),a=at(null),o=at(null),l=at(null),c=at(null);he(()=>{const L=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(g,f,E,_,C){console.log("cors proxy check: ",f),!f.includes(Ie)&&!f.includes(t.value)?L.call(this,g,Ie+"/corsproxy/"+encodeURIComponent(f),E,_,C):L.call(this,g,f,E,_,C)}});const u=async()=>{t.value||(t.value="https://www.twitch.tv/videos/1590984204");const L=t.value.includes("twitch.tv")&&!t.value.includes("twitch.tv/videos"),g=new xn({xhrSetup:f=>{f.setRequestHeader("x-donate-to","https://ttv.lol/donate")}});g.loadSource(t.value),g.attachMedia(a.value),g.on(xn.Events.MANIFEST_PARSED,()=>{a.value.play(),i.value=1}),L&&y(t.value)},h=async()=>{n.value||(n.value="https://www.twitch.tv/videos/1590984204");const L=await fetch(`${Ie}/twitch/getVodSource/${encodeURIComponent(n.value)}`).then(f=>f.text()),g=new xn;g.loadSource(L),g.attachMedia(o.value),g.on(xn.Events.MANIFEST_PARSED,()=>{o.value.play(),i.value=2})},d=L=>{r.value.complete||(r.value.startX=L.clientX+window.scrollX,r.value.startY=L.clientY+window.scrollY,r.value.active=!0)},y=L=>{const g="wss://irc-ws.chat.twitch.tv/",f=new WebSocket(g),E=Math.floor(Math.random()*99999),_=L.split("twitch.tv/")[1];f.onopen=()=>{f.send("CAP REQ :twitch.tv/tags twitch.tv/commands"),f.send("PASS SCHMOOPIIE"),f.send(`NICK justinfan${E}`),f.send(`USER justinfan${E} 8 * :justinfan${E}`),f.send(`JOIN #${_}`),s.value=_},f.onmessage=c.value.handleNewMessage},x=L=>{if(!r.value.active||r.value.complete)return;r.value.endX=L.clientX+window.scrollX,r.value.endY=L.clientY+window.scrollY;const g=document.getElementById("crop-mask");g.style.top=Math.min(r.value.startY,r.value.endY)+"px",g.style.left=Math.min(r.value.startX,r.value.endX)+"px",g.style.height=Math.abs(r.value.endY-r.value.startY)+"px",g.style.width=Math.abs(r.value.endX-r.value.startX)+"px",g.style.display="initial"},D=L=>{if(!r.value.active||r.value.complete)return;r.value.complete=!0,r.value.endX=L.clientX+window.scrollX,r.value.endY=L.clientY+window.scrollY,console.log(r.value.startX,r.value.startY,r.value.endX,r.value.endY);const[g,f,E,_]=[r.value.startX,r.value.startY,r.value.endX,r.value.endY];l.value.width=Math.abs(g-E),l.value.height=Math.abs(f-_),l.value.style.width=Math.abs(g-E)+"px",l.value.style.height=Math.abs(f-_)+"px",o.value.style.left=o.value.getBoundingClientRect().x+window.scrollX+"px",o.value.style.top=o.value.getBoundingClientRect().y+window.scrollY+"px",o.value.style.position="absolute",o.value.style.opacity=0,S()},S=()=>{const L=l.value.getContext("2d"),{x:g,y:f,width:E,height:_}=o.value.getBoundingClientRect(),C=(Math.min(r.value.startX,r.value.endX)-g-window.scrollX)*o.value.videoWidth/E,p=(Math.min(r.value.startY,r.value.endY)-f-window.scrollY)*o.value.videoHeight/_,v=l.value.width*o.value.videoWidth/E,m=l.value.height*o.value.videoHeight/_;L.drawImage(o.value,C,p,v,m,0,0,l.value.width,l.value.height),setTimeout(S,0)};return(L,g)=>(it(),lt("div",mE,[$("div",pE,[zt($("input",{"onUpdate:modelValue":g[0]||(g[0]=f=>t.value=f),placeholder:"enter vod link"},null,512),[[on,t.value]]),$("button",{onClick:u},"Go")]),pt(Mf,{ref_key:"chatbox",ref:c,channel:s.value},null,8,["channel"]),i.value==1?(it(),lt("div",yE,[zt($("input",{"onUpdate:modelValue":g[1]||(g[1]=f=>n.value=f),placeholder:"enter second view vod link"},null,512),[[on,n.value]]),$("button",{onClick:h},"Add Second View")])):At("",!0),$("video",{ref_key:"video",ref:a,class:"video-player",controls:"",autoplay:"",type:"video/mget"},null,512),i.value>0?(it(),lt("video",{key:1,ref_key:"videoTwo",ref:o,class:"video-player",controls:!r.value.active&&!r.value.complete,autoplay:"",ype:"video/mget",onMousedown:d,onMousemove:x,onMouseup:D},null,40,EE)):At("",!0),$("canvas",{id:"cx",ref_key:"canvas",ref:l,width:"0",height:"0"},null,512),xE]))}},TE=Ut(bE,[["__scopeId","data-v-0e2225d9"]]);/*!
 * Chart.js v3.9.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */function tn(){}const _E=function(){let e=0;return function(){return e++}}();function Ct(e){return e===null||typeof e>"u"}function Nt(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function _t(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}const $t=e=>(typeof e=="number"||e instanceof Number)&&isFinite(+e);function Ee(e,t){return $t(e)?e:t}function xt(e,t){return typeof e>"u"?t:e}const SE=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:e/t,kf=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Bt(e,t,n){if(e&&typeof e.call=="function")return e.apply(n,t)}function Pt(e,t,n,i){let r,s,a;if(Nt(e))if(s=e.length,i)for(r=s-1;r>=0;r--)t.call(n,e[r],r);else for(r=0;r<s;r++)t.call(n,e[r],r);else if(_t(e))for(a=Object.keys(e),s=a.length,r=0;r<s;r++)t.call(n,e[a[r]],a[r])}function is(e,t){let n,i,r,s;if(!e||!t||e.length!==t.length)return!1;for(n=0,i=e.length;n<i;++n)if(r=e[n],s=t[n],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function rs(e){if(Nt(e))return e.map(rs);if(_t(e)){const t=Object.create(null),n=Object.keys(e),i=n.length;let r=0;for(;r<i;++r)t[n[r]]=rs(e[n[r]]);return t}return e}function Ff(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function LE(e,t,n,i){if(!Ff(e))return;const r=t[e],s=n[e];_t(r)&&_t(s)?fr(r,s,i):t[e]=rs(s)}function fr(e,t,n){const i=Nt(t)?t:[t],r=i.length;if(!_t(e))return e;n=n||{};const s=n.merger||LE;for(let a=0;a<r;++a){if(t=i[a],!_t(t))continue;const o=Object.keys(t);for(let l=0,c=o.length;l<c;++l)s(o[l],e,t,n)}return e}function Yi(e,t){return fr(e,t,{merger:DE})}function DE(e,t,n){if(!Ff(e))return;const i=t[e],r=n[e];_t(i)&&_t(r)?Yi(i,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=rs(r))}const jl={"":e=>e,x:e=>e.x,y:e=>e.y};function Mn(e,t){return(jl[t]||(jl[t]=AE(t)))(e)}function AE(e){const t=CE(e);return n=>{for(const i of t){if(i==="")break;n=n&&n[i]}return n}}function CE(e){const t=e.split("."),n=[];let i="";for(const r of t)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(n.push(i),i="");return n}function yo(e){return e.charAt(0).toUpperCase()+e.slice(1)}const _e=e=>typeof e<"u",On=e=>typeof e=="function",Vl=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};function ME(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const Kt=Math.PI,wt=2*Kt,OE=wt+Kt,ss=Number.POSITIVE_INFINITY,PE=Kt/180,Vt=Kt/2,ki=Kt/4,$l=Kt*2/3,be=Math.log10,Ye=Math.sign;function Gl(e){const t=Math.round(e);e=Xi(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(be(e))),i=e/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function RE(e){const t=[],n=Math.sqrt(e);let i;for(i=1;i<n;i++)e%i===0&&(t.push(i),t.push(e/i));return n===(n|0)&&t.push(n),t.sort((r,s)=>r-s).pop(),t}function Ti(e){return!isNaN(parseFloat(e))&&isFinite(e)}function Xi(e,t,n){return Math.abs(e-t)<n}function IE(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function Bf(e,t,n){let i,r,s;for(i=0,r=e.length;i<r;i++)s=e[i][n],isNaN(s)||(t.min=Math.min(t.min,s),t.max=Math.max(t.max,s))}function Me(e){return e*(Kt/180)}function Eo(e){return e*(180/Kt)}function zl(e){if(!$t(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function Nf(e,t){const n=t.x-e.x,i=t.y-e.y,r=Math.sqrt(n*n+i*i);let s=Math.atan2(i,n);return s<-.5*Kt&&(s+=wt),{angle:s,distance:r}}function Aa(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function wE(e,t){return(e-t+OE)%wt-Kt}function ge(e){return(e%wt+wt)%wt}function dr(e,t,n,i){const r=ge(e),s=ge(t),a=ge(n),o=ge(s-r),l=ge(a-r),c=ge(r-s),u=ge(r-a);return r===s||r===a||i&&s===a||o>l&&c<u}function Qt(e,t,n){return Math.max(t,Math.min(n,e))}function kE(e){return Qt(e,-32768,32767)}function ln(e,t,n,i=1e-6){return e>=Math.min(t,n)-i&&e<=Math.max(t,n)+i}function xo(e,t,n){n=n||(a=>e[a]<t);let i=e.length-1,r=0,s;for(;i-r>1;)s=r+i>>1,n(s)?r=s:i=s;return{lo:r,hi:i}}const cn=(e,t,n,i)=>xo(e,n,i?r=>e[r][t]<=n:r=>e[r][t]<n),FE=(e,t,n)=>xo(e,n,i=>e[i][t]>=n);function BE(e,t,n){let i=0,r=e.length;for(;i<r&&e[i]<t;)i++;for(;r>i&&e[r-1]>n;)r--;return i>0||r<e.length?e.slice(i,r):e}const Uf=["push","pop","shift","splice","unshift"];function NE(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),Uf.forEach(n=>{const i="_onData"+yo(n),r=e[n];Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value(...s){const a=r.apply(this,s);return e._chartjs.listeners.forEach(o=>{typeof o[i]=="function"&&o[i](...s)}),a}})})}function Yl(e,t){const n=e._chartjs;if(!n)return;const i=n.listeners,r=i.indexOf(t);r!==-1&&i.splice(r,1),!(i.length>0)&&(Uf.forEach(s=>{delete e[s]}),delete e._chartjs)}function Wf(e){const t=new Set;let n,i;for(n=0,i=e.length;n<i;++n)t.add(e[n]);return t.size===i?e:Array.from(t)}const Kf=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function Hf(e,t,n){const i=n||(a=>Array.prototype.slice.call(a));let r=!1,s=[];return function(...a){s=i(a),r||(r=!0,Kf.call(window,()=>{r=!1,e.apply(t,s)}))}}function UE(e,t){let n;return function(...i){return t?(clearTimeout(n),n=setTimeout(e,t,i)):e.apply(this,i),t}}const bo=e=>e==="start"?"left":e==="end"?"right":"center",ie=(e,t,n)=>e==="start"?t:e==="end"?n:(t+n)/2,WE=(e,t,n,i)=>e===(i?"left":"right")?n:e==="center"?(t+n)/2:t;function jf(e,t,n){const i=t.length;let r=0,s=i;if(e._sorted){const{iScale:a,_parsed:o}=e,l=a.axis,{min:c,max:u,minDefined:h,maxDefined:d}=a.getUserBounds();h&&(r=Qt(Math.min(cn(o,a.axis,c).lo,n?i:cn(t,l,a.getPixelForValue(c)).lo),0,i-1)),d?s=Qt(Math.max(cn(o,a.axis,u,!0).hi+1,n?0:cn(t,l,a.getPixelForValue(u),!0).hi+1),r,i)-r:s=i-r}return{start:r,count:s}}function Vf(e){const{xScale:t,yScale:n,_scaleRanges:i}=e,r={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!i)return e._scaleRanges=r,!0;const s=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,r),s}const Or=e=>e===0||e===1,Xl=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*wt/n)),Ql=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*wt/n)+1,Qi={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*Vt)+1,easeOutSine:e=>Math.sin(e*Vt),easeInOutSine:e=>-.5*(Math.cos(Kt*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>Or(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>Or(e)?e:Xl(e,.075,.3),easeOutElastic:e=>Or(e)?e:Ql(e,.075,.3),easeInOutElastic(e){return Or(e)?e:e<.5?.5*Xl(e*2,.1125,.45):.5+.5*Ql(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-Qi.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?Qi.easeInBounce(e*2)*.5:Qi.easeOutBounce(e*2-1)*.5+.5};/*!
 * @kurkle/color v0.2.1
 * https://github.com/kurkle/color#readme
 * (c) 2022 Jukka Kurkela
 * Released under the MIT License
 */function Er(e){return e+.5|0}const bn=(e,t,n)=>Math.max(Math.min(e,n),t);function Hi(e){return bn(Er(e*2.55),0,255)}function Ln(e){return bn(Er(e*255),0,255)}function an(e){return bn(Er(e/2.55)/100,0,1)}function Jl(e){return bn(Er(e*100),0,100)}const ye={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Ca=[..."0123456789ABCDEF"],KE=e=>Ca[e&15],HE=e=>Ca[(e&240)>>4]+Ca[e&15],Pr=e=>(e&240)>>4===(e&15),jE=e=>Pr(e.r)&&Pr(e.g)&&Pr(e.b)&&Pr(e.a);function VE(e){var t=e.length,n;return e[0]==="#"&&(t===4||t===5?n={r:255&ye[e[1]]*17,g:255&ye[e[2]]*17,b:255&ye[e[3]]*17,a:t===5?ye[e[4]]*17:255}:(t===7||t===9)&&(n={r:ye[e[1]]<<4|ye[e[2]],g:ye[e[3]]<<4|ye[e[4]],b:ye[e[5]]<<4|ye[e[6]],a:t===9?ye[e[7]]<<4|ye[e[8]]:255})),n}const $E=(e,t)=>e<255?t(e):"";function GE(e){var t=jE(e)?KE:HE;return e?"#"+t(e.r)+t(e.g)+t(e.b)+$E(e.a,t):void 0}const zE=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function $f(e,t,n){const i=t*Math.min(n,1-n),r=(s,a=(s+e/30)%12)=>n-i*Math.max(Math.min(a-3,9-a,1),-1);return[r(0),r(8),r(4)]}function YE(e,t,n){const i=(r,s=(r+e/60)%6)=>n-n*t*Math.max(Math.min(s,4-s,1),0);return[i(5),i(3),i(1)]}function XE(e,t,n){const i=$f(e,1,.5);let r;for(t+n>1&&(r=1/(t+n),t*=r,n*=r),r=0;r<3;r++)i[r]*=1-t-n,i[r]+=t;return i}function QE(e,t,n,i,r){return e===r?(t-n)/i+(t<n?6:0):t===r?(n-e)/i+2:(e-t)/i+4}function To(e){const n=e.r/255,i=e.g/255,r=e.b/255,s=Math.max(n,i,r),a=Math.min(n,i,r),o=(s+a)/2;let l,c,u;return s!==a&&(u=s-a,c=o>.5?u/(2-s-a):u/(s+a),l=QE(n,i,r,u,s),l=l*60+.5),[l|0,c||0,o]}function _o(e,t,n,i){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,i)).map(Ln)}function So(e,t,n){return _o($f,e,t,n)}function JE(e,t,n){return _o(XE,e,t,n)}function ZE(e,t,n){return _o(YE,e,t,n)}function Gf(e){return(e%360+360)%360}function qE(e){const t=zE.exec(e);let n=255,i;if(!t)return;t[5]!==i&&(n=t[6]?Hi(+t[5]):Ln(+t[5]));const r=Gf(+t[2]),s=+t[3]/100,a=+t[4]/100;return t[1]==="hwb"?i=JE(r,s,a):t[1]==="hsv"?i=ZE(r,s,a):i=So(r,s,a),{r:i[0],g:i[1],b:i[2],a:n}}function tx(e,t){var n=To(e);n[0]=Gf(n[0]+t),n=So(n),e.r=n[0],e.g=n[1],e.b=n[2]}function ex(e){if(!e)return;const t=To(e),n=t[0],i=Jl(t[1]),r=Jl(t[2]);return e.a<255?`hsla(${n}, ${i}%, ${r}%, ${an(e.a)})`:`hsl(${n}, ${i}%, ${r}%)`}const Zl={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},ql={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function nx(){const e={},t=Object.keys(ql),n=Object.keys(Zl);let i,r,s,a,o;for(i=0;i<t.length;i++){for(a=o=t[i],r=0;r<n.length;r++)s=n[r],o=o.replace(s,Zl[s]);s=parseInt(ql[a],16),e[o]=[s>>16&255,s>>8&255,s&255]}return e}let Rr;function ix(e){Rr||(Rr=nx(),Rr.transparent=[0,0,0,0]);const t=Rr[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const rx=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function sx(e){const t=rx.exec(e);let n=255,i,r,s;if(!!t){if(t[7]!==i){const a=+t[7];n=t[8]?Hi(a):bn(a*255,0,255)}return i=+t[1],r=+t[3],s=+t[5],i=255&(t[2]?Hi(i):bn(i,0,255)),r=255&(t[4]?Hi(r):bn(r,0,255)),s=255&(t[6]?Hi(s):bn(s,0,255)),{r:i,g:r,b:s,a:n}}}function ax(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${an(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const Zs=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,oi=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function ox(e,t,n){const i=oi(an(e.r)),r=oi(an(e.g)),s=oi(an(e.b));return{r:Ln(Zs(i+n*(oi(an(t.r))-i))),g:Ln(Zs(r+n*(oi(an(t.g))-r))),b:Ln(Zs(s+n*(oi(an(t.b))-s))),a:e.a+n*(t.a-e.a)}}function Ir(e,t,n){if(e){let i=To(e);i[t]=Math.max(0,Math.min(i[t]+i[t]*n,t===0?360:1)),i=So(i),e.r=i[0],e.g=i[1],e.b=i[2]}}function zf(e,t){return e&&Object.assign(t||{},e)}function tc(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Ln(e[3]))):(t=zf(e,{r:0,g:0,b:0,a:1}),t.a=Ln(t.a)),t}function lx(e){return e.charAt(0)==="r"?sx(e):qE(e)}class as{constructor(t){if(t instanceof as)return t;const n=typeof t;let i;n==="object"?i=tc(t):n==="string"&&(i=VE(t)||ix(t)||lx(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=zf(this._rgb);return t&&(t.a=an(t.a)),t}set rgb(t){this._rgb=tc(t)}rgbString(){return this._valid?ax(this._rgb):void 0}hexString(){return this._valid?GE(this._rgb):void 0}hslString(){return this._valid?ex(this._rgb):void 0}mix(t,n){if(t){const i=this.rgb,r=t.rgb;let s;const a=n===s?.5:n,o=2*a-1,l=i.a-r.a,c=((o*l===-1?o:(o+l)/(1+o*l))+1)/2;s=1-c,i.r=255&c*i.r+s*r.r+.5,i.g=255&c*i.g+s*r.g+.5,i.b=255&c*i.b+s*r.b+.5,i.a=a*i.a+(1-a)*r.a,this.rgb=i}return this}interpolate(t,n){return t&&(this._rgb=ox(this._rgb,t._rgb,n)),this}clone(){return new as(this.rgb)}alpha(t){return this._rgb.a=Ln(t),this}clearer(t){const n=this._rgb;return n.a*=1-t,this}greyscale(){const t=this._rgb,n=Er(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=n,this}opaquer(t){const n=this._rgb;return n.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Ir(this._rgb,2,t),this}darken(t){return Ir(this._rgb,2,-t),this}saturate(t){return Ir(this._rgb,1,t),this}desaturate(t){return Ir(this._rgb,1,-t),this}rotate(t){return tx(this._rgb,t),this}}function Yf(e){return new as(e)}function Xf(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function ec(e){return Xf(e)?e:Yf(e)}function qs(e){return Xf(e)?e:Yf(e).saturate(.5).darken(.1).hexString()}const ti=Object.create(null),Ma=Object.create(null);function Ji(e,t){if(!t)return e;const n=t.split(".");for(let i=0,r=n.length;i<r;++i){const s=n[i];e=e[s]||(e[s]=Object.create(null))}return e}function ta(e,t,n){return typeof t=="string"?fr(Ji(e,t),n):fr(Ji(e,""),t)}class cx{constructor(t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,i)=>qs(i.backgroundColor),this.hoverBorderColor=(n,i)=>qs(i.borderColor),this.hoverColor=(n,i)=>qs(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t)}set(t,n){return ta(this,t,n)}get(t){return Ji(this,t)}describe(t,n){return ta(Ma,t,n)}override(t,n){return ta(ti,t,n)}route(t,n,i,r){const s=Ji(this,t),a=Ji(this,i),o="_"+n;Object.defineProperties(s,{[o]:{value:s[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[o],c=a[r];return _t(l)?Object.assign({},c,l):xt(l,c)},set(l){this[o]=l}}})}}var Lt=new cx({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});function ux(e){return!e||Ct(e.size)||Ct(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function os(e,t,n,i,r){let s=t[r];return s||(s=t[r]=e.measureText(r).width,n.push(r)),s>i&&(i=s),i}function fx(e,t,n,i){i=i||{};let r=i.data=i.data||{},s=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(r=i.data={},s=i.garbageCollect=[],i.font=t),e.save(),e.font=t;let a=0;const o=n.length;let l,c,u,h,d;for(l=0;l<o;l++)if(h=n[l],h!=null&&Nt(h)!==!0)a=os(e,r,s,a,h);else if(Nt(h))for(c=0,u=h.length;c<u;c++)d=h[c],d!=null&&!Nt(d)&&(a=os(e,r,s,a,d));e.restore();const y=s.length/2;if(y>n.length){for(l=0;l<y;l++)delete r[s[l]];s.splice(0,y)}return a}function Wn(e,t,n){const i=e.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((t-r)*i)/i+r}function nc(e,t){t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore()}function Oa(e,t,n,i){Qf(e,t,n,i,null)}function Qf(e,t,n,i,r){let s,a,o,l,c,u;const h=t.pointStyle,d=t.rotation,y=t.radius;let x=(d||0)*PE;if(h&&typeof h=="object"&&(s=h.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){e.save(),e.translate(n,i),e.rotate(x),e.drawImage(h,-h.width/2,-h.height/2,h.width,h.height),e.restore();return}if(!(isNaN(y)||y<=0)){switch(e.beginPath(),h){default:r?e.ellipse(n,i,r/2,y,0,0,wt):e.arc(n,i,y,0,wt),e.closePath();break;case"triangle":e.moveTo(n+Math.sin(x)*y,i-Math.cos(x)*y),x+=$l,e.lineTo(n+Math.sin(x)*y,i-Math.cos(x)*y),x+=$l,e.lineTo(n+Math.sin(x)*y,i-Math.cos(x)*y),e.closePath();break;case"rectRounded":c=y*.516,l=y-c,a=Math.cos(x+ki)*l,o=Math.sin(x+ki)*l,e.arc(n-a,i-o,c,x-Kt,x-Vt),e.arc(n+o,i-a,c,x-Vt,x),e.arc(n+a,i+o,c,x,x+Vt),e.arc(n-o,i+a,c,x+Vt,x+Kt),e.closePath();break;case"rect":if(!d){l=Math.SQRT1_2*y,u=r?r/2:l,e.rect(n-u,i-l,2*u,2*l);break}x+=ki;case"rectRot":a=Math.cos(x)*y,o=Math.sin(x)*y,e.moveTo(n-a,i-o),e.lineTo(n+o,i-a),e.lineTo(n+a,i+o),e.lineTo(n-o,i+a),e.closePath();break;case"crossRot":x+=ki;case"cross":a=Math.cos(x)*y,o=Math.sin(x)*y,e.moveTo(n-a,i-o),e.lineTo(n+a,i+o),e.moveTo(n+o,i-a),e.lineTo(n-o,i+a);break;case"star":a=Math.cos(x)*y,o=Math.sin(x)*y,e.moveTo(n-a,i-o),e.lineTo(n+a,i+o),e.moveTo(n+o,i-a),e.lineTo(n-o,i+a),x+=ki,a=Math.cos(x)*y,o=Math.sin(x)*y,e.moveTo(n-a,i-o),e.lineTo(n+a,i+o),e.moveTo(n+o,i-a),e.lineTo(n-o,i+a);break;case"line":a=r?r/2:Math.cos(x)*y,o=Math.sin(x)*y,e.moveTo(n-a,i-o),e.lineTo(n+a,i+o);break;case"dash":e.moveTo(n,i),e.lineTo(n+Math.cos(x)*y,i+Math.sin(x)*y);break}e.fill(),t.borderWidth>0&&e.stroke()}}function hr(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function Ls(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function Ds(e){e.restore()}function dx(e,t,n,i,r){if(!t)return e.lineTo(n.x,n.y);if(r==="middle"){const s=(t.x+n.x)/2;e.lineTo(s,t.y),e.lineTo(s,n.y)}else r==="after"!=!!i?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function hx(e,t,n,i){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function ei(e,t,n,i,r,s={}){const a=Nt(t)?t:[t],o=s.strokeWidth>0&&s.strokeColor!=="";let l,c;for(e.save(),e.font=r.string,gx(e,s),l=0;l<a.length;++l)c=a[l],o&&(s.strokeColor&&(e.strokeStyle=s.strokeColor),Ct(s.strokeWidth)||(e.lineWidth=s.strokeWidth),e.strokeText(c,n,i,s.maxWidth)),e.fillText(c,n,i,s.maxWidth),vx(e,n,i,c,s),i+=r.lineHeight;e.restore()}function gx(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),Ct(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function vx(e,t,n,i,r){if(r.strikethrough||r.underline){const s=e.measureText(i),a=t-s.actualBoundingBoxLeft,o=t+s.actualBoundingBoxRight,l=n-s.actualBoundingBoxAscent,c=n+s.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=r.decorationWidth||2,e.moveTo(a,u),e.lineTo(o,u),e.stroke()}}function gr(e,t){const{x:n,y:i,w:r,h:s,radius:a}=t;e.arc(n+a.topLeft,i+a.topLeft,a.topLeft,-Vt,Kt,!0),e.lineTo(n,i+s-a.bottomLeft),e.arc(n+a.bottomLeft,i+s-a.bottomLeft,a.bottomLeft,Kt,Vt,!0),e.lineTo(n+r-a.bottomRight,i+s),e.arc(n+r-a.bottomRight,i+s-a.bottomRight,a.bottomRight,Vt,0,!0),e.lineTo(n+r,i+a.topRight),e.arc(n+r-a.topRight,i+a.topRight,a.topRight,0,-Vt,!0),e.lineTo(n+a.topLeft,i)}const mx=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),px=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function yx(e,t){const n=(""+e).match(mx);if(!n||n[1]==="normal")return t*1.2;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100;break}return t*e}const Ex=e=>+e||0;function Lo(e,t){const n={},i=_t(t),r=i?Object.keys(t):t,s=_t(e)?i?a=>xt(e[a],e[t[a]]):a=>e[a]:()=>e;for(const a of r)n[a]=Ex(s(a));return n}function Jf(e){return Lo(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Zn(e){return Lo(e,["topLeft","topRight","bottomLeft","bottomRight"])}function oe(e){const t=Jf(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Gt(e,t){e=e||{},t=t||Lt.font;let n=xt(e.size,t.size);typeof n=="string"&&(n=parseInt(n,10));let i=xt(e.style,t.style);i&&!(""+i).match(px)&&(console.warn('Invalid font style specified: "'+i+'"'),i="");const r={family:xt(e.family,t.family),lineHeight:yx(xt(e.lineHeight,t.lineHeight),n),size:n,style:i,weight:xt(e.weight,t.weight),string:""};return r.string=ux(r),r}function ji(e,t,n,i){let r=!0,s,a,o;for(s=0,a=e.length;s<a;++s)if(o=e[s],o!==void 0&&(t!==void 0&&typeof o=="function"&&(o=o(t),r=!1),n!==void 0&&Nt(o)&&(o=o[n%o.length],r=!1),o!==void 0))return i&&!r&&(i.cacheable=!1),o}function xx(e,t,n){const{min:i,max:r}=e,s=kf(t,(r-i)/2),a=(o,l)=>n&&o===0?0:o+l;return{min:a(i,-Math.abs(s)),max:a(r,s)}}function Pn(e,t){return Object.assign(Object.create(e),t)}function Do(e,t=[""],n=e,i,r=()=>e[0]){_e(i)||(i=ed("_fallback",e));const s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:n,_fallback:i,_getTarget:r,override:a=>Do([a,...e],t,n,i)};return new Proxy(s,{deleteProperty(a,o){return delete a[o],delete a._keys,delete e[0][o],!0},get(a,o){return qf(a,o,()=>Cx(o,t,e,a))},getOwnPropertyDescriptor(a,o){return Reflect.getOwnPropertyDescriptor(a._scopes[0],o)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(a,o){return rc(a).includes(o)},ownKeys(a){return rc(a)},set(a,o,l){const c=a._storage||(a._storage=r());return a[o]=c[o]=l,delete a._keys,!0}})}function _i(e,t,n,i){const r={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:Zf(e,i),setContext:s=>_i(e,s,n,i),override:s=>_i(e.override(s),t,n,i)};return new Proxy(r,{deleteProperty(s,a){return delete s[a],delete e[a],!0},get(s,a,o){return qf(s,a,()=>Tx(s,a,o))},getOwnPropertyDescriptor(s,a){return s._descriptors.allKeys?Reflect.has(e,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,a)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(s,a){return Reflect.has(e,a)},ownKeys(){return Reflect.ownKeys(e)},set(s,a,o){return e[a]=o,delete s[a],!0}})}function Zf(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:i=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:n,indexable:i,isScriptable:On(n)?n:()=>n,isIndexable:On(i)?i:()=>i}}const bx=(e,t)=>e?e+yo(t):t,Ao=(e,t)=>_t(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function qf(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t))return e[t];const i=n();return e[t]=i,i}function Tx(e,t,n){const{_proxy:i,_context:r,_subProxy:s,_descriptors:a}=e;let o=i[t];return On(o)&&a.isScriptable(t)&&(o=_x(t,o,e,n)),Nt(o)&&o.length&&(o=Sx(t,o,e,a.isIndexable)),Ao(t,o)&&(o=_i(o,r,s&&s[t],a)),o}function _x(e,t,n,i){const{_proxy:r,_context:s,_subProxy:a,_stack:o}=n;if(o.has(e))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+e);return o.add(e),t=t(s,a||i),o.delete(e),Ao(e,t)&&(t=Co(r._scopes,r,e,t)),t}function Sx(e,t,n,i){const{_proxy:r,_context:s,_subProxy:a,_descriptors:o}=n;if(_e(s.index)&&i(e))t=t[s.index%t.length];else if(_t(t[0])){const l=t,c=r._scopes.filter(u=>u!==l);t=[];for(const u of l){const h=Co(c,r,e,u);t.push(_i(h,s,a&&a[e],o))}}return t}function td(e,t,n){return On(e)?e(t,n):e}const Lx=(e,t)=>e===!0?t:typeof e=="string"?Mn(t,e):void 0;function Dx(e,t,n,i,r){for(const s of t){const a=Lx(n,s);if(a){e.add(a);const o=td(a._fallback,n,r);if(_e(o)&&o!==n&&o!==i)return o}else if(a===!1&&_e(i)&&n!==i)return null}return!1}function Co(e,t,n,i){const r=t._rootScopes,s=td(t._fallback,n,i),a=[...e,...r],o=new Set;o.add(i);let l=ic(o,a,n,s||n,i);return l===null||_e(s)&&s!==n&&(l=ic(o,a,s,l,i),l===null)?!1:Do(Array.from(o),[""],r,s,()=>Ax(t,n,i))}function ic(e,t,n,i,r){for(;n;)n=Dx(e,t,n,i,r);return n}function Ax(e,t,n){const i=e._getTarget();t in i||(i[t]={});const r=i[t];return Nt(r)&&_t(n)?n:r}function Cx(e,t,n,i){let r;for(const s of t)if(r=ed(bx(s,e),n),_e(r))return Ao(e,r)?Co(n,i,e,r):r}function ed(e,t){for(const n of t){if(!n)continue;const i=n[e];if(_e(i))return i}}function rc(e){let t=e._keys;return t||(t=e._keys=Mx(e._scopes)),t}function Mx(e){const t=new Set;for(const n of e)for(const i of Object.keys(n).filter(r=>!r.startsWith("_")))t.add(i);return Array.from(t)}function nd(e,t,n,i){const{iScale:r}=e,{key:s="r"}=this._parsing,a=new Array(i);let o,l,c,u;for(o=0,l=i;o<l;++o)c=o+n,u=t[c],a[o]={r:r.parse(Mn(u,s),c)};return a}const Ox=Number.EPSILON||1e-14,Si=(e,t)=>t<e.length&&!e[t].skip&&e[t],id=e=>e==="x"?"y":"x";function Px(e,t,n,i){const r=e.skip?t:e,s=t,a=n.skip?t:n,o=Aa(s,r),l=Aa(a,s);let c=o/(o+l),u=l/(o+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const h=i*c,d=i*u;return{previous:{x:s.x-h*(a.x-r.x),y:s.y-h*(a.y-r.y)},next:{x:s.x+d*(a.x-r.x),y:s.y+d*(a.y-r.y)}}}function Rx(e,t,n){const i=e.length;let r,s,a,o,l,c=Si(e,0);for(let u=0;u<i-1;++u)if(l=c,c=Si(e,u+1),!(!l||!c)){if(Xi(t[u],0,Ox)){n[u]=n[u+1]=0;continue}r=n[u]/t[u],s=n[u+1]/t[u],o=Math.pow(r,2)+Math.pow(s,2),!(o<=9)&&(a=3/Math.sqrt(o),n[u]=r*a*t[u],n[u+1]=s*a*t[u])}}function Ix(e,t,n="x"){const i=id(n),r=e.length;let s,a,o,l=Si(e,0);for(let c=0;c<r;++c){if(a=o,o=l,l=Si(e,c+1),!o)continue;const u=o[n],h=o[i];a&&(s=(u-a[n])/3,o[`cp1${n}`]=u-s,o[`cp1${i}`]=h-s*t[c]),l&&(s=(l[n]-u)/3,o[`cp2${n}`]=u+s,o[`cp2${i}`]=h+s*t[c])}}function wx(e,t="x"){const n=id(t),i=e.length,r=Array(i).fill(0),s=Array(i);let a,o,l,c=Si(e,0);for(a=0;a<i;++a)if(o=l,l=c,c=Si(e,a+1),!!l){if(c){const u=c[t]-l[t];r[a]=u!==0?(c[n]-l[n])/u:0}s[a]=o?c?Ye(r[a-1])!==Ye(r[a])?0:(r[a-1]+r[a])/2:r[a-1]:r[a]}Rx(e,r,s),Ix(e,s,t)}function wr(e,t,n){return Math.max(Math.min(e,n),t)}function kx(e,t){let n,i,r,s,a,o=hr(e[0],t);for(n=0,i=e.length;n<i;++n)a=s,s=o,o=n<i-1&&hr(e[n+1],t),s&&(r=e[n],a&&(r.cp1x=wr(r.cp1x,t.left,t.right),r.cp1y=wr(r.cp1y,t.top,t.bottom)),o&&(r.cp2x=wr(r.cp2x,t.left,t.right),r.cp2y=wr(r.cp2y,t.top,t.bottom)))}function Fx(e,t,n,i,r){let s,a,o,l;if(t.spanGaps&&(e=e.filter(c=>!c.skip)),t.cubicInterpolationMode==="monotone")wx(e,r);else{let c=i?e[e.length-1]:e[0];for(s=0,a=e.length;s<a;++s)o=e[s],l=Px(c,o,e[Math.min(s+1,a-(i?0:1))%a],t.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,c=o}t.capBezierPoints&&kx(e,n)}function rd(){return typeof window<"u"&&typeof document<"u"}function Mo(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function ls(e,t,n){let i;return typeof e=="string"?(i=parseInt(e,10),e.indexOf("%")!==-1&&(i=i/100*t.parentNode[n])):i=e,i}const As=e=>window.getComputedStyle(e,null);function Bx(e,t){return As(e).getPropertyValue(t)}const Nx=["top","right","bottom","left"];function qn(e,t,n){const i={};n=n?"-"+n:"";for(let r=0;r<4;r++){const s=Nx[r];i[s]=parseFloat(e[t+"-"+s+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const Ux=(e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot);function Wx(e,t){const n=e.touches,i=n&&n.length?n[0]:e,{offsetX:r,offsetY:s}=i;let a=!1,o,l;if(Ux(r,s,e.target))o=r,l=s;else{const c=t.getBoundingClientRect();o=i.clientX-c.left,l=i.clientY-c.top,a=!0}return{x:o,y:l,box:a}}function jn(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:i}=t,r=As(n),s=r.boxSizing==="border-box",a=qn(r,"padding"),o=qn(r,"border","width"),{x:l,y:c,box:u}=Wx(e,n),h=a.left+(u&&o.left),d=a.top+(u&&o.top);let{width:y,height:x}=t;return s&&(y-=a.width+o.width,x-=a.height+o.height),{x:Math.round((l-h)/y*n.width/i),y:Math.round((c-d)/x*n.height/i)}}function Kx(e,t,n){let i,r;if(t===void 0||n===void 0){const s=Mo(e);if(!s)t=e.clientWidth,n=e.clientHeight;else{const a=s.getBoundingClientRect(),o=As(s),l=qn(o,"border","width"),c=qn(o,"padding");t=a.width-c.width-l.width,n=a.height-c.height-l.height,i=ls(o.maxWidth,s,"clientWidth"),r=ls(o.maxHeight,s,"clientHeight")}}return{width:t,height:n,maxWidth:i||ss,maxHeight:r||ss}}const ea=e=>Math.round(e*10)/10;function Hx(e,t,n,i){const r=As(e),s=qn(r,"margin"),a=ls(r.maxWidth,e,"clientWidth")||ss,o=ls(r.maxHeight,e,"clientHeight")||ss,l=Kx(e,t,n);let{width:c,height:u}=l;if(r.boxSizing==="content-box"){const h=qn(r,"border","width"),d=qn(r,"padding");c-=d.width+h.width,u-=d.height+h.height}return c=Math.max(0,c-s.width),u=Math.max(0,i?Math.floor(c/i):u-s.height),c=ea(Math.min(c,a,l.maxWidth)),u=ea(Math.min(u,o,l.maxHeight)),c&&!u&&(u=ea(c/2)),{width:c,height:u}}function sc(e,t,n){const i=t||1,r=Math.floor(e.height*i),s=Math.floor(e.width*i);e.height=r/i,e.width=s/i;const a=e.canvas;return a.style&&(n||!a.style.height&&!a.style.width)&&(a.style.height=`${e.height}px`,a.style.width=`${e.width}px`),e.currentDevicePixelRatio!==i||a.height!==r||a.width!==s?(e.currentDevicePixelRatio=i,a.height=r,a.width=s,e.ctx.setTransform(i,0,0,i,0,0),!0):!1}const jx=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch{}return e}();function ac(e,t){const n=Bx(e,t),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function Vn(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function Vx(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:i==="middle"?n<.5?e.y:t.y:i==="after"?n<1?e.y:t.y:n>0?t.y:e.y}}function $x(e,t,n,i){const r={x:e.cp2x,y:e.cp2y},s={x:t.cp1x,y:t.cp1y},a=Vn(e,r,n),o=Vn(r,s,n),l=Vn(s,t,n),c=Vn(a,o,n),u=Vn(o,l,n);return Vn(c,u,n)}const oc=new Map;function Gx(e,t){t=t||{};const n=e+JSON.stringify(t);let i=oc.get(n);return i||(i=new Intl.NumberFormat(e,t),oc.set(n,i)),i}function xr(e,t,n){return Gx(t,n).format(e)}const zx=function(e,t){return{x(n){return e+e+t-n},setWidth(n){t=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,i){return n-i},leftForLtr(n,i){return n-i}}},Yx=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function vi(e,t,n){return e?zx(t,n):Yx()}function sd(e,t){let n,i;(t==="ltr"||t==="rtl")&&(n=e.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=i)}function ad(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function od(e){return e==="angle"?{between:dr,compare:wE,normalize:ge}:{between:ln,compare:(t,n)=>t-n,normalize:t=>t}}function lc({start:e,end:t,count:n,loop:i,style:r}){return{start:e%n,end:t%n,loop:i&&(t-e+1)%n===0,style:r}}function Xx(e,t,n){const{property:i,start:r,end:s}=n,{between:a,normalize:o}=od(i),l=t.length;let{start:c,end:u,loop:h}=e,d,y;if(h){for(c+=l,u+=l,d=0,y=l;d<y&&a(o(t[c%l][i]),r,s);++d)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:h,style:e.style}}function ld(e,t,n){if(!n)return[e];const{property:i,start:r,end:s}=n,a=t.length,{compare:o,between:l,normalize:c}=od(i),{start:u,end:h,loop:d,style:y}=Xx(e,t,n),x=[];let D=!1,S=null,L,g,f;const E=()=>l(r,f,L)&&o(r,f)!==0,_=()=>o(s,L)===0||l(s,f,L),C=()=>D||E(),p=()=>!D||_();for(let v=u,m=u;v<=h;++v)g=t[v%a],!g.skip&&(L=c(g[i]),L!==f&&(D=l(L,r,s),S===null&&C()&&(S=o(L,r)===0?v:m),S!==null&&p()&&(x.push(lc({start:S,end:v,loop:d,count:a,style:y})),S=null),m=v,f=L));return S!==null&&x.push(lc({start:S,end:h,loop:d,count:a,style:y})),x}function cd(e,t){const n=[],i=e.segments;for(let r=0;r<i.length;r++){const s=ld(i[r],e.points,t);s.length&&n.push(...s)}return n}function Qx(e,t,n,i){let r=0,s=t-1;if(n&&!i)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,n&&(s+=r);s>r&&e[s%t].skip;)s--;return s%=t,{start:r,end:s}}function Jx(e,t,n,i){const r=e.length,s=[];let a=t,o=e[t],l;for(l=t+1;l<=n;++l){const c=e[l%r];c.skip||c.stop?o.skip||(i=!1,s.push({start:t%r,end:(l-1)%r,loop:i}),t=a=c.stop?l:null):(a=l,o.skip&&(t=l)),o=c}return a!==null&&s.push({start:t%r,end:a%r,loop:i}),s}function Zx(e,t){const n=e.points,i=e.options.spanGaps,r=n.length;if(!r)return[];const s=!!e._loop,{start:a,end:o}=Qx(n,r,s,i);if(i===!0)return cc(e,[{start:a,end:o,loop:s}],n,t);const l=o<a?o+r:o,c=!!e._fullLoop&&a===0&&o===r-1;return cc(e,Jx(n,a,l,c),n,t)}function cc(e,t,n,i){return!i||!i.setContext||!n?t:qx(e,t,n,i)}function qx(e,t,n,i){const r=e._chart.getContext(),s=uc(e.options),{_datasetIndex:a,options:{spanGaps:o}}=e,l=n.length,c=[];let u=s,h=t[0].start,d=h;function y(x,D,S,L){const g=o?-1:1;if(x!==D){for(x+=l;n[x%l].skip;)x-=g;for(;n[D%l].skip;)D+=g;x%l!==D%l&&(c.push({start:x%l,end:D%l,loop:S,style:L}),u=L,h=D%l)}}for(const x of t){h=o?h:x.start;let D=n[h%l],S;for(d=h+1;d<=x.end;d++){const L=n[d%l];S=uc(i.setContext(Pn(r,{type:"segment",p0:D,p1:L,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:a}))),tb(S,u)&&y(h,d-1,x.loop,u),D=L,u=S}h<d-1&&y(h,d-1,x.loop,u)}return c}function uc(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function tb(e,t){return t&&JSON.stringify(e)!==JSON.stringify(t)}/*!
 * Chart.js v3.9.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */class eb{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,n,i,r){const s=n.listeners[r],a=n.duration;s.forEach(o=>o({chart:t,initial:n.initial,numSteps:a,currentStep:Math.min(i-n.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=Kf.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let n=0;this._charts.forEach((i,r)=>{if(!i.running||!i.items.length)return;const s=i.items;let a=s.length-1,o=!1,l;for(;a>=0;--a)l=s[a],l._active?(l._total>i.duration&&(i.duration=l._total),l.tick(t),o=!0):(s[a]=s[s.length-1],s.pop());o&&(r.draw(),this._notify(r,i,t,"progress")),s.length||(i.running=!1,this._notify(r,i,t,"complete"),i.initial=!1),n+=s.length}),this._lastDate=t,n===0&&(this._running=!1)}_getAnims(t){const n=this._charts;let i=n.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(t,i)),i}listen(t,n,i){this._getAnims(t).listeners[n].push(i)}add(t,n){!n||!n.length||this._getAnims(t).items.push(...n)}has(t){return this._getAnims(t).items.length>0}start(t){const n=this._charts.get(t);!n||(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((i,r)=>Math.max(i,r._duration),0),this._refresh())}running(t){if(!this._running)return!1;const n=this._charts.get(t);return!(!n||!n.running||!n.items.length)}stop(t){const n=this._charts.get(t);if(!n||!n.items.length)return;const i=n.items;let r=i.length-1;for(;r>=0;--r)i[r].cancel();n.items=[],this._notify(t,n,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var nn=new eb;const fc="transparent",nb={boolean(e,t,n){return n>.5?t:e},color(e,t,n){const i=ec(e||fc),r=i.valid&&ec(t||fc);return r&&r.valid?r.mix(i,n).hexString():t},number(e,t,n){return e+(t-e)*n}};class ib{constructor(t,n,i,r){const s=n[i];r=ji([t.to,r,s,t.from]);const a=ji([t.from,s,r]);this._active=!0,this._fn=t.fn||nb[t.type||typeof a],this._easing=Qi[t.easing]||Qi.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=i,this._from=a,this._to=r,this._promises=void 0}active(){return this._active}update(t,n,i){if(this._active){this._notify(!1);const r=this._target[this._prop],s=i-this._start,a=this._duration-s;this._start=i,this._duration=Math.floor(Math.max(a,t.duration)),this._total+=s,this._loop=!!t.loop,this._to=ji([t.to,n,r,t.from]),this._from=ji([t.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const n=t-this._start,i=this._duration,r=this._prop,s=this._from,a=this._loop,o=this._to;let l;if(this._active=s!==o&&(a||n<i),!this._active){this._target[r]=o,this._notify(!0);return}if(n<0){this._target[r]=s;return}l=n/i%2,l=a&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(s,o,l)}wait(){const t=this._promises||(this._promises=[]);return new Promise((n,i)=>{t.push({res:n,rej:i})})}_notify(t){const n=t?"res":"rej",i=this._promises||[];for(let r=0;r<i.length;r++)i[r][n]()}}const rb=["x","y","borderWidth","radius","tension"],sb=["color","borderColor","backgroundColor"];Lt.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const ab=Object.keys(Lt.animation);Lt.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"});Lt.set("animations",{colors:{type:"color",properties:sb},numbers:{type:"number",properties:rb}});Lt.describe("animations",{_fallback:"animation"});Lt.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}});class ud{constructor(t,n){this._chart=t,this._properties=new Map,this.configure(n)}configure(t){if(!_t(t))return;const n=this._properties;Object.getOwnPropertyNames(t).forEach(i=>{const r=t[i];if(!_t(r))return;const s={};for(const a of ab)s[a]=r[a];(Nt(r.properties)&&r.properties||[i]).forEach(a=>{(a===i||!n.has(a))&&n.set(a,s)})})}_animateOptions(t,n){const i=n.options,r=lb(t,i);if(!r)return[];const s=this._createAnimations(r,i);return i.$shared&&ob(t.options.$animations,i).then(()=>{t.options=i},()=>{}),s}_createAnimations(t,n){const i=this._properties,r=[],s=t.$animations||(t.$animations={}),a=Object.keys(n),o=Date.now();let l;for(l=a.length-1;l>=0;--l){const c=a[l];if(c.charAt(0)==="$")continue;if(c==="options"){r.push(...this._animateOptions(t,n));continue}const u=n[c];let h=s[c];const d=i.get(c);if(h)if(d&&h.active()){h.update(d,u,o);continue}else h.cancel();if(!d||!d.duration){t[c]=u;continue}s[c]=h=new ib(d,t,c,u),r.push(h)}return r}update(t,n){if(this._properties.size===0){Object.assign(t,n);return}const i=this._createAnimations(t,n);if(i.length)return nn.add(this._chart,i),!0}}function ob(e,t){const n=[],i=Object.keys(t);for(let r=0;r<i.length;r++){const s=e[i[r]];s&&s.active()&&n.push(s.wait())}return Promise.all(n)}function lb(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function dc(e,t){const n=e&&e.options||{},i=n.reverse,r=n.min===void 0?t:0,s=n.max===void 0?t:0;return{start:i?s:r,end:i?r:s}}function cb(e,t,n){if(n===!1)return!1;const i=dc(e,n),r=dc(t,n);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}function ub(e){let t,n,i,r;return _t(e)?(t=e.top,n=e.right,i=e.bottom,r=e.left):t=n=i=r=e,{top:t,right:n,bottom:i,left:r,disabled:e===!1}}function fd(e,t){const n=[],i=e._getSortedDatasetMetas(t);let r,s;for(r=0,s=i.length;r<s;++r)n.push(i[r].index);return n}function hc(e,t,n,i={}){const r=e.keys,s=i.mode==="single";let a,o,l,c;if(t!==null){for(a=0,o=r.length;a<o;++a){if(l=+r[a],l===n){if(i.all)continue;break}c=e.values[l],$t(c)&&(s||t===0||Ye(t)===Ye(c))&&(t+=c)}return t}}function fb(e){const t=Object.keys(e),n=new Array(t.length);let i,r,s;for(i=0,r=t.length;i<r;++i)s=t[i],n[i]={x:s,y:e[s]};return n}function gc(e,t){const n=e&&e.options.stacked;return n||n===void 0&&t.stack!==void 0}function db(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}function hb(e){const{min:t,max:n,minDefined:i,maxDefined:r}=e.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function gb(e,t,n){const i=e[t]||(e[t]={});return i[n]||(i[n]={})}function vc(e,t,n,i){for(const r of t.getMatchingVisibleMetas(i).reverse()){const s=e[r.index];if(n&&s>0||!n&&s<0)return r.index}return null}function mc(e,t){const{chart:n,_cachedMeta:i}=e,r=n._stacks||(n._stacks={}),{iScale:s,vScale:a,index:o}=i,l=s.axis,c=a.axis,u=db(s,a,i),h=t.length;let d;for(let y=0;y<h;++y){const x=t[y],{[l]:D,[c]:S}=x,L=x._stacks||(x._stacks={});d=L[c]=gb(r,u,D),d[o]=S,d._top=vc(d,a,!0,i.type),d._bottom=vc(d,a,!1,i.type)}}function na(e,t){const n=e.scales;return Object.keys(n).filter(i=>n[i].axis===t).shift()}function vb(e,t){return Pn(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function mb(e,t,n){return Pn(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}function Fi(e,t){const n=e.controller.index,i=e.vScale&&e.vScale.axis;if(!!i){t=t||e._parsed;for(const r of t){const s=r._stacks;if(!s||s[i]===void 0||s[i][n]===void 0)return;delete s[i][n]}}}const ia=e=>e==="reset"||e==="none",pc=(e,t)=>t?e:Object.assign({},e),pb=(e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:fd(n,!0),values:null};class Fe{constructor(t,n){this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=gc(t.vScale,t),this.addElements()}updateIndex(t){this.index!==t&&Fi(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,n=this._cachedMeta,i=this.getDataset(),r=(h,d,y,x)=>h==="x"?d:h==="r"?x:y,s=n.xAxisID=xt(i.xAxisID,na(t,"x")),a=n.yAxisID=xt(i.yAxisID,na(t,"y")),o=n.rAxisID=xt(i.rAxisID,na(t,"r")),l=n.indexAxis,c=n.iAxisID=r(l,s,a,o),u=n.vAxisID=r(l,a,s,o);n.xScale=this.getScaleForId(s),n.yScale=this.getScaleForId(a),n.rScale=this.getScaleForId(o),n.iScale=this.getScaleForId(c),n.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const n=this._cachedMeta;return t===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&Yl(this._data,this),t._stacked&&Fi(t)}_dataCheck(){const t=this.getDataset(),n=t.data||(t.data=[]),i=this._data;if(_t(n))this._data=fb(n);else if(i!==n){if(i){Yl(i,this);const r=this._cachedMeta;Fi(r),r._parsed=[]}n&&Object.isExtensible(n)&&NE(n,this),this._syncList=[],this._data=n}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const n=this._cachedMeta,i=this.getDataset();let r=!1;this._dataCheck();const s=n._stacked;n._stacked=gc(n.vScale,n),n.stack!==i.stack&&(r=!0,Fi(n),n.stack=i.stack),this._resyncElements(t),(r||s!==n._stacked)&&mc(this,n._parsed)}configure(){const t=this.chart.config,n=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),n,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,n){const{_cachedMeta:i,_data:r}=this,{iScale:s,_stacked:a}=i,o=s.axis;let l=t===0&&n===r.length?!0:i._sorted,c=t>0&&i._parsed[t-1],u,h,d;if(this._parsing===!1)i._parsed=r,i._sorted=!0,d=r;else{Nt(r[t])?d=this.parseArrayData(i,r,t,n):_t(r[t])?d=this.parseObjectData(i,r,t,n):d=this.parsePrimitiveData(i,r,t,n);const y=()=>h[o]===null||c&&h[o]<c[o];for(u=0;u<n;++u)i._parsed[u+t]=h=d[u],l&&(y()&&(l=!1),c=h);i._sorted=l}a&&mc(this,d)}parsePrimitiveData(t,n,i,r){const{iScale:s,vScale:a}=t,o=s.axis,l=a.axis,c=s.getLabels(),u=s===a,h=new Array(r);let d,y,x;for(d=0,y=r;d<y;++d)x=d+i,h[d]={[o]:u||s.parse(c[x],x),[l]:a.parse(n[x],x)};return h}parseArrayData(t,n,i,r){const{xScale:s,yScale:a}=t,o=new Array(r);let l,c,u,h;for(l=0,c=r;l<c;++l)u=l+i,h=n[u],o[l]={x:s.parse(h[0],u),y:a.parse(h[1],u)};return o}parseObjectData(t,n,i,r){const{xScale:s,yScale:a}=t,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,c=new Array(r);let u,h,d,y;for(u=0,h=r;u<h;++u)d=u+i,y=n[d],c[u]={x:s.parse(Mn(y,o),d),y:a.parse(Mn(y,l),d)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,n,i){const r=this.chart,s=this._cachedMeta,a=n[t.axis],o={keys:fd(r,!0),values:n._stacks[t.axis]};return hc(o,a,s.index,{mode:i})}updateRangeFromParsed(t,n,i,r){const s=i[n.axis];let a=s===null?NaN:s;const o=r&&i._stacks[n.axis];r&&o&&(r.values=o,a=hc(r,s,this._cachedMeta.index)),t.min=Math.min(t.min,a),t.max=Math.max(t.max,a)}getMinMax(t,n){const i=this._cachedMeta,r=i._parsed,s=i._sorted&&t===i.iScale,a=r.length,o=this._getOtherScale(t),l=pb(n,i,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:h}=hb(o);let d,y;function x(){y=r[d];const D=y[o.axis];return!$t(y[t.axis])||u>D||h<D}for(d=0;d<a&&!(!x()&&(this.updateRangeFromParsed(c,t,y,l),s));++d);if(s){for(d=a-1;d>=0;--d)if(!x()){this.updateRangeFromParsed(c,t,y,l);break}}return c}getAllParsedValues(t){const n=this._cachedMeta._parsed,i=[];let r,s,a;for(r=0,s=n.length;r<s;++r)a=n[r][t.axis],$t(a)&&i.push(a);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const n=this._cachedMeta,i=n.iScale,r=n.vScale,s=this.getParsed(t);return{label:i?""+i.getLabelForValue(s[i.axis]):"",value:r?""+r.getLabelForValue(s[r.axis]):""}}_update(t){const n=this._cachedMeta;this.update(t||"default"),n._clip=ub(xt(this.options.clip,cb(n.xScale,n.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,n=this.chart,i=this._cachedMeta,r=i.data||[],s=n.chartArea,a=[],o=this._drawStart||0,l=this._drawCount||r.length-o,c=this.options.drawActiveElementsOnTop;let u;for(i.dataset&&i.dataset.draw(t,s,o,l),u=o;u<o+l;++u){const h=r[u];h.hidden||(h.active&&c?a.push(h):h.draw(t,s))}for(u=0;u<a.length;++u)a[u].draw(t,s)}getStyle(t,n){const i=n?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,n,i){const r=this.getDataset();let s;if(t>=0&&t<this._cachedMeta.data.length){const a=this._cachedMeta.data[t];s=a.$context||(a.$context=mb(this.getContext(),t,a)),s.parsed=this.getParsed(t),s.raw=r.data[t],s.index=s.dataIndex=t}else s=this.$context||(this.$context=vb(this.chart.getContext(),this.index)),s.dataset=r,s.index=s.datasetIndex=this.index;return s.active=!!n,s.mode=i,s}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,n){return this._resolveElementOptions(this.dataElementType.id,n,t)}_resolveElementOptions(t,n="default",i){const r=n==="active",s=this._cachedDataOpts,a=t+"-"+n,o=s[a],l=this.enableOptionSharing&&_e(i);if(o)return pc(o,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,t),h=r?[`${t}Hover`,"hover",t,""]:[t,""],d=c.getOptionScopes(this.getDataset(),u),y=Object.keys(Lt.elements[t]),x=()=>this.getContext(i,r),D=c.resolveNamedOptions(d,y,x,h);return D.$shared&&(D.$shared=l,s[a]=Object.freeze(pc(D,l))),D}_resolveAnimations(t,n,i){const r=this.chart,s=this._cachedDataOpts,a=`animation-${n}`,o=s[a];if(o)return o;let l;if(r.options.animation!==!1){const u=this.chart.config,h=u.datasetAnimationScopeKeys(this._type,n),d=u.getOptionScopes(this.getDataset(),h);l=u.createResolver(d,this.getContext(t,i,n))}const c=new ud(r,l&&l.animations);return l&&l._cacheable&&(s[a]=Object.freeze(c)),c}getSharedOptions(t){if(!!t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,n){return!n||ia(t)||this.chart._animationsDisabled}_getSharedOptions(t,n){const i=this.resolveDataElementOptions(t,n),r=this._sharedOptions,s=this.getSharedOptions(i),a=this.includeOptions(n,s)||s!==r;return this.updateSharedOptions(s,n,i),{sharedOptions:s,includeOptions:a}}updateElement(t,n,i,r){ia(r)?Object.assign(t,i):this._resolveAnimations(n,r).update(t,i)}updateSharedOptions(t,n,i){t&&!ia(n)&&this._resolveAnimations(void 0,n).update(t,i)}_setStyle(t,n,i,r){t.active=r;const s=this.getStyle(n,r);this._resolveAnimations(n,i,r).update(t,{options:!r&&this.getSharedOptions(s)||s})}removeHoverStyle(t,n,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,n,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const n=this._data,i=this._cachedMeta.data;for(const[o,l,c]of this._syncList)this[o](l,c);this._syncList=[];const r=i.length,s=n.length,a=Math.min(s,r);a&&this.parse(0,a),s>r?this._insertElements(r,s-r,t):s<r&&this._removeElements(s,r-s)}_insertElements(t,n,i=!0){const r=this._cachedMeta,s=r.data,a=t+n;let o;const l=c=>{for(c.length+=n,o=c.length-1;o>=a;o--)c[o]=c[o-n]};for(l(s),o=t;o<a;++o)s[o]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(t,n),i&&this.updateElements(s,t,n,"reset")}updateElements(t,n,i,r){}_removeElements(t,n){const i=this._cachedMeta;if(this._parsing){const r=i._parsed.splice(t,n);i._stacked&&Fi(i,r)}i.data.splice(t,n)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[n,i,r]=t;this[n](i,r)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,n){n&&this._sync(["_removeElements",t,n]);const i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Fe.defaults={};Fe.prototype.datasetElementType=null;Fe.prototype.dataElementType=null;function yb(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let i=[];for(let r=0,s=n.length;r<s;r++)i=i.concat(n[r].controller.getAllParsedValues(e));e._cache.$bar=Wf(i.sort((r,s)=>r-s))}return e._cache.$bar}function Eb(e){const t=e.iScale,n=yb(t,e.type);let i=t._length,r,s,a,o;const l=()=>{a===32767||a===-32768||(_e(o)&&(i=Math.min(i,Math.abs(a-o)||i)),o=a)};for(r=0,s=n.length;r<s;++r)a=t.getPixelForValue(n[r]),l();for(o=void 0,r=0,s=t.ticks.length;r<s;++r)a=t.getPixelForTick(r),l();return i}function xb(e,t,n,i){const r=n.barThickness;let s,a;return Ct(r)?(s=t.min*n.categoryPercentage,a=n.barPercentage):(s=r*i,a=1),{chunk:s/i,ratio:a,start:t.pixels[e]-s/2}}function bb(e,t,n,i){const r=t.pixels,s=r[e];let a=e>0?r[e-1]:null,o=e<r.length-1?r[e+1]:null;const l=n.categoryPercentage;a===null&&(a=s-(o===null?t.end-t.start:o-s)),o===null&&(o=s+s-a);const c=s-(s-Math.min(a,o))/2*l;return{chunk:Math.abs(o-a)/2*l/i,ratio:n.barPercentage,start:c}}function Tb(e,t,n,i){const r=n.parse(e[0],i),s=n.parse(e[1],i),a=Math.min(r,s),o=Math.max(r,s);let l=a,c=o;Math.abs(a)>Math.abs(o)&&(l=o,c=a),t[n.axis]=c,t._custom={barStart:l,barEnd:c,start:r,end:s,min:a,max:o}}function dd(e,t,n,i){return Nt(e)?Tb(e,t,n,i):t[n.axis]=n.parse(e,i),t}function yc(e,t,n,i){const r=e.iScale,s=e.vScale,a=r.getLabels(),o=r===s,l=[];let c,u,h,d;for(c=n,u=n+i;c<u;++c)d=t[c],h={},h[r.axis]=o||r.parse(a[c],c),l.push(dd(d,h,s,c));return l}function ra(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function _b(e,t,n){return e!==0?Ye(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}function Sb(e){let t,n,i,r,s;return e.horizontal?(t=e.base>e.x,n="left",i="right"):(t=e.base<e.y,n="bottom",i="top"),t?(r="end",s="start"):(r="start",s="end"),{start:n,end:i,reverse:t,top:r,bottom:s}}function Lb(e,t,n,i){let r=t.borderSkipped;const s={};if(!r){e.borderSkipped=s;return}if(r===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:a,end:o,reverse:l,top:c,bottom:u}=Sb(e);r==="middle"&&n&&(e.enableBorderRadius=!0,(n._top||0)===i?r=c:(n._bottom||0)===i?r=u:(s[Ec(u,a,o,l)]=!0,r=c)),s[Ec(r,a,o,l)]=!0,e.borderSkipped=s}function Ec(e,t,n,i){return i?(e=Db(e,t,n),e=xc(e,n,t)):e=xc(e,t,n),e}function Db(e,t,n){return e===t?n:e===n?t:e}function xc(e,t,n){return e==="start"?t:e==="end"?n:e}function Ab(e,{inflateAmount:t},n){e.inflateAmount=t==="auto"?n===1?.33:0:t}class Cs extends Fe{parsePrimitiveData(t,n,i,r){return yc(t,n,i,r)}parseArrayData(t,n,i,r){return yc(t,n,i,r)}parseObjectData(t,n,i,r){const{iScale:s,vScale:a}=t,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,c=s.axis==="x"?o:l,u=a.axis==="x"?o:l,h=[];let d,y,x,D;for(d=i,y=i+r;d<y;++d)D=n[d],x={},x[s.axis]=s.parse(Mn(D,c),d),h.push(dd(Mn(D,u),x,a,d));return h}updateRangeFromParsed(t,n,i,r){super.updateRangeFromParsed(t,n,i,r);const s=i._custom;s&&n===this._cachedMeta.vScale&&(t.min=Math.min(t.min,s.min),t.max=Math.max(t.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const n=this._cachedMeta,{iScale:i,vScale:r}=n,s=this.getParsed(t),a=s._custom,o=ra(a)?"["+a.start+", "+a.end+"]":""+r.getLabelForValue(s[r.axis]);return{label:""+i.getLabelForValue(s[i.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,t)}updateElements(t,n,i,r){const s=r==="reset",{index:a,_cachedMeta:{vScale:o}}=this,l=o.getBasePixel(),c=o.isHorizontal(),u=this._getRuler(),{sharedOptions:h,includeOptions:d}=this._getSharedOptions(n,r);for(let y=n;y<n+i;y++){const x=this.getParsed(y),D=s||Ct(x[o.axis])?{base:l,head:l}:this._calculateBarValuePixels(y),S=this._calculateBarIndexPixels(y,u),L=(x._stacks||{})[o.axis],g={horizontal:c,base:D.base,enableBorderRadius:!L||ra(x._custom)||a===L._top||a===L._bottom,x:c?D.head:S.center,y:c?S.center:D.head,height:c?S.size:Math.abs(D.size),width:c?Math.abs(D.size):S.size};d&&(g.options=h||this.resolveDataElementOptions(y,t[y].active?"active":r));const f=g.options||t[y].options;Lb(g,f,L,a),Ab(g,f,u.ratio),this.updateElement(t[y],y,g,r)}}_getStacks(t,n){const{iScale:i}=this._cachedMeta,r=i.getMatchingVisibleMetas(this._type).filter(l=>l.controller.options.grouped),s=i.options.stacked,a=[],o=l=>{const c=l.controller.getParsed(n),u=c&&c[l.vScale.axis];if(Ct(u)||isNaN(u))return!0};for(const l of r)if(!(n!==void 0&&o(l))&&((s===!1||a.indexOf(l.stack)===-1||s===void 0&&l.stack===void 0)&&a.push(l.stack),l.index===t))break;return a.length||a.push(void 0),a}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,n,i){const r=this._getStacks(t,i),s=n!==void 0?r.indexOf(n):-1;return s===-1?r.length-1:s}_getRuler(){const t=this.options,n=this._cachedMeta,i=n.iScale,r=[];let s,a;for(s=0,a=n.data.length;s<a;++s)r.push(i.getPixelForValue(this.getParsed(s)[i.axis],s));const o=t.barThickness;return{min:o||Eb(n),pixels:r,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:t.grouped,ratio:o?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:n,_stacked:i},options:{base:r,minBarLength:s}}=this,a=r||0,o=this.getParsed(t),l=o._custom,c=ra(l);let u=o[n.axis],h=0,d=i?this.applyStack(n,o,i):u,y,x;d!==u&&(h=d-u,d=u),c&&(u=l.barStart,d=l.barEnd-l.barStart,u!==0&&Ye(u)!==Ye(l.barEnd)&&(h=0),h+=u);const D=!Ct(r)&&!c?r:h;let S=n.getPixelForValue(D);if(this.chart.getDataVisibility(t)?y=n.getPixelForValue(h+d):y=S,x=y-S,Math.abs(x)<s){x=_b(x,n,a)*s,u===a&&(S-=x/2);const L=n.getPixelForDecimal(0),g=n.getPixelForDecimal(1),f=Math.min(L,g),E=Math.max(L,g);S=Math.max(Math.min(S,E),f),y=S+x}if(S===n.getPixelForValue(a)){const L=Ye(x)*n.getLineWidthForValue(a)/2;S+=L,x-=L}return{size:x,base:S,head:y,center:y+x/2}}_calculateBarIndexPixels(t,n){const i=n.scale,r=this.options,s=r.skipNull,a=xt(r.maxBarThickness,1/0);let o,l;if(n.grouped){const c=s?this._getStackCount(t):n.stackCount,u=r.barThickness==="flex"?bb(t,n,r,c):xb(t,n,r,c),h=this._getStackIndex(this.index,this._cachedMeta.stack,s?t:void 0);o=u.start+u.chunk*h+u.chunk/2,l=Math.min(a,u.chunk*u.ratio)}else o=i.getPixelForValue(this.getParsed(t)[i.axis],t),l=Math.min(a,n.min*n.ratio);return{base:o-l/2,head:o+l/2,center:o,size:l}}draw(){const t=this._cachedMeta,n=t.vScale,i=t.data,r=i.length;let s=0;for(;s<r;++s)this.getParsed(s)[n.axis]!==null&&i[s].draw(this._ctx)}}Cs.id="bar";Cs.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};Cs.overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class Ms extends Fe{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,n,i,r){const s=super.parsePrimitiveData(t,n,i,r);for(let a=0;a<s.length;a++)s[a]._custom=this.resolveDataElementOptions(a+i).radius;return s}parseArrayData(t,n,i,r){const s=super.parseArrayData(t,n,i,r);for(let a=0;a<s.length;a++){const o=n[i+a];s[a]._custom=xt(o[2],this.resolveDataElementOptions(a+i).radius)}return s}parseObjectData(t,n,i,r){const s=super.parseObjectData(t,n,i,r);for(let a=0;a<s.length;a++){const o=n[i+a];s[a]._custom=xt(o&&o.r&&+o.r,this.resolveDataElementOptions(a+i).radius)}return s}getMaxOverflow(){const t=this._cachedMeta.data;let n=0;for(let i=t.length-1;i>=0;--i)n=Math.max(n,t[i].size(this.resolveDataElementOptions(i))/2);return n>0&&n}getLabelAndValue(t){const n=this._cachedMeta,{xScale:i,yScale:r}=n,s=this.getParsed(t),a=i.getLabelForValue(s.x),o=r.getLabelForValue(s.y),l=s._custom;return{label:n.label,value:"("+a+", "+o+(l?", "+l:"")+")"}}update(t){const n=this._cachedMeta.data;this.updateElements(n,0,n.length,t)}updateElements(t,n,i,r){const s=r==="reset",{iScale:a,vScale:o}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(n,r),u=a.axis,h=o.axis;for(let d=n;d<n+i;d++){const y=t[d],x=!s&&this.getParsed(d),D={},S=D[u]=s?a.getPixelForDecimal(.5):a.getPixelForValue(x[u]),L=D[h]=s?o.getBasePixel():o.getPixelForValue(x[h]);D.skip=isNaN(S)||isNaN(L),c&&(D.options=l||this.resolveDataElementOptions(d,y.active?"active":r),s&&(D.options.radius=0)),this.updateElement(y,d,D,r)}}resolveDataElementOptions(t,n){const i=this.getParsed(t);let r=super.resolveDataElementOptions(t,n);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const s=r.radius;return n!=="active"&&(r.radius=0),r.radius+=xt(i&&i._custom,s),r}}Ms.id="bubble";Ms.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};Ms.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title(){return""}}}}};function Cb(e,t,n){let i=1,r=1,s=0,a=0;if(t<wt){const o=e,l=o+t,c=Math.cos(o),u=Math.sin(o),h=Math.cos(l),d=Math.sin(l),y=(f,E,_)=>dr(f,o,l,!0)?1:Math.max(E,E*n,_,_*n),x=(f,E,_)=>dr(f,o,l,!0)?-1:Math.min(E,E*n,_,_*n),D=y(0,c,h),S=y(Vt,u,d),L=x(Kt,c,h),g=x(Kt+Vt,u,d);i=(D-L)/2,r=(S-g)/2,s=-(D+L)/2,a=-(S+g)/2}return{ratioX:i,ratioY:r,offsetX:s,offsetY:a}}class Oi extends Fe{constructor(t,n){super(t,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,n){const i=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=i;else{let s=l=>+i[l];if(_t(i[t])){const{key:l="value"}=this._parsing;s=c=>+Mn(i[c],l)}let a,o;for(a=t,o=t+n;a<o;++a)r._parsed[a]=s(a)}}_getRotation(){return Me(this.options.rotation-90)}_getCircumference(){return Me(this.options.circumference)}_getRotationExtents(){let t=wt,n=-wt;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)){const r=this.chart.getDatasetMeta(i).controller,s=r._getRotation(),a=r._getCircumference();t=Math.min(t,s),n=Math.max(n,s+a)}return{rotation:t,circumference:n-t}}update(t){const n=this.chart,{chartArea:i}=n,r=this._cachedMeta,s=r.data,a=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,o=Math.max((Math.min(i.width,i.height)-a)/2,0),l=Math.min(SE(this.options.cutout,o),1),c=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:d,ratioY:y,offsetX:x,offsetY:D}=Cb(h,u,l),S=(i.width-a)/d,L=(i.height-a)/y,g=Math.max(Math.min(S,L)/2,0),f=kf(this.options.radius,g),E=Math.max(f*l,0),_=(f-E)/this._getVisibleDatasetWeightTotal();this.offsetX=x*f,this.offsetY=D*f,r.total=this.calculateTotal(),this.outerRadius=f-_*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-_*c,0),this.updateElements(s,0,s.length,t)}_circumference(t,n){const i=this.options,r=this._cachedMeta,s=this._getCircumference();return n&&i.animation.animateRotate||!this.chart.getDataVisibility(t)||r._parsed[t]===null||r.data[t].hidden?0:this.calculateCircumference(r._parsed[t]*s/wt)}updateElements(t,n,i,r){const s=r==="reset",a=this.chart,o=a.chartArea,c=a.options.animation,u=(o.left+o.right)/2,h=(o.top+o.bottom)/2,d=s&&c.animateScale,y=d?0:this.innerRadius,x=d?0:this.outerRadius,{sharedOptions:D,includeOptions:S}=this._getSharedOptions(n,r);let L=this._getRotation(),g;for(g=0;g<n;++g)L+=this._circumference(g,s);for(g=n;g<n+i;++g){const f=this._circumference(g,s),E=t[g],_={x:u+this.offsetX,y:h+this.offsetY,startAngle:L,endAngle:L+f,circumference:f,outerRadius:x,innerRadius:y};S&&(_.options=D||this.resolveDataElementOptions(g,E.active?"active":r)),L+=f,this.updateElement(E,g,_,r)}}calculateTotal(){const t=this._cachedMeta,n=t.data;let i=0,r;for(r=0;r<n.length;r++){const s=t._parsed[r];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(i+=Math.abs(s))}return i}calculateCircumference(t){const n=this._cachedMeta.total;return n>0&&!isNaN(t)?wt*(Math.abs(t)/n):0}getLabelAndValue(t){const n=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=xr(n._parsed[t],i.options.locale);return{label:r[t]||"",value:s}}getMaxBorderWidth(t){let n=0;const i=this.chart;let r,s,a,o,l;if(!t){for(r=0,s=i.data.datasets.length;r<s;++r)if(i.isDatasetVisible(r)){a=i.getDatasetMeta(r),t=a.data,o=a.controller;break}}if(!t)return 0;for(r=0,s=t.length;r<s;++r)l=o.resolveDataElementOptions(r),l.borderAlign!=="inner"&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(t){let n=0;for(let i=0,r=t.length;i<r;++i){const s=this.resolveDataElementOptions(i);n=Math.max(n,s.offset||0,s.hoverOffset||0)}return n}_getRingWeightOffset(t){let n=0;for(let i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(n+=this._getRingWeight(i));return n}_getRingWeight(t){return Math.max(xt(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Oi.id="doughnut";Oi.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};Oi.descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"};Oi.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n}}=e.legend.options;return t.labels.map((i,r)=>{const a=e.getDatasetMeta(0).controller.getStyle(r);return{text:i,fillStyle:a.backgroundColor,strokeStyle:a.borderColor,lineWidth:a.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(r),index:r}})}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}},tooltip:{callbacks:{title(){return""},label(e){let t=e.label;const n=": "+e.formattedValue;return Nt(t)?(t=t.slice(),t[0]+=n):t+=n,t}}}}};class Os extends Fe{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const n=this._cachedMeta,{dataset:i,data:r=[],_dataset:s}=n,a=this.chart._animationsDisabled;let{start:o,count:l}=jf(n,r,a);this._drawStart=o,this._drawCount=l,Vf(n)&&(o=0,l=r.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!s._decimated,i.points=r;const c=this.resolveDatasetElementOptions(t);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(i,void 0,{animated:!a,options:c},t),this.updateElements(r,o,l,t)}updateElements(t,n,i,r){const s=r==="reset",{iScale:a,vScale:o,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:h}=this._getSharedOptions(n,r),d=a.axis,y=o.axis,{spanGaps:x,segment:D}=this.options,S=Ti(x)?x:Number.POSITIVE_INFINITY,L=this.chart._animationsDisabled||s||r==="none";let g=n>0&&this.getParsed(n-1);for(let f=n;f<n+i;++f){const E=t[f],_=this.getParsed(f),C=L?E:{},p=Ct(_[y]),v=C[d]=a.getPixelForValue(_[d],f),m=C[y]=s||p?o.getBasePixel():o.getPixelForValue(l?this.applyStack(o,_,l):_[y],f);C.skip=isNaN(v)||isNaN(m)||p,C.stop=f>0&&Math.abs(_[d]-g[d])>S,D&&(C.parsed=_,C.raw=c.data[f]),h&&(C.options=u||this.resolveDataElementOptions(f,E.active?"active":r)),L||this.updateElement(E,f,C,r),g=_}}getMaxOverflow(){const t=this._cachedMeta,n=t.dataset,i=n.options&&n.options.borderWidth||0,r=t.data||[];if(!r.length)return i;const s=r[0].size(this.resolveDataElementOptions(0)),a=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(i,s,a)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}Os.id="line";Os.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};Os.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};class Ps extends Fe{constructor(t,n){super(t,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const n=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=xr(n._parsed[t].r,i.options.locale);return{label:r[t]||"",value:s}}parseObjectData(t,n,i,r){return nd.bind(this)(t,n,i,r)}update(t){const n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,t)}getMinMax(){const t=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((i,r)=>{const s=this.getParsed(r).r;!isNaN(s)&&this.chart.getDataVisibility(r)&&(s<n.min&&(n.min=s),s>n.max&&(n.max=s))}),n}_updateRadius(){const t=this.chart,n=t.chartArea,i=t.options,r=Math.min(n.right-n.left,n.bottom-n.top),s=Math.max(r/2,0),a=Math.max(i.cutoutPercentage?s/100*i.cutoutPercentage:1,0),o=(s-a)/t.getVisibleDatasetCount();this.outerRadius=s-o*this.index,this.innerRadius=this.outerRadius-o}updateElements(t,n,i,r){const s=r==="reset",a=this.chart,l=a.options.animation,c=this._cachedMeta.rScale,u=c.xCenter,h=c.yCenter,d=c.getIndexAngle(0)-.5*Kt;let y=d,x;const D=360/this.countVisibleElements();for(x=0;x<n;++x)y+=this._computeAngle(x,r,D);for(x=n;x<n+i;x++){const S=t[x];let L=y,g=y+this._computeAngle(x,r,D),f=a.getDataVisibility(x)?c.getDistanceFromCenterForValue(this.getParsed(x).r):0;y=g,s&&(l.animateScale&&(f=0),l.animateRotate&&(L=g=d));const E={x:u,y:h,innerRadius:0,outerRadius:f,startAngle:L,endAngle:g,options:this.resolveDataElementOptions(x,S.active?"active":r)};this.updateElement(S,x,E,r)}}countVisibleElements(){const t=this._cachedMeta;let n=0;return t.data.forEach((i,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&n++}),n}_computeAngle(t,n,i){return this.chart.getDataVisibility(t)?Me(this.resolveDataElementOptions(t,n).angle||i):0}}Ps.id="polarArea";Ps.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};Ps.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n}}=e.legend.options;return t.labels.map((i,r)=>{const a=e.getDatasetMeta(0).controller.getStyle(r);return{text:i,fillStyle:a.backgroundColor,strokeStyle:a.borderColor,lineWidth:a.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(r),index:r}})}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}},tooltip:{callbacks:{title(){return""},label(e){return e.chart.data.labels[e.dataIndex]+": "+e.formattedValue}}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class Oo extends Oi{}Oo.id="pie";Oo.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class Rs extends Fe{getLabelAndValue(t){const n=this._cachedMeta.vScale,i=this.getParsed(t);return{label:n.getLabels()[t],value:""+n.getLabelForValue(i[n.axis])}}parseObjectData(t,n,i,r){return nd.bind(this)(t,n,i,r)}update(t){const n=this._cachedMeta,i=n.dataset,r=n.data||[],s=n.iScale.getLabels();if(i.points=r,t!=="resize"){const a=this.resolveDatasetElementOptions(t);this.options.showLine||(a.borderWidth=0);const o={_loop:!0,_fullLoop:s.length===r.length,options:a};this.updateElement(i,void 0,o,t)}this.updateElements(r,0,r.length,t)}updateElements(t,n,i,r){const s=this._cachedMeta.rScale,a=r==="reset";for(let o=n;o<n+i;o++){const l=t[o],c=this.resolveDataElementOptions(o,l.active?"active":r),u=s.getPointPositionForValue(o,this.getParsed(o).r),h=a?s.xCenter:u.x,d=a?s.yCenter:u.y,y={x:h,y:d,angle:u.angle,skip:isNaN(h)||isNaN(d),options:c};this.updateElement(l,o,y,r)}}}Rs.id="radar";Rs.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};Rs.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class Be{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(t){const{x:n,y:i}=this.getProps(["x","y"],t);return{x:n,y:i}}hasValue(){return Ti(this.x)&&Ti(this.y)}getProps(t,n){const i=this.$animations;if(!n||!i)return this;const r={};return t.forEach(s=>{r[s]=i[s]&&i[s].active()?i[s]._to:this[s]}),r}}Be.defaults={};Be.defaultRoutes=void 0;const hd={values(e){return Nt(e)?e:""+e},numeric(e,t,n){if(e===0)return"0";const i=this.chart.options.locale;let r,s=e;if(n.length>1){const c=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(c<1e-4||c>1e15)&&(r="scientific"),s=Mb(e,n)}const a=be(Math.abs(s)),o=Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:r,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),xr(e,i,l)},logarithmic(e,t,n){if(e===0)return"0";const i=e/Math.pow(10,Math.floor(be(e)));return i===1||i===2||i===5?hd.numeric.call(this,e,t,n):""}};function Mb(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e)),n}var Is={formatters:hd};Lt.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Is.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}});Lt.route("scale.ticks","color","","color");Lt.route("scale.grid","color","","borderColor");Lt.route("scale.grid","borderColor","","borderColor");Lt.route("scale.title","color","","color");Lt.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"});Lt.describe("scales",{_fallback:"scale"});Lt.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"});function Ob(e,t){const n=e.options.ticks,i=n.maxTicksLimit||Pb(e),r=n.major.enabled?Ib(t):[],s=r.length,a=r[0],o=r[s-1],l=[];if(s>i)return wb(t,l,r,s/i),l;const c=Rb(r,t,i);if(s>0){let u,h;const d=s>1?Math.round((o-a)/(s-1)):null;for(kr(t,l,c,Ct(d)?0:a-d,a),u=0,h=s-1;u<h;u++)kr(t,l,c,r[u],r[u+1]);return kr(t,l,c,o,Ct(d)?t.length:o+d),l}return kr(t,l,c),l}function Pb(e){const t=e.options.offset,n=e._tickSize(),i=e._length/n+(t?0:1),r=e._maxLength/n;return Math.floor(Math.min(i,r))}function Rb(e,t,n){const i=kb(e),r=t.length/n;if(!i)return Math.max(r,1);const s=RE(i);for(let a=0,o=s.length-1;a<o;a++){const l=s[a];if(l>r)return l}return Math.max(r,1)}function Ib(e){const t=[];let n,i;for(n=0,i=e.length;n<i;n++)e[n].major&&t.push(n);return t}function wb(e,t,n,i){let r=0,s=n[0],a;for(i=Math.ceil(i),a=0;a<e.length;a++)a===s&&(t.push(e[a]),r++,s=n[r*i])}function kr(e,t,n,i,r){const s=xt(i,0),a=Math.min(xt(r,e.length),e.length);let o=0,l,c,u;for(n=Math.ceil(n),r&&(l=r-i,n=l/Math.floor(l/n)),u=s;u<0;)o++,u=Math.round(s+o*n);for(c=Math.max(s,0);c<a;c++)c===u&&(t.push(e[c]),o++,u=Math.round(s+o*n))}function kb(e){const t=e.length;let n,i;if(t<2)return!1;for(i=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==i)return!1;return i}const Fb=e=>e==="left"?"right":e==="right"?"left":e,bc=(e,t,n)=>t==="top"||t==="left"?e[t]+n:e[t]-n;function Tc(e,t){const n=[],i=e.length/t,r=e.length;let s=0;for(;s<r;s+=i)n.push(e[Math.floor(s)]);return n}function Bb(e,t,n){const i=e.ticks.length,r=Math.min(t,i-1),s=e._startPixel,a=e._endPixel,o=1e-6;let l=e.getPixelForTick(r),c;if(!(n&&(i===1?c=Math.max(l-s,a-l):t===0?c=(e.getPixelForTick(1)-l)/2:c=(l-e.getPixelForTick(r-1))/2,l+=r<t?c:-c,l<s-o||l>a+o)))return l}function Nb(e,t){Pt(e,n=>{const i=n.gc,r=i.length/2;let s;if(r>t){for(s=0;s<r;++s)delete n.data[i[s]];i.splice(0,r)}})}function Bi(e){return e.drawTicks?e.tickLength:0}function _c(e,t){if(!e.display)return 0;const n=Gt(e.font,t),i=oe(e.padding);return(Nt(e.text)?e.text.length:1)*n.lineHeight+i.height}function Ub(e,t){return Pn(e,{scale:t,type:"scale"})}function Wb(e,t,n){return Pn(e,{tick:n,index:t,type:"tick"})}function Kb(e,t,n){let i=bo(e);return(n&&t!=="right"||!n&&t==="right")&&(i=Fb(i)),i}function Hb(e,t,n,i){const{top:r,left:s,bottom:a,right:o,chart:l}=e,{chartArea:c,scales:u}=l;let h=0,d,y,x;const D=a-r,S=o-s;if(e.isHorizontal()){if(y=ie(i,s,o),_t(n)){const L=Object.keys(n)[0],g=n[L];x=u[L].getPixelForValue(g)+D-t}else n==="center"?x=(c.bottom+c.top)/2+D-t:x=bc(e,n,t);d=o-s}else{if(_t(n)){const L=Object.keys(n)[0],g=n[L];y=u[L].getPixelForValue(g)-S+t}else n==="center"?y=(c.left+c.right)/2-S+t:y=bc(e,n,t);x=ie(i,a,r),h=n==="left"?-Vt:Vt}return{titleX:y,titleY:x,maxWidth:d,rotation:h}}class ii extends Be{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,n){return t}getUserBounds(){let{_userMin:t,_userMax:n,_suggestedMin:i,_suggestedMax:r}=this;return t=Ee(t,Number.POSITIVE_INFINITY),n=Ee(n,Number.NEGATIVE_INFINITY),i=Ee(i,Number.POSITIVE_INFINITY),r=Ee(r,Number.NEGATIVE_INFINITY),{min:Ee(t,i),max:Ee(n,r),minDefined:$t(t),maxDefined:$t(n)}}getMinMax(t){let{min:n,max:i,minDefined:r,maxDefined:s}=this.getUserBounds(),a;if(r&&s)return{min:n,max:i};const o=this.getMatchingVisibleMetas();for(let l=0,c=o.length;l<c;++l)a=o[l].controller.getMinMax(this,t),r||(n=Math.min(n,a.min)),s||(i=Math.max(i,a.max));return n=s&&n>i?i:n,i=r&&n>i?n:i,{min:Ee(n,Ee(i,n)),max:Ee(i,Ee(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Bt(this.options.beforeUpdate,[this])}update(t,n,i){const{beginAtZero:r,grace:s,ticks:a}=this.options,o=a.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=n,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=xx(this,s,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=o<this.ticks.length;this._convertTicksToLabels(l?Tc(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=Ob(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,n,i;this.isHorizontal()?(n=this.left,i=this.right):(n=this.top,i=this.bottom,t=!t),this._startPixel=n,this._endPixel=i,this._reversePixels=t,this._length=i-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Bt(this.options.afterUpdate,[this])}beforeSetDimensions(){Bt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Bt(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Bt(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Bt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const n=this.options.ticks;let i,r,s;for(i=0,r=t.length;i<r;i++)s=t[i],s.label=Bt(n.callback,[s.value,i,t],this)}afterTickToLabelConversion(){Bt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Bt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,n=t.ticks,i=this.ticks.length,r=n.minRotation||0,s=n.maxRotation;let a=r,o,l,c;if(!this._isVisible()||!n.display||r>=s||i<=1||!this.isHorizontal()){this.labelRotation=r;return}const u=this._getLabelSizes(),h=u.widest.width,d=u.highest.height,y=Qt(this.chart.width-h,0,this.maxWidth);o=t.offset?this.maxWidth/i:y/(i-1),h+6>o&&(o=y/(i-(t.offset?.5:1)),l=this.maxHeight-Bi(t.grid)-n.padding-_c(t.title,this.chart.options.font),c=Math.sqrt(h*h+d*d),a=Eo(Math.min(Math.asin(Qt((u.highest.height+6)/o,-1,1)),Math.asin(Qt(l/c,-1,1))-Math.asin(Qt(d/c,-1,1)))),a=Math.max(r,Math.min(s,a))),this.labelRotation=a}afterCalculateLabelRotation(){Bt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Bt(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:n,options:{ticks:i,title:r,grid:s}}=this,a=this._isVisible(),o=this.isHorizontal();if(a){const l=_c(r,n.options.font);if(o?(t.width=this.maxWidth,t.height=Bi(s)+l):(t.height=this.maxHeight,t.width=Bi(s)+l),i.display&&this.ticks.length){const{first:c,last:u,widest:h,highest:d}=this._getLabelSizes(),y=i.padding*2,x=Me(this.labelRotation),D=Math.cos(x),S=Math.sin(x);if(o){const L=i.mirror?0:S*h.width+D*d.height;t.height=Math.min(this.maxHeight,t.height+L+y)}else{const L=i.mirror?0:D*h.width+S*d.height;t.width=Math.min(this.maxWidth,t.width+L+y)}this._calculatePadding(c,u,S,D)}}this._handleMargins(),o?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,n,i,r){const{ticks:{align:s,padding:a},position:o}=this.options,l=this.labelRotation!==0,c=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,y=0;l?c?(d=r*t.width,y=i*n.height):(d=i*t.height,y=r*n.width):s==="start"?y=n.width:s==="end"?d=t.width:s!=="inner"&&(d=t.width/2,y=n.width/2),this.paddingLeft=Math.max((d-u+a)*this.width/(this.width-u),0),this.paddingRight=Math.max((y-h+a)*this.width/(this.width-h),0)}else{let u=n.height/2,h=t.height/2;s==="start"?(u=0,h=t.height):s==="end"&&(u=n.height,h=0),this.paddingTop=u+a,this.paddingBottom=h+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Bt(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:n}=this.options;return n==="top"||n==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let n,i;for(n=0,i=t.length;n<i;n++)Ct(t[n].label)&&(t.splice(n,1),i--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const n=this.options.ticks.sampleSize;let i=this.ticks;n<i.length&&(i=Tc(i,n)),this._labelSizes=t=this._computeLabelSizes(i,i.length)}return t}_computeLabelSizes(t,n){const{ctx:i,_longestTextCache:r}=this,s=[],a=[];let o=0,l=0,c,u,h,d,y,x,D,S,L,g,f;for(c=0;c<n;++c){if(d=t[c].label,y=this._resolveTickFontOptions(c),i.font=x=y.string,D=r[x]=r[x]||{data:{},gc:[]},S=y.lineHeight,L=g=0,!Ct(d)&&!Nt(d))L=os(i,D.data,D.gc,L,d),g=S;else if(Nt(d))for(u=0,h=d.length;u<h;++u)f=d[u],!Ct(f)&&!Nt(f)&&(L=os(i,D.data,D.gc,L,f),g+=S);s.push(L),a.push(g),o=Math.max(L,o),l=Math.max(g,l)}Nb(r,n);const E=s.indexOf(o),_=a.indexOf(l),C=p=>({width:s[p]||0,height:a[p]||0});return{first:C(0),last:C(n-1),widest:C(E),highest:C(_),widths:s,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,n){return NaN}getValueForPixel(t){}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const n=this._startPixel+t*this._length;return kE(this._alignToPixels?Wn(this.chart,n,0):n)}getDecimalForPixel(t){const n=(t-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:n}=this;return t<0&&n<0?n:t>0&&n>0?t:0}getContext(t){const n=this.ticks||[];if(t>=0&&t<n.length){const i=n[t];return i.$context||(i.$context=Wb(this.getContext(),t,i))}return this.$context||(this.$context=Ub(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,n=Me(this.labelRotation),i=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),s=this._getLabelSizes(),a=t.autoSkipPadding||0,o=s?s.widest.width+a:0,l=s?s.highest.height+a:0;return this.isHorizontal()?l*i>o*r?o/i:l/r:l*r<o*i?l/i:o/r}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const n=this.axis,i=this.chart,r=this.options,{grid:s,position:a}=r,o=s.offset,l=this.isHorizontal(),u=this.ticks.length+(o?1:0),h=Bi(s),d=[],y=s.setContext(this.getContext()),x=y.drawBorder?y.borderWidth:0,D=x/2,S=function(M){return Wn(i,M,x)};let L,g,f,E,_,C,p,v,m,A,b,T;if(a==="top")L=S(this.bottom),C=this.bottom-h,v=L-D,A=S(t.top)+D,T=t.bottom;else if(a==="bottom")L=S(this.top),A=t.top,T=S(t.bottom)-D,C=L+D,v=this.top+h;else if(a==="left")L=S(this.right),_=this.right-h,p=L-D,m=S(t.left)+D,b=t.right;else if(a==="right")L=S(this.left),m=t.left,b=S(t.right)-D,_=L+D,p=this.left+h;else if(n==="x"){if(a==="center")L=S((t.top+t.bottom)/2+.5);else if(_t(a)){const M=Object.keys(a)[0],R=a[M];L=S(this.chart.scales[M].getPixelForValue(R))}A=t.top,T=t.bottom,C=L+D,v=C+h}else if(n==="y"){if(a==="center")L=S((t.left+t.right)/2);else if(_t(a)){const M=Object.keys(a)[0],R=a[M];L=S(this.chart.scales[M].getPixelForValue(R))}_=L-D,p=_-h,m=t.left,b=t.right}const P=xt(r.ticks.maxTicksLimit,u),O=Math.max(1,Math.ceil(u/P));for(g=0;g<u;g+=O){const M=s.setContext(this.getContext(g)),R=M.lineWidth,I=M.color,w=M.borderDash||[],k=M.borderDashOffset,B=M.tickWidth,F=M.tickColor,N=M.tickBorderDash||[],K=M.tickBorderDashOffset;f=Bb(this,g,o),f!==void 0&&(E=Wn(i,f,R),l?_=p=m=b=E:C=v=A=T=E,d.push({tx1:_,ty1:C,tx2:p,ty2:v,x1:m,y1:A,x2:b,y2:T,width:R,color:I,borderDash:w,borderDashOffset:k,tickWidth:B,tickColor:F,tickBorderDash:N,tickBorderDashOffset:K}))}return this._ticksLength=u,this._borderValue=L,d}_computeLabelItems(t){const n=this.axis,i=this.options,{position:r,ticks:s}=i,a=this.isHorizontal(),o=this.ticks,{align:l,crossAlign:c,padding:u,mirror:h}=s,d=Bi(i.grid),y=d+u,x=h?-u:y,D=-Me(this.labelRotation),S=[];let L,g,f,E,_,C,p,v,m,A,b,T,P="middle";if(r==="top")C=this.bottom-x,p=this._getXAxisLabelAlignment();else if(r==="bottom")C=this.top+x,p=this._getXAxisLabelAlignment();else if(r==="left"){const M=this._getYAxisLabelAlignment(d);p=M.textAlign,_=M.x}else if(r==="right"){const M=this._getYAxisLabelAlignment(d);p=M.textAlign,_=M.x}else if(n==="x"){if(r==="center")C=(t.top+t.bottom)/2+y;else if(_t(r)){const M=Object.keys(r)[0],R=r[M];C=this.chart.scales[M].getPixelForValue(R)+y}p=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")_=(t.left+t.right)/2-y;else if(_t(r)){const M=Object.keys(r)[0],R=r[M];_=this.chart.scales[M].getPixelForValue(R)}p=this._getYAxisLabelAlignment(d).textAlign}n==="y"&&(l==="start"?P="top":l==="end"&&(P="bottom"));const O=this._getLabelSizes();for(L=0,g=o.length;L<g;++L){f=o[L],E=f.label;const M=s.setContext(this.getContext(L));v=this.getPixelForTick(L)+s.labelOffset,m=this._resolveTickFontOptions(L),A=m.lineHeight,b=Nt(E)?E.length:1;const R=b/2,I=M.color,w=M.textStrokeColor,k=M.textStrokeWidth;let B=p;a?(_=v,p==="inner"&&(L===g-1?B=this.options.reverse?"left":"right":L===0?B=this.options.reverse?"right":"left":B="center"),r==="top"?c==="near"||D!==0?T=-b*A+A/2:c==="center"?T=-O.highest.height/2-R*A+A:T=-O.highest.height+A/2:c==="near"||D!==0?T=A/2:c==="center"?T=O.highest.height/2-R*A:T=O.highest.height-b*A,h&&(T*=-1)):(C=v,T=(1-b)*A/2);let F;if(M.showLabelBackdrop){const N=oe(M.backdropPadding),K=O.heights[L],H=O.widths[L];let U=C+T-N.top,j=_-N.left;switch(P){case"middle":U-=K/2;break;case"bottom":U-=K;break}switch(p){case"center":j-=H/2;break;case"right":j-=H;break}F={left:j,top:U,width:H+N.width,height:K+N.height,color:M.backdropColor}}S.push({rotation:D,label:E,font:m,color:I,strokeColor:w,strokeWidth:k,textOffset:T,textAlign:B,textBaseline:P,translation:[_,C],backdrop:F})}return S}_getXAxisLabelAlignment(){const{position:t,ticks:n}=this.options;if(-Me(this.labelRotation))return t==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(t){const{position:n,ticks:{crossAlign:i,mirror:r,padding:s}}=this.options,a=this._getLabelSizes(),o=t+s,l=a.widest.width;let c,u;return n==="left"?r?(u=this.right+s,i==="near"?c="left":i==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-o,i==="near"?c="right":i==="center"?(c="center",u-=l/2):(c="left",u=this.left)):n==="right"?r?(u=this.left+s,i==="near"?c="right":i==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+o,i==="near"?c="left":i==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:n},left:i,top:r,width:s,height:a}=this;n&&(t.save(),t.fillStyle=n,t.fillRect(i,r,s,a),t.restore())}getLineWidthForValue(t){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(s=>s.value===t);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(t){const n=this.options.grid,i=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let s,a;const o=(l,c,u)=>{!u.width||!u.color||(i.save(),i.lineWidth=u.width,i.strokeStyle=u.color,i.setLineDash(u.borderDash||[]),i.lineDashOffset=u.borderDashOffset,i.beginPath(),i.moveTo(l.x,l.y),i.lineTo(c.x,c.y),i.stroke(),i.restore())};if(n.display)for(s=0,a=r.length;s<a;++s){const l=r[s];n.drawOnChartArea&&o({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&o({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:n,options:{grid:i}}=this,r=i.setContext(this.getContext()),s=i.drawBorder?r.borderWidth:0;if(!s)return;const a=i.setContext(this.getContext(0)).lineWidth,o=this._borderValue;let l,c,u,h;this.isHorizontal()?(l=Wn(t,this.left,s)-s/2,c=Wn(t,this.right,a)+a/2,u=h=o):(u=Wn(t,this.top,s)-s/2,h=Wn(t,this.bottom,a)+a/2,l=c=o),n.save(),n.lineWidth=r.borderWidth,n.strokeStyle=r.borderColor,n.beginPath(),n.moveTo(l,u),n.lineTo(c,h),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;const i=this.ctx,r=this._computeLabelArea();r&&Ls(i,r);const s=this._labelItems||(this._labelItems=this._computeLabelItems(t));let a,o;for(a=0,o=s.length;a<o;++a){const l=s[a],c=l.font,u=l.label;l.backdrop&&(i.fillStyle=l.backdrop.color,i.fillRect(l.backdrop.left,l.backdrop.top,l.backdrop.width,l.backdrop.height));let h=l.textOffset;ei(i,u,0,h,c,l)}r&&Ds(i)}drawTitle(){const{ctx:t,options:{position:n,title:i,reverse:r}}=this;if(!i.display)return;const s=Gt(i.font),a=oe(i.padding),o=i.align;let l=s.lineHeight/2;n==="bottom"||n==="center"||_t(n)?(l+=a.bottom,Nt(i.text)&&(l+=s.lineHeight*(i.text.length-1))):l+=a.top;const{titleX:c,titleY:u,maxWidth:h,rotation:d}=Hb(this,l,n,o);ei(t,i.text,0,0,s,{color:i.color,maxWidth:h,rotation:d,textAlign:Kb(o,n,r),textBaseline:"middle",translation:[c,u]})}draw(t){!this._isVisible()||(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,n=t.ticks&&t.ticks.z||0,i=xt(t.grid&&t.grid.z,-1);return!this._isVisible()||this.draw!==ii.prototype.draw?[{z:n,draw:r=>{this.draw(r)}}]:[{z:i,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:i+1,draw:()=>{this.drawBorder()}},{z:n,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(t){const n=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",r=[];let s,a;for(s=0,a=n.length;s<a;++s){const o=n[s];o[i]===this.id&&(!t||o.type===t)&&r.push(o)}return r}_resolveTickFontOptions(t){const n=this.options.ticks.setContext(this.getContext(t));return Gt(n.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Fr{constructor(t,n,i){this.type=t,this.scope=n,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const n=Object.getPrototypeOf(t);let i;$b(n)&&(i=this.register(n));const r=this.items,s=t.id,a=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+t);return s in r||(r[s]=t,jb(t,a,i),this.override&&Lt.override(t.id,t.overrides)),a}get(t){return this.items[t]}unregister(t){const n=this.items,i=t.id,r=this.scope;i in n&&delete n[i],r&&i in Lt[r]&&(delete Lt[r][i],this.override&&delete ti[i])}}function jb(e,t,n){const i=fr(Object.create(null),[n?Lt.get(n):{},Lt.get(t),e.defaults]);Lt.set(t,i),e.defaultRoutes&&Vb(t,e.defaultRoutes),e.descriptors&&Lt.describe(t,e.descriptors)}function Vb(e,t){Object.keys(t).forEach(n=>{const i=n.split("."),r=i.pop(),s=[e].concat(i).join("."),a=t[n].split("."),o=a.pop(),l=a.join(".");Lt.route(s,r,l,o)})}function $b(e){return"id"in e&&"defaults"in e}class Gb{constructor(){this.controllers=new Fr(Fe,"datasets",!0),this.elements=new Fr(Be,"elements"),this.plugins=new Fr(Object,"plugins"),this.scales=new Fr(ii,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,n,i){[...n].forEach(r=>{const s=i||this._getRegistryForType(r);i||s.isForType(r)||s===this.plugins&&r.id?this._exec(t,s,r):Pt(r,a=>{const o=i||this._getRegistryForType(a);this._exec(t,o,a)})})}_exec(t,n,i){const r=yo(t);Bt(i["before"+r],[],i),n[t](i),Bt(i["after"+r],[],i)}_getRegistryForType(t){for(let n=0;n<this._typedRegistries.length;n++){const i=this._typedRegistries[n];if(i.isForType(t))return i}return this.plugins}_get(t,n,i){const r=n.get(t);if(r===void 0)throw new Error('"'+t+'" is not a registered '+i+".");return r}}var $e=new Gb;class ws extends Fe{update(t){const n=this._cachedMeta,{data:i=[]}=n,r=this.chart._animationsDisabled;let{start:s,count:a}=jf(n,i,r);if(this._drawStart=s,this._drawCount=a,Vf(n)&&(s=0,a=i.length),this.options.showLine){const{dataset:o,_dataset:l}=n;o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!l._decimated,o.points=i;const c=this.resolveDatasetElementOptions(t);c.segment=this.options.segment,this.updateElement(o,void 0,{animated:!r,options:c},t)}this.updateElements(i,s,a,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=$e.getElement("line")),super.addElements()}updateElements(t,n,i,r){const s=r==="reset",{iScale:a,vScale:o,_stacked:l,_dataset:c}=this._cachedMeta,u=this.resolveDataElementOptions(n,r),h=this.getSharedOptions(u),d=this.includeOptions(r,h),y=a.axis,x=o.axis,{spanGaps:D,segment:S}=this.options,L=Ti(D)?D:Number.POSITIVE_INFINITY,g=this.chart._animationsDisabled||s||r==="none";let f=n>0&&this.getParsed(n-1);for(let E=n;E<n+i;++E){const _=t[E],C=this.getParsed(E),p=g?_:{},v=Ct(C[x]),m=p[y]=a.getPixelForValue(C[y],E),A=p[x]=s||v?o.getBasePixel():o.getPixelForValue(l?this.applyStack(o,C,l):C[x],E);p.skip=isNaN(m)||isNaN(A)||v,p.stop=E>0&&Math.abs(C[y]-f[y])>L,S&&(p.parsed=C,p.raw=c.data[E]),d&&(p.options=h||this.resolveDataElementOptions(E,_.active?"active":r)),g||this.updateElement(_,E,p,r),f=C}this.updateSharedOptions(h,r,u)}getMaxOverflow(){const t=this._cachedMeta,n=t.data||[];if(!this.options.showLine){let o=0;for(let l=n.length-1;l>=0;--l)o=Math.max(o,n[l].size(this.resolveDataElementOptions(l))/2);return o>0&&o}const i=t.dataset,r=i.options&&i.options.borderWidth||0;if(!n.length)return r;const s=n[0].size(this.resolveDataElementOptions(0)),a=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(r,s,a)/2}}ws.id="scatter";ws.defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};ws.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title(){return""},label(e){return"("+e.label+", "+e.formattedValue+")"}}}},scales:{x:{type:"linear"},y:{type:"linear"}}};var zb=Object.freeze({__proto__:null,BarController:Cs,BubbleController:Ms,DoughnutController:Oi,LineController:Os,PolarAreaController:Ps,PieController:Oo,RadarController:Rs,ScatterController:ws});function Kn(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Pa{constructor(t){this.options=t||{}}init(t){}formats(){return Kn()}parse(t,n){return Kn()}format(t,n){return Kn()}add(t,n,i){return Kn()}diff(t,n,i){return Kn()}startOf(t,n,i){return Kn()}endOf(t,n){return Kn()}}Pa.override=function(e){Object.assign(Pa.prototype,e)};var Yb={_date:Pa};function Xb(e,t,n,i){const{controller:r,data:s,_sorted:a}=e,o=r._cachedMeta.iScale;if(o&&t===o.axis&&t!=="r"&&a&&s.length){const l=o._reversePixels?FE:cn;if(i){if(r._sharedOptions){const c=s[0],u=typeof c.getRange=="function"&&c.getRange(t);if(u){const h=l(s,t,n-u),d=l(s,t,n+u);return{lo:h.lo,hi:d.hi}}}}else return l(s,t,n)}return{lo:0,hi:s.length-1}}function br(e,t,n,i,r){const s=e.getSortedVisibleDatasetMetas(),a=n[t];for(let o=0,l=s.length;o<l;++o){const{index:c,data:u}=s[o],{lo:h,hi:d}=Xb(s[o],t,a,r);for(let y=h;y<=d;++y){const x=u[y];x.skip||i(x,c,y)}}}function Qb(e){const t=e.indexOf("x")!==-1,n=e.indexOf("y")!==-1;return function(i,r){const s=t?Math.abs(i.x-r.x):0,a=n?Math.abs(i.y-r.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(a,2))}}function sa(e,t,n,i,r){const s=[];return!r&&!e.isPointInArea(t)||br(e,n,t,function(o,l,c){!r&&!hr(o,e.chartArea,0)||o.inRange(t.x,t.y,i)&&s.push({element:o,datasetIndex:l,index:c})},!0),s}function Jb(e,t,n,i){let r=[];function s(a,o,l){const{startAngle:c,endAngle:u}=a.getProps(["startAngle","endAngle"],i),{angle:h}=Nf(a,{x:t.x,y:t.y});dr(h,c,u)&&r.push({element:a,datasetIndex:o,index:l})}return br(e,n,t,s),r}function Zb(e,t,n,i,r,s){let a=[];const o=Qb(n);let l=Number.POSITIVE_INFINITY;function c(u,h,d){const y=u.inRange(t.x,t.y,r);if(i&&!y)return;const x=u.getCenterPoint(r);if(!(!!s||e.isPointInArea(x))&&!y)return;const S=o(t,x);S<l?(a=[{element:u,datasetIndex:h,index:d}],l=S):S===l&&a.push({element:u,datasetIndex:h,index:d})}return br(e,n,t,c),a}function aa(e,t,n,i,r,s){return!s&&!e.isPointInArea(t)?[]:n==="r"&&!i?Jb(e,t,n,r):Zb(e,t,n,i,r,s)}function Sc(e,t,n,i,r){const s=[],a=n==="x"?"inXRange":"inYRange";let o=!1;return br(e,n,t,(l,c,u)=>{l[a](t[n],r)&&(s.push({element:l,datasetIndex:c,index:u}),o=o||l.inRange(t.x,t.y,r))}),i&&!o?[]:s}var qb={evaluateInteractionItems:br,modes:{index(e,t,n,i){const r=jn(t,e),s=n.axis||"x",a=n.includeInvisible||!1,o=n.intersect?sa(e,r,s,i,a):aa(e,r,s,!1,i,a),l=[];return o.length?(e.getSortedVisibleDatasetMetas().forEach(c=>{const u=o[0].index,h=c.data[u];h&&!h.skip&&l.push({element:h,datasetIndex:c.index,index:u})}),l):[]},dataset(e,t,n,i){const r=jn(t,e),s=n.axis||"xy",a=n.includeInvisible||!1;let o=n.intersect?sa(e,r,s,i,a):aa(e,r,s,!1,i,a);if(o.length>0){const l=o[0].datasetIndex,c=e.getDatasetMeta(l).data;o=[];for(let u=0;u<c.length;++u)o.push({element:c[u],datasetIndex:l,index:u})}return o},point(e,t,n,i){const r=jn(t,e),s=n.axis||"xy",a=n.includeInvisible||!1;return sa(e,r,s,i,a)},nearest(e,t,n,i){const r=jn(t,e),s=n.axis||"xy",a=n.includeInvisible||!1;return aa(e,r,s,n.intersect,i,a)},x(e,t,n,i){const r=jn(t,e);return Sc(e,r,"x",n.intersect,i)},y(e,t,n,i){const r=jn(t,e);return Sc(e,r,"y",n.intersect,i)}}};const gd=["left","top","right","bottom"];function Ni(e,t){return e.filter(n=>n.pos===t)}function Lc(e,t){return e.filter(n=>gd.indexOf(n.pos)===-1&&n.box.axis===t)}function Ui(e,t){return e.sort((n,i)=>{const r=t?i:n,s=t?n:i;return r.weight===s.weight?r.index-s.index:r.weight-s.weight})}function tT(e){const t=[];let n,i,r,s,a,o;for(n=0,i=(e||[]).length;n<i;++n)r=e[n],{position:s,options:{stack:a,stackWeight:o=1}}=r,t.push({index:n,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:a&&s+a,stackWeight:o});return t}function eT(e){const t={};for(const n of e){const{stack:i,pos:r,stackWeight:s}=n;if(!i||!gd.includes(r))continue;const a=t[i]||(t[i]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=s}return t}function nT(e,t){const n=eT(e),{vBoxMaxWidth:i,hBoxMaxHeight:r}=t;let s,a,o;for(s=0,a=e.length;s<a;++s){o=e[s];const{fullSize:l}=o.box,c=n[o.stack],u=c&&o.stackWeight/c.weight;o.horizontal?(o.width=u?u*i:l&&t.availableWidth,o.height=r):(o.width=i,o.height=u?u*r:l&&t.availableHeight)}return n}function iT(e){const t=tT(e),n=Ui(t.filter(c=>c.box.fullSize),!0),i=Ui(Ni(t,"left"),!0),r=Ui(Ni(t,"right")),s=Ui(Ni(t,"top"),!0),a=Ui(Ni(t,"bottom")),o=Lc(t,"x"),l=Lc(t,"y");return{fullSize:n,leftAndTop:i.concat(s),rightAndBottom:r.concat(l).concat(a).concat(o),chartArea:Ni(t,"chartArea"),vertical:i.concat(r).concat(l),horizontal:s.concat(a).concat(o)}}function Dc(e,t,n,i){return Math.max(e[n],t[n])+Math.max(e[i],t[i])}function vd(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function rT(e,t,n,i){const{pos:r,box:s}=n,a=e.maxPadding;if(!_t(r)){n.size&&(e[r]-=n.size);const h=i[n.stack]||{size:0,count:1};h.size=Math.max(h.size,n.horizontal?s.height:s.width),n.size=h.size/h.count,e[r]+=n.size}s.getPadding&&vd(a,s.getPadding());const o=Math.max(0,t.outerWidth-Dc(a,e,"left","right")),l=Math.max(0,t.outerHeight-Dc(a,e,"top","bottom")),c=o!==e.w,u=l!==e.h;return e.w=o,e.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}function sT(e){const t=e.maxPadding;function n(i){const r=Math.max(t[i]-e[i],0);return e[i]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function aT(e,t){const n=t.maxPadding;function i(r){const s={left:0,top:0,right:0,bottom:0};return r.forEach(a=>{s[a]=Math.max(t[a],n[a])}),s}return i(e?["left","right"]:["top","bottom"])}function Vi(e,t,n,i){const r=[];let s,a,o,l,c,u;for(s=0,a=e.length,c=0;s<a;++s){o=e[s],l=o.box,l.update(o.width||t.w,o.height||t.h,aT(o.horizontal,t));const{same:h,other:d}=rT(t,n,o,i);c|=h&&r.length,u=u||d,l.fullSize||r.push(o)}return c&&Vi(r,t,n,i)||u}function Br(e,t,n,i,r){e.top=n,e.left=t,e.right=t+i,e.bottom=n+r,e.width=i,e.height=r}function Ac(e,t,n,i){const r=n.padding;let{x:s,y:a}=t;for(const o of e){const l=o.box,c=i[o.stack]||{count:1,placed:0,weight:1},u=o.stackWeight/c.weight||1;if(o.horizontal){const h=t.w*u,d=c.size||l.height;_e(c.start)&&(a=c.start),l.fullSize?Br(l,r.left,a,n.outerWidth-r.right-r.left,d):Br(l,t.left+c.placed,a,h,d),c.start=a,c.placed+=h,a=l.bottom}else{const h=t.h*u,d=c.size||l.width;_e(c.start)&&(s=c.start),l.fullSize?Br(l,s,r.top,d,n.outerHeight-r.bottom-r.top):Br(l,s,t.top+c.placed,d,h),c.start=s,c.placed+=h,s=l.right}}t.x=s,t.y=a}Lt.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}});var ae={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(n){t.draw(n)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;n!==-1&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,i){if(!e)return;const r=oe(e.options.layout.padding),s=Math.max(t-r.width,0),a=Math.max(n-r.height,0),o=iT(e.boxes),l=o.vertical,c=o.horizontal;Pt(e.boxes,D=>{typeof D.beforeLayout=="function"&&D.beforeLayout()});const u=l.reduce((D,S)=>S.box.options&&S.box.options.display===!1?D:D+1,0)||1,h=Object.freeze({outerWidth:t,outerHeight:n,padding:r,availableWidth:s,availableHeight:a,vBoxMaxWidth:s/2/u,hBoxMaxHeight:a/2}),d=Object.assign({},r);vd(d,oe(i));const y=Object.assign({maxPadding:d,w:s,h:a,x:r.left,y:r.top},r),x=nT(l.concat(c),h);Vi(o.fullSize,y,h,x),Vi(l,y,h,x),Vi(c,y,h,x)&&Vi(l,y,h,x),sT(y),Ac(o.leftAndTop,y,h,x),y.x+=y.w,y.y+=y.h,Ac(o.rightAndBottom,y,h,x),e.chartArea={left:y.left,top:y.top,right:y.left+y.w,bottom:y.top+y.h,height:y.h,width:y.w},Pt(o.chartArea,D=>{const S=D.box;Object.assign(S,e.chartArea),S.update(y.w,y.h,{left:0,top:0,right:0,bottom:0})})}};class md{acquireContext(t,n){}releaseContext(t){return!1}addEventListener(t,n,i){}removeEventListener(t,n,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,n,i,r){return n=Math.max(0,n||t.width),i=i||t.height,{width:n,height:Math.max(0,r?Math.floor(n/r):i)}}isAttached(t){return!0}updateConfig(t){}}class oT extends md{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const Xr="$chartjs",lT={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Cc=e=>e===null||e==="";function cT(e,t){const n=e.style,i=e.getAttribute("height"),r=e.getAttribute("width");if(e[Xr]={initial:{height:i,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Cc(r)){const s=ac(e,"width");s!==void 0&&(e.width=s)}if(Cc(i))if(e.style.height==="")e.height=e.width/(t||2);else{const s=ac(e,"height");s!==void 0&&(e.height=s)}return e}const pd=jx?{passive:!0}:!1;function uT(e,t,n){e.addEventListener(t,n,pd)}function fT(e,t,n){e.canvas.removeEventListener(t,n,pd)}function dT(e,t){const n=lT[e.type]||e.type,{x:i,y:r}=jn(e,t);return{type:n,chart:t,native:e,x:i!==void 0?i:null,y:r!==void 0?r:null}}function cs(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function hT(e,t,n){const i=e.canvas,r=new MutationObserver(s=>{let a=!1;for(const o of s)a=a||cs(o.addedNodes,i),a=a&&!cs(o.removedNodes,i);a&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function gT(e,t,n){const i=e.canvas,r=new MutationObserver(s=>{let a=!1;for(const o of s)a=a||cs(o.removedNodes,i),a=a&&!cs(o.addedNodes,i);a&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const vr=new Map;let Mc=0;function yd(){const e=window.devicePixelRatio;e!==Mc&&(Mc=e,vr.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function vT(e,t){vr.size||window.addEventListener("resize",yd),vr.set(e,t)}function mT(e){vr.delete(e),vr.size||window.removeEventListener("resize",yd)}function pT(e,t,n){const i=e.canvas,r=i&&Mo(i);if(!r)return;const s=Hf((o,l)=>{const c=r.clientWidth;n(o,l),c<r.clientWidth&&n()},window),a=new ResizeObserver(o=>{const l=o[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||s(c,u)});return a.observe(r),vT(e,s),a}function oa(e,t,n){n&&n.disconnect(),t==="resize"&&mT(e)}function yT(e,t,n){const i=e.canvas,r=Hf(s=>{e.ctx!==null&&n(dT(s,e))},e,s=>{const a=s[0];return[a,a.offsetX,a.offsetY]});return uT(i,t,r),r}class ET extends md{acquireContext(t,n){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(cT(t,n),i):null}releaseContext(t){const n=t.canvas;if(!n[Xr])return!1;const i=n[Xr].initial;["height","width"].forEach(s=>{const a=i[s];Ct(a)?n.removeAttribute(s):n.setAttribute(s,a)});const r=i.style||{};return Object.keys(r).forEach(s=>{n.style[s]=r[s]}),n.width=n.width,delete n[Xr],!0}addEventListener(t,n,i){this.removeEventListener(t,n);const r=t.$proxies||(t.$proxies={}),a={attach:hT,detach:gT,resize:pT}[n]||yT;r[n]=a(t,n,i)}removeEventListener(t,n){const i=t.$proxies||(t.$proxies={}),r=i[n];if(!r)return;({attach:oa,detach:oa,resize:oa}[n]||fT)(t,n,r),i[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,n,i,r){return Hx(t,n,i,r)}isAttached(t){const n=Mo(t);return!!(n&&n.isConnected)}}function xT(e){return!rd()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?oT:ET}class bT{constructor(){this._init=[]}notify(t,n,i,r){n==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const s=r?this._descriptors(t).filter(r):this._descriptors(t),a=this._notify(s,t,n,i);return n==="afterDestroy"&&(this._notify(s,t,"stop"),this._notify(this._init,t,"uninstall")),a}_notify(t,n,i,r){r=r||{};for(const s of t){const a=s.plugin,o=a[i],l=[n,r,s.options];if(Bt(o,l,a)===!1&&r.cancelable)return!1}return!0}invalidate(){Ct(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),n}_createDescriptors(t,n){const i=t&&t.config,r=xt(i.options&&i.options.plugins,{}),s=TT(i);return r===!1&&!n?[]:ST(t,s,r,n)}_notifyStateChanges(t){const n=this._oldCache||[],i=this._cache,r=(s,a)=>s.filter(o=>!a.some(l=>o.plugin.id===l.plugin.id));this._notify(r(n,i),t,"stop"),this._notify(r(i,n),t,"start")}}function TT(e){const t={},n=[],i=Object.keys($e.plugins.items);for(let s=0;s<i.length;s++)n.push($e.getPlugin(i[s]));const r=e.plugins||[];for(let s=0;s<r.length;s++){const a=r[s];n.indexOf(a)===-1&&(n.push(a),t[a.id]=!0)}return{plugins:n,localIds:t}}function _T(e,t){return!t&&e===!1?null:e===!0?{}:e}function ST(e,{plugins:t,localIds:n},i,r){const s=[],a=e.getContext();for(const o of t){const l=o.id,c=_T(i[l],r);c!==null&&s.push({plugin:o,options:LT(e.config,{plugin:o,local:n[l]},c,a)})}return s}function LT(e,{plugin:t,local:n},i,r){const s=e.pluginScopeKeys(t),a=e.getOptionScopes(i,s);return n&&t.defaults&&a.push(t.defaults),e.createResolver(a,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Ra(e,t){const n=Lt.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function DT(e,t){let n=e;return e==="_index_"?n=t:e==="_value_"&&(n=t==="x"?"y":"x"),n}function AT(e,t){return e===t?"_index_":"_value_"}function CT(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function Ia(e,t){return e==="x"||e==="y"?e:t.axis||CT(t.position)||e.charAt(0).toLowerCase()}function MT(e,t){const n=ti[e.type]||{scales:{}},i=t.scales||{},r=Ra(e.type,t),s=Object.create(null),a=Object.create(null);return Object.keys(i).forEach(o=>{const l=i[o];if(!_t(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=Ia(o,l),u=AT(c,r),h=n.scales||{};s[c]=s[c]||o,a[o]=Yi(Object.create(null),[{axis:c},l,h[c],h[u]])}),e.data.datasets.forEach(o=>{const l=o.type||e.type,c=o.indexAxis||Ra(l,t),h=(ti[l]||{}).scales||{};Object.keys(h).forEach(d=>{const y=DT(d,c),x=o[y+"AxisID"]||s[y]||y;a[x]=a[x]||Object.create(null),Yi(a[x],[{axis:y},i[x],h[d]])})}),Object.keys(a).forEach(o=>{const l=a[o];Yi(l,[Lt.scales[l.type],Lt.scale])}),a}function Ed(e){const t=e.options||(e.options={});t.plugins=xt(t.plugins,{}),t.scales=MT(e,t)}function xd(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function OT(e){return e=e||{},e.data=xd(e.data),Ed(e),e}const Oc=new Map,bd=new Set;function Nr(e,t){let n=Oc.get(e);return n||(n=t(),Oc.set(e,n),bd.add(n)),n}const Wi=(e,t,n)=>{const i=Mn(t,n);i!==void 0&&e.add(i)};class PT{constructor(t){this._config=OT(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=xd(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),Ed(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Nr(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,n){return Nr(`${t}.transition.${n}`,()=>[[`datasets.${t}.transitions.${n}`,`transitions.${n}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,n){return Nr(`${t}-${n}`,()=>[[`datasets.${t}.elements.${n}`,`datasets.${t}`,`elements.${n}`,""]])}pluginScopeKeys(t){const n=t.id,i=this.type;return Nr(`${i}-plugin-${n}`,()=>[[`plugins.${n}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,n){const i=this._scopeCache;let r=i.get(t);return(!r||n)&&(r=new Map,i.set(t,r)),r}getOptionScopes(t,n,i){const{options:r,type:s}=this,a=this._cachedScopes(t,i),o=a.get(n);if(o)return o;const l=new Set;n.forEach(u=>{t&&(l.add(t),u.forEach(h=>Wi(l,t,h))),u.forEach(h=>Wi(l,r,h)),u.forEach(h=>Wi(l,ti[s]||{},h)),u.forEach(h=>Wi(l,Lt,h)),u.forEach(h=>Wi(l,Ma,h))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),bd.has(n)&&a.set(n,c),c}chartOptionScopes(){const{options:t,type:n}=this;return[t,ti[n]||{},Lt.datasets[n]||{},{type:n},Lt,Ma]}resolveNamedOptions(t,n,i,r=[""]){const s={$shared:!0},{resolver:a,subPrefixes:o}=Pc(this._resolverCache,t,r);let l=a;if(IT(a,n)){s.$shared=!1,i=On(i)?i():i;const c=this.createResolver(t,i,o);l=_i(a,i,c)}for(const c of n)s[c]=l[c];return s}createResolver(t,n,i=[""],r){const{resolver:s}=Pc(this._resolverCache,t,i);return _t(n)?_i(s,n,void 0,r):s}}function Pc(e,t,n){let i=e.get(t);i||(i=new Map,e.set(t,i));const r=n.join();let s=i.get(r);return s||(s={resolver:Do(t,n),subPrefixes:n.filter(o=>!o.toLowerCase().includes("hover"))},i.set(r,s)),s}const RT=e=>_t(e)&&Object.getOwnPropertyNames(e).reduce((t,n)=>t||On(e[n]),!1);function IT(e,t){const{isScriptable:n,isIndexable:i}=Zf(e);for(const r of t){const s=n(r),a=i(r),o=(a||s)&&e[r];if(s&&(On(o)||RT(o))||a&&Nt(o))return!0}return!1}var wT="3.9.1";const kT=["top","bottom","left","right","chartArea"];function Rc(e,t){return e==="top"||e==="bottom"||kT.indexOf(e)===-1&&t==="x"}function Ic(e,t){return function(n,i){return n[e]===i[e]?n[t]-i[t]:n[e]-i[e]}}function wc(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),Bt(n&&n.onComplete,[e],t)}function FT(e){const t=e.chart,n=t.options.animation;Bt(n&&n.onProgress,[e],t)}function Td(e){return rd()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const us={},_d=e=>{const t=Td(e);return Object.values(us).filter(n=>n.canvas===t).pop()};function BT(e,t,n){const i=Object.keys(e);for(const r of i){const s=+r;if(s>=t){const a=e[r];delete e[r],(n>0||s>t)&&(e[s+n]=a)}}}function NT(e,t,n,i){return!n||e.type==="mouseout"?null:i?t:e}class Ve{constructor(t,n){const i=this.config=new PT(n),r=Td(t),s=_d(r);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const a=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||xT(r)),this.platform.updateConfig(i);const o=this.platform.acquireContext(r,a.aspectRatio),l=o&&o.canvas,c=l&&l.height,u=l&&l.width;if(this.id=_E(),this.ctx=o,this.canvas=l,this.width=u,this.height=c,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new bT,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=UE(h=>this.update(h),a.resizeDelay||0),this._dataChanges=[],us[this.id]=this,!o||!l){console.error("Failed to create chart: can't acquire context from the given item");return}nn.listen(this,"complete",wc),nn.listen(this,"progress",FT),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:n},width:i,height:r,_aspectRatio:s}=this;return Ct(t)?n&&s?s:r?i/r:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():sc(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return nc(this.canvas,this.ctx),this}stop(){return nn.stop(this),this}resize(t,n){nn.running(this)?this._resizeBeforeDraw={width:t,height:n}:this._resize(t,n)}_resize(t,n){const i=this.options,r=this.canvas,s=i.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(r,t,n,s),o=i.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,sc(this,o,!0)&&(this.notifyPlugins("resize",{size:a}),Bt(i.onResize,[this,a],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Pt(n,(i,r)=>{i.id=r})}buildOrUpdateScales(){const t=this.options,n=t.scales,i=this.scales,r=Object.keys(i).reduce((a,o)=>(a[o]=!1,a),{});let s=[];n&&(s=s.concat(Object.keys(n).map(a=>{const o=n[a],l=Ia(a,o),c=l==="r",u=l==="x";return{options:o,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),Pt(s,a=>{const o=a.options,l=o.id,c=Ia(l,o),u=xt(o.type,a.dtype);(o.position===void 0||Rc(o.position,c)!==Rc(a.dposition))&&(o.position=a.dposition),r[l]=!0;let h=null;if(l in i&&i[l].type===u)h=i[l];else{const d=$e.getScale(u);h=new d({id:l,type:u,ctx:this.ctx,chart:this}),i[h.id]=h}h.init(o,t)}),Pt(r,(a,o)=>{a||delete i[o]}),Pt(i,a=>{ae.configure(this,a,a.options),ae.addBox(this,a)})}_updateMetasets(){const t=this._metasets,n=this.data.datasets.length,i=t.length;if(t.sort((r,s)=>r.index-s.index),i>n){for(let r=n;r<i;++r)this._destroyDatasetMeta(r);t.splice(n,i-n)}this._sortedMetasets=t.slice(0).sort(Ic("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:n}}=this;t.length>n.length&&delete this._stacks,t.forEach((i,r)=>{n.filter(s=>s===i._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const t=[],n=this.data.datasets;let i,r;for(this._removeUnreferencedMetasets(),i=0,r=n.length;i<r;i++){const s=n[i];let a=this.getDatasetMeta(i);const o=s.type||this.config.type;if(a.type&&a.type!==o&&(this._destroyDatasetMeta(i),a=this.getDatasetMeta(i)),a.type=o,a.indexAxis=s.indexAxis||Ra(o,this.options),a.order=s.order||0,a.index=i,a.label=""+s.label,a.visible=this.isDatasetVisible(i),a.controller)a.controller.updateIndex(i),a.controller.linkScales();else{const l=$e.getController(o),{datasetElementType:c,dataElementType:u}=Lt.datasets[o];Object.assign(l.prototype,{dataElementType:$e.getElement(u),datasetElementType:c&&$e.getElement(c)}),a.controller=new l(this,i),t.push(a.controller)}}return this._updateMetasets(),t}_resetElements(){Pt(this.data.datasets,(t,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const n=this.config;n.update();const i=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:h}=this.getDatasetMeta(c),d=!r&&s.indexOf(h)===-1;h.buildOrUpdateElements(d),a=Math.max(+h.getMaxOverflow(),a)}a=this._minPadding=i.layout.autoPadding?a:0,this._updateLayout(a),r||Pt(s,c=>{c.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(Ic("z","_idx"));const{_active:o,_lastEvent:l}=this;l?this._eventHandler(l,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){Pt(this.scales,t=>{ae.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,n=new Set(Object.keys(this._listeners)),i=new Set(t.events);(!Vl(n,i)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,n=this._getUniformDataChanges()||[];for(const{method:i,start:r,count:s}of n){const a=i==="_removeElements"?-s:s;BT(t,r,a)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const n=this.data.datasets.length,i=s=>new Set(t.filter(a=>a[0]===s).map((a,o)=>o+","+a.splice(1).join(","))),r=i(0);for(let s=1;s<n;s++)if(!Vl(r,i(s)))return;return Array.from(r).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;ae.update(this,this.width,this.height,t);const n=this.chartArea,i=n.width<=0||n.height<=0;this._layers=[],Pt(this.boxes,r=>{i&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,s)=>{r._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let n=0,i=this.data.datasets.length;n<i;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,i=this.data.datasets.length;n<i;++n)this._updateDataset(n,On(t)?t({datasetIndex:n}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,n){const i=this.getDatasetMeta(t),r={meta:i,index:t,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(i.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(nn.has(this)?this.attached&&!nn.running(this)&&nn.start(this):(this.draw(),wc({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:i,height:r}=this._resizeBeforeDraw;this._resize(i,r),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(this.chartArea);for(this._drawDatasets();t<n.length;++t)n[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const n=this._sortedMetasets,i=[];let r,s;for(r=0,s=n.length;r<s;++r){const a=n[r];(!t||a.visible)&&i.push(a)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)this._drawDataset(t[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const n=this.ctx,i=t._clip,r=!i.disabled,s=this.chartArea,a={meta:t,index:t.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",a)!==!1&&(r&&Ls(n,{left:i.left===!1?0:s.left-i.left,right:i.right===!1?this.width:s.right+i.right,top:i.top===!1?0:s.top-i.top,bottom:i.bottom===!1?this.height:s.bottom+i.bottom}),t.controller.draw(),r&&Ds(n),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(t){return hr(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,n,i,r){const s=qb.modes[n];return typeof s=="function"?s(this,t,i,r):[]}getDatasetMeta(t){const n=this.data.datasets[t],i=this._metasets;let r=i.filter(s=>s&&s._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:t,_dataset:n,_parsed:[],_sorted:!1},i.push(r)),r}getContext(){return this.$context||(this.$context=Pn(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const n=this.data.datasets[t];if(!n)return!1;const i=this.getDatasetMeta(t);return typeof i.hidden=="boolean"?!i.hidden:!n.hidden}setDatasetVisibility(t,n){const i=this.getDatasetMeta(t);i.hidden=!n}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,n,i){const r=i?"show":"hide",s=this.getDatasetMeta(t),a=s.controller._resolveAnimations(void 0,r);_e(n)?(s.data[n].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),a.update(s,{visible:i}),this.update(o=>o.datasetIndex===t?r:void 0))}hide(t,n){this._updateVisibility(t,n,!1)}show(t,n){this._updateVisibility(t,n,!0)}_destroyDatasetMeta(t){const n=this._metasets[t];n&&n.controller&&n.controller._destroy(),delete this._metasets[t]}_stop(){let t,n;for(this.stop(),nn.remove(this),t=0,n=this.data.datasets.length;t<n;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:n}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),nc(t,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),this.notifyPlugins("destroy"),delete us[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,n=this.platform,i=(s,a)=>{n.addEventListener(this,s,a),t[s]=a},r=(s,a,o)=>{s.offsetX=a,s.offsetY=o,this._eventHandler(s)};Pt(this.options.events,s=>i(s,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,n=this.platform,i=(l,c)=>{n.addEventListener(this,l,c),t[l]=c},r=(l,c)=>{t[l]&&(n.removeEventListener(this,l,c),delete t[l])},s=(l,c)=>{this.canvas&&this.resize(l,c)};let a;const o=()=>{r("attach",o),this.attached=!0,this.resize(),i("resize",s),i("detach",a)};a=()=>{this.attached=!1,r("resize",s),this._stop(),this._resize(0,0),i("attach",o)},n.isAttached(this.canvas)?o():a()}unbindEvents(){Pt(this._listeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._listeners={},Pt(this._responsiveListeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,n,i){const r=i?"set":"remove";let s,a,o,l;for(n==="dataset"&&(s=this.getDatasetMeta(t[0].datasetIndex),s.controller["_"+r+"DatasetHoverStyle"]()),o=0,l=t.length;o<l;++o){a=t[o];const c=a&&this.getDatasetMeta(a.datasetIndex).controller;c&&c[r+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const n=this._active||[],i=t.map(({datasetIndex:s,index:a})=>{const o=this.getDatasetMeta(s);if(!o)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:o.data[a],index:a}});!is(i,n)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,n))}notifyPlugins(t,n,i){return this._plugins.notify(this,t,n,i)}_updateHoverStyles(t,n,i){const r=this.options.hover,s=(l,c)=>l.filter(u=>!c.some(h=>u.datasetIndex===h.datasetIndex&&u.index===h.index)),a=s(n,t),o=i?t:s(t,n);a.length&&this.updateHoverStyle(a,r.mode,!1),o.length&&r.mode&&this.updateHoverStyle(o,r.mode,!0)}_eventHandler(t,n){const i={event:t,replay:n,cancelable:!0,inChartArea:this.isPointInArea(t)},r=a=>(a.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",i,r)===!1)return;const s=this._handleEvent(t,n,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,r),(s||i.changed)&&this.render(),this}_handleEvent(t,n,i){const{_active:r=[],options:s}=this,a=n,o=this._getActiveElements(t,r,i,a),l=ME(t),c=NT(t,this._lastEvent,i,l);i&&(this._lastEvent=null,Bt(s.onHover,[t,o,this],this),l&&Bt(s.onClick,[t,o,this],this));const u=!is(o,r);return(u||n)&&(this._active=o,this._updateHoverStyles(o,r,n)),this._lastEvent=c,u}_getActiveElements(t,n,i,r){if(t.type==="mouseout")return[];if(!i)return n;const s=this.options.hover;return this.getElementsAtEventForMode(t,s.mode,s,r)}}const kc=()=>Pt(Ve.instances,e=>e._plugins.invalidate()),vn=!0;Object.defineProperties(Ve,{defaults:{enumerable:vn,value:Lt},instances:{enumerable:vn,value:us},overrides:{enumerable:vn,value:ti},registry:{enumerable:vn,value:$e},version:{enumerable:vn,value:wT},getChart:{enumerable:vn,value:_d},register:{enumerable:vn,value:(...e)=>{$e.add(...e),kc()}},unregister:{enumerable:vn,value:(...e)=>{$e.remove(...e),kc()}}});function Sd(e,t,n){const{startAngle:i,pixelMargin:r,x:s,y:a,outerRadius:o,innerRadius:l}=t;let c=r/o;e.beginPath(),e.arc(s,a,o,i-c,n+c),l>r?(c=r/l,e.arc(s,a,l,n+c,i-c,!0)):e.arc(s,a,r,n+Vt,i-Vt),e.closePath(),e.clip()}function UT(e){return Lo(e,["outerStart","outerEnd","innerStart","innerEnd"])}function WT(e,t,n,i){const r=UT(e.options.borderRadius),s=(n-t)/2,a=Math.min(s,i*t/2),o=l=>{const c=(n-Math.min(s,l))*i/2;return Qt(l,0,Math.min(s,c))};return{outerStart:o(r.outerStart),outerEnd:o(r.outerEnd),innerStart:Qt(r.innerStart,0,a),innerEnd:Qt(r.innerEnd,0,a)}}function li(e,t,n,i){return{x:n+e*Math.cos(t),y:i+e*Math.sin(t)}}function wa(e,t,n,i,r,s){const{x:a,y:o,startAngle:l,pixelMargin:c,innerRadius:u}=t,h=Math.max(t.outerRadius+i+n-c,0),d=u>0?u+i+n+c:0;let y=0;const x=r-l;if(i){const M=u>0?u-i:0,R=h>0?h-i:0,I=(M+R)/2,w=I!==0?x*I/(I+i):x;y=(x-w)/2}const D=Math.max(.001,x*h-n/Kt)/h,S=(x-D)/2,L=l+S+y,g=r-S-y,{outerStart:f,outerEnd:E,innerStart:_,innerEnd:C}=WT(t,d,h,g-L),p=h-f,v=h-E,m=L+f/p,A=g-E/v,b=d+_,T=d+C,P=L+_/b,O=g-C/T;if(e.beginPath(),s){if(e.arc(a,o,h,m,A),E>0){const I=li(v,A,a,o);e.arc(I.x,I.y,E,A,g+Vt)}const M=li(T,g,a,o);if(e.lineTo(M.x,M.y),C>0){const I=li(T,O,a,o);e.arc(I.x,I.y,C,g+Vt,O+Math.PI)}if(e.arc(a,o,d,g-C/d,L+_/d,!0),_>0){const I=li(b,P,a,o);e.arc(I.x,I.y,_,P+Math.PI,L-Vt)}const R=li(p,L,a,o);if(e.lineTo(R.x,R.y),f>0){const I=li(p,m,a,o);e.arc(I.x,I.y,f,L-Vt,m)}}else{e.moveTo(a,o);const M=Math.cos(m)*h+a,R=Math.sin(m)*h+o;e.lineTo(M,R);const I=Math.cos(A)*h+a,w=Math.sin(A)*h+o;e.lineTo(I,w)}e.closePath()}function KT(e,t,n,i,r){const{fullCircles:s,startAngle:a,circumference:o}=t;let l=t.endAngle;if(s){wa(e,t,n,i,a+wt,r);for(let c=0;c<s;++c)e.fill();isNaN(o)||(l=a+o%wt,o%wt===0&&(l+=wt))}return wa(e,t,n,i,l,r),e.fill(),l}function HT(e,t,n){const{x:i,y:r,startAngle:s,pixelMargin:a,fullCircles:o}=t,l=Math.max(t.outerRadius-a,0),c=t.innerRadius+a;let u;for(n&&Sd(e,t,s+wt),e.beginPath(),e.arc(i,r,c,s+wt,s,!0),u=0;u<o;++u)e.stroke();for(e.beginPath(),e.arc(i,r,l,s,s+wt),u=0;u<o;++u)e.stroke()}function jT(e,t,n,i,r,s){const{options:a}=t,{borderWidth:o,borderJoinStyle:l}=a,c=a.borderAlign==="inner";!o||(c?(e.lineWidth=o*2,e.lineJoin=l||"round"):(e.lineWidth=o,e.lineJoin=l||"bevel"),t.fullCircles&&HT(e,t,c),c&&Sd(e,t,r),wa(e,t,n,i,r,s),e.stroke())}class ks extends Be{constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,n,i){const r=this.getProps(["x","y"],i),{angle:s,distance:a}=Nf(r,{x:t,y:n}),{startAngle:o,endAngle:l,innerRadius:c,outerRadius:u,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),d=this.options.spacing/2,x=xt(h,l-o)>=wt||dr(s,o,l),D=ln(a,c+d,u+d);return x&&D}getCenterPoint(t){const{x:n,y:i,startAngle:r,endAngle:s,innerRadius:a,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],t),{offset:l,spacing:c}=this.options,u=(r+s)/2,h=(a+o+c+l)/2;return{x:n+Math.cos(u)*h,y:i+Math.sin(u)*h}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:n,circumference:i}=this,r=(n.offset||0)/2,s=(n.spacing||0)/2,a=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=i>wt?Math.floor(i/wt):0,i===0||this.innerRadius<0||this.outerRadius<0)return;t.save();let o=0;if(r){o=r/2;const c=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(c)*o,Math.sin(c)*o),this.circumference>=Kt&&(o=r)}t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor;const l=KT(t,this,o,s,a);jT(t,this,o,s,l,a),t.restore()}}ks.id="arc";ks.defaults={borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};ks.defaultRoutes={backgroundColor:"backgroundColor"};function Ld(e,t,n=t){e.lineCap=xt(n.borderCapStyle,t.borderCapStyle),e.setLineDash(xt(n.borderDash,t.borderDash)),e.lineDashOffset=xt(n.borderDashOffset,t.borderDashOffset),e.lineJoin=xt(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=xt(n.borderWidth,t.borderWidth),e.strokeStyle=xt(n.borderColor,t.borderColor)}function VT(e,t,n){e.lineTo(n.x,n.y)}function $T(e){return e.stepped?dx:e.tension||e.cubicInterpolationMode==="monotone"?hx:VT}function Dd(e,t,n={}){const i=e.length,{start:r=0,end:s=i-1}=n,{start:a,end:o}=t,l=Math.max(r,a),c=Math.min(s,o),u=r<a&&s<a||r>o&&s>o;return{count:i,start:l,loop:t.loop,ilen:c<l&&!u?i+c-l:c-l}}function GT(e,t,n,i){const{points:r,options:s}=t,{count:a,start:o,loop:l,ilen:c}=Dd(r,n,i),u=$T(s);let{move:h=!0,reverse:d}=i||{},y,x,D;for(y=0;y<=c;++y)x=r[(o+(d?c-y:y))%a],!x.skip&&(h?(e.moveTo(x.x,x.y),h=!1):u(e,D,x,d,s.stepped),D=x);return l&&(x=r[(o+(d?c:0))%a],u(e,D,x,d,s.stepped)),!!l}function zT(e,t,n,i){const r=t.points,{count:s,start:a,ilen:o}=Dd(r,n,i),{move:l=!0,reverse:c}=i||{};let u=0,h=0,d,y,x,D,S,L;const g=E=>(a+(c?o-E:E))%s,f=()=>{D!==S&&(e.lineTo(u,S),e.lineTo(u,D),e.lineTo(u,L))};for(l&&(y=r[g(0)],e.moveTo(y.x,y.y)),d=0;d<=o;++d){if(y=r[g(d)],y.skip)continue;const E=y.x,_=y.y,C=E|0;C===x?(_<D?D=_:_>S&&(S=_),u=(h*u+E)/++h):(f(),e.lineTo(E,_),x=C,h=0,D=S=_),L=_}f()}function ka(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!n?zT:GT}function YT(e){return e.stepped?Vx:e.tension||e.cubicInterpolationMode==="monotone"?$x:Vn}function XT(e,t,n,i){let r=t._path;r||(r=t._path=new Path2D,t.path(r,n,i)&&r.closePath()),Ld(e,t.options),e.stroke(r)}function QT(e,t,n,i){const{segments:r,options:s}=t,a=ka(t);for(const o of r)Ld(e,s,o.style),e.beginPath(),a(e,t,o,{start:n,end:n+i-1})&&e.closePath(),e.stroke()}const JT=typeof Path2D=="function";function ZT(e,t,n,i){JT&&!t.options.segment?XT(e,t,n,i):QT(e,t,n,i)}class Rn extends Be{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,n){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const r=i.spanGaps?this._loop:this._fullLoop;Fx(this._points,i,t,r,n),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Zx(this,this.options.segment))}first(){const t=this.segments,n=this.points;return t.length&&n[t[0].start]}last(){const t=this.segments,n=this.points,i=t.length;return i&&n[t[i-1].end]}interpolate(t,n){const i=this.options,r=t[n],s=this.points,a=cd(this,{property:n,start:r,end:r});if(!a.length)return;const o=[],l=YT(i);let c,u;for(c=0,u=a.length;c<u;++c){const{start:h,end:d}=a[c],y=s[h],x=s[d];if(y===x){o.push(y);continue}const D=Math.abs((r-y[n])/(x[n]-y[n])),S=l(y,x,D,i.stepped);S[n]=t[n],o.push(S)}return o.length===1?o[0]:o}pathSegment(t,n,i){return ka(this)(t,this,n,i)}path(t,n,i){const r=this.segments,s=ka(this);let a=this._loop;n=n||0,i=i||this.points.length-n;for(const o of r)a&=s(t,this,o,{start:n,end:n+i-1});return!!a}draw(t,n,i,r){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(t.save(),ZT(t,this,i,r),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Rn.id="line";Rn.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};Rn.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};Rn.descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};function Fc(e,t,n,i){const r=e.options,{[n]:s}=e.getProps([n],i);return Math.abs(t-s)<r.radius+r.hitRadius}class Fs extends Be{constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,n,i){const r=this.options,{x:s,y:a}=this.getProps(["x","y"],i);return Math.pow(t-s,2)+Math.pow(n-a,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(t,n){return Fc(this,t,"x",n)}inYRange(t,n){return Fc(this,t,"y",n)}getCenterPoint(t){const{x:n,y:i}=this.getProps(["x","y"],t);return{x:n,y:i}}size(t){t=t||this.options||{};let n=t.radius||0;n=Math.max(n,n&&t.hoverRadius||0);const i=n&&t.borderWidth||0;return(n+i)*2}draw(t,n){const i=this.options;this.skip||i.radius<.1||!hr(this,n,this.size(i)/2)||(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,Oa(t,i,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}Fs.id="point";Fs.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};Fs.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};function Ad(e,t){const{x:n,y:i,base:r,width:s,height:a}=e.getProps(["x","y","base","width","height"],t);let o,l,c,u,h;return e.horizontal?(h=a/2,o=Math.min(n,r),l=Math.max(n,r),c=i-h,u=i+h):(h=s/2,o=n-h,l=n+h,c=Math.min(i,r),u=Math.max(i,r)),{left:o,top:c,right:l,bottom:u}}function Tn(e,t,n,i){return e?0:Qt(t,n,i)}function qT(e,t,n){const i=e.options.borderWidth,r=e.borderSkipped,s=Jf(i);return{t:Tn(r.top,s.top,0,n),r:Tn(r.right,s.right,0,t),b:Tn(r.bottom,s.bottom,0,n),l:Tn(r.left,s.left,0,t)}}function t_(e,t,n){const{enableBorderRadius:i}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,s=Zn(r),a=Math.min(t,n),o=e.borderSkipped,l=i||_t(r);return{topLeft:Tn(!l||o.top||o.left,s.topLeft,0,a),topRight:Tn(!l||o.top||o.right,s.topRight,0,a),bottomLeft:Tn(!l||o.bottom||o.left,s.bottomLeft,0,a),bottomRight:Tn(!l||o.bottom||o.right,s.bottomRight,0,a)}}function e_(e){const t=Ad(e),n=t.right-t.left,i=t.bottom-t.top,r=qT(e,n/2,i/2),s=t_(e,n/2,i/2);return{outer:{x:t.left,y:t.top,w:n,h:i,radius:s},inner:{x:t.left+r.l,y:t.top+r.t,w:n-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}function la(e,t,n,i){const r=t===null,s=n===null,o=e&&!(r&&s)&&Ad(e,i);return o&&(r||ln(t,o.left,o.right))&&(s||ln(n,o.top,o.bottom))}function n_(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function i_(e,t){e.rect(t.x,t.y,t.w,t.h)}function ca(e,t,n={}){const i=e.x!==n.x?-t:0,r=e.y!==n.y?-t:0,s=(e.x+e.w!==n.x+n.w?t:0)-i,a=(e.y+e.h!==n.y+n.h?t:0)-r;return{x:e.x+i,y:e.y+r,w:e.w+s,h:e.h+a,radius:e.radius}}class Bs extends Be{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:n,options:{borderColor:i,backgroundColor:r}}=this,{inner:s,outer:a}=e_(this),o=n_(a.radius)?gr:i_;t.save(),(a.w!==s.w||a.h!==s.h)&&(t.beginPath(),o(t,ca(a,n,s)),t.clip(),o(t,ca(s,-n,a)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),o(t,ca(s,n)),t.fillStyle=r,t.fill(),t.restore()}inRange(t,n,i){return la(this,t,n,i)}inXRange(t,n){return la(this,t,null,n)}inYRange(t,n){return la(this,null,t,n)}getCenterPoint(t){const{x:n,y:i,base:r,horizontal:s}=this.getProps(["x","y","base","horizontal"],t);return{x:s?(n+r)/2:n,y:s?i:(i+r)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}Bs.id="bar";Bs.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};Bs.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};var r_=Object.freeze({__proto__:null,ArcElement:ks,LineElement:Rn,PointElement:Fs,BarElement:Bs});function s_(e,t,n,i,r){const s=r.samples||i;if(s>=n)return e.slice(t,t+n);const a=[],o=(n-2)/(s-2);let l=0;const c=t+n-1;let u=t,h,d,y,x,D;for(a[l++]=e[u],h=0;h<s-2;h++){let S=0,L=0,g;const f=Math.floor((h+1)*o)+1+t,E=Math.min(Math.floor((h+2)*o)+1,n)+t,_=E-f;for(g=f;g<E;g++)S+=e[g].x,L+=e[g].y;S/=_,L/=_;const C=Math.floor(h*o)+1+t,p=Math.min(Math.floor((h+1)*o)+1,n)+t,{x:v,y:m}=e[u];for(y=x=-1,g=C;g<p;g++)x=.5*Math.abs((v-S)*(e[g].y-m)-(v-e[g].x)*(L-m)),x>y&&(y=x,d=e[g],D=g);a[l++]=d,u=D}return a[l++]=e[c],a}function a_(e,t,n,i){let r=0,s=0,a,o,l,c,u,h,d,y,x,D;const S=[],L=t+n-1,g=e[t].x,E=e[L].x-g;for(a=t;a<t+n;++a){o=e[a],l=(o.x-g)/E*i,c=o.y;const _=l|0;if(_===u)c<x?(x=c,h=a):c>D&&(D=c,d=a),r=(s*r+o.x)/++s;else{const C=a-1;if(!Ct(h)&&!Ct(d)){const p=Math.min(h,d),v=Math.max(h,d);p!==y&&p!==C&&S.push({...e[p],x:r}),v!==y&&v!==C&&S.push({...e[v],x:r})}a>0&&C!==y&&S.push(e[C]),S.push(o),u=_,s=0,x=D=c,h=d=y=a}}return S}function Cd(e){if(e._decimated){const t=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{value:t})}}function Bc(e){e.data.datasets.forEach(t=>{Cd(t)})}function o_(e,t){const n=t.length;let i=0,r;const{iScale:s}=e,{min:a,max:o,minDefined:l,maxDefined:c}=s.getUserBounds();return l&&(i=Qt(cn(t,s.axis,a).lo,0,n-1)),c?r=Qt(cn(t,s.axis,o).hi+1,i,n)-i:r=n-i,{start:i,count:r}}var l_={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,t,n)=>{if(!n.enabled){Bc(e);return}const i=e.width;e.data.datasets.forEach((r,s)=>{const{_data:a,indexAxis:o}=r,l=e.getDatasetMeta(s),c=a||r.data;if(ji([o,e.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const u=e.scales[l.xAxisID];if(u.type!=="linear"&&u.type!=="time"||e.options.parsing)return;let{start:h,count:d}=o_(l,c);const y=n.threshold||4*i;if(d<=y){Cd(r);return}Ct(a)&&(r._data=c,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(D){this._data=D}}));let x;switch(n.algorithm){case"lttb":x=s_(c,h,d,i,n);break;case"min-max":x=a_(c,h,d,i);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}r._decimated=x})},destroy(e){Bc(e)}};function c_(e,t,n){const i=e.segments,r=e.points,s=t.points,a=[];for(const o of i){let{start:l,end:c}=o;c=Po(l,c,r);const u=Fa(n,r[l],r[c],o.loop);if(!t.segments){a.push({source:o,target:u,start:r[l],end:r[c]});continue}const h=cd(t,u);for(const d of h){const y=Fa(n,s[d.start],s[d.end],d.loop),x=ld(o,r,y);for(const D of x)a.push({source:D,target:d,start:{[n]:Nc(u,y,"start",Math.max)},end:{[n]:Nc(u,y,"end",Math.min)}})}}return a}function Fa(e,t,n,i){if(i)return;let r=t[e],s=n[e];return e==="angle"&&(r=ge(r),s=ge(s)),{property:e,start:r,end:s}}function u_(e,t){const{x:n=null,y:i=null}=e||{},r=t.points,s=[];return t.segments.forEach(({start:a,end:o})=>{o=Po(a,o,r);const l=r[a],c=r[o];i!==null?(s.push({x:l.x,y:i}),s.push({x:c.x,y:i})):n!==null&&(s.push({x:n,y:l.y}),s.push({x:n,y:c.y}))}),s}function Po(e,t,n){for(;t>e;t--){const i=n[t];if(!isNaN(i.x)&&!isNaN(i.y))break}return t}function Nc(e,t,n,i){return e&&t?i(e[n],t[n]):e?e[n]:t?t[n]:0}function Md(e,t){let n=[],i=!1;return Nt(e)?(i=!0,n=e):n=u_(e,t),n.length?new Rn({points:n,options:{tension:0},_loop:i,_fullLoop:i}):null}function Uc(e){return e&&e.fill!==!1}function f_(e,t,n){let r=e[t].fill;const s=[t];let a;if(!n)return r;for(;r!==!1&&s.indexOf(r)===-1;){if(!$t(r))return r;if(a=e[r],!a)return!1;if(a.visible)return r;s.push(r),r=a.fill}return!1}function d_(e,t,n){const i=m_(e);if(_t(i))return isNaN(i.value)?!1:i;let r=parseFloat(i);return $t(r)&&Math.floor(r)===r?h_(i[0],t,r,n):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function h_(e,t,n,i){return(e==="-"||e==="+")&&(n=t+n),n===t||n<0||n>=i?!1:n}function g_(e,t){let n=null;return e==="start"?n=t.bottom:e==="end"?n=t.top:_t(e)?n=t.getPixelForValue(e.value):t.getBasePixel&&(n=t.getBasePixel()),n}function v_(e,t,n){let i;return e==="start"?i=n:e==="end"?i=t.options.reverse?t.min:t.max:_t(e)?i=e.value:i=t.getBaseValue(),i}function m_(e){const t=e.options,n=t.fill;let i=xt(n&&n.target,n);return i===void 0&&(i=!!t.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function p_(e){const{scale:t,index:n,line:i}=e,r=[],s=i.segments,a=i.points,o=y_(t,n);o.push(Md({x:null,y:t.bottom},i));for(let l=0;l<s.length;l++){const c=s[l];for(let u=c.start;u<=c.end;u++)E_(r,a[u],o)}return new Rn({points:r,options:{}})}function y_(e,t){const n=[],i=e.getMatchingVisibleMetas("line");for(let r=0;r<i.length;r++){const s=i[r];if(s.index===t)break;s.hidden||n.unshift(s.dataset)}return n}function E_(e,t,n){const i=[];for(let r=0;r<n.length;r++){const s=n[r],{first:a,last:o,point:l}=x_(s,t,"x");if(!(!l||a&&o)){if(a)i.unshift(l);else if(e.push(l),!o)break}}e.push(...i)}function x_(e,t,n){const i=e.interpolate(t,n);if(!i)return{};const r=i[n],s=e.segments,a=e.points;let o=!1,l=!1;for(let c=0;c<s.length;c++){const u=s[c],h=a[u.start][n],d=a[u.end][n];if(ln(r,h,d)){o=r===h,l=r===d;break}}return{first:o,last:l,point:i}}class Od{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,n,i){const{x:r,y:s,radius:a}=this;return n=n||{start:0,end:wt},t.arc(r,s,a,n.end,n.start,!0),!i.bounds}interpolate(t){const{x:n,y:i,radius:r}=this,s=t.angle;return{x:n+Math.cos(s)*r,y:i+Math.sin(s)*r,angle:s}}}function b_(e){const{chart:t,fill:n,line:i}=e;if($t(n))return T_(t,n);if(n==="stack")return p_(e);if(n==="shape")return!0;const r=__(e);return r instanceof Od?r:Md(r,i)}function T_(e,t){const n=e.getDatasetMeta(t);return n&&e.isDatasetVisible(t)?n.dataset:null}function __(e){return(e.scale||{}).getPointPositionForValue?L_(e):S_(e)}function S_(e){const{scale:t={},fill:n}=e,i=g_(n,t);if($t(i)){const r=t.isHorizontal();return{x:r?i:null,y:r?null:i}}return null}function L_(e){const{scale:t,fill:n}=e,i=t.options,r=t.getLabels().length,s=i.reverse?t.max:t.min,a=v_(n,t,s),o=[];if(i.grid.circular){const l=t.getPointPositionForValue(0,s);return new Od({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(a)})}for(let l=0;l<r;++l)o.push(t.getPointPositionForValue(l,a));return o}function ua(e,t,n){const i=b_(t),{line:r,scale:s,axis:a}=t,o=r.options,l=o.fill,c=o.backgroundColor,{above:u=c,below:h=c}=l||{};i&&r.points.length&&(Ls(e,n),D_(e,{line:r,target:i,above:u,below:h,area:n,scale:s,axis:a}),Ds(e))}function D_(e,t){const{line:n,target:i,above:r,below:s,area:a,scale:o}=t,l=n._loop?"angle":t.axis;e.save(),l==="x"&&s!==r&&(Wc(e,i,a.top),Kc(e,{line:n,target:i,color:r,scale:o,property:l}),e.restore(),e.save(),Wc(e,i,a.bottom)),Kc(e,{line:n,target:i,color:s,scale:o,property:l}),e.restore()}function Wc(e,t,n){const{segments:i,points:r}=t;let s=!0,a=!1;e.beginPath();for(const o of i){const{start:l,end:c}=o,u=r[l],h=r[Po(l,c,r)];s?(e.moveTo(u.x,u.y),s=!1):(e.lineTo(u.x,n),e.lineTo(u.x,u.y)),a=!!t.pathSegment(e,o,{move:a}),a?e.closePath():e.lineTo(h.x,n)}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function Kc(e,t){const{line:n,target:i,property:r,color:s,scale:a}=t,o=c_(n,i,r);for(const{source:l,target:c,start:u,end:h}of o){const{style:{backgroundColor:d=s}={}}=l,y=i!==!0;e.save(),e.fillStyle=d,A_(e,a,y&&Fa(r,u,h)),e.beginPath();const x=!!n.pathSegment(e,l);let D;if(y){x?e.closePath():Hc(e,i,h,r);const S=!!i.pathSegment(e,c,{move:x,reverse:!0});D=x&&S,D||Hc(e,i,u,r)}e.closePath(),e.fill(D?"evenodd":"nonzero"),e.restore()}}function A_(e,t,n){const{top:i,bottom:r}=t.chart.chartArea,{property:s,start:a,end:o}=n||{};s==="x"&&(e.beginPath(),e.rect(a,i,o-a,r-i),e.clip())}function Hc(e,t,n,i){const r=t.interpolate(n,i);r&&e.lineTo(r.x,r.y)}var C_={id:"filler",afterDatasetsUpdate(e,t,n){const i=(e.data.datasets||[]).length,r=[];let s,a,o,l;for(a=0;a<i;++a)s=e.getDatasetMeta(a),o=s.dataset,l=null,o&&o.options&&o instanceof Rn&&(l={visible:e.isDatasetVisible(a),index:a,fill:d_(o,a,i),chart:e,axis:s.controller.options.indexAxis,scale:s.vScale,line:o}),s.$filler=l,r.push(l);for(a=0;a<i;++a)l=r[a],!(!l||l.fill===!1)&&(l.fill=f_(r,a,n.propagate))},beforeDraw(e,t,n){const i=n.drawTime==="beforeDraw",r=e.getSortedVisibleDatasetMetas(),s=e.chartArea;for(let a=r.length-1;a>=0;--a){const o=r[a].$filler;!o||(o.line.updateControlPoints(s,o.axis),i&&o.fill&&ua(e.ctx,o,s))}},beforeDatasetsDraw(e,t,n){if(n.drawTime!=="beforeDatasetsDraw")return;const i=e.getSortedVisibleDatasetMetas();for(let r=i.length-1;r>=0;--r){const s=i[r].$filler;Uc(s)&&ua(e.ctx,s,e.chartArea)}},beforeDatasetDraw(e,t,n){const i=t.meta.$filler;!Uc(i)||n.drawTime!=="beforeDatasetDraw"||ua(e.ctx,i,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const jc=(e,t)=>{let{boxHeight:n=t,boxWidth:i=t}=e;return e.usePointStyle&&(n=Math.min(n,t),i=e.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(t,n)}},M_=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class Vc extends Be{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n,i){this.maxWidth=t,this.maxHeight=n,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let n=Bt(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter(i=>t.filter(i,this.chart.data))),t.sort&&(n=n.sort((i,r)=>t.sort(i,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:t,ctx:n}=this;if(!t.display){this.width=this.height=0;return}const i=t.labels,r=Gt(i.font),s=r.size,a=this._computeTitleHeight(),{boxWidth:o,itemHeight:l}=jc(i,s);let c,u;n.font=r.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(a,s,o,l)+10):(u=this.maxHeight,c=this._fitCols(a,s,o,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(u,t.maxHeight||this.maxHeight)}_fitRows(t,n,i,r){const{ctx:s,maxWidth:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=r+o;let h=t;s.textAlign="left",s.textBaseline="middle";let d=-1,y=-u;return this.legendItems.forEach((x,D)=>{const S=i+n/2+s.measureText(x.text).width;(D===0||c[c.length-1]+S+2*o>a)&&(h+=u,c[c.length-(D>0?0:1)]=0,y+=u,d++),l[D]={left:0,top:y,row:d,width:S,height:r},c[c.length-1]+=S+o}),h}_fitCols(t,n,i,r){const{ctx:s,maxHeight:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=a-t;let h=o,d=0,y=0,x=0,D=0;return this.legendItems.forEach((S,L)=>{const g=i+n/2+s.measureText(S.text).width;L>0&&y+r+2*o>u&&(h+=d+o,c.push({width:d,height:y}),x+=d+o,D++,d=y=0),l[L]={left:x,top:y,col:D,width:g,height:r},d=Math.max(d,g),y+=r+o}),h+=d,c.push({width:d,height:y}),h}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:i,labels:{padding:r},rtl:s}}=this,a=vi(s,this.left,this.width);if(this.isHorizontal()){let o=0,l=ie(i,this.left+r,this.right-this.lineWidths[o]);for(const c of n)o!==c.row&&(o=c.row,l=ie(i,this.left+r,this.right-this.lineWidths[o])),c.top+=this.top+t+r,c.left=a.leftForLtr(a.x(l),c.width),l+=c.width+r}else{let o=0,l=ie(i,this.top+t+r,this.bottom-this.columnSizes[o].height);for(const c of n)c.col!==o&&(o=c.col,l=ie(i,this.top+t+r,this.bottom-this.columnSizes[o].height)),c.top=l,c.left+=this.left+r,c.left=a.leftForLtr(a.x(c.left),c.width),l+=c.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;Ls(t,this),this._draw(),Ds(t)}}_draw(){const{options:t,columnSizes:n,lineWidths:i,ctx:r}=this,{align:s,labels:a}=t,o=Lt.color,l=vi(t.rtl,this.left,this.width),c=Gt(a.font),{color:u,padding:h}=a,d=c.size,y=d/2;let x;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=c.string;const{boxWidth:D,boxHeight:S,itemHeight:L}=jc(a,d),g=function(p,v,m){if(isNaN(D)||D<=0||isNaN(S)||S<0)return;r.save();const A=xt(m.lineWidth,1);if(r.fillStyle=xt(m.fillStyle,o),r.lineCap=xt(m.lineCap,"butt"),r.lineDashOffset=xt(m.lineDashOffset,0),r.lineJoin=xt(m.lineJoin,"miter"),r.lineWidth=A,r.strokeStyle=xt(m.strokeStyle,o),r.setLineDash(xt(m.lineDash,[])),a.usePointStyle){const b={radius:S*Math.SQRT2/2,pointStyle:m.pointStyle,rotation:m.rotation,borderWidth:A},T=l.xPlus(p,D/2),P=v+y;Qf(r,b,T,P,a.pointStyleWidth&&D)}else{const b=v+Math.max((d-S)/2,0),T=l.leftForLtr(p,D),P=Zn(m.borderRadius);r.beginPath(),Object.values(P).some(O=>O!==0)?gr(r,{x:T,y:b,w:D,h:S,radius:P}):r.rect(T,b,D,S),r.fill(),A!==0&&r.stroke()}r.restore()},f=function(p,v,m){ei(r,m.text,p,v+L/2,c,{strikethrough:m.hidden,textAlign:l.textAlign(m.textAlign)})},E=this.isHorizontal(),_=this._computeTitleHeight();E?x={x:ie(s,this.left+h,this.right-i[0]),y:this.top+h+_,line:0}:x={x:this.left+h,y:ie(s,this.top+_+h,this.bottom-n[0].height),line:0},sd(this.ctx,t.textDirection);const C=L+h;this.legendItems.forEach((p,v)=>{r.strokeStyle=p.fontColor||u,r.fillStyle=p.fontColor||u;const m=r.measureText(p.text).width,A=l.textAlign(p.textAlign||(p.textAlign=a.textAlign)),b=D+y+m;let T=x.x,P=x.y;l.setWidth(this.width),E?v>0&&T+b+h>this.right&&(P=x.y+=C,x.line++,T=x.x=ie(s,this.left+h,this.right-i[x.line])):v>0&&P+C>this.bottom&&(T=x.x=T+n[x.line].width+h,x.line++,P=x.y=ie(s,this.top+_+h,this.bottom-n[x.line].height));const O=l.x(T);g(O,P,p),T=WE(A,T+D+y,E?T+b:this.right,t.rtl),f(l.x(T),P,p),E?x.x+=b+h:x.y+=C}),ad(this.ctx,t.textDirection)}drawTitle(){const t=this.options,n=t.title,i=Gt(n.font),r=oe(n.padding);if(!n.display)return;const s=vi(t.rtl,this.left,this.width),a=this.ctx,o=n.position,l=i.size/2,c=r.top+l;let u,h=this.left,d=this.width;if(this.isHorizontal())d=Math.max(...this.lineWidths),u=this.top+c,h=ie(t.align,h,this.right-d);else{const x=this.columnSizes.reduce((D,S)=>Math.max(D,S.height),0);u=c+ie(t.align,this.top,this.bottom-x-t.labels.padding-this._computeTitleHeight())}const y=ie(o,h,h+d);a.textAlign=s.textAlign(bo(o)),a.textBaseline="middle",a.strokeStyle=n.color,a.fillStyle=n.color,a.font=i.string,ei(a,n.text,y,u,i)}_computeTitleHeight(){const t=this.options.title,n=Gt(t.font),i=oe(t.padding);return t.display?n.lineHeight+i.height:0}_getLegendItemAt(t,n){let i,r,s;if(ln(t,this.left,this.right)&&ln(n,this.top,this.bottom)){for(s=this.legendHitBoxes,i=0;i<s.length;++i)if(r=s[i],ln(t,r.left,r.left+r.width)&&ln(n,r.top,r.top+r.height))return this.legendItems[i]}return null}handleEvent(t){const n=this.options;if(!O_(t.type,n))return;const i=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const r=this._hoveredItem,s=M_(r,i);r&&!s&&Bt(n.onLeave,[t,r,this],this),this._hoveredItem=i,i&&!s&&Bt(n.onHover,[t,i,this],this)}else i&&Bt(n.onClick,[t,i,this],this)}}function O_(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var P_={id:"legend",_element:Vc,start(e,t,n){const i=e.legend=new Vc({ctx:e.ctx,options:n,chart:e});ae.configure(e,i,n),ae.addBox(e,i)},stop(e){ae.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const i=e.legend;ae.configure(e,i,n),i.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const i=t.datasetIndex,r=n.chart;r.isDatasetVisible(i)?(r.hide(i),t.hidden=!0):(r.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:r,color:s}}=e.legend.options;return e._getSortedDatasetMetas().map(a=>{const o=a.controller.getStyle(n?0:void 0),l=oe(o.borderWidth);return{text:t[a.index].label,fillStyle:o.backgroundColor,fontColor:s,hidden:!a.visible,lineCap:o.borderCapStyle,lineDash:o.borderDash,lineDashOffset:o.borderDashOffset,lineJoin:o.borderJoinStyle,lineWidth:(l.width+l.height)/4,strokeStyle:o.borderColor,pointStyle:i||o.pointStyle,rotation:o.rotation,textAlign:r||o.textAlign,borderRadius:0,datasetIndex:a.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class Ro extends Be{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=n;const r=Nt(i.text)?i.text.length:1;this._padding=oe(i.padding);const s=r*Gt(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:n,left:i,bottom:r,right:s,options:a}=this,o=a.align;let l=0,c,u,h;return this.isHorizontal()?(u=ie(o,i,s),h=n+t,c=s-i):(a.position==="left"?(u=i+t,h=ie(o,r,n),l=Kt*-.5):(u=s-t,h=ie(o,n,r),l=Kt*.5),c=r-n),{titleX:u,titleY:h,maxWidth:c,rotation:l}}draw(){const t=this.ctx,n=this.options;if(!n.display)return;const i=Gt(n.font),s=i.lineHeight/2+this._padding.top,{titleX:a,titleY:o,maxWidth:l,rotation:c}=this._drawArgs(s);ei(t,n.text,0,0,i,{color:n.color,maxWidth:l,rotation:c,textAlign:bo(n.align),textBaseline:"middle",translation:[a,o]})}}function R_(e,t){const n=new Ro({ctx:e.ctx,options:t,chart:e});ae.configure(e,n,t),ae.addBox(e,n),e.titleBlock=n}var I_={id:"title",_element:Ro,start(e,t,n){R_(e,n)},stop(e){const t=e.titleBlock;ae.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const i=e.titleBlock;ae.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Ur=new WeakMap;var w_={id:"subtitle",start(e,t,n){const i=new Ro({ctx:e.ctx,options:n,chart:e});ae.configure(e,i,n),ae.addBox(e,i),Ur.set(e,i)},stop(e){ae.removeBox(e,Ur.get(e)),Ur.delete(e)},beforeUpdate(e,t,n){const i=Ur.get(e);ae.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Zi={average(e){if(!e.length)return!1;let t,n,i=0,r=0,s=0;for(t=0,n=e.length;t<n;++t){const a=e[t].element;if(a&&a.hasValue()){const o=a.tooltipPosition();i+=o.x,r+=o.y,++s}}return{x:i/s,y:r/s}},nearest(e,t){if(!e.length)return!1;let n=t.x,i=t.y,r=Number.POSITIVE_INFINITY,s,a,o;for(s=0,a=e.length;s<a;++s){const l=e[s].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=Aa(t,c);u<r&&(r=u,o=l)}}if(o){const l=o.tooltipPosition();n=l.x,i=l.y}return{x:n,y:i}}};function Ke(e,t){return t&&(Nt(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function rn(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function k_(e,t){const{element:n,datasetIndex:i,index:r}=t,s=e.getDatasetMeta(i).controller,{label:a,value:o}=s.getLabelAndValue(r);return{chart:e,label:a,parsed:s.getParsed(r),raw:e.data.datasets[i].data[r],formattedValue:o,dataset:s.getDataset(),dataIndex:r,datasetIndex:i,element:n}}function $c(e,t){const n=e.chart.ctx,{body:i,footer:r,title:s}=e,{boxWidth:a,boxHeight:o}=t,l=Gt(t.bodyFont),c=Gt(t.titleFont),u=Gt(t.footerFont),h=s.length,d=r.length,y=i.length,x=oe(t.padding);let D=x.height,S=0,L=i.reduce((E,_)=>E+_.before.length+_.lines.length+_.after.length,0);if(L+=e.beforeBody.length+e.afterBody.length,h&&(D+=h*c.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),L){const E=t.displayColors?Math.max(o,l.lineHeight):l.lineHeight;D+=y*E+(L-y)*l.lineHeight+(L-1)*t.bodySpacing}d&&(D+=t.footerMarginTop+d*u.lineHeight+(d-1)*t.footerSpacing);let g=0;const f=function(E){S=Math.max(S,n.measureText(E).width+g)};return n.save(),n.font=c.string,Pt(e.title,f),n.font=l.string,Pt(e.beforeBody.concat(e.afterBody),f),g=t.displayColors?a+2+t.boxPadding:0,Pt(i,E=>{Pt(E.before,f),Pt(E.lines,f),Pt(E.after,f)}),g=0,n.font=u.string,Pt(e.footer,f),n.restore(),S+=x.width,{width:S,height:D}}function F_(e,t){const{y:n,height:i}=t;return n<i/2?"top":n>e.height-i/2?"bottom":"center"}function B_(e,t,n,i){const{x:r,width:s}=i,a=n.caretSize+n.caretPadding;if(e==="left"&&r+s+a>t.width||e==="right"&&r-s-a<0)return!0}function N_(e,t,n,i){const{x:r,width:s}=n,{width:a,chartArea:{left:o,right:l}}=e;let c="center";return i==="center"?c=r<=(o+l)/2?"left":"right":r<=s/2?c="left":r>=a-s/2&&(c="right"),B_(c,e,t,n)&&(c="center"),c}function Gc(e,t,n){const i=n.yAlign||t.yAlign||F_(e,n);return{xAlign:n.xAlign||t.xAlign||N_(e,t,n,i),yAlign:i}}function U_(e,t){let{x:n,width:i}=e;return t==="right"?n-=i:t==="center"&&(n-=i/2),n}function W_(e,t,n){let{y:i,height:r}=e;return t==="top"?i+=n:t==="bottom"?i-=r+n:i-=r/2,i}function zc(e,t,n,i){const{caretSize:r,caretPadding:s,cornerRadius:a}=e,{xAlign:o,yAlign:l}=n,c=r+s,{topLeft:u,topRight:h,bottomLeft:d,bottomRight:y}=Zn(a);let x=U_(t,o);const D=W_(t,l,c);return l==="center"?o==="left"?x+=c:o==="right"&&(x-=c):o==="left"?x-=Math.max(u,d)+r:o==="right"&&(x+=Math.max(h,y)+r),{x:Qt(x,0,i.width-t.width),y:Qt(D,0,i.height-t.height)}}function Wr(e,t,n){const i=oe(n.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-i.right:e.x+i.left}function Yc(e){return Ke([],rn(e))}function K_(e,t,n){return Pn(e,{tooltip:t,tooltipItems:n,type:"tooltip"})}function Xc(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}class Ba extends Be{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart||t._chart,this._chart=this.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const n=this.chart,i=this.options.setContext(this.getContext()),r=i.enabled&&n.options.animation&&i.animations,s=new ud(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=K_(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,n){const{callbacks:i}=n,r=i.beforeTitle.apply(this,[t]),s=i.title.apply(this,[t]),a=i.afterTitle.apply(this,[t]);let o=[];return o=Ke(o,rn(r)),o=Ke(o,rn(s)),o=Ke(o,rn(a)),o}getBeforeBody(t,n){return Yc(n.callbacks.beforeBody.apply(this,[t]))}getBody(t,n){const{callbacks:i}=n,r=[];return Pt(t,s=>{const a={before:[],lines:[],after:[]},o=Xc(i,s);Ke(a.before,rn(o.beforeLabel.call(this,s))),Ke(a.lines,o.label.call(this,s)),Ke(a.after,rn(o.afterLabel.call(this,s))),r.push(a)}),r}getAfterBody(t,n){return Yc(n.callbacks.afterBody.apply(this,[t]))}getFooter(t,n){const{callbacks:i}=n,r=i.beforeFooter.apply(this,[t]),s=i.footer.apply(this,[t]),a=i.afterFooter.apply(this,[t]);let o=[];return o=Ke(o,rn(r)),o=Ke(o,rn(s)),o=Ke(o,rn(a)),o}_createItems(t){const n=this._active,i=this.chart.data,r=[],s=[],a=[];let o=[],l,c;for(l=0,c=n.length;l<c;++l)o.push(k_(this.chart,n[l]));return t.filter&&(o=o.filter((u,h,d)=>t.filter(u,h,d,i))),t.itemSort&&(o=o.sort((u,h)=>t.itemSort(u,h,i))),Pt(o,u=>{const h=Xc(t.callbacks,u);r.push(h.labelColor.call(this,u)),s.push(h.labelPointStyle.call(this,u)),a.push(h.labelTextColor.call(this,u))}),this.labelColors=r,this.labelPointStyles=s,this.labelTextColors=a,this.dataPoints=o,o}update(t,n){const i=this.options.setContext(this.getContext()),r=this._active;let s,a=[];if(!r.length)this.opacity!==0&&(s={opacity:0});else{const o=Zi[i.position].call(this,r,this._eventPosition);a=this._createItems(i),this.title=this.getTitle(a,i),this.beforeBody=this.getBeforeBody(a,i),this.body=this.getBody(a,i),this.afterBody=this.getAfterBody(a,i),this.footer=this.getFooter(a,i);const l=this._size=$c(this,i),c=Object.assign({},o,l),u=Gc(this.chart,i,c),h=zc(i,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,s={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:o.x,caretY:o.y}}this._tooltipItems=a,this.$context=void 0,s&&this._resolveAnimations().update(this,s),t&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(t,n,i,r){const s=this.getCaretPosition(t,i,r);n.lineTo(s.x1,s.y1),n.lineTo(s.x2,s.y2),n.lineTo(s.x3,s.y3)}getCaretPosition(t,n,i){const{xAlign:r,yAlign:s}=this,{caretSize:a,cornerRadius:o}=i,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:h}=Zn(o),{x:d,y}=t,{width:x,height:D}=n;let S,L,g,f,E,_;return s==="center"?(E=y+D/2,r==="left"?(S=d,L=S-a,f=E+a,_=E-a):(S=d+x,L=S+a,f=E-a,_=E+a),g=S):(r==="left"?L=d+Math.max(l,u)+a:r==="right"?L=d+x-Math.max(c,h)-a:L=this.caretX,s==="top"?(f=y,E=f-a,S=L-a,g=L+a):(f=y+D,E=f+a,S=L+a,g=L-a),_=f),{x1:S,x2:L,x3:g,y1:f,y2:E,y3:_}}drawTitle(t,n,i){const r=this.title,s=r.length;let a,o,l;if(s){const c=vi(i.rtl,this.x,this.width);for(t.x=Wr(this,i.titleAlign,i),n.textAlign=c.textAlign(i.titleAlign),n.textBaseline="middle",a=Gt(i.titleFont),o=i.titleSpacing,n.fillStyle=i.titleColor,n.font=a.string,l=0;l<s;++l)n.fillText(r[l],c.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+o,l+1===s&&(t.y+=i.titleMarginBottom-o)}}_drawColorBox(t,n,i,r,s){const a=this.labelColors[i],o=this.labelPointStyles[i],{boxHeight:l,boxWidth:c,boxPadding:u}=s,h=Gt(s.bodyFont),d=Wr(this,"left",s),y=r.x(d),x=l<h.lineHeight?(h.lineHeight-l)/2:0,D=n.y+x;if(s.usePointStyle){const S={radius:Math.min(c,l)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},L=r.leftForLtr(y,c)+c/2,g=D+l/2;t.strokeStyle=s.multiKeyBackground,t.fillStyle=s.multiKeyBackground,Oa(t,S,L,g),t.strokeStyle=a.borderColor,t.fillStyle=a.backgroundColor,Oa(t,S,L,g)}else{t.lineWidth=_t(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,t.strokeStyle=a.borderColor,t.setLineDash(a.borderDash||[]),t.lineDashOffset=a.borderDashOffset||0;const S=r.leftForLtr(y,c-u),L=r.leftForLtr(r.xPlus(y,1),c-u-2),g=Zn(a.borderRadius);Object.values(g).some(f=>f!==0)?(t.beginPath(),t.fillStyle=s.multiKeyBackground,gr(t,{x:S,y:D,w:c,h:l,radius:g}),t.fill(),t.stroke(),t.fillStyle=a.backgroundColor,t.beginPath(),gr(t,{x:L,y:D+1,w:c-2,h:l-2,radius:g}),t.fill()):(t.fillStyle=s.multiKeyBackground,t.fillRect(S,D,c,l),t.strokeRect(S,D,c,l),t.fillStyle=a.backgroundColor,t.fillRect(L,D+1,c-2,l-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,n,i){const{body:r}=this,{bodySpacing:s,bodyAlign:a,displayColors:o,boxHeight:l,boxWidth:c,boxPadding:u}=i,h=Gt(i.bodyFont);let d=h.lineHeight,y=0;const x=vi(i.rtl,this.x,this.width),D=function(v){n.fillText(v,x.x(t.x+y),t.y+d/2),t.y+=d+s},S=x.textAlign(a);let L,g,f,E,_,C,p;for(n.textAlign=a,n.textBaseline="middle",n.font=h.string,t.x=Wr(this,S,i),n.fillStyle=i.bodyColor,Pt(this.beforeBody,D),y=o&&S!=="right"?a==="center"?c/2+u:c+2+u:0,E=0,C=r.length;E<C;++E){for(L=r[E],g=this.labelTextColors[E],n.fillStyle=g,Pt(L.before,D),f=L.lines,o&&f.length&&(this._drawColorBox(n,t,E,x,i),d=Math.max(h.lineHeight,l)),_=0,p=f.length;_<p;++_)D(f[_]),d=h.lineHeight;Pt(L.after,D)}y=0,d=h.lineHeight,Pt(this.afterBody,D),t.y-=s}drawFooter(t,n,i){const r=this.footer,s=r.length;let a,o;if(s){const l=vi(i.rtl,this.x,this.width);for(t.x=Wr(this,i.footerAlign,i),t.y+=i.footerMarginTop,n.textAlign=l.textAlign(i.footerAlign),n.textBaseline="middle",a=Gt(i.footerFont),n.fillStyle=i.footerColor,n.font=a.string,o=0;o<s;++o)n.fillText(r[o],l.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+i.footerSpacing}}drawBackground(t,n,i,r){const{xAlign:s,yAlign:a}=this,{x:o,y:l}=t,{width:c,height:u}=i,{topLeft:h,topRight:d,bottomLeft:y,bottomRight:x}=Zn(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(o+h,l),a==="top"&&this.drawCaret(t,n,i,r),n.lineTo(o+c-d,l),n.quadraticCurveTo(o+c,l,o+c,l+d),a==="center"&&s==="right"&&this.drawCaret(t,n,i,r),n.lineTo(o+c,l+u-x),n.quadraticCurveTo(o+c,l+u,o+c-x,l+u),a==="bottom"&&this.drawCaret(t,n,i,r),n.lineTo(o+y,l+u),n.quadraticCurveTo(o,l+u,o,l+u-y),a==="center"&&s==="left"&&this.drawCaret(t,n,i,r),n.lineTo(o,l+h),n.quadraticCurveTo(o,l,o+h,l),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(t){const n=this.chart,i=this.$animations,r=i&&i.x,s=i&&i.y;if(r||s){const a=Zi[t.position].call(this,this._active,this._eventPosition);if(!a)return;const o=this._size=$c(this,t),l=Object.assign({},a,this._size),c=Gc(n,t,l),u=zc(t,l,c,n);(r._to!==u.x||s._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=o.width,this.height=o.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(t){const n=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},s={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const a=oe(n.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&o&&(t.save(),t.globalAlpha=i,this.drawBackground(s,t,r,n),sd(t,n.textDirection),s.y+=a.top,this.drawTitle(s,t,n),this.drawBody(s,t,n),this.drawFooter(s,t,n),ad(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,n){const i=this._active,r=t.map(({datasetIndex:o,index:l})=>{const c=this.chart.getDatasetMeta(o);if(!c)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:c.data[l],index:l}}),s=!is(i,r),a=this._positionChanged(r,n);(s||a)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,n,i=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,s=this._active||[],a=this._getActiveElements(t,s,n,i),o=this._positionChanged(a,t),l=n||!is(a,s)||o;return l&&(this._active=a,(r.enabled||r.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,n))),l}_getActiveElements(t,n,i,r){const s=this.options;if(t.type==="mouseout")return[];if(!r)return n;const a=this.chart.getElementsAtEventForMode(t,s.mode,s,i);return s.reverse&&a.reverse(),a}_positionChanged(t,n){const{caretX:i,caretY:r,options:s}=this,a=Zi[s.position].call(this,t,n);return a!==!1&&(i!==a.x||r!==a.y)}}Ba.positioners=Zi;var H_={id:"tooltip",_element:Ba,positioners:Zi,afterInit(e,t,n){n&&(e.tooltip=new Ba({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",n)===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:tn,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,i=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return n[t.dataIndex]}return""},afterTitle:tn,beforeBody:tn,beforeLabel:tn,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return Ct(n)||(t+=n),t},labelColor(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:tn,afterBody:tn,beforeFooter:tn,footer:tn,afterFooter:tn}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},j_=Object.freeze({__proto__:null,Decimation:l_,Filler:C_,Legend:P_,SubTitle:w_,Title:I_,Tooltip:H_});const V_=(e,t,n,i)=>(typeof t=="string"?(n=e.push(t)-1,i.unshift({index:n,label:t})):isNaN(t)&&(n=null),n);function $_(e,t,n,i){const r=e.indexOf(t);if(r===-1)return V_(e,t,n,i);const s=e.lastIndexOf(t);return r!==s?n:r}const G_=(e,t)=>e===null?null:Qt(Math.round(e),0,t);class fs extends ii{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const n=this._addedLabels;if(n.length){const i=this.getLabels();for(const{index:r,label:s}of n)i[r]===s&&i.splice(r,1);this._addedLabels=[]}super.init(t)}parse(t,n){if(Ct(t))return null;const i=this.getLabels();return n=isFinite(n)&&i[n]===t?n:$_(i,t,xt(n,t),this._addedLabels),G_(n,i.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:i,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(i=0),n||(r=this.getLabels().length-1)),this.min=i,this.max=r}buildTicks(){const t=this.min,n=this.max,i=this.options.offset,r=[];let s=this.getLabels();s=t===0&&n===s.length-1?s:s.slice(t,n+1),this._valueRange=Math.max(s.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let a=t;a<=n;a++)r.push({value:a});return r}getLabelForValue(t){const n=this.getLabels();return t>=0&&t<n.length?n[t]:t}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}fs.id="category";fs.defaults={ticks:{callback:fs.prototype.getLabelForValue}};function z_(e,t){const n=[],{bounds:r,step:s,min:a,max:o,precision:l,count:c,maxTicks:u,maxDigits:h,includeBounds:d}=e,y=s||1,x=u-1,{min:D,max:S}=t,L=!Ct(a),g=!Ct(o),f=!Ct(c),E=(S-D)/(h+1);let _=Gl((S-D)/x/y)*y,C,p,v,m;if(_<1e-14&&!L&&!g)return[{value:D},{value:S}];m=Math.ceil(S/_)-Math.floor(D/_),m>x&&(_=Gl(m*_/x/y)*y),Ct(l)||(C=Math.pow(10,l),_=Math.ceil(_*C)/C),r==="ticks"?(p=Math.floor(D/_)*_,v=Math.ceil(S/_)*_):(p=D,v=S),L&&g&&s&&IE((o-a)/s,_/1e3)?(m=Math.round(Math.min((o-a)/_,u)),_=(o-a)/m,p=a,v=o):f?(p=L?a:p,v=g?o:v,m=c-1,_=(v-p)/m):(m=(v-p)/_,Xi(m,Math.round(m),_/1e3)?m=Math.round(m):m=Math.ceil(m));const A=Math.max(zl(_),zl(p));C=Math.pow(10,Ct(l)?A:l),p=Math.round(p*C)/C,v=Math.round(v*C)/C;let b=0;for(L&&(d&&p!==a?(n.push({value:a}),p<a&&b++,Xi(Math.round((p+b*_)*C)/C,a,Qc(a,E,e))&&b++):p<a&&b++);b<m;++b)n.push({value:Math.round((p+b*_)*C)/C});return g&&d&&v!==o?n.length&&Xi(n[n.length-1].value,o,Qc(o,E,e))?n[n.length-1].value=o:n.push({value:o}):(!g||v===o)&&n.push({value:v}),n}function Qc(e,t,{horizontal:n,minRotation:i}){const r=Me(i),s=(n?Math.sin(r):Math.cos(r))||.001,a=.75*t*(""+e).length;return Math.min(t/s,a)}class ds extends ii{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,n){return Ct(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:n,maxDefined:i}=this.getUserBounds();let{min:r,max:s}=this;const a=l=>r=n?r:l,o=l=>s=i?s:l;if(t){const l=Ye(r),c=Ye(s);l<0&&c<0?o(0):l>0&&c>0&&a(0)}if(r===s){let l=1;(s>=Number.MAX_SAFE_INTEGER||r<=Number.MIN_SAFE_INTEGER)&&(l=Math.abs(s*.05)),o(s+l),t||a(r-l)}this.min=r,this.max=s}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:n,stepSize:i}=t,r;return i?(r=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,n=t.ticks;let i=this.getTickLimit();i=Math.max(2,i);const r={maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},s=this._range||this,a=z_(r,s);return t.bounds==="ticks"&&Bf(a,this,"value"),t.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const t=this.ticks;let n=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const r=(i-n)/Math.max(t.length-1,1)/2;n-=r,i+=r}this._startValue=n,this._endValue=i,this._valueRange=i-n}getLabelForValue(t){return xr(t,this.chart.options.locale,this.options.ticks.format)}}class Io extends ds{determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=$t(t)?t:0,this.max=$t(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),n=t?this.width:this.height,i=Me(this.options.ticks.minRotation),r=(t?Math.sin(i):Math.cos(i))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,s.lineHeight/r))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}Io.id="linear";Io.defaults={ticks:{callback:Is.formatters.numeric}};function Jc(e){return e/Math.pow(10,Math.floor(be(e)))===1}function Y_(e,t){const n=Math.floor(be(t.max)),i=Math.ceil(t.max/Math.pow(10,n)),r=[];let s=Ee(e.min,Math.pow(10,Math.floor(be(t.min)))),a=Math.floor(be(s)),o=Math.floor(s/Math.pow(10,a)),l=a<0?Math.pow(10,Math.abs(a)):1;do r.push({value:s,major:Jc(s)}),++o,o===10&&(o=1,++a,l=a>=0?1:l),s=Math.round(o*Math.pow(10,a)*l)/l;while(a<n||a===n&&o<i);const c=Ee(e.max,s);return r.push({value:c,major:Jc(s)}),r}class wo extends ii{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,n){const i=ds.prototype.parse.apply(this,[t,n]);if(i===0){this._zero=!0;return}return $t(i)&&i>0?i:null}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=$t(t)?Math.max(0,t):null,this.max=$t(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let i=this.min,r=this.max;const s=l=>i=t?i:l,a=l=>r=n?r:l,o=(l,c)=>Math.pow(10,Math.floor(be(l))+c);i===r&&(i<=0?(s(1),a(10)):(s(o(i,-1)),a(o(r,1)))),i<=0&&s(o(r,-1)),r<=0&&a(o(i,1)),this._zero&&this.min!==this._suggestedMin&&i===o(this.min,0)&&s(o(i,-1)),this.min=i,this.max=r}buildTicks(){const t=this.options,n={min:this._userMin,max:this._userMax},i=Y_(n,this);return t.bounds==="ticks"&&Bf(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(t){return t===void 0?"0":xr(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=be(t),this._valueRange=be(this.max)-be(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(be(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const n=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+n*this._valueRange)}}wo.id="logarithmic";wo.defaults={ticks:{callback:Is.formatters.logarithmic,major:{enabled:!0}}};function Na(e){const t=e.ticks;if(t.display&&e.display){const n=oe(t.backdropPadding);return xt(t.font&&t.font.size,Lt.font.size)+n.height}return 0}function X_(e,t,n){return n=Nt(n)?n:[n],{w:fx(e,t.string,n),h:n.length*t.lineHeight}}function Zc(e,t,n,i,r){return e===i||e===r?{start:t-n/2,end:t+n/2}:e<i||e>r?{start:t-n,end:t}:{start:t,end:t+n}}function Q_(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),i=[],r=[],s=e._pointLabels.length,a=e.options.pointLabels,o=a.centerPointLabels?Kt/s:0;for(let l=0;l<s;l++){const c=a.setContext(e.getPointLabelContext(l));r[l]=c.padding;const u=e.getPointPosition(l,e.drawingArea+r[l],o),h=Gt(c.font),d=X_(e.ctx,h,e._pointLabels[l]);i[l]=d;const y=ge(e.getIndexAngle(l)+o),x=Math.round(Eo(y)),D=Zc(x,u.x,d.w,0,180),S=Zc(x,u.y,d.h,90,270);J_(n,t,y,D,S)}e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=Z_(e,i,r)}function J_(e,t,n,i,r){const s=Math.abs(Math.sin(n)),a=Math.abs(Math.cos(n));let o=0,l=0;i.start<t.l?(o=(t.l-i.start)/s,e.l=Math.min(e.l,t.l-o)):i.end>t.r&&(o=(i.end-t.r)/s,e.r=Math.max(e.r,t.r+o)),r.start<t.t?(l=(t.t-r.start)/a,e.t=Math.min(e.t,t.t-l)):r.end>t.b&&(l=(r.end-t.b)/a,e.b=Math.max(e.b,t.b+l))}function Z_(e,t,n){const i=[],r=e._pointLabels.length,s=e.options,a=Na(s)/2,o=e.drawingArea,l=s.pointLabels.centerPointLabels?Kt/r:0;for(let c=0;c<r;c++){const u=e.getPointPosition(c,o+a+n[c],l),h=Math.round(Eo(ge(u.angle+Vt))),d=t[c],y=eS(u.y,d.h,h),x=q_(h),D=tS(u.x,d.w,x);i.push({x:u.x,y,textAlign:x,left:D,top:y,right:D+d.w,bottom:y+d.h})}return i}function q_(e){return e===0||e===180?"center":e<180?"left":"right"}function tS(e,t,n){return n==="right"?e-=t:n==="center"&&(e-=t/2),e}function eS(e,t,n){return n===90||n===270?e-=t/2:(n>270||n<90)&&(e-=t),e}function nS(e,t){const{ctx:n,options:{pointLabels:i}}=e;for(let r=t-1;r>=0;r--){const s=i.setContext(e.getPointLabelContext(r)),a=Gt(s.font),{x:o,y:l,textAlign:c,left:u,top:h,right:d,bottom:y}=e._pointLabelItems[r],{backdropColor:x}=s;if(!Ct(x)){const D=Zn(s.borderRadius),S=oe(s.backdropPadding);n.fillStyle=x;const L=u-S.left,g=h-S.top,f=d-u+S.width,E=y-h+S.height;Object.values(D).some(_=>_!==0)?(n.beginPath(),gr(n,{x:L,y:g,w:f,h:E,radius:D}),n.fill()):n.fillRect(L,g,f,E)}ei(n,e._pointLabels[r],o,l+a.lineHeight/2,a,{color:s.color,textAlign:c,textBaseline:"middle"})}}function Pd(e,t,n,i){const{ctx:r}=e;if(n)r.arc(e.xCenter,e.yCenter,t,0,wt);else{let s=e.getPointPosition(0,t);r.moveTo(s.x,s.y);for(let a=1;a<i;a++)s=e.getPointPosition(a,t),r.lineTo(s.x,s.y)}}function iS(e,t,n,i){const r=e.ctx,s=t.circular,{color:a,lineWidth:o}=t;!s&&!i||!a||!o||n<0||(r.save(),r.strokeStyle=a,r.lineWidth=o,r.setLineDash(t.borderDash),r.lineDashOffset=t.borderDashOffset,r.beginPath(),Pd(e,n,s,i),r.closePath(),r.stroke(),r.restore())}function rS(e,t,n){return Pn(e,{label:n,index:t,type:"pointLabel"})}class Tr extends ds{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=oe(Na(this.options)/2),n=this.width=this.maxWidth-t.width,i=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+n/2+t.left),this.yCenter=Math.floor(this.top+i/2+t.top),this.drawingArea=Math.floor(Math.min(n,i)/2)}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!1);this.min=$t(t)&&!isNaN(t)?t:0,this.max=$t(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Na(this.options))}generateTickLabels(t){ds.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((n,i)=>{const r=Bt(this.options.pointLabels.callback,[n,i],this);return r||r===0?r:""}).filter((n,i)=>this.chart.getDataVisibility(i))}fit(){const t=this.options;t.display&&t.pointLabels.display?Q_(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,n,i,r){this.xCenter+=Math.floor((t-n)/2),this.yCenter+=Math.floor((i-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,n,i,r))}getIndexAngle(t){const n=wt/(this._pointLabels.length||1),i=this.options.startAngle||0;return ge(t*n+Me(i))}getDistanceFromCenterForValue(t){if(Ct(t))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*n:(t-this.min)*n}getValueForDistanceFromCenter(t){if(Ct(t))return NaN;const n=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(t){const n=this._pointLabels||[];if(t>=0&&t<n.length){const i=n[t];return rS(this.getContext(),t,i)}}getPointPosition(t,n,i=0){const r=this.getIndexAngle(t)-Vt+i;return{x:Math.cos(r)*n+this.xCenter,y:Math.sin(r)*n+this.yCenter,angle:r}}getPointPositionForValue(t,n){return this.getPointPosition(t,this.getDistanceFromCenterForValue(n))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:n,top:i,right:r,bottom:s}=this._pointLabelItems[t];return{left:n,top:i,right:r,bottom:s}}drawBackground(){const{backgroundColor:t,grid:{circular:n}}=this.options;if(t){const i=this.ctx;i.save(),i.beginPath(),Pd(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const t=this.ctx,n=this.options,{angleLines:i,grid:r}=n,s=this._pointLabels.length;let a,o,l;if(n.pointLabels.display&&nS(this,s),r.display&&this.ticks.forEach((c,u)=>{if(u!==0){o=this.getDistanceFromCenterForValue(c.value);const h=r.setContext(this.getContext(u-1));iS(this,h,o,s)}}),i.display){for(t.save(),a=s-1;a>=0;a--){const c=i.setContext(this.getPointLabelContext(a)),{color:u,lineWidth:h}=c;!h||!u||(t.lineWidth=h,t.strokeStyle=u,t.setLineDash(c.borderDash),t.lineDashOffset=c.borderDashOffset,o=this.getDistanceFromCenterForValue(n.ticks.reverse?this.min:this.max),l=this.getPointPosition(a,o),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(l.x,l.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,n=this.options,i=n.ticks;if(!i.display)return;const r=this.getIndexAngle(0);let s,a;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(r),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((o,l)=>{if(l===0&&!n.reverse)return;const c=i.setContext(this.getContext(l)),u=Gt(c.font);if(s=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){t.font=u.string,a=t.measureText(o.label).width,t.fillStyle=c.backdropColor;const h=oe(c.backdropPadding);t.fillRect(-a/2-h.left,-s-u.size/2-h.top,a+h.width,u.size+h.height)}ei(t,o.label,0,-s,u,{color:c.color})}),t.restore()}drawTitle(){}}Tr.id="radialLinear";Tr.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Is.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}};Tr.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};Tr.descriptors={angleLines:{_fallback:"grid"}};const Ns={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},fe=Object.keys(Ns);function sS(e,t){return e-t}function qc(e,t){if(Ct(t))return null;const n=e._adapter,{parser:i,round:r,isoWeekday:s}=e._parseOpts;let a=t;return typeof i=="function"&&(a=i(a)),$t(a)||(a=typeof i=="string"?n.parse(a,i):n.parse(a)),a===null?null:(r&&(a=r==="week"&&(Ti(s)||s===!0)?n.startOf(a,"isoWeek",s):n.startOf(a,r)),+a)}function tu(e,t,n,i){const r=fe.length;for(let s=fe.indexOf(e);s<r-1;++s){const a=Ns[fe[s]],o=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((n-t)/(o*a.size))<=i)return fe[s]}return fe[r-1]}function aS(e,t,n,i,r){for(let s=fe.length-1;s>=fe.indexOf(n);s--){const a=fe[s];if(Ns[a].common&&e._adapter.diff(r,i,a)>=t-1)return a}return fe[n?fe.indexOf(n):0]}function oS(e){for(let t=fe.indexOf(e)+1,n=fe.length;t<n;++t)if(Ns[fe[t]].common)return fe[t]}function eu(e,t,n){if(!n)e[t]=!0;else if(n.length){const{lo:i,hi:r}=xo(n,t),s=n[i]>=t?n[i]:n[r];e[s]=!0}}function lS(e,t,n,i){const r=e._adapter,s=+r.startOf(t[0].value,i),a=t[t.length-1].value;let o,l;for(o=s;o<=a;o=+r.add(o,1,i))l=n[o],l>=0&&(t[l].major=!0);return t}function nu(e,t,n){const i=[],r={},s=t.length;let a,o;for(a=0;a<s;++a)o=t[a],r[o]=a,i.push({value:o,major:!1});return s===0||!n?i:lS(e,i,r,n)}class _r extends ii{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,n){const i=t.time||(t.time={}),r=this._adapter=new Yb._date(t.adapters.date);r.init(n),Yi(i.displayFormats,r.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=n.normalized}parse(t,n){return t===void 0?null:qc(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,n=this._adapter,i=t.time.unit||"day";let{min:r,max:s,minDefined:a,maxDefined:o}=this.getUserBounds();function l(c){!a&&!isNaN(c.min)&&(r=Math.min(r,c.min)),!o&&!isNaN(c.max)&&(s=Math.max(s,c.max))}(!a||!o)&&(l(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=$t(r)&&!isNaN(r)?r:+n.startOf(Date.now(),i),s=$t(s)&&!isNaN(s)?s:+n.endOf(Date.now(),i)+1,this.min=Math.min(r,s-1),this.max=Math.max(r+1,s)}_getLabelBounds(){const t=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(n=t[0],i=t[t.length-1]),{min:n,max:i}}buildTicks(){const t=this.options,n=t.time,i=t.ticks,r=i.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const s=this.min,a=this.max,o=BE(r,s,a);return this._unit=n.unit||(i.autoSkip?tu(n.minUnit,this.min,this.max,this._getLabelCapacity(s)):aS(this,o.length,n.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:oS(this._unit),this.initOffsets(r),t.reverse&&o.reverse(),nu(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t){let n=0,i=0,r,s;this.options.offset&&t.length&&(r=this.getDecimalForValue(t[0]),t.length===1?n=1-r:n=(this.getDecimalForValue(t[1])-r)/2,s=this.getDecimalForValue(t[t.length-1]),t.length===1?i=s:i=(s-this.getDecimalForValue(t[t.length-2]))/2);const a=t.length<3?.5:.25;n=Qt(n,0,a),i=Qt(i,0,a),this._offsets={start:n,end:i,factor:1/(n+1+i)}}_generate(){const t=this._adapter,n=this.min,i=this.max,r=this.options,s=r.time,a=s.unit||tu(s.minUnit,n,i,this._getLabelCapacity(n)),o=xt(s.stepSize,1),l=a==="week"?s.isoWeekday:!1,c=Ti(l)||l===!0,u={};let h=n,d,y;if(c&&(h=+t.startOf(h,"isoWeek",l)),h=+t.startOf(h,c?"day":a),t.diff(i,n,a)>1e5*o)throw new Error(n+" and "+i+" are too far apart with stepSize of "+o+" "+a);const x=r.ticks.source==="data"&&this.getDataTimestamps();for(d=h,y=0;d<i;d=+t.add(d,o,a),y++)eu(u,d,x);return(d===i||r.bounds==="ticks"||y===1)&&eu(u,d,x),Object.keys(u).sort((D,S)=>D-S).map(D=>+D)}getLabelForValue(t){const n=this._adapter,i=this.options.time;return i.tooltipFormat?n.format(t,i.tooltipFormat):n.format(t,i.displayFormats.datetime)}_tickFormatFunction(t,n,i,r){const s=this.options,a=s.time.displayFormats,o=this._unit,l=this._majorUnit,c=o&&a[o],u=l&&a[l],h=i[n],d=l&&u&&h&&h.major,y=this._adapter.format(t,r||(d?u:c)),x=s.ticks.callback;return x?Bt(x,[y,n,i],this):y}generateTickLabels(t){let n,i,r;for(n=0,i=t.length;n<i;++n)r=t[n],r.label=this._tickFormatFunction(r.value,n,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const n=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((n.start+i)*n.factor)}getValueForPixel(t){const n=this._offsets,i=this.getDecimalForPixel(t)/n.factor-n.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){const n=this.options.ticks,i=this.ctx.measureText(t).width,r=Me(this.isHorizontal()?n.maxRotation:n.minRotation),s=Math.cos(r),a=Math.sin(r),o=this._resolveTickFontOptions(0).size;return{w:i*s+o*a,h:i*a+o*s}}_getLabelCapacity(t){const n=this.options.time,i=n.displayFormats,r=i[n.unit]||i.millisecond,s=this._tickFormatFunction(t,0,nu(this,[t],this._majorUnit),r),a=this._getLabelSize(s),o=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return o>0?o:1}getDataTimestamps(){let t=this._cache.data||[],n,i;if(t.length)return t;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,i=r.length;n<i;++n)t=t.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let n,i;if(t.length)return t;const r=this.getLabels();for(n=0,i=r.length;n<i;++n)t.push(qc(this,r[n]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return Wf(t.sort(sS))}}_r.id="time";_r.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};function Kr(e,t,n){let i=0,r=e.length-1,s,a,o,l;n?(t>=e[i].pos&&t<=e[r].pos&&({lo:i,hi:r}=cn(e,"pos",t)),{pos:s,time:o}=e[i],{pos:a,time:l}=e[r]):(t>=e[i].time&&t<=e[r].time&&({lo:i,hi:r}=cn(e,"time",t)),{time:s,pos:o}=e[i],{time:a,pos:l}=e[r]);const c=a-s;return c?o+(l-o)*(t-s)/c:o}class ko extends _r{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(t);this._minPos=Kr(n,this.min),this._tableRange=Kr(n,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:n,max:i}=this,r=[],s=[];let a,o,l,c,u;for(a=0,o=t.length;a<o;++a)c=t[a],c>=n&&c<=i&&r.push(c);if(r.length<2)return[{time:n,pos:0},{time:i,pos:1}];for(a=0,o=r.length;a<o;++a)u=r[a+1],l=r[a-1],c=r[a],Math.round((u+l)/2)!==c&&s.push({time:c,pos:a/(o-1)});return s}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const n=this.getDataTimestamps(),i=this.getLabelTimestamps();return n.length&&i.length?t=this.normalize(n.concat(i)):t=n.length?n:i,t=this._cache.all=t,t}getDecimalForValue(t){return(Kr(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const n=this._offsets,i=this.getDecimalForPixel(t)/n.factor-n.end;return Kr(this._table,i*this._tableRange+this._minPos,!0)}}ko.id="timeseries";ko.defaults=_r.defaults;var cS=Object.freeze({__proto__:null,CategoryScale:fs,LinearScale:Io,LogarithmicScale:wo,RadialLinearScale:Tr,TimeScale:_r,TimeSeriesScale:ko});const uS=[zb,r_,j_,cS];Ve.register(...uS);const Us=e=>(Xe("data-v-a9b23cdf"),e=e(),Qe(),e),fS={key:0,class:"loader-holder"},dS={class:"twitch-analyze-container"},hS={key:0,class:"channel-info"},gS={class:"header-buttons"},vS={class:"info-each"},mS=Us(()=>$("div",{class:"info-type"}," Channel ",-1)),pS={class:"info-data"},yS={class:"info-each"},ES=Us(()=>$("div",{class:"info-type"}," Num Vods Analyzed ",-1)),xS={class:"info-data"},bS={key:0},TS={class:"info-each"},_S=Us(()=>$("div",{class:"info-type"}," Average Vod Views ",-1)),SS={class:"info-data"},LS={class:"info-each"},DS=Us(()=>$("div",{class:"info-type"}," Average Stream Length ",-1)),AS={class:"info-data"},CS={key:1,class:"click-tip"},MS={class:"chart-container chart-top"},OS={class:"chart-container"},PS={class:"chart-container"},RS={class:"chart-container"},IS={class:"chart-container"},wS={__name:"TwitchAnalyzeView",setup(e){const t=Mi(),n=me(),i=100,r=at(null),s=at(null),a=at(null),o=at(null),l=at(null),c=at([]),u=at(!0);he(async()=>{await h(),c.value.length>i&&(c.value.length=i),Ve.defaults.color="#ffffff",S(r.value,"node.game.displayName","Categories"),S(s.value,"node.publishedAt","Days Streamed",!0),L(),g(),f(),u.value=!1});const h=async()=>{u.value=!0;const C=t.params.twitchChannelName;let p=null,v=null;for(console.log("channel: ",C);c.value.length<i;){v=Xt(Df(C,p));const m=await fetch(de,v).then(A=>A.json());if(console.log(m),c.value.push(...m.data.user.videos.edges),c.value.length)p=c.value[c.value.length-1].cursor;else return;if(!p)return;console.log(c.value)}},d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],y=C=>d[new Date(C).getDay()],x=(C,p)=>p.split(".").reduce((v,m)=>v&&v[m]?v[m]:null,C),D=C=>["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)","white","rgba(255, 99, 132, 0.5)","rgba(54, 162, 235, 0.5)","rgba(255, 206, 86, 0.5)","rgba(75, 192, 192, 0.5)","rgba(153, 102, 255, 0.5)","rgba(255, 159, 64, 0.5)"].slice(0,C),S=(C,p,v,m=!1)=>{let A={};for(const b of c.value){const T=m?y(x(b,p)):x(b,p);A[T]?A[T]+=1:A[T]=1}console.log(A),m&&(A=Object.assign(d.reduce((b,T)=>({...b,[T]:null}),{}),A)),new Ve(C,{type:"doughnut",data:{labels:Object.keys(A),datasets:[{label:v,data:Object.values(A),backgroundColor:D(Object.keys(A).length),borderColor:D(Object.keys(A).length)}]}})},L=()=>{const C=c.value.map(p=>({x:p.node.lengthSeconds,y:p.node.viewCount}));console.log(C),new Ve(a.value,{type:"scatter",data:{labels:C.map(p=>wi(p.x)),datasets:[{label:"Vod Views",data:C,backgroundColor:"#a970ff"}]},options:{plugins:{title:{display:!0,text:"Vod Views vs Stream Length"},tooltip:{callbacks:{beforeLabel:p=>`(${wi(p.raw.x)})`,label:p=>`Vod Views: ${De(p.raw.y)}`}}},scales:{x:{ticks:{callback:wi}},y:{ticks:{callback:De}}}}})},g=()=>{const C=c.value.map(v=>v.node.viewCount).reverse(),p=c.value.map(v=>new Date(v.node.publishedAt).toLocaleDateString()).reverse();console.log(C,p),new Ve(o.value,{type:"bar",data:{labels:p,datasets:[{label:"Vod Views",data:C,backgroundColor:"#a970ff"}]},options:{plugins:{title:{display:!0,text:"Vod Views per Stream"},tooltip:{callbacks:{label:v=>`Vod Views: ${De(v.raw)}`}}},scales:{y:{ticks:{callback:De}}}}})},f=()=>{const C={};let p=null;for(const v of c.value.reverse()){p||(p=new Date(v.node.publishedAt));const m=new Date(v.node.publishedAt).toLocaleDateString(),A=v.node.lengthSeconds;if(C[m]===void 0){let b=0;for(;C[m]===void 0;)if(C[p.toLocaleDateString()]=0,p.setDate(p.getDate()+1),b++,b>100)return}C[m]+=A}console.log(C),new Ve(l.value,{type:"bar",data:{labels:Object.keys(C),datasets:[{label:"Stream Length",data:Object.values(C),backgroundColor:"#a970ff"}]},options:{plugins:{title:{display:!0,text:"Stream Length vs Date"},tooltip:{callbacks:{label:v=>wi(v.raw)}}},scales:{y:{ticks:{callback:wi}}}}})},E=()=>{const C=c.value.map(v=>v.node.viewCount),p=C.reduce((v,m)=>v+m,0)/C.length;return De(p)},_=()=>{const C=c.value.map(v=>v.node.lengthSeconds),p=C.reduce((v,m)=>v+m,0)/C.length;return uo(Math.round(p))};return(C,p)=>(it(),lt(Rt,null,[u.value?(it(),lt("div",fS,[pt(po)])):At("",!0),$("div",dS,[u.value?At("",!0):(it(),lt("div",hS,[$("div",gS,[$("div",{class:"button",onClick:p[0]||(p[0]=v=>ht(n).go(-1))},"Back")]),$("div",vS,[mS,$("div",pS,mt(ht(t).params.twitchChannelName),1)]),$("div",yS,[ES,$("div",xS,[c.value.length<i?(it(),lt("span",bS,"(All available vods) ")):At("",!0),we(mt(c.value.length),1)])]),$("div",TS,[_S,$("div",SS,mt(E()),1)]),$("div",LS,[DS,$("div",AS,mt(_()),1)])])),u.value?At("",!0):(it(),lt("div",CS,"click a category in legend to hide")),$("div",MS,[$("canvas",{ref_key:"gamesChart",ref:r,width:"400",height:"400"},null,512)]),$("div",OS,[$("canvas",{ref_key:"daysChart",ref:s,width:"400",height:"400"},null,512)]),$("div",PS,[$("canvas",{ref_key:"viewsChart",ref:a,width:"400",height:"400"},null,512)]),$("div",RS,[$("canvas",{ref_key:"viewsVsTimeChart",ref:o,width:"400",height:"400"},null,512)]),$("div",IS,[$("canvas",{ref_key:"streamLengthOverTimeChart",ref:l,width:"400",height:"400"},null,512)])])],64))}},kS=Ut(wS,[["__scopeId","data-v-a9b23cdf"]]);const Pi=e=>(Xe("data-v-821a356a"),e=e(),Qe(),e),FS={key:0,class:"loader-holder"},BS={class:"channel-info"},NS={class:"header-buttons"},US={key:0,class:"raw-data"},WS={key:1},KS={class:"info-each"},HS=Pi(()=>$("div",{class:"info-type"}," Channel ",-1)),jS={class:"info-data"},VS={class:"info-each"},$S=Pi(()=>$("div",{class:"info-type"}," Sample Size ",-1)),GS={class:"info-data"},zS={key:0,class:"info-each"},YS=Pi(()=>$("div",{class:"info-type"}," Average Account Creation Date ",-1)),XS={class:"info-data"},QS={key:1,class:"info-each"},JS=Pi(()=>$("div",{class:"info-type"}," Common Name Length ",-1)),ZS={class:"info-data"},qS={key:2,class:"info-each"},t1=Pi(()=>$("div",{class:"info-type"}," Most Common Name in Viewers ",-1)),e1={class:"info-data"},n1={key:3,class:"info-each"},i1=Pi(()=>$("div",{class:"info-type red"}," Invalid Channel ",-1)),r1=[i1],s1={__name:"TwitchAnalyzeLiveView",setup(e){const i=Mi(),r=me(),s=at([]),a=at([]),o=at(""),l=at(null),c=at(!0),u=at(!1),h=at(""),d=at(5),y=at(!1),x=async()=>{var p;const g=i.params.twitchChannelName,f=await fetch(ns(`http://tmi.twitch.tv/group/user/${g}/chatters`)).then(v=>v.json()),E=(p=f==null?void 0:f.chatters)==null?void 0:p.viewers;s.value=E;const _=Math.min(E.length,100),C=Array(_).fill(null).map(()=>Mm(i.params.twitchChannelName,E[Math.floor(Math.random()*E.length)]));for(let v=0;v<_;v+=35){const m=Xt(C.slice(v,v+35)),A=await fetch(de,m).then(b=>b.json());a.value=a.value.concat(A.map(b=>{var T,P;return new Date((P=(T=b==null?void 0:b.data)==null?void 0:T.targetUser)==null?void 0:P.createdAt).getTime()}))}a.value.sort()},D=()=>{if(!a.value.length)return;const g=[],f=new Date(a.value[0]).getFullYear();console.log(f);for(const _ of a.value){const C=new Date(_).getFullYear()-f;g[C]?g[C]++:g[C]=1}const E=[];for(let _=0;_<g.length;_++)E[_]=String(_+f);console.log(E),new Ve(l.value,{type:"bar",data:{labels:E,datasets:[{label:"Current Viewers",data:g,backgroundColor:"#a970ff"}]},options:{plugins:{title:{display:!0,text:"Viewer Account Date Created"}}}})};he(async()=>{c.value=!0,await x(),Ve.defaults.color="#ffffff",D(),c.value=!1,S()}),Pe([s,d],()=>{L()});const S=()=>{let g=0;a.value.forEach(f=>g+=f),console.log(g,g/a.value.length),u.value=g==0,g!=0&&(o.value=new Date(g/a.value.length).toLocaleDateString("default"))},L=()=>{if(!s.value||!s.value.length)return;let g="",f="",E=0,_=0;for(const C of s.value){const p=C.substring(0,d.value);p.length<d.value||(p==f?_++:(_=0,f=p),_>E&&(E=_,g=f))}h.value=g||"'None'"};return(g,f)=>(it(),lt(Rt,null,[c.value?(it(),lt("div",FS,[pt(po)])):At("",!0),$("div",BS,[$("div",NS,[$("div",{class:"back-button",onClick:f[0]||(f[0]=E=>ht(r).go(-1))},"Back"),$("div",{class:"data-button",onClick:f[1]||(f[1]=E=>y.value=!y.value)},mt(y.value?"Show Summary":"Show All"),1)]),y.value?(it(),lt("div",US,mt(s.value),1)):(it(),lt("div",WS,[$("div",KS,[HS,$("div",jS,mt(ht(i).params.twitchChannelName),1)]),$("div",VS,[$S,$("div",GS,mt(a.value.length),1)]),u.value?At("",!0):(it(),lt("div",zS,[YS,$("div",XS,mt(o.value),1)])),u.value?At("",!0):(it(),lt("div",QS,[JS,$("div",ZS,[zt($("input",{class:"number-input",type:"number","onUpdate:modelValue":f[2]||(f[2]=E=>d.value=E),min:"1"},null,512),[[on,d.value]])])])),u.value?(it(),lt("div",n1,r1)):(it(),lt("div",qS,[t1,$("div",e1,mt(h.value),1)]))]))]),$("div",{class:"chart-container",style:Dn(y.value?"opacity: 0":"")},[$("canvas",{ref_key:"createdChart",ref:l,width:"400",height:"400"},null,512)],4)],64))}},a1=Ut(s1,[["__scopeId","data-v-821a356a"]]),o1={},l1={class:"svg-icon",style:{width:"1em",height:"1em","vertical-align":"middle",fill:"currentColor",overflow:"hidden"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},c1=$("path",{d:"M891.161 512l-749.992 450v-900l749.992 450z"},null,-1),u1=[c1];function f1(e,t){return it(),lt("svg",l1,u1)}const d1=Ut(o1,[["render",f1]]),h1={},g1={version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 511.955 511.955",style:{"enable-background":"new 0 0 511.955 511.955"},"xml:space":"preserve"},v1=$("g",null,[$("path",{d:`M511.813,254.103c-0.96-5.227-5.653-8.853-10.88-8.853H36.293l195.2-195.093c4.053-4.267,3.947-10.987-0.213-15.04
        c-4.16-3.947-10.667-3.947-14.827,0L3.12,248.45c-4.16,4.16-4.16,10.88,0,15.04l213.333,213.333
        c4.267,4.053,10.987,3.947,15.04-0.213c3.947-4.16,3.947-10.667,0-14.827l-195.2-195.2h464.96
        C507.76,266.583,512.88,260.717,511.813,254.103z`})],-1),m1=[v1];function p1(e,t){return it(),lt("svg",g1,m1)}const y1=Ut(h1,[["render",p1]]);const E1={class:"page-view"},x1={class:"clips-page"},b1={class:"video-container"},T1=["src"],_1={class:"clip-title"},S1={class:"clip-date"},L1={class:"clip-views"},D1={__name:"TwitchClipsView",setup(e){const n=Mi(),i=me(),r=at(null),s=at([]),a=at(0),o=at(!1),l=at(0),c=at(null),u=at(!1),h=at(0);he(async()=>{await y(),await x(),window.addEventListener("wheel",L),window.addEventListener("scroll",g),window.addEventListener("keydown",f)}),Ci(()=>{window.removeEventListener("wheel",L),window.removeEventListener("scroll",g),window.removeEventListener("keydown",f)}),Pe(()=>s.value[1],async()=>{c.value.length<2&&await qa(),d()});const d=()=>{const m=s.value[1].source;c.value.forEach(A=>{A.src==m?(A.currentTime=0,A.play().then(()=>u.value=!1).catch(b=>{u.value=!0,console.log("play e-r")})):A.pause()})},y=async()=>{var b,T,P;const m=Xt(Wl(n.params.twitchChannelName)),A=await fetch(de,m).then(O=>O.json());console.log(A),r.value=(P=(T=(b=A==null?void 0:A.data)==null?void 0:b.user)==null?void 0:T.clips)==null?void 0:P.edges},x=async()=>{if(console.log(r.value),!!r.value){s.value.push({});for(const m in[0,1])await S(m),s.value.push(r.value[m]);S(2)}},D=m=>(m.includes("production.assets.clips.twitchcdn.net")||console.log(`error in converting clip src, origin not found:
`,m),m.replace("production.assets.clips.twitchcdn.net","clips-media-assets2.twitch.tv")),S=async m=>{const A=r.value[m].node.slug,b=Xt(Om(A)),T=await fetch(de,b).then(O=>O.json()),P=D(T.data.clip.videoQualities[0].sourceURL);r.value[m].source=P},L=m=>{if(!r.value)return;const A=m.deltaY>0;_(A)},g=m=>{const A=window.pageYOffset||document.documentElement.scrollTop,b=A>h.value;h.value=A,_(b)},f=m=>{m.key=="ArrowDown"?_(!0):m.key=="ArrowUp"?_(!1):(m.key==" "||m.key=="k")&&p({target:c.value.filter(A=>A.src==s.value[1].source)[0]})},E=m=>{setTimeout(()=>{Date.now()-l.value>150?o.value=!1:E(300-(Date.now()-l.value))},m)},_=async m=>{if(l.value=Date.now(),!o.value)if(o.value=!0,E(300),m)s.value.shift(),s.value.push(r.value[a.value+2]),a.value++,await C();else{if(a.value==0)return;s.value.pop(),s.value.unshift(a.value==1?{}:r.value[a.value-2]),a.value--}},C=async()=>{var m,A,b;if(a.value==r.value.length-2){console.log("fetching next batch: ");const T=r.value[a.value+1].cursor;if(!T)return console.log("error, no cursor present");const P=Xt(Wl(n.params.twitchChannelName,T)),O=await fetch(de,P).then(M=>M.json());console.log(O),r.value.push(...(b=(A=(m=O==null?void 0:O.data)==null?void 0:m.user)==null?void 0:A.clips)==null?void 0:b.edges)}r.value[a.value+2].source||S(a.value+2)},p=m=>{m.target.paused?(u.value=!1,m.target.play()):(u.value=!0,m.target.pause())},v=()=>{i.options.history.state.back?i.back():i.push(`/twitch/${n.params.twitchChannelName}`)};return(m,A)=>(it(),lt("div",E1,[$("div",x1,[pt(cf,{name:"clip-flow"},{default:Qn(()=>[(it(!0),lt(Rt,null,ze(s.value,b=>{var T,P,O,M;return it(),lt("div",{class:"clip-window",key:(b==null?void 0:b.source)||"empty"},[$("div",b1,[$("video",{class:"clip-video",src:b==null?void 0:b.source,controls:!1,autoplay:!1,loop:"","webkit-playsinline":"",playsinline:"",ref_for:!0,ref_key:"videoEls",ref:c,onClick:p,autobuffer:"true"},null,8,T1),$("div",_1,mt((T=b==null?void 0:b.node)==null?void 0:T.title),1),$("div",S1,mt(ht(fo)((P=b==null?void 0:b.node)==null?void 0:P.createdAt)),1),$("div",L1,mt((O=b==null?void 0:b.node)!=null&&O.viewCount?`${ht(De)((M=b==null?void 0:b.node)==null?void 0:M.viewCount)} Views`:""),1),u.value?(it(),Yt(d1,{key:0,class:"play-button"})):At("",!0)]),pt(y1,{class:"icon-back",onClick:v})])}),128))]),_:1})])]))}},A1=Ut(D1,[["__scopeId","data-v-4637894e"]]),C1=vm({history:Rv("/"),routes:[{path:"/",name:"home",component:Sy},{path:"/twitch/:twitchChannelName?",name:"twitch",component:aE},{path:"/youtube",name:"youtubelive",component:gE},{path:"/hls",alias:["/hls/twitch/:twitchChannelName?","/hls/twitchvod/:twitchVodId?","/hls/yt/:ytWatchId?"],name:"hls",component:Z0},{path:"/origview",name:"origview",component:bm},{path:"/overridesource",name:"overridesource",component:TE},{path:"/twitch/:twitchChannelName/analyze",name:"twitchAnalysis",component:kS},{path:"/twitch/:twitchChannelName/analyzelive/",name:"twitchLiveAnalysis",component:a1},{path:"/twitch/:twitchChannelName/clips",name:"twitchChannelClips",component:A1}]});const Rd=hv(pm);Rd.use(C1);Rd.mount("#app");
