(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();function Ka(e,t){const n=Object.create(null),i=e.split(",");for(let r=0;r<i.length;r++)n[i[r]]=!0;return t?r=>!!n[r.toLowerCase()]:r=>!!n[r]}const Hd="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",jd=Ka(Hd);function su(e){return!!e||e===""}function Ge(e){if(gt(e)){const t={};for(let n=0;n<e.length;n++){const i=e[n],r=Jt(i)?Gd(i):Ge(i);if(r)for(const s in r)t[s]=r[s]}return t}else{if(Jt(e))return e;if(Ft(e))return e}}const Vd=/;(?![^(]*\))/g,$d=/:(.+)/;function Gd(e){const t={};return e.split(Vd).forEach(n=>{if(n){const i=n.split($d);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function Ha(e){let t="";if(Jt(e))t=e;else if(gt(e))for(let n=0;n<e.length;n++){const i=Ha(e[n]);i&&(t+=i+" ")}else if(Ft(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}function zd(e,t){if(e.length!==t.length)return!1;let n=!0;for(let i=0;n&&i<e.length;i++)n=gr(e[i],t[i]);return n}function gr(e,t){if(e===t)return!0;let n=Ko(e),i=Ko(t);if(n||i)return n&&i?e.getTime()===t.getTime():!1;if(n=Zi(e),i=Zi(t),n||i)return e===t;if(n=gt(e),i=gt(t),n||i)return n&&i?zd(e,t):!1;if(n=Ft(e),i=Ft(t),n||i){if(!n||!i)return!1;const r=Object.keys(e).length,s=Object.keys(t).length;if(r!==s)return!1;for(const a in e){const o=e.hasOwnProperty(a),l=t.hasOwnProperty(a);if(o&&!l||!o&&l||!gr(e[a],t[a]))return!1}}return String(e)===String(t)}function ja(e,t){return e.findIndex(n=>gr(n,t))}const mt=e=>Jt(e)?e:e==null?"":gt(e)||Ft(e)&&(e.toString===lu||!bt(e.toString))?JSON.stringify(e,au,2):String(e),au=(e,t)=>t&&t.__v_isRef?au(e,t.value):ui(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[i,r])=>(n[`${i} =>`]=r,n),{})}:_i(t)?{[`Set(${t.size})`]:[...t.values()]}:Ft(t)&&!gt(t)&&!cu(t)?String(t):t,kt={},ci=[],Pe=()=>{},Yd=()=>!1,Xd=/^on[^a-z]/,hs=e=>Xd.test(e),Va=e=>e.startsWith("onUpdate:"),Zt=Object.assign,$a=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},Qd=Object.prototype.hasOwnProperty,Dt=(e,t)=>Qd.call(e,t),gt=Array.isArray,ui=e=>vr(e)==="[object Map]",_i=e=>vr(e)==="[object Set]",Ko=e=>vr(e)==="[object Date]",bt=e=>typeof e=="function",Jt=e=>typeof e=="string",Zi=e=>typeof e=="symbol",Ft=e=>e!==null&&typeof e=="object",ou=e=>Ft(e)&&bt(e.then)&&bt(e.catch),lu=Object.prototype.toString,vr=e=>lu.call(e),Zd=e=>vr(e).slice(8,-1),cu=e=>vr(e)==="[object Object]",Ga=e=>Jt(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Hr=Ka(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),gs=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},Jd=/-(\w)/g,Xe=gs(e=>e.replace(Jd,(t,n)=>n?n.toUpperCase():"")),qd=/\B([A-Z])/g,ti=gs(e=>e.replace(qd,"-$1").toLowerCase()),vs=gs(e=>e.charAt(0).toUpperCase()+e.slice(1)),$s=gs(e=>e?`on${vs(e)}`:""),Ji=(e,t)=>!Object.is(e,t),jr=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},Qr=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},qi=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Ho;const th=()=>Ho||(Ho=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let We;class eh{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&We&&(this.parent=We,this.index=(We.scopes||(We.scopes=[])).push(this)-1)}run(t){if(this.active){const n=We;try{return We=this,t()}finally{We=n}}}on(){We=this}off(){We=this.parent}stop(t){if(this.active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(this.parent&&!t){const r=this.parent.scopes.pop();r&&r!==this&&(this.parent.scopes[this.index]=r,r.index=this.index)}this.active=!1}}}function nh(e,t=We){t&&t.active&&t.effects.push(e)}const za=e=>{const t=new Set(e);return t.w=0,t.n=0,t},uu=e=>(e.w&Dn)>0,fu=e=>(e.n&Dn)>0,ih=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Dn},rh=e=>{const{deps:t}=e;if(t.length){let n=0;for(let i=0;i<t.length;i++){const r=t[i];uu(r)&&!fu(r)?r.delete(e):t[n++]=r,r.w&=~Dn,r.n&=~Dn}t.length=n}},da=new WeakMap;let Ni=0,Dn=1;const ha=30;let Ae;const Yn=Symbol(""),ga=Symbol("");class Ya{constructor(t,n=null,i){this.fn=t,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,nh(this,i)}run(){if(!this.active)return this.fn();let t=Ae,n=Tn;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=Ae,Ae=this,Tn=!0,Dn=1<<++Ni,Ni<=ha?ih(this):jo(this),this.fn()}finally{Ni<=ha&&rh(this),Dn=1<<--Ni,Ae=this.parent,Tn=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){Ae===this?this.deferStop=!0:this.active&&(jo(this),this.onStop&&this.onStop(),this.active=!1)}}function jo(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let Tn=!0;const du=[];function Si(){du.push(Tn),Tn=!1}function Li(){const e=du.pop();Tn=e===void 0?!0:e}function ge(e,t,n){if(Tn&&Ae){let i=da.get(e);i||da.set(e,i=new Map);let r=i.get(n);r||i.set(n,r=za()),hu(r)}}function hu(e,t){let n=!1;Ni<=ha?fu(e)||(e.n|=Dn,n=!uu(e)):n=!e.has(Ae),n&&(e.add(Ae),Ae.deps.push(e))}function ln(e,t,n,i,r,s){const a=da.get(e);if(!a)return;let o=[];if(t==="clear")o=[...a.values()];else if(n==="length"&&gt(e))a.forEach((l,c)=>{(c==="length"||c>=i)&&o.push(l)});else switch(n!==void 0&&o.push(a.get(n)),t){case"add":gt(e)?Ga(n)&&o.push(a.get("length")):(o.push(a.get(Yn)),ui(e)&&o.push(a.get(ga)));break;case"delete":gt(e)||(o.push(a.get(Yn)),ui(e)&&o.push(a.get(ga)));break;case"set":ui(e)&&o.push(a.get(Yn));break}if(o.length===1)o[0]&&va(o[0]);else{const l=[];for(const c of o)c&&l.push(...c);va(za(l))}}function va(e,t){const n=gt(e)?e:[...e];for(const i of n)i.computed&&Vo(i);for(const i of n)i.computed||Vo(i)}function Vo(e,t){(e!==Ae||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const sh=Ka("__proto__,__v_isRef,__isVue"),gu=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Zi)),ah=Xa(),oh=Xa(!1,!0),lh=Xa(!0),$o=ch();function ch(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...n){const i=Ct(this);for(let s=0,a=this.length;s<a;s++)ge(i,"get",s+"");const r=i[t](...n);return r===-1||r===!1?i[t](...n.map(Ct)):r}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...n){Si();const i=Ct(this)[t].apply(this,n);return Li(),i}}),e}function Xa(e=!1,t=!1){return function(i,r,s){if(r==="__v_isReactive")return!e;if(r==="__v_isReadonly")return e;if(r==="__v_isShallow")return t;if(r==="__v_raw"&&s===(e?t?Lh:Eu:t?yu:pu).get(i))return i;const a=gt(i);if(!e&&a&&Dt($o,r))return Reflect.get($o,r,s);const o=Reflect.get(i,r,s);return(Zi(r)?gu.has(r):sh(r))||(e||ge(i,"get",r),t)?o:re(o)?a&&Ga(r)?o:o.value:Ft(o)?e?xu(o):mr(o):o}}const uh=vu(),fh=vu(!0);function vu(e=!1){return function(n,i,r,s){let a=n[i];if(vi(a)&&re(a)&&!re(r))return!1;if(!e&&(!Zr(r)&&!vi(r)&&(a=Ct(a),r=Ct(r)),!gt(n)&&re(a)&&!re(r)))return a.value=r,!0;const o=gt(n)&&Ga(i)?Number(i)<n.length:Dt(n,i),l=Reflect.set(n,i,r,s);return n===Ct(s)&&(o?Ji(r,a)&&ln(n,"set",i,r):ln(n,"add",i,r)),l}}function dh(e,t){const n=Dt(e,t);e[t];const i=Reflect.deleteProperty(e,t);return i&&n&&ln(e,"delete",t,void 0),i}function hh(e,t){const n=Reflect.has(e,t);return(!Zi(t)||!gu.has(t))&&ge(e,"has",t),n}function gh(e){return ge(e,"iterate",gt(e)?"length":Yn),Reflect.ownKeys(e)}const mu={get:ah,set:uh,deleteProperty:dh,has:hh,ownKeys:gh},vh={get:lh,set(e,t){return!0},deleteProperty(e,t){return!0}},mh=Zt({},mu,{get:oh,set:fh}),Qa=e=>e,ms=e=>Reflect.getPrototypeOf(e);function Sr(e,t,n=!1,i=!1){e=e.__v_raw;const r=Ct(e),s=Ct(t);n||(t!==s&&ge(r,"get",t),ge(r,"get",s));const{has:a}=ms(r),o=i?Qa:n?qa:tr;if(a.call(r,t))return o(e.get(t));if(a.call(r,s))return o(e.get(s));e!==r&&e.get(t)}function Lr(e,t=!1){const n=this.__v_raw,i=Ct(n),r=Ct(e);return t||(e!==r&&ge(i,"has",e),ge(i,"has",r)),e===r?n.has(e):n.has(e)||n.has(r)}function Dr(e,t=!1){return e=e.__v_raw,!t&&ge(Ct(e),"iterate",Yn),Reflect.get(e,"size",e)}function Go(e){e=Ct(e);const t=Ct(this);return ms(t).has.call(t,e)||(t.add(e),ln(t,"add",e,e)),this}function zo(e,t){t=Ct(t);const n=Ct(this),{has:i,get:r}=ms(n);let s=i.call(n,e);s||(e=Ct(e),s=i.call(n,e));const a=r.call(n,e);return n.set(e,t),s?Ji(t,a)&&ln(n,"set",e,t):ln(n,"add",e,t),this}function Yo(e){const t=Ct(this),{has:n,get:i}=ms(t);let r=n.call(t,e);r||(e=Ct(e),r=n.call(t,e)),i&&i.call(t,e);const s=t.delete(e);return r&&ln(t,"delete",e,void 0),s}function Xo(){const e=Ct(this),t=e.size!==0,n=e.clear();return t&&ln(e,"clear",void 0,void 0),n}function Ar(e,t){return function(i,r){const s=this,a=s.__v_raw,o=Ct(a),l=t?Qa:e?qa:tr;return!e&&ge(o,"iterate",Yn),a.forEach((c,u)=>i.call(r,l(c),l(u),s))}}function Cr(e,t,n){return function(...i){const r=this.__v_raw,s=Ct(r),a=ui(s),o=e==="entries"||e===Symbol.iterator&&a,l=e==="keys"&&a,c=r[e](...i),u=n?Qa:t?qa:tr;return!t&&ge(s,"iterate",l?ga:Yn),{next(){const{value:h,done:d}=c.next();return d?{value:h,done:d}:{value:o?[u(h[0]),u(h[1])]:u(h),done:d}},[Symbol.iterator](){return this}}}}function dn(e){return function(...t){return e==="delete"?!1:this}}function ph(){const e={get(s){return Sr(this,s)},get size(){return Dr(this)},has:Lr,add:Go,set:zo,delete:Yo,clear:Xo,forEach:Ar(!1,!1)},t={get(s){return Sr(this,s,!1,!0)},get size(){return Dr(this)},has:Lr,add:Go,set:zo,delete:Yo,clear:Xo,forEach:Ar(!1,!0)},n={get(s){return Sr(this,s,!0)},get size(){return Dr(this,!0)},has(s){return Lr.call(this,s,!0)},add:dn("add"),set:dn("set"),delete:dn("delete"),clear:dn("clear"),forEach:Ar(!0,!1)},i={get(s){return Sr(this,s,!0,!0)},get size(){return Dr(this,!0)},has(s){return Lr.call(this,s,!0)},add:dn("add"),set:dn("set"),delete:dn("delete"),clear:dn("clear"),forEach:Ar(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{e[s]=Cr(s,!1,!1),n[s]=Cr(s,!0,!1),t[s]=Cr(s,!1,!0),i[s]=Cr(s,!0,!0)}),[e,n,t,i]}const[yh,Eh,xh,bh]=ph();function Za(e,t){const n=t?e?bh:xh:e?Eh:yh;return(i,r,s)=>r==="__v_isReactive"?!e:r==="__v_isReadonly"?e:r==="__v_raw"?i:Reflect.get(Dt(n,r)&&r in i?n:i,r,s)}const Th={get:Za(!1,!1)},_h={get:Za(!1,!0)},Sh={get:Za(!0,!1)},pu=new WeakMap,yu=new WeakMap,Eu=new WeakMap,Lh=new WeakMap;function Dh(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ah(e){return e.__v_skip||!Object.isExtensible(e)?0:Dh(Zd(e))}function mr(e){return vi(e)?e:Ja(e,!1,mu,Th,pu)}function Ch(e){return Ja(e,!1,mh,_h,yu)}function xu(e){return Ja(e,!0,vh,Sh,Eu)}function Ja(e,t,n,i,r){if(!Ft(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const s=r.get(e);if(s)return s;const a=Ah(e);if(a===0)return e;const o=new Proxy(e,a===2?i:n);return r.set(e,o),o}function fi(e){return vi(e)?fi(e.__v_raw):!!(e&&e.__v_isReactive)}function vi(e){return!!(e&&e.__v_isReadonly)}function Zr(e){return!!(e&&e.__v_isShallow)}function bu(e){return fi(e)||vi(e)}function Ct(e){const t=e&&e.__v_raw;return t?Ct(t):e}function Tu(e){return Qr(e,"__v_skip",!0),e}const tr=e=>Ft(e)?mr(e):e,qa=e=>Ft(e)?xu(e):e;function _u(e){Tn&&Ae&&(e=Ct(e),hu(e.dep||(e.dep=za())))}function Su(e,t){e=Ct(e),e.dep&&va(e.dep)}function re(e){return!!(e&&e.__v_isRef===!0)}function ot(e){return Lu(e,!1)}function Oh(e){return Lu(e,!0)}function Lu(e,t){return re(e)?e:new Mh(e,t)}class Mh{constructor(t,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?t:Ct(t),this._value=n?t:tr(t)}get value(){return _u(this),this._value}set value(t){const n=this.__v_isShallow||Zr(t)||vi(t);t=n?t:Ct(t),Ji(t,this._rawValue)&&(this._rawValue=t,this._value=n?t:tr(t),Su(this))}}function ht(e){return re(e)?e.value:e}const Ph={get:(e,t,n)=>ht(Reflect.get(e,t,n)),set:(e,t,n,i)=>{const r=e[t];return re(r)&&!re(n)?(r.value=n,!0):Reflect.set(e,t,n,i)}};function Du(e){return fi(e)?e:new Proxy(e,Ph)}var Au;class Rh{constructor(t,n,i,r){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this[Au]=!1,this._dirty=!0,this.effect=new Ya(t,()=>{this._dirty||(this._dirty=!0,Su(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!r,this.__v_isReadonly=i}get value(){const t=Ct(this);return _u(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}Au="__v_isReadonly";function Ih(e,t,n=!1){let i,r;const s=bt(e);return s?(i=e,r=Pe):(i=e.get,r=e.set),new Rh(i,r,s||!r,n)}function _n(e,t,n,i){let r;try{r=i?e(...i):e()}catch(s){ps(s,t,n)}return r}function _e(e,t,n,i){if(bt(e)){const s=_n(e,t,n,i);return s&&ou(s)&&s.catch(a=>{ps(a,t,n)}),s}const r=[];for(let s=0;s<e.length;s++)r.push(_e(e[s],t,n,i));return r}function ps(e,t,n,i=!0){const r=t?t.vnode:null;if(t){let s=t.parent;const a=t.proxy,o=n;for(;s;){const c=s.ec;if(c){for(let u=0;u<c.length;u++)if(c[u](e,a,o)===!1)return}s=s.parent}const l=t.appContext.config.errorHandler;if(l){_n(l,null,10,[e,a,o]);return}}wh(e,n,r,i)}function wh(e,t,n,i=!0){console.error(e)}let er=!1,ma=!1;const ie=[];let je=0;const di=[];let rn=null,Vn=0;const Cu=Promise.resolve();let to=null;function Jr(e){const t=to||Cu;return e?t.then(this?e.bind(this):e):t}function kh(e){let t=je+1,n=ie.length;for(;t<n;){const i=t+n>>>1;nr(ie[i])<e?t=i+1:n=i}return t}function eo(e){(!ie.length||!ie.includes(e,er&&e.allowRecurse?je+1:je))&&(e.id==null?ie.push(e):ie.splice(kh(e.id),0,e),Ou())}function Ou(){!er&&!ma&&(ma=!0,to=Cu.then(Pu))}function Fh(e){const t=ie.indexOf(e);t>je&&ie.splice(t,1)}function Bh(e){gt(e)?di.push(...e):(!rn||!rn.includes(e,e.allowRecurse?Vn+1:Vn))&&di.push(e),Ou()}function Qo(e,t=er?je+1:0){for(;t<ie.length;t++){const n=ie[t];n&&n.pre&&(ie.splice(t,1),t--,n())}}function Mu(e){if(di.length){const t=[...new Set(di)];if(di.length=0,rn){rn.push(...t);return}for(rn=t,rn.sort((n,i)=>nr(n)-nr(i)),Vn=0;Vn<rn.length;Vn++)rn[Vn]();rn=null,Vn=0}}const nr=e=>e.id==null?1/0:e.id,Nh=(e,t)=>{const n=nr(e)-nr(t);if(n===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return n};function Pu(e){ma=!1,er=!0,ie.sort(Nh);const t=Pe;try{for(je=0;je<ie.length;je++){const n=ie[je];n&&n.active!==!1&&_n(n,null,14)}}finally{je=0,ie.length=0,Mu(),er=!1,to=null,(ie.length||di.length)&&Pu()}}function Uh(e,t,...n){if(e.isUnmounted)return;const i=e.vnode.props||kt;let r=n;const s=t.startsWith("update:"),a=s&&t.slice(7);if(a&&a in i){const u=`${a==="modelValue"?"model":a}Modifiers`,{number:h,trim:d}=i[u]||kt;d&&(r=n.map(y=>y.trim())),h&&(r=n.map(qi))}let o,l=i[o=$s(t)]||i[o=$s(Xe(t))];!l&&s&&(l=i[o=$s(ti(t))]),l&&_e(l,e,6,r);const c=i[o+"Once"];if(c){if(!e.emitted)e.emitted={};else if(e.emitted[o])return;e.emitted[o]=!0,_e(c,e,6,r)}}function Ru(e,t,n=!1){const i=t.emitsCache,r=i.get(e);if(r!==void 0)return r;const s=e.emits;let a={},o=!1;if(!bt(e)){const l=c=>{const u=Ru(c,t,!0);u&&(o=!0,Zt(a,u))};!n&&t.mixins.length&&t.mixins.forEach(l),e.extends&&l(e.extends),e.mixins&&e.mixins.forEach(l)}return!s&&!o?(Ft(e)&&i.set(e,null),null):(gt(s)?s.forEach(l=>a[l]=null):Zt(a,s),Ft(e)&&i.set(e,a),a)}function ys(e,t){return!e||!hs(t)?!1:(t=t.slice(2).replace(/Once$/,""),Dt(e,t[0].toLowerCase()+t.slice(1))||Dt(e,ti(t))||Dt(e,t))}let Te=null,Es=null;function qr(e){const t=Te;return Te=e,Es=e&&e.type.__scopeId||null,t}function cn(e){Es=e}function un(){Es=null}function Sn(e,t=Te,n){if(!t||e._n)return e;const i=(...r)=>{i._d&&ol(-1);const s=qr(t),a=e(...r);return qr(s),i._d&&ol(1),a};return i._n=!0,i._c=!0,i._d=!0,i}function Gs(e){const{type:t,vnode:n,proxy:i,withProxy:r,props:s,propsOptions:[a],slots:o,attrs:l,emit:c,render:u,renderCache:h,data:d,setupState:y,ctx:E,inheritAttrs:L}=e;let _,A;const v=qr(e);try{if(n.shapeFlag&4){const x=r||i;_=He(u.call(x,x,h,s,y,d,E)),A=l}else{const x=t;_=He(x.length>1?x(s,{attrs:l,slots:o,emit:c}):x(s,null)),A=t.props?l:Wh(l)}}catch(x){Hi.length=0,ps(x,e,1),_=pt(we)}let f=_;if(A&&L!==!1){const x=Object.keys(A),{shapeFlag:S}=f;x.length&&S&7&&(a&&x.some(Va)&&(A=Kh(A,a)),f=An(f,A))}return n.dirs&&(f=An(f),f.dirs=f.dirs?f.dirs.concat(n.dirs):n.dirs),n.transition&&(f.transition=n.transition),_=f,qr(v),_}const Wh=e=>{let t;for(const n in e)(n==="class"||n==="style"||hs(n))&&((t||(t={}))[n]=e[n]);return t},Kh=(e,t)=>{const n={};for(const i in e)(!Va(i)||!(i.slice(9)in t))&&(n[i]=e[i]);return n};function Hh(e,t,n){const{props:i,children:r,component:s}=e,{props:a,children:o,patchFlag:l}=t,c=s.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&l>=0){if(l&1024)return!0;if(l&16)return i?Zo(i,a,c):!!a;if(l&8){const u=t.dynamicProps;for(let h=0;h<u.length;h++){const d=u[h];if(a[d]!==i[d]&&!ys(c,d))return!0}}}else return(r||o)&&(!o||!o.$stable)?!0:i===a?!1:i?a?Zo(i,a,c):!0:!!a;return!1}function Zo(e,t,n){const i=Object.keys(t);if(i.length!==Object.keys(e).length)return!0;for(let r=0;r<i.length;r++){const s=i[r];if(t[s]!==e[s]&&!ys(n,s))return!0}return!1}function jh({vnode:e,parent:t},n){for(;t&&t.subTree===e;)(e=t.vnode).el=n,t=t.parent}const Vh=e=>e.__isSuspense;function $h(e,t){t&&t.pendingBranch?gt(e)?t.effects.push(...e):t.effects.push(e):Bh(e)}function Vr(e,t){if(Yt){let n=Yt.provides;const i=Yt.parent&&Yt.parent.provides;i===n&&(n=Yt.provides=Object.create(i)),n[e]=t}}function ze(e,t,n=!1){const i=Yt||Te;if(i){const r=i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides;if(r&&e in r)return r[e];if(arguments.length>1)return n&&bt(t)?t.call(i.proxy):t}}const Jo={};function Re(e,t,n){return Iu(e,t,n)}function Iu(e,t,{immediate:n,deep:i,flush:r,onTrack:s,onTrigger:a}=kt){const o=Yt;let l,c=!1,u=!1;if(re(e)?(l=()=>e.value,c=Zr(e)):fi(e)?(l=()=>e,i=!0):gt(e)?(u=!0,c=e.some(A=>fi(A)||Zr(A)),l=()=>e.map(A=>{if(re(A))return A.value;if(fi(A))return zn(A);if(bt(A))return _n(A,o,2)})):bt(e)?t?l=()=>_n(e,o,2):l=()=>{if(!(o&&o.isUnmounted))return h&&h(),_e(e,o,3,[d])}:l=Pe,t&&i){const A=l;l=()=>zn(A())}let h,d=A=>{h=_.onStop=()=>{_n(A,o,4)}};if(ar)return d=Pe,t?n&&_e(t,o,3,[l(),u?[]:void 0,d]):l(),Pe;let y=u?[]:Jo;const E=()=>{if(!!_.active)if(t){const A=_.run();(i||c||(u?A.some((v,f)=>Ji(v,y[f])):Ji(A,y)))&&(h&&h(),_e(t,o,3,[A,y===Jo?void 0:y,d]),y=A)}else _.run()};E.allowRecurse=!!t;let L;r==="sync"?L=E:r==="post"?L=()=>ue(E,o&&o.suspense):(E.pre=!0,o&&(E.id=o.uid),L=()=>eo(E));const _=new Ya(l,L);return t?n?E():y=_.run():r==="post"?ue(_.run.bind(_),o&&o.suspense):_.run(),()=>{_.stop(),o&&o.scope&&$a(o.scope.effects,_)}}function Gh(e,t,n){const i=this.proxy,r=Jt(e)?e.includes(".")?wu(i,e):()=>i[e]:e.bind(i,i);let s;bt(t)?s=t:(s=t.handler,n=t);const a=Yt;mi(this);const o=Iu(r,s.bind(i),n);return a?mi(a):Xn(),o}function wu(e,t){const n=t.split(".");return()=>{let i=e;for(let r=0;r<n.length&&i;r++)i=i[n[r]];return i}}function zn(e,t){if(!Ft(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),re(e))zn(e.value,t);else if(gt(e))for(let n=0;n<e.length;n++)zn(e[n],t);else if(_i(e)||ui(e))e.forEach(n=>{zn(n,t)});else if(cu(e))for(const n in e)zn(e[n],t);return e}function ku(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return ve(()=>{e.isMounted=!0}),Ku(()=>{e.isUnmounting=!0}),e}const pe=[Function,Array],zh={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:pe,onEnter:pe,onAfterEnter:pe,onEnterCancelled:pe,onBeforeLeave:pe,onLeave:pe,onAfterLeave:pe,onLeaveCancelled:pe,onBeforeAppear:pe,onAppear:pe,onAfterAppear:pe,onAppearCancelled:pe},setup(e,{slots:t}){const n=tf(),i=ku();let r;return()=>{const s=t.default&&no(t.default(),!0);if(!s||!s.length)return;let a=s[0];if(s.length>1){for(const L of s)if(L.type!==we){a=L;break}}const o=Ct(e),{mode:l}=o;if(i.isLeaving)return zs(a);const c=qo(a);if(!c)return zs(a);const u=ir(c,o,i,n);rr(c,u);const h=n.subTree,d=h&&qo(h);let y=!1;const{getTransitionKey:E}=c.type;if(E){const L=E();r===void 0?r=L:L!==r&&(r=L,y=!0)}if(d&&d.type!==we&&(!$n(c,d)||y)){const L=ir(d,o,i,n);if(rr(d,L),l==="out-in")return i.isLeaving=!0,L.afterLeave=()=>{i.isLeaving=!1,n.update()},zs(a);l==="in-out"&&c.type!==we&&(L.delayLeave=(_,A,v)=>{const f=Bu(i,d);f[String(d.key)]=d,_._leaveCb=()=>{A(),_._leaveCb=void 0,delete u.delayedLeave},u.delayedLeave=v})}return a}}},Fu=zh;function Bu(e,t){const{leavingVNodes:n}=e;let i=n.get(t.type);return i||(i=Object.create(null),n.set(t.type,i)),i}function ir(e,t,n,i){const{appear:r,mode:s,persisted:a=!1,onBeforeEnter:o,onEnter:l,onAfterEnter:c,onEnterCancelled:u,onBeforeLeave:h,onLeave:d,onAfterLeave:y,onLeaveCancelled:E,onBeforeAppear:L,onAppear:_,onAfterAppear:A,onAppearCancelled:v}=t,f=String(e.key),x=Bu(n,e),S=(g,m)=>{g&&_e(g,i,9,m)},C=(g,m)=>{const D=m[1];S(g,m),gt(g)?g.every(b=>b.length<=1)&&D():g.length<=1&&D()},p={mode:s,persisted:a,beforeEnter(g){let m=o;if(!n.isMounted)if(r)m=L||o;else return;g._leaveCb&&g._leaveCb(!0);const D=x[f];D&&$n(e,D)&&D.el._leaveCb&&D.el._leaveCb(),S(m,[g])},enter(g){let m=l,D=c,b=u;if(!n.isMounted)if(r)m=_||l,D=A||c,b=v||u;else return;let T=!1;const P=g._enterCb=M=>{T||(T=!0,M?S(b,[g]):S(D,[g]),p.delayedLeave&&p.delayedLeave(),g._enterCb=void 0)};m?C(m,[g,P]):P()},leave(g,m){const D=String(e.key);if(g._enterCb&&g._enterCb(!0),n.isUnmounting)return m();S(h,[g]);let b=!1;const T=g._leaveCb=P=>{b||(b=!0,m(),P?S(E,[g]):S(y,[g]),g._leaveCb=void 0,x[D]===e&&delete x[D])};x[D]=e,d?C(d,[g,T]):T()},clone(g){return ir(g,t,n,i)}};return p}function zs(e){if(xs(e))return e=An(e),e.children=null,e}function qo(e){return xs(e)?e.children?e.children[0]:void 0:e}function rr(e,t){e.shapeFlag&6&&e.component?rr(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function no(e,t=!1,n){let i=[],r=0;for(let s=0;s<e.length;s++){let a=e[s];const o=n==null?a.key:String(n)+String(a.key!=null?a.key:s);a.type===Rt?(a.patchFlag&128&&r++,i=i.concat(no(a.children,t,o))):(t||a.type!==we)&&i.push(o!=null?An(a,{key:o}):a)}if(r>1)for(let s=0;s<i.length;s++)i[s].patchFlag=-2;return i}function Nu(e){return bt(e)?{setup:e,name:e.name}:e}const $r=e=>!!e.type.__asyncLoader,xs=e=>e.type.__isKeepAlive;function Yh(e,t){Uu(e,"a",t)}function Xh(e,t){Uu(e,"da",t)}function Uu(e,t,n=Yt){const i=e.__wdc||(e.__wdc=()=>{let r=n;for(;r;){if(r.isDeactivated)return;r=r.parent}return e()});if(bs(t,i,n),n){let r=n.parent;for(;r&&r.parent;)xs(r.parent.vnode)&&Qh(i,t,n,r),r=r.parent}}function Qh(e,t,n,i){const r=bs(t,e,i,!0);Di(()=>{$a(i[t],r)},n)}function bs(e,t,n=Yt,i=!1){if(n){const r=n[e]||(n[e]=[]),s=t.__weh||(t.__weh=(...a)=>{if(n.isUnmounted)return;Si(),mi(n);const o=_e(t,n,e,a);return Xn(),Li(),o});return i?r.unshift(s):r.push(s),s}}const fn=e=>(t,n=Yt)=>(!ar||e==="sp")&&bs(e,t,n),Zh=fn("bm"),ve=fn("m"),Jh=fn("bu"),Wu=fn("u"),Ku=fn("bum"),Di=fn("um"),qh=fn("sp"),tg=fn("rtg"),eg=fn("rtc");function ng(e,t=Yt){bs("ec",e,t)}function ce(e,t){const n=Te;if(n===null)return e;const i=_s(n)||n.proxy,r=e.dirs||(e.dirs=[]);for(let s=0;s<t.length;s++){let[a,o,l,c=kt]=t[s];bt(a)&&(a={mounted:a,updated:a}),a.deep&&zn(o),r.push({dir:a,instance:i,value:o,oldValue:void 0,arg:l,modifiers:c})}return e}function kn(e,t,n,i){const r=e.dirs,s=t&&t.dirs;for(let a=0;a<r.length;a++){const o=r[a];s&&(o.oldValue=s[a].value);let l=o.dir[i];l&&(Si(),_e(l,n,8,[e.el,o,e,t]),Li())}}const Hu="components";function ig(e,t){return sg(Hu,e,!0,t)||e}const rg=Symbol();function sg(e,t,n=!0,i=!1){const r=Te||Yt;if(r){const s=r.type;if(e===Hu){const o=wg(s,!1);if(o&&(o===t||o===Xe(t)||o===vs(Xe(t))))return s}const a=tl(r[e]||s[e],t)||tl(r.appContext[e],t);return!a&&i?s:a}}function tl(e,t){return e&&(e[t]||e[Xe(t)]||e[vs(Xe(t))])}function Ie(e,t,n,i){let r;const s=n&&n[i];if(gt(e)||Jt(e)){r=new Array(e.length);for(let a=0,o=e.length;a<o;a++)r[a]=t(e[a],a,void 0,s&&s[a])}else if(typeof e=="number"){r=new Array(e);for(let a=0;a<e;a++)r[a]=t(a+1,a,void 0,s&&s[a])}else if(Ft(e))if(e[Symbol.iterator])r=Array.from(e,(a,o)=>t(a,o,void 0,s&&s[o]));else{const a=Object.keys(e);r=new Array(a.length);for(let o=0,l=a.length;o<l;o++){const c=a[o];r[o]=t(e[c],c,o,s&&s[o])}}else r=[];return n&&(n[i]=r),r}const pa=e=>e?ef(e)?_s(e)||e.proxy:pa(e.parent):null,ts=Zt(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>pa(e.parent),$root:e=>pa(e.root),$emit:e=>e.emit,$options:e=>io(e),$forceUpdate:e=>e.f||(e.f=()=>eo(e.update)),$nextTick:e=>e.n||(e.n=Jr.bind(e.proxy)),$watch:e=>Gh.bind(e)}),ag={get({_:e},t){const{ctx:n,setupState:i,data:r,props:s,accessCache:a,type:o,appContext:l}=e;let c;if(t[0]!=="$"){const y=a[t];if(y!==void 0)switch(y){case 1:return i[t];case 2:return r[t];case 4:return n[t];case 3:return s[t]}else{if(i!==kt&&Dt(i,t))return a[t]=1,i[t];if(r!==kt&&Dt(r,t))return a[t]=2,r[t];if((c=e.propsOptions[0])&&Dt(c,t))return a[t]=3,s[t];if(n!==kt&&Dt(n,t))return a[t]=4,n[t];ya&&(a[t]=0)}}const u=ts[t];let h,d;if(u)return t==="$attrs"&&ge(e,"get",t),u(e);if((h=o.__cssModules)&&(h=h[t]))return h;if(n!==kt&&Dt(n,t))return a[t]=4,n[t];if(d=l.config.globalProperties,Dt(d,t))return d[t]},set({_:e},t,n){const{data:i,setupState:r,ctx:s}=e;return r!==kt&&Dt(r,t)?(r[t]=n,!0):i!==kt&&Dt(i,t)?(i[t]=n,!0):Dt(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(s[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:i,appContext:r,propsOptions:s}},a){let o;return!!n[a]||e!==kt&&Dt(e,a)||t!==kt&&Dt(t,a)||(o=s[0])&&Dt(o,a)||Dt(i,a)||Dt(ts,a)||Dt(r.config.globalProperties,a)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:Dt(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};let ya=!0;function og(e){const t=io(e),n=e.proxy,i=e.ctx;ya=!1,t.beforeCreate&&el(t.beforeCreate,e,"bc");const{data:r,computed:s,methods:a,watch:o,provide:l,inject:c,created:u,beforeMount:h,mounted:d,beforeUpdate:y,updated:E,activated:L,deactivated:_,beforeDestroy:A,beforeUnmount:v,destroyed:f,unmounted:x,render:S,renderTracked:C,renderTriggered:p,errorCaptured:g,serverPrefetch:m,expose:D,inheritAttrs:b,components:T,directives:P,filters:M}=t;if(c&&lg(c,i,null,e.appContext.config.unwrapInjectedRef),a)for(const I in a){const w=a[I];bt(w)&&(i[I]=w.bind(n))}if(r){const I=r.call(n,n);Ft(I)&&(e.data=mr(I))}if(ya=!0,s)for(const I in s){const w=s[I],k=bt(w)?w.bind(n,n):bt(w.get)?w.get.bind(n,n):Pe,B=!bt(w)&&bt(w.set)?w.set.bind(n):Pe,F=xe({get:k,set:B});Object.defineProperty(i,I,{enumerable:!0,configurable:!0,get:()=>F.value,set:N=>F.value=N})}if(o)for(const I in o)ju(o[I],i,n,I);if(l){const I=bt(l)?l.call(n):l;Reflect.ownKeys(I).forEach(w=>{Vr(w,I[w])})}u&&el(u,e,"c");function R(I,w){gt(w)?w.forEach(k=>I(k.bind(n))):w&&I(w.bind(n))}if(R(Zh,h),R(ve,d),R(Jh,y),R(Wu,E),R(Yh,L),R(Xh,_),R(ng,g),R(eg,C),R(tg,p),R(Ku,v),R(Di,x),R(qh,m),gt(D))if(D.length){const I=e.exposed||(e.exposed={});D.forEach(w=>{Object.defineProperty(I,w,{get:()=>n[w],set:k=>n[w]=k})})}else e.exposed||(e.exposed={});S&&e.render===Pe&&(e.render=S),b!=null&&(e.inheritAttrs=b),T&&(e.components=T),P&&(e.directives=P)}function lg(e,t,n=Pe,i=!1){gt(e)&&(e=Ea(e));for(const r in e){const s=e[r];let a;Ft(s)?"default"in s?a=ze(s.from||r,s.default,!0):a=ze(s.from||r):a=ze(s),re(a)&&i?Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>a.value,set:o=>a.value=o}):t[r]=a}}function el(e,t,n){_e(gt(e)?e.map(i=>i.bind(t.proxy)):e.bind(t.proxy),t,n)}function ju(e,t,n,i){const r=i.includes(".")?wu(n,i):()=>n[i];if(Jt(e)){const s=t[e];bt(s)&&Re(r,s)}else if(bt(e))Re(r,e.bind(n));else if(Ft(e))if(gt(e))e.forEach(s=>ju(s,t,n,i));else{const s=bt(e.handler)?e.handler.bind(n):t[e.handler];bt(s)&&Re(r,s,e)}}function io(e){const t=e.type,{mixins:n,extends:i}=t,{mixins:r,optionsCache:s,config:{optionMergeStrategies:a}}=e.appContext,o=s.get(t);let l;return o?l=o:!r.length&&!n&&!i?l=t:(l={},r.length&&r.forEach(c=>es(l,c,a,!0)),es(l,t,a)),Ft(t)&&s.set(t,l),l}function es(e,t,n,i=!1){const{mixins:r,extends:s}=t;s&&es(e,s,n,!0),r&&r.forEach(a=>es(e,a,n,!0));for(const a in t)if(!(i&&a==="expose")){const o=cg[a]||n&&n[a];e[a]=o?o(e[a],t[a]):t[a]}return e}const cg={data:nl,props:Kn,emits:Kn,methods:Kn,computed:Kn,beforeCreate:le,created:le,beforeMount:le,mounted:le,beforeUpdate:le,updated:le,beforeDestroy:le,beforeUnmount:le,destroyed:le,unmounted:le,activated:le,deactivated:le,errorCaptured:le,serverPrefetch:le,components:Kn,directives:Kn,watch:fg,provide:nl,inject:ug};function nl(e,t){return t?e?function(){return Zt(bt(e)?e.call(this,this):e,bt(t)?t.call(this,this):t)}:t:e}function ug(e,t){return Kn(Ea(e),Ea(t))}function Ea(e){if(gt(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function le(e,t){return e?[...new Set([].concat(e,t))]:t}function Kn(e,t){return e?Zt(Zt(Object.create(null),e),t):t}function fg(e,t){if(!e)return t;if(!t)return e;const n=Zt(Object.create(null),e);for(const i in t)n[i]=le(e[i],t[i]);return n}function dg(e,t,n,i=!1){const r={},s={};Qr(s,Ts,1),e.propsDefaults=Object.create(null),Vu(e,t,r,s);for(const a in e.propsOptions[0])a in r||(r[a]=void 0);n?e.props=i?r:Ch(r):e.type.props?e.props=r:e.props=s,e.attrs=s}function hg(e,t,n,i){const{props:r,attrs:s,vnode:{patchFlag:a}}=e,o=Ct(r),[l]=e.propsOptions;let c=!1;if((i||a>0)&&!(a&16)){if(a&8){const u=e.vnode.dynamicProps;for(let h=0;h<u.length;h++){let d=u[h];if(ys(e.emitsOptions,d))continue;const y=t[d];if(l)if(Dt(s,d))y!==s[d]&&(s[d]=y,c=!0);else{const E=Xe(d);r[E]=xa(l,o,E,y,e,!1)}else y!==s[d]&&(s[d]=y,c=!0)}}}else{Vu(e,t,r,s)&&(c=!0);let u;for(const h in o)(!t||!Dt(t,h)&&((u=ti(h))===h||!Dt(t,u)))&&(l?n&&(n[h]!==void 0||n[u]!==void 0)&&(r[h]=xa(l,o,h,void 0,e,!0)):delete r[h]);if(s!==o)for(const h in s)(!t||!Dt(t,h)&&!0)&&(delete s[h],c=!0)}c&&ln(e,"set","$attrs")}function Vu(e,t,n,i){const[r,s]=e.propsOptions;let a=!1,o;if(t)for(let l in t){if(Hr(l))continue;const c=t[l];let u;r&&Dt(r,u=Xe(l))?!s||!s.includes(u)?n[u]=c:(o||(o={}))[u]=c:ys(e.emitsOptions,l)||(!(l in i)||c!==i[l])&&(i[l]=c,a=!0)}if(s){const l=Ct(n),c=o||kt;for(let u=0;u<s.length;u++){const h=s[u];n[h]=xa(r,l,h,c[h],e,!Dt(c,h))}}return a}function xa(e,t,n,i,r,s){const a=e[n];if(a!=null){const o=Dt(a,"default");if(o&&i===void 0){const l=a.default;if(a.type!==Function&&bt(l)){const{propsDefaults:c}=r;n in c?i=c[n]:(mi(r),i=c[n]=l.call(null,t),Xn())}else i=l}a[0]&&(s&&!o?i=!1:a[1]&&(i===""||i===ti(n))&&(i=!0))}return i}function $u(e,t,n=!1){const i=t.propsCache,r=i.get(e);if(r)return r;const s=e.props,a={},o=[];let l=!1;if(!bt(e)){const u=h=>{l=!0;const[d,y]=$u(h,t,!0);Zt(a,d),y&&o.push(...y)};!n&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}if(!s&&!l)return Ft(e)&&i.set(e,ci),ci;if(gt(s))for(let u=0;u<s.length;u++){const h=Xe(s[u]);il(h)&&(a[h]=kt)}else if(s)for(const u in s){const h=Xe(u);if(il(h)){const d=s[u],y=a[h]=gt(d)||bt(d)?{type:d}:d;if(y){const E=al(Boolean,y.type),L=al(String,y.type);y[0]=E>-1,y[1]=L<0||E<L,(E>-1||Dt(y,"default"))&&o.push(h)}}}const c=[a,o];return Ft(e)&&i.set(e,c),c}function il(e){return e[0]!=="$"}function rl(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function sl(e,t){return rl(e)===rl(t)}function al(e,t){return gt(t)?t.findIndex(n=>sl(n,e)):bt(t)&&sl(t,e)?0:-1}const Gu=e=>e[0]==="_"||e==="$stable",ro=e=>gt(e)?e.map(He):[He(e)],gg=(e,t,n)=>{if(t._n)return t;const i=Sn((...r)=>ro(t(...r)),n);return i._c=!1,i},zu=(e,t,n)=>{const i=e._ctx;for(const r in e){if(Gu(r))continue;const s=e[r];if(bt(s))t[r]=gg(r,s,i);else if(s!=null){const a=ro(s);t[r]=()=>a}}},Yu=(e,t)=>{const n=ro(t);e.slots.default=()=>n},vg=(e,t)=>{if(e.vnode.shapeFlag&32){const n=t._;n?(e.slots=Ct(t),Qr(t,"_",n)):zu(t,e.slots={})}else e.slots={},t&&Yu(e,t);Qr(e.slots,Ts,1)},mg=(e,t,n)=>{const{vnode:i,slots:r}=e;let s=!0,a=kt;if(i.shapeFlag&32){const o=t._;o?n&&o===1?s=!1:(Zt(r,t),!n&&o===1&&delete r._):(s=!t.$stable,zu(t,r)),a=t}else t&&(Yu(e,t),a={default:1});if(s)for(const o in r)!Gu(o)&&!(o in a)&&delete r[o]};function Xu(){return{app:null,config:{isNativeTag:Yd,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let pg=0;function yg(e,t){return function(i,r=null){bt(i)||(i=Object.assign({},i)),r!=null&&!Ft(r)&&(r=null);const s=Xu(),a=new Set;let o=!1;const l=s.app={_uid:pg++,_component:i,_props:r,_container:null,_context:s,_instance:null,version:Fg,get config(){return s.config},set config(c){},use(c,...u){return a.has(c)||(c&&bt(c.install)?(a.add(c),c.install(l,...u)):bt(c)&&(a.add(c),c(l,...u))),l},mixin(c){return s.mixins.includes(c)||s.mixins.push(c),l},component(c,u){return u?(s.components[c]=u,l):s.components[c]},directive(c,u){return u?(s.directives[c]=u,l):s.directives[c]},mount(c,u,h){if(!o){const d=pt(i,r);return d.appContext=s,u&&t?t(d,c):e(d,c,h),o=!0,l._container=c,c.__vue_app__=l,_s(d.component)||d.component.proxy}},unmount(){o&&(e(null,l._container),delete l._container.__vue_app__)},provide(c,u){return s.provides[c]=u,l}};return l}}function ba(e,t,n,i,r=!1){if(gt(e)){e.forEach((d,y)=>ba(d,t&&(gt(t)?t[y]:t),n,i,r));return}if($r(i)&&!r)return;const s=i.shapeFlag&4?_s(i.component)||i.component.proxy:i.el,a=r?null:s,{i:o,r:l}=e,c=t&&t.r,u=o.refs===kt?o.refs={}:o.refs,h=o.setupState;if(c!=null&&c!==l&&(Jt(c)?(u[c]=null,Dt(h,c)&&(h[c]=null)):re(c)&&(c.value=null)),bt(l))_n(l,o,12,[a,u]);else{const d=Jt(l),y=re(l);if(d||y){const E=()=>{if(e.f){const L=d?u[l]:l.value;r?gt(L)&&$a(L,s):gt(L)?L.includes(s)||L.push(s):d?(u[l]=[s],Dt(h,l)&&(h[l]=u[l])):(l.value=[s],e.k&&(u[e.k]=l.value))}else d?(u[l]=a,Dt(h,l)&&(h[l]=a)):y&&(l.value=a,e.k&&(u[e.k]=a))};a?(E.id=-1,ue(E,n)):E()}}}const ue=$h;function Eg(e){return xg(e)}function xg(e,t){const n=th();n.__VUE__=!0;const{insert:i,remove:r,patchProp:s,createElement:a,createText:o,createComment:l,setText:c,setElementText:u,parentNode:h,nextSibling:d,setScopeId:y=Pe,cloneNode:E,insertStaticContent:L}=e,_=(W,V,z,Y=null,Q=null,J=null,rt=!1,tt=null,et=!!V.dynamicChildren)=>{if(W===V)return;W&&!$n(W,V)&&(Y=X(W),K(W,Q,J,!0),W=null),V.patchFlag===-2&&(et=!1,V.dynamicChildren=null);const{type:q,ref:ut,shapeFlag:lt}=V;switch(q){case so:A(W,V,z,Y);break;case we:v(W,V,z,Y);break;case Gr:W==null&&f(V,z,Y,rt);break;case Rt:P(W,V,z,Y,Q,J,rt,tt,et);break;default:lt&1?C(W,V,z,Y,Q,J,rt,tt,et):lt&6?M(W,V,z,Y,Q,J,rt,tt,et):(lt&64||lt&128)&&q.process(W,V,z,Y,Q,J,rt,tt,et,nt)}ut!=null&&Q&&ba(ut,W&&W.ref,J,V||W,!V)},A=(W,V,z,Y)=>{if(W==null)i(V.el=o(V.children),z,Y);else{const Q=V.el=W.el;V.children!==W.children&&c(Q,V.children)}},v=(W,V,z,Y)=>{W==null?i(V.el=l(V.children||""),z,Y):V.el=W.el},f=(W,V,z,Y)=>{[W.el,W.anchor]=L(W.children,V,z,Y,W.el,W.anchor)},x=({el:W,anchor:V},z,Y)=>{let Q;for(;W&&W!==V;)Q=d(W),i(W,z,Y),W=Q;i(V,z,Y)},S=({el:W,anchor:V})=>{let z;for(;W&&W!==V;)z=d(W),r(W),W=z;r(V)},C=(W,V,z,Y,Q,J,rt,tt,et)=>{rt=rt||V.type==="svg",W==null?p(V,z,Y,Q,J,rt,tt,et):D(W,V,Q,J,rt,tt,et)},p=(W,V,z,Y,Q,J,rt,tt)=>{let et,q;const{type:ut,props:lt,shapeFlag:ft,transition:dt,patchFlag:vt,dirs:Et}=W;if(W.el&&E!==void 0&&vt===-1)et=W.el=E(W.el);else{if(et=W.el=a(W.type,J,lt&&lt.is,lt),ft&8?u(et,W.children):ft&16&&m(W.children,et,null,Y,Q,J&&ut!=="foreignObject",rt,tt),Et&&kn(W,null,Y,"created"),lt){for(const Tt in lt)Tt!=="value"&&!Hr(Tt)&&s(et,Tt,null,lt[Tt],J,W.children,Y,Q,$);"value"in lt&&s(et,"value",null,lt.value),(q=lt.onVnodeBeforeMount)&&Ue(q,Y,W)}g(et,W,W.scopeId,rt,Y)}Et&&kn(W,null,Y,"beforeMount");const yt=(!Q||Q&&!Q.pendingBranch)&&dt&&!dt.persisted;yt&&dt.beforeEnter(et),i(et,V,z),((q=lt&&lt.onVnodeMounted)||yt||Et)&&ue(()=>{q&&Ue(q,Y,W),yt&&dt.enter(et),Et&&kn(W,null,Y,"mounted")},Q)},g=(W,V,z,Y,Q)=>{if(z&&y(W,z),Y)for(let J=0;J<Y.length;J++)y(W,Y[J]);if(Q){let J=Q.subTree;if(V===J){const rt=Q.vnode;g(W,rt,rt.scopeId,rt.slotScopeIds,Q.parent)}}},m=(W,V,z,Y,Q,J,rt,tt,et=0)=>{for(let q=et;q<W.length;q++){const ut=W[q]=tt?pn(W[q]):He(W[q]);_(null,ut,V,z,Y,Q,J,rt,tt)}},D=(W,V,z,Y,Q,J,rt)=>{const tt=V.el=W.el;let{patchFlag:et,dynamicChildren:q,dirs:ut}=V;et|=W.patchFlag&16;const lt=W.props||kt,ft=V.props||kt;let dt;z&&Fn(z,!1),(dt=ft.onVnodeBeforeUpdate)&&Ue(dt,z,V,W),ut&&kn(V,W,z,"beforeUpdate"),z&&Fn(z,!0);const vt=Q&&V.type!=="foreignObject";if(q?b(W.dynamicChildren,q,tt,z,Y,vt,J):rt||k(W,V,tt,null,z,Y,vt,J,!1),et>0){if(et&16)T(tt,V,lt,ft,z,Y,Q);else if(et&2&&lt.class!==ft.class&&s(tt,"class",null,ft.class,Q),et&4&&s(tt,"style",lt.style,ft.style,Q),et&8){const Et=V.dynamicProps;for(let yt=0;yt<Et.length;yt++){const Tt=Et[yt],Wt=lt[Tt],te=ft[Tt];(te!==Wt||Tt==="value")&&s(tt,Tt,Wt,te,Q,W.children,z,Y,$)}}et&1&&W.children!==V.children&&u(tt,V.children)}else!rt&&q==null&&T(tt,V,lt,ft,z,Y,Q);((dt=ft.onVnodeUpdated)||ut)&&ue(()=>{dt&&Ue(dt,z,V,W),ut&&kn(V,W,z,"updated")},Y)},b=(W,V,z,Y,Q,J,rt)=>{for(let tt=0;tt<V.length;tt++){const et=W[tt],q=V[tt],ut=et.el&&(et.type===Rt||!$n(et,q)||et.shapeFlag&70)?h(et.el):z;_(et,q,ut,null,Y,Q,J,rt,!0)}},T=(W,V,z,Y,Q,J,rt)=>{if(z!==Y){for(const tt in Y){if(Hr(tt))continue;const et=Y[tt],q=z[tt];et!==q&&tt!=="value"&&s(W,tt,q,et,rt,V.children,Q,J,$)}if(z!==kt)for(const tt in z)!Hr(tt)&&!(tt in Y)&&s(W,tt,z[tt],null,rt,V.children,Q,J,$);"value"in Y&&s(W,"value",z.value,Y.value)}},P=(W,V,z,Y,Q,J,rt,tt,et)=>{const q=V.el=W?W.el:o(""),ut=V.anchor=W?W.anchor:o("");let{patchFlag:lt,dynamicChildren:ft,slotScopeIds:dt}=V;dt&&(tt=tt?tt.concat(dt):dt),W==null?(i(q,z,Y),i(ut,z,Y),m(V.children,z,ut,Q,J,rt,tt,et)):lt>0&&lt&64&&ft&&W.dynamicChildren?(b(W.dynamicChildren,ft,z,Q,J,rt,tt),(V.key!=null||Q&&V===Q.subTree)&&Qu(W,V,!0)):k(W,V,z,ut,Q,J,rt,tt,et)},M=(W,V,z,Y,Q,J,rt,tt,et)=>{V.slotScopeIds=tt,W==null?V.shapeFlag&512?Q.ctx.activate(V,z,Y,rt,et):O(V,z,Y,Q,J,rt,et):R(W,V,et)},O=(W,V,z,Y,Q,J,rt)=>{const tt=W.component=Og(W,Y,Q);if(xs(W)&&(tt.ctx.renderer=nt),Mg(tt),tt.asyncDep){if(Q&&Q.registerDep(tt,I),!W.el){const et=tt.subTree=pt(we);v(null,et,V,z)}return}I(tt,W,V,z,Q,J,rt)},R=(W,V,z)=>{const Y=V.component=W.component;if(Hh(W,V,z))if(Y.asyncDep&&!Y.asyncResolved){w(Y,V,z);return}else Y.next=V,Fh(Y.update),Y.update();else V.el=W.el,Y.vnode=V},I=(W,V,z,Y,Q,J,rt)=>{const tt=()=>{if(W.isMounted){let{next:ut,bu:lt,u:ft,parent:dt,vnode:vt}=W,Et=ut,yt;Fn(W,!1),ut?(ut.el=vt.el,w(W,ut,rt)):ut=vt,lt&&jr(lt),(yt=ut.props&&ut.props.onVnodeBeforeUpdate)&&Ue(yt,dt,ut,vt),Fn(W,!0);const Tt=Gs(W),Wt=W.subTree;W.subTree=Tt,_(Wt,Tt,h(Wt.el),X(Wt),W,Q,J),ut.el=Tt.el,Et===null&&jh(W,Tt.el),ft&&ue(ft,Q),(yt=ut.props&&ut.props.onVnodeUpdated)&&ue(()=>Ue(yt,dt,ut,vt),Q)}else{let ut;const{el:lt,props:ft}=V,{bm:dt,m:vt,parent:Et}=W,yt=$r(V);if(Fn(W,!1),dt&&jr(dt),!yt&&(ut=ft&&ft.onVnodeBeforeMount)&&Ue(ut,Et,V),Fn(W,!0),lt&&it){const Tt=()=>{W.subTree=Gs(W),it(lt,W.subTree,W,Q,null)};yt?V.type.__asyncLoader().then(()=>!W.isUnmounted&&Tt()):Tt()}else{const Tt=W.subTree=Gs(W);_(null,Tt,z,Y,W,Q,J),V.el=Tt.el}if(vt&&ue(vt,Q),!yt&&(ut=ft&&ft.onVnodeMounted)){const Tt=V;ue(()=>Ue(ut,Et,Tt),Q)}(V.shapeFlag&256||Et&&$r(Et.vnode)&&Et.vnode.shapeFlag&256)&&W.a&&ue(W.a,Q),W.isMounted=!0,V=z=Y=null}},et=W.effect=new Ya(tt,()=>eo(q),W.scope),q=W.update=()=>et.run();q.id=W.uid,Fn(W,!0),q()},w=(W,V,z)=>{V.component=W;const Y=W.vnode.props;W.vnode=V,W.next=null,hg(W,V.props,Y,z),mg(W,V.children,z),Si(),Qo(),Li()},k=(W,V,z,Y,Q,J,rt,tt,et=!1)=>{const q=W&&W.children,ut=W?W.shapeFlag:0,lt=V.children,{patchFlag:ft,shapeFlag:dt}=V;if(ft>0){if(ft&128){F(q,lt,z,Y,Q,J,rt,tt,et);return}else if(ft&256){B(q,lt,z,Y,Q,J,rt,tt,et);return}}dt&8?(ut&16&&$(q,Q,J),lt!==q&&u(z,lt)):ut&16?dt&16?F(q,lt,z,Y,Q,J,rt,tt,et):$(q,Q,J,!0):(ut&8&&u(z,""),dt&16&&m(lt,z,Y,Q,J,rt,tt,et))},B=(W,V,z,Y,Q,J,rt,tt,et)=>{W=W||ci,V=V||ci;const q=W.length,ut=V.length,lt=Math.min(q,ut);let ft;for(ft=0;ft<lt;ft++){const dt=V[ft]=et?pn(V[ft]):He(V[ft]);_(W[ft],dt,z,null,Q,J,rt,tt,et)}q>ut?$(W,Q,J,!0,!1,lt):m(V,z,Y,Q,J,rt,tt,et,lt)},F=(W,V,z,Y,Q,J,rt,tt,et)=>{let q=0;const ut=V.length;let lt=W.length-1,ft=ut-1;for(;q<=lt&&q<=ft;){const dt=W[q],vt=V[q]=et?pn(V[q]):He(V[q]);if($n(dt,vt))_(dt,vt,z,null,Q,J,rt,tt,et);else break;q++}for(;q<=lt&&q<=ft;){const dt=W[lt],vt=V[ft]=et?pn(V[ft]):He(V[ft]);if($n(dt,vt))_(dt,vt,z,null,Q,J,rt,tt,et);else break;lt--,ft--}if(q>lt){if(q<=ft){const dt=ft+1,vt=dt<ut?V[dt].el:Y;for(;q<=ft;)_(null,V[q]=et?pn(V[q]):He(V[q]),z,vt,Q,J,rt,tt,et),q++}}else if(q>ft)for(;q<=lt;)K(W[q],Q,J,!0),q++;else{const dt=q,vt=q,Et=new Map;for(q=vt;q<=ft;q++){const St=V[q]=et?pn(V[q]):He(V[q]);St.key!=null&&Et.set(St.key,q)}let yt,Tt=0;const Wt=ft-vt+1;let te=!1,Ht=0;const jt=new Array(Wt);for(q=0;q<Wt;q++)jt[q]=0;for(q=dt;q<=lt;q++){const St=W[q];if(Tt>=Wt){K(St,Q,J,!0);continue}let It;if(St.key!=null)It=Et.get(St.key);else for(yt=vt;yt<=ft;yt++)if(jt[yt-vt]===0&&$n(St,V[yt])){It=yt;break}It===void 0?K(St,Q,J,!0):(jt[It-vt]=q+1,It>=Ht?Ht=It:te=!0,_(St,V[It],z,null,Q,J,rt,tt,et),Tt++)}const oe=te?bg(jt):ci;for(yt=oe.length-1,q=Wt-1;q>=0;q--){const St=vt+q,It=V[St],ee=St+1<ut?V[St+1].el:Y;jt[q]===0?_(null,It,z,ee,Q,J,rt,tt,et):te&&(yt<0||q!==oe[yt]?N(It,z,ee,2):yt--)}}},N=(W,V,z,Y,Q=null)=>{const{el:J,type:rt,transition:tt,children:et,shapeFlag:q}=W;if(q&6){N(W.component.subTree,V,z,Y);return}if(q&128){W.suspense.move(V,z,Y);return}if(q&64){rt.move(W,V,z,nt);return}if(rt===Rt){i(J,V,z);for(let lt=0;lt<et.length;lt++)N(et[lt],V,z,Y);i(W.anchor,V,z);return}if(rt===Gr){x(W,V,z);return}if(Y!==2&&q&1&&tt)if(Y===0)tt.beforeEnter(J),i(J,V,z),ue(()=>tt.enter(J),Q);else{const{leave:lt,delayLeave:ft,afterLeave:dt}=tt,vt=()=>i(J,V,z),Et=()=>{lt(J,()=>{vt(),dt&&dt()})};ft?ft(J,vt,Et):Et()}else i(J,V,z)},K=(W,V,z,Y=!1,Q=!1)=>{const{type:J,props:rt,ref:tt,children:et,dynamicChildren:q,shapeFlag:ut,patchFlag:lt,dirs:ft}=W;if(tt!=null&&ba(tt,null,z,W,!0),ut&256){V.ctx.deactivate(W);return}const dt=ut&1&&ft,vt=!$r(W);let Et;if(vt&&(Et=rt&&rt.onVnodeBeforeUnmount)&&Ue(Et,V,W),ut&6)j(W.component,z,Y);else{if(ut&128){W.suspense.unmount(z,Y);return}dt&&kn(W,null,V,"beforeUnmount"),ut&64?W.type.remove(W,V,z,Q,nt,Y):q&&(J!==Rt||lt>0&&lt&64)?$(q,V,z,!1,!0):(J===Rt&&lt&384||!Q&&ut&16)&&$(et,V,z),Y&&H(W)}(vt&&(Et=rt&&rt.onVnodeUnmounted)||dt)&&ue(()=>{Et&&Ue(Et,V,W),dt&&kn(W,null,V,"unmounted")},z)},H=W=>{const{type:V,el:z,anchor:Y,transition:Q}=W;if(V===Rt){U(z,Y);return}if(V===Gr){S(W);return}const J=()=>{r(z),Q&&!Q.persisted&&Q.afterLeave&&Q.afterLeave()};if(W.shapeFlag&1&&Q&&!Q.persisted){const{leave:rt,delayLeave:tt}=Q,et=()=>rt(z,J);tt?tt(W.el,J,et):et()}else J()},U=(W,V)=>{let z;for(;W!==V;)z=d(W),r(W),W=z;r(V)},j=(W,V,z)=>{const{bum:Y,scope:Q,update:J,subTree:rt,um:tt}=W;Y&&jr(Y),Q.stop(),J&&(J.active=!1,K(rt,W,V,z)),tt&&ue(tt,V),ue(()=>{W.isUnmounted=!0},V),V&&V.pendingBranch&&!V.isUnmounted&&W.asyncDep&&!W.asyncResolved&&W.suspenseId===V.pendingId&&(V.deps--,V.deps===0&&V.resolve())},$=(W,V,z,Y=!1,Q=!1,J=0)=>{for(let rt=J;rt<W.length;rt++)K(W[rt],V,z,Y,Q)},X=W=>W.shapeFlag&6?X(W.component.subTree):W.shapeFlag&128?W.suspense.next():d(W.anchor||W.el),Z=(W,V,z)=>{W==null?V._vnode&&K(V._vnode,null,null,!0):_(V._vnode||null,W,V,null,null,null,z),Qo(),Mu(),V._vnode=W},nt={p:_,um:K,m:N,r:H,mt:O,mc:m,pc:k,pbc:b,n:X,o:e};let at,it;return t&&([at,it]=t(nt)),{render:Z,hydrate:at,createApp:yg(Z,at)}}function Fn({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function Qu(e,t,n=!1){const i=e.children,r=t.children;if(gt(i)&&gt(r))for(let s=0;s<i.length;s++){const a=i[s];let o=r[s];o.shapeFlag&1&&!o.dynamicChildren&&((o.patchFlag<=0||o.patchFlag===32)&&(o=r[s]=pn(r[s]),o.el=a.el),n||Qu(a,o))}}function bg(e){const t=e.slice(),n=[0];let i,r,s,a,o;const l=e.length;for(i=0;i<l;i++){const c=e[i];if(c!==0){if(r=n[n.length-1],e[r]<c){t[i]=r,n.push(i);continue}for(s=0,a=n.length-1;s<a;)o=s+a>>1,e[n[o]]<c?s=o+1:a=o;c<e[n[s]]&&(s>0&&(t[i]=n[s-1]),n[s]=i)}}for(s=n.length,a=n[s-1];s-- >0;)n[s]=a,a=t[a];return n}const Tg=e=>e.__isTeleport,Rt=Symbol(void 0),so=Symbol(void 0),we=Symbol(void 0),Gr=Symbol(void 0),Hi=[];let Oe=null;function st(e=!1){Hi.push(Oe=e?null:[])}function _g(){Hi.pop(),Oe=Hi[Hi.length-1]||null}let sr=1;function ol(e){sr+=e}function Zu(e){return e.dynamicChildren=sr>0?Oe||ci:null,_g(),sr>0&&Oe&&Oe.push(e),e}function ct(e,t,n,i,r,s){return Zu(G(e,t,n,i,r,s,!0))}function zt(e,t,n,i,r){return Zu(pt(e,t,n,i,r,!0))}function Ta(e){return e?e.__v_isVNode===!0:!1}function $n(e,t){return e.type===t.type&&e.key===t.key}const Ts="__vInternal",Ju=({key:e})=>e!=null?e:null,zr=({ref:e,ref_key:t,ref_for:n})=>e!=null?Jt(e)||re(e)||bt(e)?{i:Te,r:e,k:t,f:!!n}:e:null;function G(e,t=null,n=null,i=0,r=null,s=e===Rt?0:1,a=!1,o=!1){const l={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Ju(t),ref:t&&zr(t),scopeId:Es,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:r,dynamicChildren:null,appContext:null};return o?(ao(l,n),s&128&&e.normalize(l)):n&&(l.shapeFlag|=Jt(n)?8:16),sr>0&&!a&&Oe&&(l.patchFlag>0||s&6)&&l.patchFlag!==32&&Oe.push(l),l}const pt=Sg;function Sg(e,t=null,n=null,i=0,r=null,s=!1){if((!e||e===rg)&&(e=we),Ta(e)){const o=An(e,t,!0);return n&&ao(o,n),sr>0&&!s&&Oe&&(o.shapeFlag&6?Oe[Oe.indexOf(e)]=o:Oe.push(o)),o.patchFlag|=-2,o}if(kg(e)&&(e=e.__vccOpts),t){t=Lg(t);let{class:o,style:l}=t;o&&!Jt(o)&&(t.class=Ha(o)),Ft(l)&&(bu(l)&&!gt(l)&&(l=Zt({},l)),t.style=Ge(l))}const a=Jt(e)?1:Vh(e)?128:Tg(e)?64:Ft(e)?4:bt(e)?2:0;return G(e,t,n,i,r,a,s,!0)}function Lg(e){return e?bu(e)||Ts in e?Zt({},e):e:null}function An(e,t,n=!1){const{props:i,ref:r,patchFlag:s,children:a}=e,o=t?Dg(i||{},t):i;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:o,key:o&&Ju(o),ref:t&&t.ref?n&&r?gt(r)?r.concat(zr(t)):[r,zr(t)]:zr(t):r,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:a,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Rt?s===-1?16:s|16:s,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&An(e.ssContent),ssFallback:e.ssFallback&&An(e.ssFallback),el:e.el,anchor:e.anchor}}function Se(e=" ",t=0){return pt(so,null,e,t)}function qu(e,t){const n=pt(Gr,null,e);return n.staticCount=t,n}function Ot(e="",t=!1){return t?(st(),zt(we,null,e)):pt(we,null,e)}function He(e){return e==null||typeof e=="boolean"?pt(we):gt(e)?pt(Rt,null,e.slice()):typeof e=="object"?pn(e):pt(so,null,String(e))}function pn(e){return e.el===null||e.memo?e:An(e)}function ao(e,t){let n=0;const{shapeFlag:i}=e;if(t==null)t=null;else if(gt(t))n=16;else if(typeof t=="object")if(i&65){const r=t.default;r&&(r._c&&(r._d=!1),ao(e,r()),r._c&&(r._d=!0));return}else{n=32;const r=t._;!r&&!(Ts in t)?t._ctx=Te:r===3&&Te&&(Te.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else bt(t)?(t={default:t,_ctx:Te},n=32):(t=String(t),i&64?(n=16,t=[Se(t)]):n=8);e.children=t,e.shapeFlag|=n}function Dg(...e){const t={};for(let n=0;n<e.length;n++){const i=e[n];for(const r in i)if(r==="class")t.class!==i.class&&(t.class=Ha([t.class,i.class]));else if(r==="style")t.style=Ge([t.style,i.style]);else if(hs(r)){const s=t[r],a=i[r];a&&s!==a&&!(gt(s)&&s.includes(a))&&(t[r]=s?[].concat(s,a):a)}else r!==""&&(t[r]=i[r])}return t}function Ue(e,t,n,i=null){_e(e,t,7,[n,i])}const Ag=Xu();let Cg=0;function Og(e,t,n){const i=e.type,r=(t?t.appContext:e.appContext)||Ag,s={uid:Cg++,vnode:e,type:i,parent:t,appContext:r,root:null,next:null,subTree:null,effect:null,update:null,scope:new eh(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(r.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:$u(i,r),emitsOptions:Ru(i,r),emit:null,emitted:null,propsDefaults:kt,inheritAttrs:i.inheritAttrs,ctx:kt,data:kt,props:kt,attrs:kt,slots:kt,refs:kt,setupState:kt,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=Uh.bind(null,s),e.ce&&e.ce(s),s}let Yt=null;const tf=()=>Yt||Te,mi=e=>{Yt=e,e.scope.on()},Xn=()=>{Yt&&Yt.scope.off(),Yt=null};function ef(e){return e.vnode.shapeFlag&4}let ar=!1;function Mg(e,t=!1){ar=t;const{props:n,children:i}=e.vnode,r=ef(e);dg(e,n,r,t),vg(e,i);const s=r?Pg(e,t):void 0;return ar=!1,s}function Pg(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=Tu(new Proxy(e.ctx,ag));const{setup:i}=n;if(i){const r=e.setupContext=i.length>1?Ig(e):null;mi(e),Si();const s=_n(i,e,0,[e.props,r]);if(Li(),Xn(),ou(s)){if(s.then(Xn,Xn),t)return s.then(a=>{ll(e,a,t)}).catch(a=>{ps(a,e,0)});e.asyncDep=s}else ll(e,s,t)}else nf(e,t)}function ll(e,t,n){bt(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Ft(t)&&(e.setupState=Du(t)),nf(e,n)}let cl;function nf(e,t,n){const i=e.type;if(!e.render){if(!t&&cl&&!i.render){const r=i.template||io(e).template;if(r){const{isCustomElement:s,compilerOptions:a}=e.appContext.config,{delimiters:o,compilerOptions:l}=i,c=Zt(Zt({isCustomElement:s,delimiters:o},a),l);i.render=cl(r,c)}}e.render=i.render||Pe}mi(e),Si(),og(e),Li(),Xn()}function Rg(e){return new Proxy(e.attrs,{get(t,n){return ge(e,"get","$attrs"),t[n]}})}function Ig(e){const t=i=>{e.exposed=i||{}};let n;return{get attrs(){return n||(n=Rg(e))},slots:e.slots,emit:e.emit,expose:t}}function _s(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Du(Tu(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in ts)return ts[n](e)}}))}function wg(e,t=!0){return bt(e)?e.displayName||e.name:e.name||t&&e.__name}function kg(e){return bt(e)&&"__vccOpts"in e}const xe=(e,t)=>Ih(e,t,ar);function oo(e,t,n){const i=arguments.length;return i===2?Ft(t)&&!gt(t)?Ta(t)?pt(e,null,[t]):pt(e,t):pt(e,null,t):(i>3?n=Array.prototype.slice.call(arguments,2):i===3&&Ta(n)&&(n=[n]),pt(e,t,n))}const Fg="3.2.39",Bg="http://www.w3.org/2000/svg",Gn=typeof document<"u"?document:null,ul=Gn&&Gn.createElement("template"),Ng={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,i)=>{const r=t?Gn.createElementNS(Bg,e):Gn.createElement(e,n?{is:n}:void 0);return e==="select"&&i&&i.multiple!=null&&r.setAttribute("multiple",i.multiple),r},createText:e=>Gn.createTextNode(e),createComment:e=>Gn.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Gn.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},cloneNode(e){const t=e.cloneNode(!0);return"_value"in e&&(t._value=e._value),t},insertStaticContent(e,t,n,i,r,s){const a=n?n.previousSibling:t.lastChild;if(r&&(r===s||r.nextSibling))for(;t.insertBefore(r.cloneNode(!0),n),!(r===s||!(r=r.nextSibling)););else{ul.innerHTML=i?`<svg>${e}</svg>`:e;const o=ul.content;if(i){const l=o.firstChild;for(;l.firstChild;)o.appendChild(l.firstChild);o.removeChild(l)}t.insertBefore(o,n)}return[a?a.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};function Ug(e,t,n){const i=e._vtc;i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}function Wg(e,t,n){const i=e.style,r=Jt(n);if(n&&!r){for(const s in n)_a(i,s,n[s]);if(t&&!Jt(t))for(const s in t)n[s]==null&&_a(i,s,"")}else{const s=i.display;r?t!==n&&(i.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(i.display=s)}}const fl=/\s*!important$/;function _a(e,t,n){if(gt(n))n.forEach(i=>_a(e,t,i));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const i=Kg(e,t);fl.test(n)?e.setProperty(ti(i),n.replace(fl,""),"important"):e[i]=n}}const dl=["Webkit","Moz","ms"],Ys={};function Kg(e,t){const n=Ys[t];if(n)return n;let i=Xe(t);if(i!=="filter"&&i in e)return Ys[t]=i;i=vs(i);for(let r=0;r<dl.length;r++){const s=dl[r]+i;if(s in e)return Ys[t]=s}return t}const hl="http://www.w3.org/1999/xlink";function Hg(e,t,n,i,r){if(i&&t.startsWith("xlink:"))n==null?e.removeAttributeNS(hl,t.slice(6,t.length)):e.setAttributeNS(hl,t,n);else{const s=jd(t);n==null||s&&!su(n)?e.removeAttribute(t):e.setAttribute(t,s?"":n)}}function jg(e,t,n,i,r,s,a){if(t==="innerHTML"||t==="textContent"){i&&a(i,r,s),e[t]=n==null?"":n;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=n;const l=n==null?"":n;(e.value!==l||e.tagName==="OPTION")&&(e.value=l),n==null&&e.removeAttribute(t);return}let o=!1;if(n===""||n==null){const l=typeof e[t];l==="boolean"?n=su(n):n==null&&l==="string"?(n="",o=!0):l==="number"&&(n=0,o=!0)}try{e[t]=n}catch{}o&&e.removeAttribute(t)}const[rf,Vg]=(()=>{let e=Date.now,t=!1;if(typeof window<"u"){Date.now()>document.createEvent("Event").timeStamp&&(e=performance.now.bind(performance));const n=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(n&&Number(n[1])<=53)}return[e,t]})();let Sa=0;const $g=Promise.resolve(),Gg=()=>{Sa=0},zg=()=>Sa||($g.then(Gg),Sa=rf());function En(e,t,n,i){e.addEventListener(t,n,i)}function Yg(e,t,n,i){e.removeEventListener(t,n,i)}function Xg(e,t,n,i,r=null){const s=e._vei||(e._vei={}),a=s[t];if(i&&a)a.value=i;else{const[o,l]=Qg(t);if(i){const c=s[t]=Zg(i,r);En(e,o,c,l)}else a&&(Yg(e,o,a,l),s[t]=void 0)}}const gl=/(?:Once|Passive|Capture)$/;function Qg(e){let t;if(gl.test(e)){t={};let i;for(;i=e.match(gl);)e=e.slice(0,e.length-i[0].length),t[i[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):ti(e.slice(2)),t]}function Zg(e,t){const n=i=>{const r=i.timeStamp||rf();(Vg||r>=n.attached-1)&&_e(Jg(i,n.value),t,5,[i])};return n.value=e,n.attached=zg(),n}function Jg(e,t){if(gt(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(i=>r=>!r._stopped&&i&&i(r))}else return t}const vl=/^on[a-z]/,qg=(e,t,n,i,r=!1,s,a,o,l)=>{t==="class"?Ug(e,i,r):t==="style"?Wg(e,n,i):hs(t)?Va(t)||Xg(e,t,n,i,a):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):tv(e,t,i,r))?jg(e,t,i,s,a,o,l):(t==="true-value"?e._trueValue=i:t==="false-value"&&(e._falseValue=i),Hg(e,t,i,r))};function tv(e,t,n,i){return i?!!(t==="innerHTML"||t==="textContent"||t in e&&vl.test(t)&&bt(n)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||vl.test(t)&&Jt(n)?!1:t in e}const hn="transition",Oi="animation",hi=(e,{slots:t})=>oo(Fu,af(e),t);hi.displayName="Transition";const sf={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},ev=hi.props=Zt({},Fu.props,sf),Bn=(e,t=[])=>{gt(e)?e.forEach(n=>n(...t)):e&&e(...t)},ml=e=>e?gt(e)?e.some(t=>t.length>1):e.length>1:!1;function af(e){const t={};for(const T in e)T in sf||(t[T]=e[T]);if(e.css===!1)return t;const{name:n="v",type:i,duration:r,enterFromClass:s=`${n}-enter-from`,enterActiveClass:a=`${n}-enter-active`,enterToClass:o=`${n}-enter-to`,appearFromClass:l=s,appearActiveClass:c=a,appearToClass:u=o,leaveFromClass:h=`${n}-leave-from`,leaveActiveClass:d=`${n}-leave-active`,leaveToClass:y=`${n}-leave-to`}=e,E=nv(r),L=E&&E[0],_=E&&E[1],{onBeforeEnter:A,onEnter:v,onEnterCancelled:f,onLeave:x,onLeaveCancelled:S,onBeforeAppear:C=A,onAppear:p=v,onAppearCancelled:g=f}=t,m=(T,P,M)=>{mn(T,P?u:o),mn(T,P?c:a),M&&M()},D=(T,P)=>{T._isLeaving=!1,mn(T,h),mn(T,y),mn(T,d),P&&P()},b=T=>(P,M)=>{const O=T?p:v,R=()=>m(P,T,M);Bn(O,[P,R]),pl(()=>{mn(P,T?l:s),tn(P,T?u:o),ml(O)||yl(P,i,L,R)})};return Zt(t,{onBeforeEnter(T){Bn(A,[T]),tn(T,s),tn(T,a)},onBeforeAppear(T){Bn(C,[T]),tn(T,l),tn(T,c)},onEnter:b(!1),onAppear:b(!0),onLeave(T,P){T._isLeaving=!0;const M=()=>D(T,P);tn(T,h),lf(),tn(T,d),pl(()=>{!T._isLeaving||(mn(T,h),tn(T,y),ml(x)||yl(T,i,_,M))}),Bn(x,[T,M])},onEnterCancelled(T){m(T,!1),Bn(f,[T])},onAppearCancelled(T){m(T,!0),Bn(g,[T])},onLeaveCancelled(T){D(T),Bn(S,[T])}})}function nv(e){if(e==null)return null;if(Ft(e))return[Xs(e.enter),Xs(e.leave)];{const t=Xs(e);return[t,t]}}function Xs(e){return qi(e)}function tn(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e._vtc||(e._vtc=new Set)).add(t)}function mn(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.remove(i));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function pl(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let iv=0;function yl(e,t,n,i){const r=e._endId=++iv,s=()=>{r===e._endId&&i()};if(n)return setTimeout(s,n);const{type:a,timeout:o,propCount:l}=of(e,t);if(!a)return i();const c=a+"end";let u=0;const h=()=>{e.removeEventListener(c,d),s()},d=y=>{y.target===e&&++u>=l&&h()};setTimeout(()=>{u<l&&h()},o+1),e.addEventListener(c,d)}function of(e,t){const n=window.getComputedStyle(e),i=E=>(n[E]||"").split(", "),r=i(hn+"Delay"),s=i(hn+"Duration"),a=El(r,s),o=i(Oi+"Delay"),l=i(Oi+"Duration"),c=El(o,l);let u=null,h=0,d=0;t===hn?a>0&&(u=hn,h=a,d=s.length):t===Oi?c>0&&(u=Oi,h=c,d=l.length):(h=Math.max(a,c),u=h>0?a>c?hn:Oi:null,d=u?u===hn?s.length:l.length:0);const y=u===hn&&/\b(transform|all)(,|$)/.test(n[hn+"Property"]);return{type:u,timeout:h,propCount:d,hasTransform:y}}function El(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,i)=>xl(n)+xl(e[i])))}function xl(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function lf(){return document.body.offsetHeight}const cf=new WeakMap,uf=new WeakMap,rv={name:"TransitionGroup",props:Zt({},ev,{tag:String,moveClass:String}),setup(e,{slots:t}){const n=tf(),i=ku();let r,s;return Wu(()=>{if(!r.length)return;const a=e.moveClass||`${e.name||"v"}-move`;if(!lv(r[0].el,n.vnode.el,a))return;r.forEach(sv),r.forEach(av);const o=r.filter(ov);lf(),o.forEach(l=>{const c=l.el,u=c.style;tn(c,a),u.transform=u.webkitTransform=u.transitionDuration="";const h=c._moveCb=d=>{d&&d.target!==c||(!d||/transform$/.test(d.propertyName))&&(c.removeEventListener("transitionend",h),c._moveCb=null,mn(c,a))};c.addEventListener("transitionend",h)})}),()=>{const a=Ct(e),o=af(a);let l=a.tag||Rt;r=s,s=t.default?no(t.default()):[];for(let c=0;c<s.length;c++){const u=s[c];u.key!=null&&rr(u,ir(u,o,i,n))}if(r)for(let c=0;c<r.length;c++){const u=r[c];rr(u,ir(u,o,i,n)),cf.set(u,u.el.getBoundingClientRect())}return pt(l,null,s)}}},ff=rv;function sv(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function av(e){uf.set(e,e.el.getBoundingClientRect())}function ov(e){const t=cf.get(e),n=uf.get(e),i=t.left-n.left,r=t.top-n.top;if(i||r){const s=e.el.style;return s.transform=s.webkitTransform=`translate(${i}px,${r}px)`,s.transitionDuration="0s",e}}function lv(e,t,n){const i=e.cloneNode();e._vtc&&e._vtc.forEach(a=>{a.split(/\s+/).forEach(o=>o&&i.classList.remove(o))}),n.split(/\s+/).forEach(a=>a&&i.classList.add(a)),i.style.display="none";const r=t.nodeType===1?t:t.parentNode;r.appendChild(i);const{hasTransform:s}=of(i);return r.removeChild(i),s}const pi=e=>{const t=e.props["onUpdate:modelValue"]||!1;return gt(t)?n=>jr(t,n):t};function cv(e){e.target.composing=!0}function bl(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const li={created(e,{modifiers:{lazy:t,trim:n,number:i}},r){e._assign=pi(r);const s=i||r.props&&r.props.type==="number";En(e,t?"change":"input",a=>{if(a.target.composing)return;let o=e.value;n&&(o=o.trim()),s&&(o=qi(o)),e._assign(o)}),n&&En(e,"change",()=>{e.value=e.value.trim()}),t||(En(e,"compositionstart",cv),En(e,"compositionend",bl),En(e,"change",bl))},mounted(e,{value:t}){e.value=t==null?"":t},beforeUpdate(e,{value:t,modifiers:{lazy:n,trim:i,number:r}},s){if(e._assign=pi(s),e.composing||document.activeElement===e&&e.type!=="range"&&(n||i&&e.value.trim()===t||(r||e.type==="number")&&qi(e.value)===t))return;const a=t==null?"":t;e.value!==a&&(e.value=a)}},Nn={deep:!0,created(e,t,n){e._assign=pi(n),En(e,"change",()=>{const i=e._modelValue,r=or(e),s=e.checked,a=e._assign;if(gt(i)){const o=ja(i,r),l=o!==-1;if(s&&!l)a(i.concat(r));else if(!s&&l){const c=[...i];c.splice(o,1),a(c)}}else if(_i(i)){const o=new Set(i);s?o.add(r):o.delete(r),a(o)}else a(hf(e,s))})},mounted:Tl,beforeUpdate(e,t,n){e._assign=pi(n),Tl(e,t,n)}};function Tl(e,{value:t,oldValue:n},i){e._modelValue=t,gt(t)?e.checked=ja(t,i.props.value)>-1:_i(t)?e.checked=t.has(i.props.value):t!==n&&(e.checked=gr(t,hf(e,!0)))}const df={deep:!0,created(e,{value:t,modifiers:{number:n}},i){const r=_i(t);En(e,"change",()=>{const s=Array.prototype.filter.call(e.options,a=>a.selected).map(a=>n?qi(or(a)):or(a));e._assign(e.multiple?r?new Set(s):s:s[0])}),e._assign=pi(i)},mounted(e,{value:t}){_l(e,t)},beforeUpdate(e,t,n){e._assign=pi(n)},updated(e,{value:t}){_l(e,t)}};function _l(e,t){const n=e.multiple;if(!(n&&!gt(t)&&!_i(t))){for(let i=0,r=e.options.length;i<r;i++){const s=e.options[i],a=or(s);if(n)gt(t)?s.selected=ja(t,a)>-1:s.selected=t.has(a);else if(gr(or(s),t)){e.selectedIndex!==i&&(e.selectedIndex=i);return}}!n&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function or(e){return"_value"in e?e._value:e.value}function hf(e,t){const n=t?"_trueValue":"_falseValue";return n in e?e[n]:t}const uv=["ctrl","shift","alt","meta"],fv={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>uv.some(n=>e[`${n}Key`]&&!t.includes(n))},dv=(e,t)=>(n,...i)=>{for(let r=0;r<t.length;r++){const s=fv[t[r]];if(s&&s(n,t))return}return e(n,...i)},hv={esc:"escape",space:" ",up:"arrow-up",left:"arrow-left",right:"arrow-right",down:"arrow-down",delete:"backspace"},gv=(e,t)=>n=>{if(!("key"in n))return;const i=ti(n.key);if(t.some(r=>r===i||hv[r]===i))return e(n)},vv=Zt({patchProp:qg},Ng);let Sl;function mv(){return Sl||(Sl=Eg(vv))}const pv=(...e)=>{const t=mv().createApp(...e),{mount:n}=t;return t.mount=i=>{const r=yv(i);if(!r)return;const s=t._component;!bt(s)&&!s.render&&!s.template&&(s.template=r.innerHTML),r.innerHTML="";const a=n(r,!1,r instanceof SVGElement);return r instanceof Element&&(r.removeAttribute("v-cloak"),r.setAttribute("data-v-app","")),a},t};function yv(e){return Jt(e)?document.querySelector(e):e}/*!
  * vue-router v4.1.5
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const oi=typeof window<"u";function Ev(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const Mt=Object.assign;function Qs(e,t){const n={};for(const i in t){const r=t[i];n[i]=ke(r)?r.map(e):e(r)}return n}const ji=()=>{},ke=Array.isArray,xv=/\/$/,bv=e=>e.replace(xv,"");function Zs(e,t,n="/"){let i,r={},s="",a="";const o=t.indexOf("#");let l=t.indexOf("?");return o<l&&o>=0&&(l=-1),l>-1&&(i=t.slice(0,l),s=t.slice(l+1,o>-1?o:t.length),r=e(s)),o>-1&&(i=i||t.slice(0,o),a=t.slice(o,t.length)),i=Lv(i!=null?i:t,n),{fullPath:i+(s&&"?")+s+a,path:i,query:r,hash:a}}function Tv(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function Ll(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function _v(e,t,n){const i=t.matched.length-1,r=n.matched.length-1;return i>-1&&i===r&&yi(t.matched[i],n.matched[r])&&gf(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function yi(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function gf(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!Sv(e[n],t[n]))return!1;return!0}function Sv(e,t){return ke(e)?Dl(e,t):ke(t)?Dl(t,e):e===t}function Dl(e,t){return ke(t)?e.length===t.length&&e.every((n,i)=>n===t[i]):e.length===1&&e[0]===t}function Lv(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),i=e.split("/");let r=n.length-1,s,a;for(s=0;s<i.length;s++)if(a=i[s],a!==".")if(a==="..")r>1&&r--;else break;return n.slice(0,r).join("/")+"/"+i.slice(s-(s===i.length?1:0)).join("/")}var lr;(function(e){e.pop="pop",e.push="push"})(lr||(lr={}));var Vi;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Vi||(Vi={}));function Dv(e){if(!e)if(oi){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),bv(e)}const Av=/^[^#]+#/;function Cv(e,t){return e.replace(Av,"#")+t}function Ov(e,t){const n=document.documentElement.getBoundingClientRect(),i=e.getBoundingClientRect();return{behavior:t.behavior,left:i.left-n.left-(t.left||0),top:i.top-n.top-(t.top||0)}}const Ss=()=>({left:window.pageXOffset,top:window.pageYOffset});function Mv(e){let t;if("el"in e){const n=e.el,i=typeof n=="string"&&n.startsWith("#"),r=typeof n=="string"?i?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!r)return;t=Ov(r,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function Al(e,t){return(history.state?history.state.position-t:-1)+e}const La=new Map;function Pv(e,t){La.set(e,t)}function Rv(e){const t=La.get(e);return La.delete(e),t}let Iv=()=>location.protocol+"//"+location.host;function vf(e,t){const{pathname:n,search:i,hash:r}=t,s=e.indexOf("#");if(s>-1){let o=r.includes(e.slice(s))?e.slice(s).length:1,l=r.slice(o);return l[0]!=="/"&&(l="/"+l),Ll(l,"")}return Ll(n,e)+i+r}function wv(e,t,n,i){let r=[],s=[],a=null;const o=({state:d})=>{const y=vf(e,location),E=n.value,L=t.value;let _=0;if(d){if(n.value=y,t.value=d,a&&a===E){a=null;return}_=L?d.position-L.position:0}else i(y);r.forEach(A=>{A(n.value,E,{delta:_,type:lr.pop,direction:_?_>0?Vi.forward:Vi.back:Vi.unknown})})};function l(){a=n.value}function c(d){r.push(d);const y=()=>{const E=r.indexOf(d);E>-1&&r.splice(E,1)};return s.push(y),y}function u(){const{history:d}=window;!d.state||d.replaceState(Mt({},d.state,{scroll:Ss()}),"")}function h(){for(const d of s)d();s=[],window.removeEventListener("popstate",o),window.removeEventListener("beforeunload",u)}return window.addEventListener("popstate",o),window.addEventListener("beforeunload",u),{pauseListeners:l,listen:c,destroy:h}}function Cl(e,t,n,i=!1,r=!1){return{back:e,current:t,forward:n,replaced:i,position:window.history.length,scroll:r?Ss():null}}function kv(e){const{history:t,location:n}=window,i={value:vf(e,n)},r={value:t.state};r.value||s(i.value,{back:null,current:i.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function s(l,c,u){const h=e.indexOf("#"),d=h>-1?(n.host&&document.querySelector("base")?e:e.slice(h))+l:Iv()+e+l;try{t[u?"replaceState":"pushState"](c,"",d),r.value=c}catch(y){console.error(y),n[u?"replace":"assign"](d)}}function a(l,c){const u=Mt({},t.state,Cl(r.value.back,l,r.value.forward,!0),c,{position:r.value.position});s(l,u,!0),i.value=l}function o(l,c){const u=Mt({},r.value,t.state,{forward:l,scroll:Ss()});s(u.current,u,!0);const h=Mt({},Cl(i.value,l,null),{position:u.position+1},c);s(l,h,!1),i.value=l}return{location:i,state:r,push:o,replace:a}}function Fv(e){e=Dv(e);const t=kv(e),n=wv(e,t.state,t.location,t.replace);function i(s,a=!0){a||n.pauseListeners(),history.go(s)}const r=Mt({location:"",base:e,go:i,createHref:Cv.bind(null,e)},t,n);return Object.defineProperty(r,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(r,"state",{enumerable:!0,get:()=>t.state.value}),r}function Bv(e){return typeof e=="string"||e&&typeof e=="object"}function mf(e){return typeof e=="string"||typeof e=="symbol"}const gn={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},pf=Symbol("");var Ol;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(Ol||(Ol={}));function Ei(e,t){return Mt(new Error,{type:e,[pf]:!0},t)}function Je(e,t){return e instanceof Error&&pf in e&&(t==null||!!(e.type&t))}const Ml="[^/]+?",Nv={sensitive:!1,strict:!1,start:!0,end:!0},Uv=/[.+*?^${}()[\]/\\]/g;function Wv(e,t){const n=Mt({},Nv,t),i=[];let r=n.start?"^":"";const s=[];for(const c of e){const u=c.length?[]:[90];n.strict&&!c.length&&(r+="/");for(let h=0;h<c.length;h++){const d=c[h];let y=40+(n.sensitive?.25:0);if(d.type===0)h||(r+="/"),r+=d.value.replace(Uv,"\\$&"),y+=40;else if(d.type===1){const{value:E,repeatable:L,optional:_,regexp:A}=d;s.push({name:E,repeatable:L,optional:_});const v=A||Ml;if(v!==Ml){y+=10;try{new RegExp(`(${v})`)}catch(x){throw new Error(`Invalid custom RegExp for param "${E}" (${v}): `+x.message)}}let f=L?`((?:${v})(?:/(?:${v}))*)`:`(${v})`;h||(f=_&&c.length<2?`(?:/${f})`:"/"+f),_&&(f+="?"),r+=f,y+=20,_&&(y+=-8),L&&(y+=-20),v===".*"&&(y+=-50)}u.push(y)}i.push(u)}if(n.strict&&n.end){const c=i.length-1;i[c][i[c].length-1]+=.7000000000000001}n.strict||(r+="/?"),n.end?r+="$":n.strict&&(r+="(?:/|$)");const a=new RegExp(r,n.sensitive?"":"i");function o(c){const u=c.match(a),h={};if(!u)return null;for(let d=1;d<u.length;d++){const y=u[d]||"",E=s[d-1];h[E.name]=y&&E.repeatable?y.split("/"):y}return h}function l(c){let u="",h=!1;for(const d of e){(!h||!u.endsWith("/"))&&(u+="/"),h=!1;for(const y of d)if(y.type===0)u+=y.value;else if(y.type===1){const{value:E,repeatable:L,optional:_}=y,A=E in c?c[E]:"";if(ke(A)&&!L)throw new Error(`Provided param "${E}" is an array but it is not repeatable (* or + modifiers)`);const v=ke(A)?A.join("/"):A;if(!v)if(_)d.length<2&&(u.endsWith("/")?u=u.slice(0,-1):h=!0);else throw new Error(`Missing required param "${E}"`);u+=v}}return u||"/"}return{re:a,score:i,keys:s,parse:o,stringify:l}}function Kv(e,t){let n=0;for(;n<e.length&&n<t.length;){const i=t[n]-e[n];if(i)return i;n++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function Hv(e,t){let n=0;const i=e.score,r=t.score;for(;n<i.length&&n<r.length;){const s=Kv(i[n],r[n]);if(s)return s;n++}if(Math.abs(r.length-i.length)===1){if(Pl(i))return 1;if(Pl(r))return-1}return r.length-i.length}function Pl(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const jv={type:0,value:""},Vv=/[a-zA-Z0-9_]/;function $v(e){if(!e)return[[]];if(e==="/")return[[jv]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(y){throw new Error(`ERR (${n})/"${c}": ${y}`)}let n=0,i=n;const r=[];let s;function a(){s&&r.push(s),s=[]}let o=0,l,c="",u="";function h(){!c||(n===0?s.push({type:0,value:c}):n===1||n===2||n===3?(s.length>1&&(l==="*"||l==="+")&&t(`A repeatable param (${c}) must be alone in its segment. eg: '/:ids+.`),s.push({type:1,value:c,regexp:u,repeatable:l==="*"||l==="+",optional:l==="*"||l==="?"})):t("Invalid state to consume buffer"),c="")}function d(){c+=l}for(;o<e.length;){if(l=e[o++],l==="\\"&&n!==2){i=n,n=4;continue}switch(n){case 0:l==="/"?(c&&h(),a()):l===":"?(h(),n=1):d();break;case 4:d(),n=i;break;case 1:l==="("?n=2:Vv.test(l)?d():(h(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&o--);break;case 2:l===")"?u[u.length-1]=="\\"?u=u.slice(0,-1)+l:n=3:u+=l;break;case 3:h(),n=0,l!=="*"&&l!=="?"&&l!=="+"&&o--,u="";break;default:t("Unknown state");break}}return n===2&&t(`Unfinished custom RegExp for param "${c}"`),h(),a(),r}function Gv(e,t,n){const i=Wv($v(e.path),n),r=Mt(i,{record:e,parent:t,children:[],alias:[]});return t&&!r.record.aliasOf==!t.record.aliasOf&&t.children.push(r),r}function zv(e,t){const n=[],i=new Map;t=wl({strict:!1,end:!0,sensitive:!1},t);function r(u){return i.get(u)}function s(u,h,d){const y=!d,E=Yv(u);E.aliasOf=d&&d.record;const L=wl(t,u),_=[E];if("alias"in u){const f=typeof u.alias=="string"?[u.alias]:u.alias;for(const x of f)_.push(Mt({},E,{components:d?d.record.components:E.components,path:x,aliasOf:d?d.record:E}))}let A,v;for(const f of _){const{path:x}=f;if(h&&x[0]!=="/"){const S=h.record.path,C=S[S.length-1]==="/"?"":"/";f.path=h.record.path+(x&&C+x)}if(A=Gv(f,h,L),d?d.alias.push(A):(v=v||A,v!==A&&v.alias.push(A),y&&u.name&&!Il(A)&&a(u.name)),E.children){const S=E.children;for(let C=0;C<S.length;C++)s(S[C],A,d&&d.children[C])}d=d||A,l(A)}return v?()=>{a(v)}:ji}function a(u){if(mf(u)){const h=i.get(u);h&&(i.delete(u),n.splice(n.indexOf(h),1),h.children.forEach(a),h.alias.forEach(a))}else{const h=n.indexOf(u);h>-1&&(n.splice(h,1),u.record.name&&i.delete(u.record.name),u.children.forEach(a),u.alias.forEach(a))}}function o(){return n}function l(u){let h=0;for(;h<n.length&&Hv(u,n[h])>=0&&(u.record.path!==n[h].record.path||!yf(u,n[h]));)h++;n.splice(h,0,u),u.record.name&&!Il(u)&&i.set(u.record.name,u)}function c(u,h){let d,y={},E,L;if("name"in u&&u.name){if(d=i.get(u.name),!d)throw Ei(1,{location:u});L=d.record.name,y=Mt(Rl(h.params,d.keys.filter(v=>!v.optional).map(v=>v.name)),u.params&&Rl(u.params,d.keys.map(v=>v.name))),E=d.stringify(y)}else if("path"in u)E=u.path,d=n.find(v=>v.re.test(E)),d&&(y=d.parse(E),L=d.record.name);else{if(d=h.name?i.get(h.name):n.find(v=>v.re.test(h.path)),!d)throw Ei(1,{location:u,currentLocation:h});L=d.record.name,y=Mt({},h.params,u.params),E=d.stringify(y)}const _=[];let A=d;for(;A;)_.unshift(A.record),A=A.parent;return{name:L,path:E,params:y,matched:_,meta:Qv(_)}}return e.forEach(u=>s(u)),{addRoute:s,resolve:c,removeRoute:a,getRoutes:o,getRecordMatcher:r}}function Rl(e,t){const n={};for(const i of t)i in e&&(n[i]=e[i]);return n}function Yv(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:Xv(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function Xv(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const i in e.components)t[i]=typeof n=="boolean"?n:n[i];return t}function Il(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Qv(e){return e.reduce((t,n)=>Mt(t,n.meta),{})}function wl(e,t){const n={};for(const i in e)n[i]=i in t?t[i]:e[i];return n}function yf(e,t){return t.children.some(n=>n===e||yf(e,n))}const Ef=/#/g,Zv=/&/g,Jv=/\//g,qv=/=/g,tm=/\?/g,xf=/\+/g,em=/%5B/g,nm=/%5D/g,bf=/%5E/g,im=/%60/g,Tf=/%7B/g,rm=/%7C/g,_f=/%7D/g,sm=/%20/g;function lo(e){return encodeURI(""+e).replace(rm,"|").replace(em,"[").replace(nm,"]")}function am(e){return lo(e).replace(Tf,"{").replace(_f,"}").replace(bf,"^")}function Da(e){return lo(e).replace(xf,"%2B").replace(sm,"+").replace(Ef,"%23").replace(Zv,"%26").replace(im,"`").replace(Tf,"{").replace(_f,"}").replace(bf,"^")}function om(e){return Da(e).replace(qv,"%3D")}function lm(e){return lo(e).replace(Ef,"%23").replace(tm,"%3F")}function cm(e){return e==null?"":lm(e).replace(Jv,"%2F")}function ns(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function um(e){const t={};if(e===""||e==="?")return t;const i=(e[0]==="?"?e.slice(1):e).split("&");for(let r=0;r<i.length;++r){const s=i[r].replace(xf," "),a=s.indexOf("="),o=ns(a<0?s:s.slice(0,a)),l=a<0?null:ns(s.slice(a+1));if(o in t){let c=t[o];ke(c)||(c=t[o]=[c]),c.push(l)}else t[o]=l}return t}function kl(e){let t="";for(let n in e){const i=e[n];if(n=om(n),i==null){i!==void 0&&(t+=(t.length?"&":"")+n);continue}(ke(i)?i.map(s=>s&&Da(s)):[i&&Da(i)]).forEach(s=>{s!==void 0&&(t+=(t.length?"&":"")+n,s!=null&&(t+="="+s))})}return t}function fm(e){const t={};for(const n in e){const i=e[n];i!==void 0&&(t[n]=ke(i)?i.map(r=>r==null?null:""+r):i==null?i:""+i)}return t}const dm=Symbol(""),Fl=Symbol(""),Ls=Symbol(""),co=Symbol(""),Aa=Symbol("");function Mi(){let e=[];function t(i){return e.push(i),()=>{const r=e.indexOf(i);r>-1&&e.splice(r,1)}}function n(){e=[]}return{add:t,list:()=>e,reset:n}}function yn(e,t,n,i,r){const s=i&&(i.enterCallbacks[r]=i.enterCallbacks[r]||[]);return()=>new Promise((a,o)=>{const l=h=>{h===!1?o(Ei(4,{from:n,to:t})):h instanceof Error?o(h):Bv(h)?o(Ei(2,{from:t,to:h})):(s&&i.enterCallbacks[r]===s&&typeof h=="function"&&s.push(h),a())},c=e.call(i&&i.instances[r],t,n,l);let u=Promise.resolve(c);e.length<3&&(u=u.then(l)),u.catch(h=>o(h))})}function Js(e,t,n,i){const r=[];for(const s of e)for(const a in s.components){let o=s.components[a];if(!(t!=="beforeRouteEnter"&&!s.instances[a]))if(hm(o)){const c=(o.__vccOpts||o)[t];c&&r.push(yn(c,n,i,s,a))}else{let l=o();r.push(()=>l.then(c=>{if(!c)return Promise.reject(new Error(`Couldn't resolve component "${a}" at "${s.path}"`));const u=Ev(c)?c.default:c;s.components[a]=u;const d=(u.__vccOpts||u)[t];return d&&yn(d,n,i,s,a)()}))}}return r}function hm(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Bl(e){const t=ze(Ls),n=ze(co),i=xe(()=>t.resolve(ht(e.to))),r=xe(()=>{const{matched:l}=i.value,{length:c}=l,u=l[c-1],h=n.matched;if(!u||!h.length)return-1;const d=h.findIndex(yi.bind(null,u));if(d>-1)return d;const y=Nl(l[c-2]);return c>1&&Nl(u)===y&&h[h.length-1].path!==y?h.findIndex(yi.bind(null,l[c-2])):d}),s=xe(()=>r.value>-1&&pm(n.params,i.value.params)),a=xe(()=>r.value>-1&&r.value===n.matched.length-1&&gf(n.params,i.value.params));function o(l={}){return mm(l)?t[ht(e.replace)?"replace":"push"](ht(e.to)).catch(ji):Promise.resolve()}return{route:i,href:xe(()=>i.value.href),isActive:s,isExactActive:a,navigate:o}}const gm=Nu({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Bl,setup(e,{slots:t}){const n=mr(Bl(e)),{options:i}=ze(Ls),r=xe(()=>({[Ul(e.activeClass,i.linkActiveClass,"router-link-active")]:n.isActive,[Ul(e.exactActiveClass,i.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const s=t.default&&t.default(n);return e.custom?s:oo("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:r.value},s)}}}),vm=gm;function mm(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function pm(e,t){for(const n in t){const i=t[n],r=e[n];if(typeof i=="string"){if(i!==r)return!1}else if(!ke(r)||r.length!==i.length||i.some((s,a)=>s!==r[a]))return!1}return!0}function Nl(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Ul=(e,t,n)=>e!=null?e:t!=null?t:n,ym=Nu({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const i=ze(Aa),r=xe(()=>e.route||i.value),s=ze(Fl,0),a=xe(()=>{let c=ht(s);const{matched:u}=r.value;let h;for(;(h=u[c])&&!h.components;)c++;return c}),o=xe(()=>r.value.matched[a.value]);Vr(Fl,xe(()=>a.value+1)),Vr(dm,o),Vr(Aa,r);const l=ot();return Re(()=>[l.value,o.value,e.name],([c,u,h],[d,y,E])=>{u&&(u.instances[h]=c,y&&y!==u&&c&&c===d&&(u.leaveGuards.size||(u.leaveGuards=y.leaveGuards),u.updateGuards.size||(u.updateGuards=y.updateGuards))),c&&u&&(!y||!yi(u,y)||!d)&&(u.enterCallbacks[h]||[]).forEach(L=>L(c))},{flush:"post"}),()=>{const c=r.value,u=e.name,h=o.value,d=h&&h.components[u];if(!d)return Wl(n.default,{Component:d,route:c});const y=h.props[u],E=y?y===!0?c.params:typeof y=="function"?y(c):y:null,_=oo(d,Mt({},E,t,{onVnodeUnmounted:A=>{A.component.isUnmounted&&(h.instances[u]=null)},ref:l}));return Wl(n.default,{Component:_,route:c})||_}}});function Wl(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const Sf=ym;function Em(e){const t=zv(e.routes,e),n=e.parseQuery||um,i=e.stringifyQuery||kl,r=e.history,s=Mi(),a=Mi(),o=Mi(),l=Oh(gn);let c=gn;oi&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const u=Qs.bind(null,U=>""+U),h=Qs.bind(null,cm),d=Qs.bind(null,ns);function y(U,j){let $,X;return mf(U)?($=t.getRecordMatcher(U),X=j):X=U,t.addRoute(X,$)}function E(U){const j=t.getRecordMatcher(U);j&&t.removeRoute(j)}function L(){return t.getRoutes().map(U=>U.record)}function _(U){return!!t.getRecordMatcher(U)}function A(U,j){if(j=Mt({},j||l.value),typeof U=="string"){const it=Zs(n,U,j.path),W=t.resolve({path:it.path},j),V=r.createHref(it.fullPath);return Mt(it,W,{params:d(W.params),hash:ns(it.hash),redirectedFrom:void 0,href:V})}let $;if("path"in U)$=Mt({},U,{path:Zs(n,U.path,j.path).path});else{const it=Mt({},U.params);for(const W in it)it[W]==null&&delete it[W];$=Mt({},U,{params:h(U.params)}),j.params=h(j.params)}const X=t.resolve($,j),Z=U.hash||"";X.params=u(d(X.params));const nt=Tv(i,Mt({},U,{hash:am(Z),path:X.path})),at=r.createHref(nt);return Mt({fullPath:nt,hash:Z,query:i===kl?fm(U.query):U.query||{}},X,{redirectedFrom:void 0,href:at})}function v(U){return typeof U=="string"?Zs(n,U,l.value.path):Mt({},U)}function f(U,j){if(c!==U)return Ei(8,{from:j,to:U})}function x(U){return p(U)}function S(U){return x(Mt(v(U),{replace:!0}))}function C(U){const j=U.matched[U.matched.length-1];if(j&&j.redirect){const{redirect:$}=j;let X=typeof $=="function"?$(U):$;return typeof X=="string"&&(X=X.includes("?")||X.includes("#")?X=v(X):{path:X},X.params={}),Mt({query:U.query,hash:U.hash,params:"path"in X?{}:U.params},X)}}function p(U,j){const $=c=A(U),X=l.value,Z=U.state,nt=U.force,at=U.replace===!0,it=C($);if(it)return p(Mt(v(it),{state:typeof it=="object"?Mt({},Z,it.state):Z,force:nt,replace:at}),j||$);const W=$;W.redirectedFrom=j;let V;return!nt&&_v(i,X,$)&&(V=Ei(16,{to:W,from:X}),B(X,X,!0,!1)),(V?Promise.resolve(V):m(W,X)).catch(z=>Je(z)?Je(z,2)?z:k(z):I(z,W,X)).then(z=>{if(z){if(Je(z,2))return p(Mt({replace:at},v(z.to),{state:typeof z.to=="object"?Mt({},Z,z.to.state):Z,force:nt}),j||W)}else z=b(W,X,!0,at,Z);return D(W,X,z),z})}function g(U,j){const $=f(U,j);return $?Promise.reject($):Promise.resolve()}function m(U,j){let $;const[X,Z,nt]=xm(U,j);$=Js(X.reverse(),"beforeRouteLeave",U,j);for(const it of X)it.leaveGuards.forEach(W=>{$.push(yn(W,U,j))});const at=g.bind(null,U,j);return $.push(at),ri($).then(()=>{$=[];for(const it of s.list())$.push(yn(it,U,j));return $.push(at),ri($)}).then(()=>{$=Js(Z,"beforeRouteUpdate",U,j);for(const it of Z)it.updateGuards.forEach(W=>{$.push(yn(W,U,j))});return $.push(at),ri($)}).then(()=>{$=[];for(const it of U.matched)if(it.beforeEnter&&!j.matched.includes(it))if(ke(it.beforeEnter))for(const W of it.beforeEnter)$.push(yn(W,U,j));else $.push(yn(it.beforeEnter,U,j));return $.push(at),ri($)}).then(()=>(U.matched.forEach(it=>it.enterCallbacks={}),$=Js(nt,"beforeRouteEnter",U,j),$.push(at),ri($))).then(()=>{$=[];for(const it of a.list())$.push(yn(it,U,j));return $.push(at),ri($)}).catch(it=>Je(it,8)?it:Promise.reject(it))}function D(U,j,$){for(const X of o.list())X(U,j,$)}function b(U,j,$,X,Z){const nt=f(U,j);if(nt)return nt;const at=j===gn,it=oi?history.state:{};$&&(X||at?r.replace(U.fullPath,Mt({scroll:at&&it&&it.scroll},Z)):r.push(U.fullPath,Z)),l.value=U,B(U,j,$,at),k()}let T;function P(){T||(T=r.listen((U,j,$)=>{if(!H.listening)return;const X=A(U),Z=C(X);if(Z){p(Mt(Z,{replace:!0}),X).catch(ji);return}c=X;const nt=l.value;oi&&Pv(Al(nt.fullPath,$.delta),Ss()),m(X,nt).catch(at=>Je(at,12)?at:Je(at,2)?(p(at.to,X).then(it=>{Je(it,20)&&!$.delta&&$.type===lr.pop&&r.go(-1,!1)}).catch(ji),Promise.reject()):($.delta&&r.go(-$.delta,!1),I(at,X,nt))).then(at=>{at=at||b(X,nt,!1),at&&($.delta&&!Je(at,8)?r.go(-$.delta,!1):$.type===lr.pop&&Je(at,20)&&r.go(-1,!1)),D(X,nt,at)}).catch(ji)}))}let M=Mi(),O=Mi(),R;function I(U,j,$){k(U);const X=O.list();return X.length?X.forEach(Z=>Z(U,j,$)):console.error(U),Promise.reject(U)}function w(){return R&&l.value!==gn?Promise.resolve():new Promise((U,j)=>{M.add([U,j])})}function k(U){return R||(R=!U,P(),M.list().forEach(([j,$])=>U?$(U):j()),M.reset()),U}function B(U,j,$,X){const{scrollBehavior:Z}=e;if(!oi||!Z)return Promise.resolve();const nt=!$&&Rv(Al(U.fullPath,0))||(X||!$)&&history.state&&history.state.scroll||null;return Jr().then(()=>Z(U,j,nt)).then(at=>at&&Mv(at)).catch(at=>I(at,U,j))}const F=U=>r.go(U);let N;const K=new Set,H={currentRoute:l,listening:!0,addRoute:y,removeRoute:E,hasRoute:_,getRoutes:L,resolve:A,options:e,push:x,replace:S,go:F,back:()=>F(-1),forward:()=>F(1),beforeEach:s.add,beforeResolve:a.add,afterEach:o.add,onError:O.add,isReady:w,install(U){const j=this;U.component("RouterLink",vm),U.component("RouterView",Sf),U.config.globalProperties.$router=j,Object.defineProperty(U.config.globalProperties,"$route",{enumerable:!0,get:()=>ht(l)}),oi&&!N&&l.value===gn&&(N=!0,x(r.location).catch(Z=>{}));const $={};for(const Z in gn)$[Z]=xe(()=>l.value[Z]);U.provide(Ls,j),U.provide(co,mr($)),U.provide(Aa,l);const X=U.unmount;K.add(U),U.unmount=function(){K.delete(U),K.size<1&&(c=gn,T&&T(),T=null,l.value=gn,N=!1,R=!1),X()}}};return H}function ri(e){return e.reduce((t,n)=>t.then(()=>n()),Promise.resolve())}function xm(e,t){const n=[],i=[],r=[],s=Math.max(t.matched.length,e.matched.length);for(let a=0;a<s;a++){const o=t.matched[a];o&&(e.matched.find(c=>yi(c,o))?i.push(o):n.push(o));const l=e.matched[a];l&&(t.matched.find(c=>yi(c,l))||r.push(l))}return[n,i,r]}function me(){return ze(Ls)}function pr(){return ze(co)}const bm={__name:"App",setup(e){console.log("asdf");let t=window.innerHeight*.01;return document.documentElement.style.setProperty("--vh",`${t}px`),window.addEventListener("resize",()=>{let n=window.innerHeight*.01;document.documentElement.style.setProperty("--vh",`${n}px`)}),(n,i)=>(st(),zt(ht(Sf)))}};var Tm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _m(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Lf={exports:{}};(function(e,t){typeof window<"u"&&function(i,r){e.exports=r()}(Tm,function(){return function(n){var i={};function r(s){if(i[s])return i[s].exports;var a=i[s]={i:s,l:!1,exports:{}};return n[s].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=n,r.c=i,r.d=function(s,a,o){r.o(s,a)||Object.defineProperty(s,a,{enumerable:!0,get:o})},r.r=function(s){typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(s,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(s,"__esModule",{value:!0})},r.t=function(s,a){if(a&1&&(s=r(s)),a&8||a&4&&typeof s=="object"&&s&&s.__esModule)return s;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:s}),a&2&&typeof s!="string")for(var l in s)r.d(o,l,function(c){return s[c]}.bind(null,l));return o},r.n=function(s){var a=s&&s.__esModule?function(){return s.default}:function(){return s};return r.d(a,"a",a),a},r.o=function(s,a){return Object.prototype.hasOwnProperty.call(s,a)},r.p="/dist/",r(r.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(n,i,r){var s=Object.prototype.hasOwnProperty,a="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(a=!1));function l(d,y,E){this.fn=d,this.context=y,this.once=E||!1}function c(d,y,E,L,_){if(typeof E!="function")throw new TypeError("The listener must be a function");var A=new l(E,L||d,_),v=a?a+y:y;return d._events[v]?d._events[v].fn?d._events[v]=[d._events[v],A]:d._events[v].push(A):(d._events[v]=A,d._eventsCount++),d}function u(d,y){--d._eventsCount===0?d._events=new o:delete d._events[y]}function h(){this._events=new o,this._eventsCount=0}h.prototype.eventNames=function(){var y=[],E,L;if(this._eventsCount===0)return y;for(L in E=this._events)s.call(E,L)&&y.push(a?L.slice(1):L);return Object.getOwnPropertySymbols?y.concat(Object.getOwnPropertySymbols(E)):y},h.prototype.listeners=function(y){var E=a?a+y:y,L=this._events[E];if(!L)return[];if(L.fn)return[L.fn];for(var _=0,A=L.length,v=new Array(A);_<A;_++)v[_]=L[_].fn;return v},h.prototype.listenerCount=function(y){var E=a?a+y:y,L=this._events[E];return L?L.fn?1:L.length:0},h.prototype.emit=function(y,E,L,_,A,v){var f=a?a+y:y;if(!this._events[f])return!1;var x=this._events[f],S=arguments.length,C,p;if(x.fn){switch(x.once&&this.removeListener(y,x.fn,void 0,!0),S){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,E),!0;case 3:return x.fn.call(x.context,E,L),!0;case 4:return x.fn.call(x.context,E,L,_),!0;case 5:return x.fn.call(x.context,E,L,_,A),!0;case 6:return x.fn.call(x.context,E,L,_,A,v),!0}for(p=1,C=new Array(S-1);p<S;p++)C[p-1]=arguments[p];x.fn.apply(x.context,C)}else{var g=x.length,m;for(p=0;p<g;p++)switch(x[p].once&&this.removeListener(y,x[p].fn,void 0,!0),S){case 1:x[p].fn.call(x[p].context);break;case 2:x[p].fn.call(x[p].context,E);break;case 3:x[p].fn.call(x[p].context,E,L);break;case 4:x[p].fn.call(x[p].context,E,L,_);break;default:if(!C)for(m=1,C=new Array(S-1);m<S;m++)C[m-1]=arguments[m];x[p].fn.apply(x[p].context,C)}}return!0},h.prototype.on=function(y,E,L){return c(this,y,E,L,!1)},h.prototype.once=function(y,E,L){return c(this,y,E,L,!0)},h.prototype.removeListener=function(y,E,L,_){var A=a?a+y:y;if(!this._events[A])return this;if(!E)return u(this,A),this;var v=this._events[A];if(v.fn)v.fn===E&&(!_||v.once)&&(!L||v.context===L)&&u(this,A);else{for(var f=0,x=[],S=v.length;f<S;f++)(v[f].fn!==E||_&&!v[f].once||L&&v[f].context!==L)&&x.push(v[f]);x.length?this._events[A]=x.length===1?x[0]:x:u(this,A)}return this},h.prototype.removeAllListeners=function(y){var E;return y?(E=a?a+y:y,this._events[E]&&u(this,E)):(this._events=new o,this._eventsCount=0),this},h.prototype.off=h.prototype.removeListener,h.prototype.addListener=h.prototype.on,h.prefixed=a,h.EventEmitter=h,n.exports=h},"./node_modules/url-toolkit/src/url-toolkit.js":function(n,i,r){(function(s){var a=/^(?=((?:[a-zA-Z0-9+\-.]+:)?))\1(?=((?:\/\/[^\/?#]*)?))\2(?=((?:(?:[^?#\/]*\/)*[^;?#\/]*)?))\3((?:;[^?#]*)?)(\?[^#]*)?(#[^]*)?$/,o=/^(?=([^\/?#]*))\1([^]*)$/,l=/(?:\/|^)\.(?=\/)/g,c=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,u={buildAbsoluteURL:function(h,d,y){if(y=y||{},h=h.trim(),d=d.trim(),!d){if(!y.alwaysNormalize)return h;var E=u.parseURL(h);if(!E)throw new Error("Error trying to parse base URL.");return E.path=u.normalizePath(E.path),u.buildURLFromParts(E)}var L=u.parseURL(d);if(!L)throw new Error("Error trying to parse relative URL.");if(L.scheme)return y.alwaysNormalize?(L.path=u.normalizePath(L.path),u.buildURLFromParts(L)):d;var _=u.parseURL(h);if(!_)throw new Error("Error trying to parse base URL.");if(!_.netLoc&&_.path&&_.path[0]!=="/"){var A=o.exec(_.path);_.netLoc=A[1],_.path=A[2]}_.netLoc&&!_.path&&(_.path="/");var v={scheme:_.scheme,netLoc:L.netLoc,path:null,params:L.params,query:L.query,fragment:L.fragment};if(!L.netLoc&&(v.netLoc=_.netLoc,L.path[0]!=="/"))if(!L.path)v.path=_.path,L.params||(v.params=_.params,L.query||(v.query=_.query));else{var f=_.path,x=f.substring(0,f.lastIndexOf("/")+1)+L.path;v.path=u.normalizePath(x)}return v.path===null&&(v.path=y.alwaysNormalize?u.normalizePath(L.path):L.path),u.buildURLFromParts(v)},parseURL:function(h){var d=a.exec(h);return d?{scheme:d[1]||"",netLoc:d[2]||"",path:d[3]||"",params:d[4]||"",query:d[5]||"",fragment:d[6]||""}:null},normalizePath:function(h){for(h=h.split("").reverse().join("").replace(l,"");h.length!==(h=h.replace(c,"")).length;);return h.split("").reverse().join("")},buildURLFromParts:function(h){return h.scheme+h.netLoc+h.path+h.params+h.query+h.fragment}};n.exports=u})()},"./node_modules/webworkify-webpack/index.js":function(n,i,r){function s(y){var E={};function L(A){if(E[A])return E[A].exports;var v=E[A]={i:A,l:!1,exports:{}};return y[A].call(v.exports,v,v.exports,L),v.l=!0,v.exports}L.m=y,L.c=E,L.i=function(A){return A},L.d=function(A,v,f){L.o(A,v)||Object.defineProperty(A,v,{configurable:!1,enumerable:!0,get:f})},L.r=function(A){Object.defineProperty(A,"__esModule",{value:!0})},L.n=function(A){var v=A&&A.__esModule?function(){return A.default}:function(){return A};return L.d(v,"a",v),v},L.o=function(A,v){return Object.prototype.hasOwnProperty.call(A,v)},L.p="/",L.oe=function(A){throw console.error(A),A};var _=L(L.s=ENTRY_MODULE);return _.default||_}var a="[\\.|\\-|\\+|\\w|/|@]+",o="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+a+").*?\\)";function l(y){return(y+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function c(y){return!isNaN(1*y)}function u(y,E,L){var _={};_[L]=[];var A=E.toString(),v=A.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!v)return _;for(var f=v[1],x=new RegExp("(\\\\n|\\W)"+l(f)+o,"g"),S;S=x.exec(A);)S[3]!=="dll-reference"&&_[L].push(S[3]);for(x=new RegExp("\\("+l(f)+'\\("(dll-reference\\s('+a+'))"\\)\\)'+o,"g");S=x.exec(A);)y[S[2]]||(_[L].push(S[1]),y[S[2]]=r(S[1]).m),_[S[2]]=_[S[2]]||[],_[S[2]].push(S[4]);for(var C=Object.keys(_),p=0;p<C.length;p++)for(var g=0;g<_[C[p]].length;g++)c(_[C[p]][g])&&(_[C[p]][g]=1*_[C[p]][g]);return _}function h(y){var E=Object.keys(y);return E.reduce(function(L,_){return L||y[_].length>0},!1)}function d(y,E){for(var L={main:[E]},_={main:[]},A={main:{}};h(L);)for(var v=Object.keys(L),f=0;f<v.length;f++){var x=v[f],S=L[x],C=S.pop();if(A[x]=A[x]||{},!(A[x][C]||!y[x][C])){A[x][C]=!0,_[x]=_[x]||[],_[x].push(C);for(var p=u(y,y[x][C],x),g=Object.keys(p),m=0;m<g.length;m++)L[g[m]]=L[g[m]]||[],L[g[m]]=L[g[m]].concat(p[g[m]])}}return _}n.exports=function(y,E){E=E||{};var L={main:r.m},_=E.all?{main:Object.keys(L.main)}:d(L,y),A="";Object.keys(_).filter(function(C){return C!=="main"}).forEach(function(C){for(var p=0;_[C][p];)p++;_[C].push(p),L[C][p]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",A=A+"var "+C+" = ("+s.toString().replace("ENTRY_MODULE",JSON.stringify(p))+")({"+_[C].map(function(g){return""+JSON.stringify(g)+": "+L[C][g].toString()}).join(",")+`});
`}),A=A+"new (("+s.toString().replace("ENTRY_MODULE",JSON.stringify(y))+")({"+_.main.map(function(C){return""+JSON.stringify(C)+": "+L.main[C].toString()}).join(",")+"}))(self);";var v=new window.Blob([A],{type:"text/javascript"});if(E.bare)return v;var f=window.URL||window.webkitURL||window.mozURL||window.msURL,x=f.createObjectURL(v),S=new window.Worker(x);return S.objectURL=x,S}},"./src/config.ts":function(n,i,r){r.r(i),r.d(i,"hlsDefaultConfig",function(){return m}),r.d(i,"mergeConfig",function(){return b}),r.d(i,"enableStreamingMode",function(){return T});var s=r("./src/controller/abr-controller.ts"),a=r("./src/controller/audio-stream-controller.ts"),o=r("./src/controller/audio-track-controller.ts"),l=r("./src/controller/subtitle-stream-controller.ts"),c=r("./src/controller/subtitle-track-controller.ts"),u=r("./src/controller/buffer-controller.ts"),h=r("./src/controller/timeline-controller.ts"),d=r("./src/controller/cap-level-controller.ts"),y=r("./src/controller/fps-controller.ts"),E=r("./src/controller/eme-controller.ts"),L=r("./src/controller/cmcd-controller.ts"),_=r("./src/utils/xhr-loader.ts"),A=r("./src/utils/fetch-loader.ts"),v=r("./src/utils/cues.ts"),f=r("./src/utils/mediakeys-helper.ts"),x=r("./src/utils/logger.ts");function S(){return S=Object.assign?Object.assign.bind():function(P){for(var M=1;M<arguments.length;M++){var O=arguments[M];for(var R in O)Object.prototype.hasOwnProperty.call(O,R)&&(P[R]=O[R])}return P},S.apply(this,arguments)}function C(P,M){var O=Object.keys(P);if(Object.getOwnPropertySymbols){var R=Object.getOwnPropertySymbols(P);M&&(R=R.filter(function(I){return Object.getOwnPropertyDescriptor(P,I).enumerable})),O.push.apply(O,R)}return O}function p(P){for(var M=1;M<arguments.length;M++){var O=arguments[M]!=null?arguments[M]:{};M%2?C(Object(O),!0).forEach(function(R){g(P,R,O[R])}):Object.getOwnPropertyDescriptors?Object.defineProperties(P,Object.getOwnPropertyDescriptors(O)):C(Object(O)).forEach(function(R){Object.defineProperty(P,R,Object.getOwnPropertyDescriptor(O,R))})}return P}function g(P,M,O){return M in P?Object.defineProperty(P,M,{value:O,enumerable:!0,configurable:!0,writable:!0}):P[M]=O,P}var m=p(p({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,ignoreDevicePixelRatio:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:1/0,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:1/0,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:_.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:s.default,bufferController:u.default,capLevelController:d.default,fpsController:y.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:f.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0,cmcd:void 0,enableDateRangeMetadataCues:!0,enableEmsgMetadataCues:!0,enableID3MetadataCues:!0},D()),{},{subtitleStreamController:l.SubtitleStreamController,subtitleTrackController:c.default,timelineController:h.TimelineController,audioStreamController:a.default,audioTrackController:o.default,emeController:E.default,cmcdController:L.default});function D(){return{cueHandler:v.default,enableWebVTT:!0,enableIMSC1:!0,enableCEA708Captions:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function b(P,M){if((M.liveSyncDurationCount||M.liveMaxLatencyDurationCount)&&(M.liveSyncDuration||M.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(M.liveMaxLatencyDurationCount!==void 0&&(M.liveSyncDurationCount===void 0||M.liveMaxLatencyDurationCount<=M.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(M.liveMaxLatencyDuration!==void 0&&(M.liveSyncDuration===void 0||M.liveMaxLatencyDuration<=M.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return S({},P,M)}function T(P){var M=P.loader;if(M!==A.default&&M!==_.default)x.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),P.progressive=!1;else{var O=Object(A.fetchSupported)();O&&(P.loader=A.default,P.progressive=!0,P.enableSoftwareAES=!0,x.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":function(n,i,r){r.r(i);var s=r("./src/polyfills/number.ts"),a=r("./src/utils/ewma-bandwidth-estimator.ts"),o=r("./src/events.ts"),l=r("./src/utils/buffer-helper.ts"),c=r("./src/errors.ts"),u=r("./src/types/loader.ts"),h=r("./src/utils/logger.ts");function d(L,_){for(var A=0;A<_.length;A++){var v=_[A];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(L,v.key,v)}}function y(L,_,A){return _&&d(L.prototype,_),A&&d(L,A),Object.defineProperty(L,"prototype",{writable:!1}),L}var E=function(){function L(A){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=A;var v=A.config;this.bwEstimator=new a.default(v.abrEwmaSlowVoD,v.abrEwmaFastVoD,v.abrEwmaDefaultEstimate),this.registerListeners()}var _=L.prototype;return _.registerListeners=function(){var v=this.hls;v.on(o.Events.FRAG_LOADING,this.onFragLoading,this),v.on(o.Events.FRAG_LOADED,this.onFragLoaded,this),v.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this),v.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),v.on(o.Events.ERROR,this.onError,this)},_.unregisterListeners=function(){var v=this.hls;v.off(o.Events.FRAG_LOADING,this.onFragLoading,this),v.off(o.Events.FRAG_LOADED,this.onFragLoaded,this),v.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this),v.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),v.off(o.Events.ERROR,this.onError,this)},_.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},_.onFragLoading=function(v,f){var x=f.frag;if(x.type===u.PlaylistLevelType.MAIN&&!this.timer){var S;this.fragCurrent=x,this.partCurrent=(S=f.part)!=null?S:null,this.timer=self.setInterval(this.onCheck,100)}},_.onLevelLoaded=function(v,f){var x=this.hls.config;f.details.live?this.bwEstimator.update(x.abrEwmaSlowLive,x.abrEwmaFastLive):this.bwEstimator.update(x.abrEwmaSlowVoD,x.abrEwmaFastVoD)},_._abandonRulesCheck=function(){var v=this.fragCurrent,f=this.partCurrent,x=this.hls,S=x.autoLevelEnabled,C=x.config,p=x.media;if(!(!v||!p)){var g=f?f.stats:v.stats,m=f?f.duration:v.duration;if(g.aborted){h.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!S||p.paused||!p.playbackRate||!p.readyState)){var D=performance.now()-g.loading.start,b=Math.abs(p.playbackRate);if(!(D<=500*m/b)){var T=x.levels,P=x.minAutoLevel,M=T[v.level],O=g.total||Math.max(g.loaded,Math.round(m*M.maxBitrate/8)),R=Math.max(1,g.bwEstimate?g.bwEstimate/8:g.loaded*1e3/D),I=(O-g.loaded)/R,w=p.currentTime,k=(l.BufferHelper.bufferInfo(p,w,C.maxBufferHole).end-w)/b;if(!(k>=2*m/b||I<=k)){var B=Number.POSITIVE_INFINITY,F;for(F=v.level-1;F>P;F--){var N=T[F].maxBitrate;if(B=m*N/(8*.8*R),B<k)break}if(!(B>=I)){var K=this.bwEstimator.getEstimate();h.logger.warn("Fragment "+v.sn+(f?" part "+f.index:"")+" of level "+v.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+F+`
      Current BW estimate: `+(Object(s.isFiniteNumber)(K)?(K/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+I.toFixed(3)+` s
      Estimated load time for the next fragment: `+B.toFixed(3)+` s
      Time to underbuffer: `+k.toFixed(3)+" s"),x.nextLoadLevel=F,this.bwEstimator.sample(D,g.loaded),this.clearTimer(),v.loader&&(this.fragCurrent=this.partCurrent=null,v.loader.abort()),x.trigger(o.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:v,part:f,stats:g})}}}}}},_.onFragLoaded=function(v,f){var x=f.frag,S=f.part;if(x.type===u.PlaylistLevelType.MAIN&&Object(s.isFiniteNumber)(x.sn)){var C=S?S.stats:x.stats,p=S?S.duration:x.duration;if(this.clearTimer(),this.lastLoadedFragLevel=x.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var g=this.hls.levels[x.level],m=(g.loaded?g.loaded.bytes:0)+C.loaded,D=(g.loaded?g.loaded.duration:0)+p;g.loaded={bytes:m,duration:D},g.realBitrate=Math.round(8*m/D)}if(x.bitrateTest){var b={stats:C,frag:x,part:S,id:x.type};this.onFragBuffered(o.Events.FRAG_BUFFERED,b)}}},_.onFragBuffered=function(v,f){var x=f.frag,S=f.part,C=S?S.stats:x.stats;if(!C.aborted&&!(x.type!==u.PlaylistLevelType.MAIN||x.sn==="initSegment")){var p=C.parsing.end-C.loading.start;this.bwEstimator.sample(p,C.loaded),C.bwEstimate=this.bwEstimator.getEstimate(),x.bitrateTest?this.bitrateTestDelay=p/1e3:this.bitrateTestDelay=0}},_.onError=function(v,f){switch(f.details){case c.ErrorDetails.FRAG_LOAD_ERROR:case c.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break}},_.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},_.getNextABRAutoLevel=function(){var v=this.fragCurrent,f=this.partCurrent,x=this.hls,S=x.maxAutoLevel,C=x.config,p=x.minAutoLevel,g=x.media,m=f?f.duration:v?v.duration:0,D=g?g.currentTime:0,b=g&&g.playbackRate!==0?Math.abs(g.playbackRate):1,T=this.bwEstimator?this.bwEstimator.getEstimate():C.abrEwmaDefaultEstimate,P=(l.BufferHelper.bufferInfo(g,D,C.maxBufferHole).end-D)/b,M=this.findBestLevel(T,p,S,P,C.abrBandWidthFactor,C.abrBandWidthUpFactor);if(M>=0)return M;h.logger.trace((P?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var O=m?Math.min(m,C.maxStarvationDelay):C.maxStarvationDelay,R=C.abrBandWidthFactor,I=C.abrBandWidthUpFactor;if(!P){var w=this.bitrateTestDelay;if(w){var k=m?Math.min(m,C.maxLoadingDelay):C.maxLoadingDelay;O=k-w,h.logger.trace("bitrate test took "+Math.round(1e3*w)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*O)+" ms"),R=I=1}}return M=this.findBestLevel(T,p,S,P+O,R,I),Math.max(M,0)},_.findBestLevel=function(v,f,x,S,C,p){for(var g,m=this.fragCurrent,D=this.partCurrent,b=this.lastLoadedFragLevel,T=this.hls.levels,P=T[b],M=!!(P!=null&&(g=P.details)!==null&&g!==void 0&&g.live),O=P==null?void 0:P.codecSet,R=D?D.duration:m?m.duration:0,I=x;I>=f;I--){var w=T[I];if(!(!w||O&&w.codecSet!==O)){var k=w.details,B=(D?k==null?void 0:k.partTarget:k==null?void 0:k.averagetargetduration)||R,F=void 0;I<=b?F=C*v:F=p*v;var N=T[I].maxBitrate,K=N*B/F;if(h.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+I+"/"+Math.round(F)+"/"+N+"/"+B+"/"+S+"/"+K),F>N&&(!K||M&&!this.bitrateTestDelay||K<S))return I}}return-1},y(L,[{key:"nextAutoLevel",get:function(){var v=this._nextAutoLevel,f=this.bwEstimator;if(v!==-1&&!f.canEstimate())return v;var x=this.getNextABRAutoLevel();return v!==-1&&this.hls.levels[x].loadError?v:(v!==-1&&(x=Math.min(v,x)),x)},set:function(v){this._nextAutoLevel=v}}]),L}();i.default=E},"./src/controller/audio-stream-controller.ts":function(n,i,r){r.r(i);var s=r("./src/polyfills/number.ts"),a=r("./src/controller/base-stream-controller.ts"),o=r("./src/events.ts"),l=r("./src/utils/buffer-helper.ts"),c=r("./src/controller/fragment-tracker.ts"),u=r("./src/types/level.ts"),h=r("./src/types/loader.ts"),d=r("./src/loader/fragment.ts"),y=r("./src/demux/chunk-cache.ts"),E=r("./src/demux/transmuxer-interface.ts"),L=r("./src/types/transmuxer.ts"),_=r("./src/controller/fragment-finders.ts"),A=r("./src/utils/discontinuities.ts"),v=r("./src/errors.ts");function f(){return f=Object.assign?Object.assign.bind():function(g){for(var m=1;m<arguments.length;m++){var D=arguments[m];for(var b in D)Object.prototype.hasOwnProperty.call(D,b)&&(g[b]=D[b])}return g},f.apply(this,arguments)}function x(g,m){g.prototype=Object.create(m.prototype),g.prototype.constructor=g,S(g,m)}function S(g,m){return S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(b,T){return b.__proto__=T,b},S(g,m)}var C=100,p=function(g){x(m,g);function m(b,T){var P;return P=g.call(this,b,T,"[audio-stream-controller]")||this,P.videoBuffer=null,P.videoTrackCC=-1,P.waitingVideoCC=-1,P.audioSwitch=!1,P.trackId=-1,P.waitingData=null,P.mainDetails=null,P.bufferFlushed=!1,P.cachedTrackLoadedData=null,P._registerListeners(),P}var D=m.prototype;return D.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},D._registerListeners=function(){var T=this.hls;T.on(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),T.on(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),T.on(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),T.on(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),T.on(o.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),T.on(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),T.on(o.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),T.on(o.Events.ERROR,this.onError,this),T.on(o.Events.BUFFER_RESET,this.onBufferReset,this),T.on(o.Events.BUFFER_CREATED,this.onBufferCreated,this),T.on(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),T.on(o.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),T.on(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},D._unregisterListeners=function(){var T=this.hls;T.off(o.Events.MEDIA_ATTACHED,this.onMediaAttached,this),T.off(o.Events.MEDIA_DETACHING,this.onMediaDetaching,this),T.off(o.Events.MANIFEST_LOADING,this.onManifestLoading,this),T.off(o.Events.LEVEL_LOADED,this.onLevelLoaded,this),T.off(o.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),T.off(o.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),T.off(o.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),T.off(o.Events.ERROR,this.onError,this),T.off(o.Events.BUFFER_RESET,this.onBufferReset,this),T.off(o.Events.BUFFER_CREATED,this.onBufferCreated,this),T.off(o.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),T.off(o.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),T.off(o.Events.FRAG_BUFFERED,this.onFragBuffered,this)},D.onInitPtsFound=function(T,P){var M=P.frag,O=P.id,R=P.initPTS;if(O==="main"){var I=M.cc;this.initPTS[M.cc]=R,this.log("InitPTS for cc: "+I+" found from main: "+R),this.videoTrackCC=I,this.state===a.State.WAITING_INIT_PTS&&this.tick()}},D.startLoad=function(T){if(!this.levels){this.startPosition=T,this.state=a.State.STOPPED;return}var P=this.lastCurrentTime;this.stopLoad(),this.setInterval(C),this.fragLoadError=0,P>0&&T===-1?(this.log("Override startPosition with lastCurrentTime @"+P.toFixed(3)),T=P,this.state=a.State.IDLE):(this.loadedmetadata=!1,this.state=a.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=T,this.tick()},D.doTick=function(){switch(this.state){case a.State.IDLE:this.doTickIdle();break;case a.State.WAITING_TRACK:{var T,P=this.levels,M=this.trackId,O=P==null||(T=P[M])===null||T===void 0?void 0:T.details;if(O){if(this.waitForCdnTuneIn(O))break;this.state=a.State.WAITING_INIT_PTS}break}case a.State.FRAG_LOADING_WAITING_RETRY:{var R,I=performance.now(),w=this.retryDate;(!w||I>=w||(R=this.media)!==null&&R!==void 0&&R.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.trackId),this.state=a.State.IDLE);break}case a.State.WAITING_INIT_PTS:{var k=this.waitingData;if(k){var B=k.frag,F=k.part,N=k.cache,K=k.complete;if(this.initPTS[B.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=a.State.FRAG_LOADING;var H=N.flush(),U={frag:B,part:F,payload:H,networkDetails:null};this._handleFragmentLoadProgress(U),K&&g.prototype._handleFragmentLoadComplete.call(this,U)}else if(this.videoTrackCC!==this.waitingVideoCC)this.log("Waiting fragment cc ("+B.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var j=this.getLoadPosition(),$=l.BufferHelper.bufferInfo(this.mediaBuffer,j,this.config.maxBufferHole),X=Object(_.fragmentWithinToleranceTest)($.end,this.config.maxFragLookUpTolerance,B);X<0&&(this.log("Waiting fragment cc ("+B.cc+") @ "+B.start+" cancelled because another fragment at "+$.end+" is needed"),this.clearWaitingFragment())}}else this.state=a.State.IDLE}}this.onTickEnd()},D.clearWaitingFragment=function(){var T=this.waitingData;T&&(this.fragmentTracker.removeFragment(T.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=a.State.IDLE)},D.resetLoadingState=function(){this.clearWaitingFragment(),g.prototype.resetLoadingState.call(this)},D.onTickEnd=function(){var T=this.media;if(!(!T||!T.readyState)){var P=this.mediaBuffer?this.mediaBuffer:T,M=P.buffered;!this.loadedmetadata&&M.length&&(this.loadedmetadata=!0),this.lastCurrentTime=T.currentTime}},D.doTickIdle=function(){var T,P,M=this.hls,O=this.levels,R=this.media,I=this.trackId,w=M.config;if(!(!O||!O[I])&&!(!R&&(this.startFragRequested||!w.startFragPrefetch))){var k=O[I],B=k.details;if(!B||B.live&&this.levelLastLoaded!==I||this.waitForCdnTuneIn(B)){this.state=a.State.WAITING_TRACK;return}var F=this.mediaBuffer?this.mediaBuffer:this.media;this.bufferFlushed&&F&&(this.bufferFlushed=!1,this.afterBufferFlushed(F,d.ElementaryStreamTypes.AUDIO,h.PlaylistLevelType.AUDIO));var N=this.getFwdBufferInfo(F,h.PlaylistLevelType.AUDIO);if(N!==null){var K=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,h.PlaylistLevelType.MAIN),H=N.len,U=this.getMaxBufferLength(K==null?void 0:K.len),j=this.audioSwitch;if(!(H>=U&&!j)){if(!j&&this._streamEnded(N,B)){M.trigger(o.Events.BUFFER_EOS,{type:"audio"}),this.state=a.State.ENDED;return}var $=B.fragments,X=$[0].start,Z=N.end;if(j&&R){var nt=this.getLoadPosition();Z=nt,B.PTSKnown&&nt<X&&(N.end>X||N.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),R.currentTime=X+.05)}if(!(K&&Z>K.end+B.targetduration)&&!((!K||!K.len)&&N.len)){var at=this.getNextFragment(Z,B);if(!at){this.bufferFlushed=!0;return}((T=at.decryptdata)===null||T===void 0?void 0:T.keyFormat)==="identity"&&!((P=at.decryptdata)!==null&&P!==void 0&&P.key)?this.loadKey(at,B):this.loadFragment(at,B,Z)}}}}},D.getMaxBufferLength=function(T){var P=g.prototype.getMaxBufferLength.call(this);return T?Math.max(P,T):P},D.onMediaDetaching=function(){this.videoBuffer=null,g.prototype.onMediaDetaching.call(this)},D.onAudioTracksUpdated=function(T,P){var M=P.audioTracks;this.resetTransmuxer(),this.levels=M.map(function(O){return new u.Level(O)})},D.onAudioTrackSwitching=function(T,P){var M=!!P.url;this.trackId=P.id;var O=this.fragCurrent;O!=null&&O.loader&&O.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),M?this.setInterval(C):this.resetTransmuxer(),M?(this.audioSwitch=!0,this.state=a.State.IDLE):this.state=a.State.STOPPED,this.tick()},D.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},D.onLevelLoaded=function(T,P){this.mainDetails=P.details,this.cachedTrackLoadedData!==null&&(this.hls.trigger(o.Events.AUDIO_TRACK_LOADED,this.cachedTrackLoadedData),this.cachedTrackLoadedData=null)},D.onAudioTrackLoaded=function(T,P){var M;if(this.mainDetails==null){this.cachedTrackLoadedData=P;return}var O=this.levels,R=P.details,I=P.id;if(!O){this.warn("Audio tracks were reset while loading level "+I);return}this.log("Track "+I+" loaded ["+R.startSN+","+R.endSN+"],duration:"+R.totalduration);var w=O[I],k=0;if(R.live||(M=w.details)!==null&&M!==void 0&&M.live){var B=this.mainDetails;if(R.fragments[0]||(R.deltaUpdateFailed=!0),R.deltaUpdateFailed||!B)return;!w.details&&R.hasProgramDateTime&&B.hasProgramDateTime?(Object(A.alignMediaPlaylistByPDT)(R,B),k=R.fragments[0].start):k=this.alignPlaylists(R,w.details)}w.details=R,this.levelLastLoaded=I,!this.startFragRequested&&(this.mainDetails||!R.live)&&this.setStartPosition(w.details,k),this.state===a.State.WAITING_TRACK&&!this.waitForCdnTuneIn(R)&&(this.state=a.State.IDLE),this.tick()},D._handleFragmentLoadProgress=function(T){var P,M=T.frag,O=T.part,R=T.payload,I=this.config,w=this.trackId,k=this.levels;if(!k){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+M.sn+" of level "+M.level+" will not be buffered");return}var B=k[w];console.assert(B,"Audio track is defined on fragment load progress");var F=B.details;console.assert(F,"Audio track details are defined on fragment load progress");var N=I.defaultAudioCodec||B.audioCodec||"mp4a.40.2",K=this.transmuxer;K||(K=this.transmuxer=new E.default(this.hls,h.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var H=this.initPTS[M.cc],U=(P=M.initSegment)===null||P===void 0?void 0:P.data;if(H!==void 0){var j=!1,$=O?O.index:-1,X=$!==-1,Z=new L.ChunkMetadata(M.level,M.sn,M.stats.chunkCount,R.byteLength,$,X);K.push(R,U,N,"",M,O,F.totalduration,j,Z,H)}else{this.log("Unknown video PTS for cc "+M.cc+", waiting for video PTS before demuxing audio frag "+M.sn+" of ["+F.startSN+" ,"+F.endSN+"],track "+w);var nt=this.waitingData=this.waitingData||{frag:M,part:O,cache:new y.default,complete:!1},at=nt.cache;at.push(new Uint8Array(R)),this.waitingVideoCC=this.videoTrackCC,this.state=a.State.WAITING_INIT_PTS}},D._handleFragmentLoadComplete=function(T){if(this.waitingData){this.waitingData.complete=!0;return}g.prototype._handleFragmentLoadComplete.call(this,T)},D.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},D.onBufferCreated=function(T,P){var M=P.tracks.audio;M&&(this.mediaBuffer=M.buffer||null),P.tracks.video&&(this.videoBuffer=P.tracks.video.buffer||null)},D.onFragBuffered=function(T,P){var M=P.frag,O=P.part;if(M.type===h.PlaylistLevelType.AUDIO){if(this.fragContextChanged(M)){this.warn("Fragment "+M.sn+(O?" p: "+O.index:"")+" of level "+M.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}M.sn!=="initSegment"&&(this.fragPrevious=M,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(o.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(M,O)}},D.onError=function(T,P){switch(P.details){case v.ErrorDetails.FRAG_LOAD_ERROR:case v.ErrorDetails.FRAG_LOAD_TIMEOUT:case v.ErrorDetails.KEY_LOAD_ERROR:case v.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(h.PlaylistLevelType.AUDIO,P);break;case v.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case v.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==a.State.ERROR&&this.state!==a.State.STOPPED&&(this.state=P.fatal?a.State.ERROR:a.State.IDLE,this.warn(P.details+" while loading frag, switching to "+this.state+" state"));break;case v.ErrorDetails.BUFFER_FULL_ERROR:if(P.parent==="audio"&&(this.state===a.State.PARSING||this.state===a.State.PARSED)){var M=!0,O=this.getFwdBufferInfo(this.mediaBuffer,h.PlaylistLevelType.AUDIO);O&&O.len>.5&&(M=!this.reduceMaxBufferLength(O.len)),M&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,g.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break}},D.onBufferFlushed=function(T,P){var M=P.type;M===d.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},D._handleTransmuxComplete=function(T){var P,M="audio",O=this.hls,R=T.remuxResult,I=T.chunkMeta,w=this.getCurrentContext(I);if(!w){this.warn("The loading context changed while buffering fragment "+I.sn+" of level "+I.level+". This chunk will not be buffered."),this.resetStartWhenNotLoaded(I.level);return}var k=w.frag,B=w.part,F=w.level.details,N=R.audio,K=R.text,H=R.id3,U=R.initSegment;if(!(this.fragContextChanged(k)||!F)){if(this.state=a.State.PARSING,this.audioSwitch&&N&&this.completeAudioSwitch(),U!=null&&U.tracks&&(this._bufferInitSegment(U.tracks,k,I),O.trigger(o.Events.FRAG_PARSING_INIT_SEGMENT,{frag:k,id:M,tracks:U.tracks})),N){var j=N.startPTS,$=N.endPTS,X=N.startDTS,Z=N.endDTS;B&&(B.elementaryStreams[d.ElementaryStreamTypes.AUDIO]={startPTS:j,endPTS:$,startDTS:X,endDTS:Z}),k.setElementaryStreamInfo(d.ElementaryStreamTypes.AUDIO,j,$,X,Z),this.bufferFragmentData(N,k,B,I)}if(H!=null&&(P=H.samples)!==null&&P!==void 0&&P.length){var nt=f({id:M,frag:k,details:F},H);O.trigger(o.Events.FRAG_PARSING_METADATA,nt)}if(K){var at=f({id:M,frag:k,details:F},K);O.trigger(o.Events.FRAG_PARSING_USERDATA,at)}}},D._bufferInitSegment=function(T,P,M){if(this.state===a.State.PARSING){T.video&&delete T.video;var O=T.audio;if(!!O){O.levelCodec=O.codec,O.id="audio",this.log("Init audio buffer, container:"+O.container+", codecs[parsed]=["+O.codec+"]"),this.hls.trigger(o.Events.BUFFER_CODECS,T);var R=O.initSegment;if(R!=null&&R.byteLength){var I={type:"audio",frag:P,part:null,chunkMeta:M,parent:P.type,data:R};this.hls.trigger(o.Events.BUFFER_APPENDING,I)}this.tick()}}},D.loadFragment=function(T,P,M){var O=this.fragmentTracker.getState(T);this.fragCurrent=T,(this.audioSwitch||O===c.FragmentState.NOT_LOADED||O===c.FragmentState.PARTIAL)&&(T.sn==="initSegment"?this._loadInitSegment(T):P.live&&!Object(s.isFiniteNumber)(this.initPTS[T.cc])?(this.log("Waiting for video PTS in continuity counter "+T.cc+" of live stream before loading audio fragment "+T.sn+" of level "+this.trackId),this.state=a.State.WAITING_INIT_PTS):(this.startFragRequested=!0,g.prototype.loadFragment.call(this,T,P,M)))},D.completeAudioSwitch=function(){var T=this.hls,P=this.media,M=this.trackId;P&&(this.log("Switching audio track : flushing all audio"),g.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,T.trigger(o.Events.AUDIO_TRACK_SWITCHED,{id:M})},m}(a.default);i.default=p},"./src/controller/audio-track-controller.ts":function(n,i,r){r.r(i);var s=r("./src/events.ts"),a=r("./src/errors.ts"),o=r("./src/controller/base-playlist-controller.ts"),l=r("./src/types/loader.ts");function c(E,L){for(var _=0;_<L.length;_++){var A=L[_];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(E,A.key,A)}}function u(E,L,_){return L&&c(E.prototype,L),_&&c(E,_),Object.defineProperty(E,"prototype",{writable:!1}),E}function h(E,L){E.prototype=Object.create(L.prototype),E.prototype.constructor=E,d(E,L)}function d(E,L){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(A,v){return A.__proto__=v,A},d(E,L)}var y=function(E){h(L,E);function L(A){var v;return v=E.call(this,A,"[audio-track-controller]")||this,v.tracks=[],v.groupId=null,v.tracksInGroup=[],v.trackId=-1,v.trackName="",v.selectDefaultTrack=!0,v.registerListeners(),v}var _=L.prototype;return _.registerListeners=function(){var v=this.hls;v.on(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),v.on(s.Events.MANIFEST_PARSED,this.onManifestParsed,this),v.on(s.Events.LEVEL_LOADING,this.onLevelLoading,this),v.on(s.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),v.on(s.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),v.on(s.Events.ERROR,this.onError,this)},_.unregisterListeners=function(){var v=this.hls;v.off(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),v.off(s.Events.MANIFEST_PARSED,this.onManifestParsed,this),v.off(s.Events.LEVEL_LOADING,this.onLevelLoading,this),v.off(s.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),v.off(s.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),v.off(s.Events.ERROR,this.onError,this)},_.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,E.prototype.destroy.call(this)},_.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},_.onManifestParsed=function(v,f){this.tracks=f.audioTracks||[]},_.onAudioTrackLoaded=function(v,f){var x=f.id,S=f.details,C=this.tracksInGroup[x];if(!C){this.warn("Invalid audio track id "+x);return}var p=C.details;C.details=f.details,this.log("audioTrack "+x+" loaded ["+S.startSN+"-"+S.endSN+"]"),x===this.trackId&&(this.retryCount=0,this.playlistLoaded(x,f,p))},_.onLevelLoading=function(v,f){this.switchLevel(f.level)},_.onLevelSwitching=function(v,f){this.switchLevel(f.level)},_.switchLevel=function(v){var f=this.hls.levels[v];if(!!(f!=null&&f.audioGroupIds)){var x=f.audioGroupIds[f.urlId];if(this.groupId!==x){this.groupId=x;var S=this.tracks.filter(function(p){return!x||p.groupId===x});this.selectDefaultTrack&&!S.some(function(p){return p.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=S;var C={audioTracks:S};this.log("Updating audio tracks, "+S.length+' track(s) found in "'+x+'" group-id'),this.hls.trigger(s.Events.AUDIO_TRACKS_UPDATED,C),this.selectInitialTrack()}}},_.onError=function(v,f){E.prototype.onError.call(this,v,f),!(f.fatal||!f.context)&&f.context.type===l.PlaylistContextType.AUDIO_TRACK&&f.context.id===this.trackId&&f.context.groupId===this.groupId&&this.retryLoadingOrFail(f)},_.setAudioTrack=function(v){var f=this.tracksInGroup;if(v<0||v>=f.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var x=f[this.trackId];this.log("Now switching to audio-track index "+v);var S=f[v],C=S.id,p=S.groupId,g=p===void 0?"":p,m=S.name,D=S.type,b=S.url;if(this.trackId=v,this.trackName=m,this.selectDefaultTrack=!1,this.hls.trigger(s.Events.AUDIO_TRACK_SWITCHING,{id:C,groupId:g,name:m,type:D,url:b}),!(S.details&&!S.details.live)){var T=this.switchParams(S.url,x==null?void 0:x.details);this.loadPlaylist(T)}},_.selectInitialTrack=function(){var v=this.tracksInGroup;console.assert(v.length,"Initial audio track should be selected when tracks are known");var f=this.trackName,x=this.findTrackId(f)||this.findTrackId();x!==-1?this.setAudioTrack(x):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},_.findTrackId=function(v){for(var f=this.tracksInGroup,x=0;x<f.length;x++){var S=f[x];if((!this.selectDefaultTrack||S.default)&&(!v||v===S.name))return S.id}return-1},_.loadPlaylist=function(v){var f=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(f)){var x=f.id,S=f.groupId,C=f.url;if(v)try{C=v.addDirectives(C)}catch(p){this.warn("Could not construct new URL with HLS Delivery Directives: "+p)}this.log("loading audio-track playlist for id: "+x),this.clearTimer(),this.hls.trigger(s.Events.AUDIO_TRACK_LOADING,{url:C,id:x,groupId:S,deliveryDirectives:v||null})}},u(L,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(v){this.selectDefaultTrack=!1,this.setAudioTrack(v)}}]),L}(o.default);i.default=y},"./src/controller/base-playlist-controller.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return u});var s=r("./src/polyfills/number.ts"),a=r("./src/types/level.ts"),o=r("./src/controller/level-helper.ts"),l=r("./src/utils/logger.ts"),c=r("./src/errors.ts"),u=function(){function h(y,E){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=l.logger.log.bind(l.logger,E+":"),this.warn=l.logger.warn.bind(l.logger,E+":"),this.hls=y}var d=h.prototype;return d.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},d.onError=function(E,L){L.fatal&&L.type===c.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},d.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},d.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},d.stopLoad=function(){this.canLoad=!1,this.clearTimer()},d.switchParams=function(E,L){var _=L==null?void 0:L.renditionReports;if(_)for(var A=0;A<_.length;A++){var v=_[A],f=""+v.URI;if(f===E.slice(-f.length)){var x=parseInt(v["LAST-MSN"]),S=parseInt(v["LAST-PART"]);if(L&&this.hls.config.lowLatencyMode){var C=Math.min(L.age-L.partTarget,L.targetduration);S!==void 0&&C>L.partTarget&&(S+=1)}if(Object(s.isFiniteNumber)(x))return new a.HlsUrlParameters(x,Object(s.isFiniteNumber)(S)?S:void 0,a.HlsSkip.No)}}},d.loadPlaylist=function(E){},d.shouldLoadTrack=function(E){return this.canLoad&&E&&!!E.url&&(!E.details||E.details.live)},d.playlistLoaded=function(E,L,_){var A=this,v=L.details,f=L.stats,x=f.loading.end?Math.max(0,self.performance.now()-f.loading.end):0;if(v.advancedDateTime=Date.now()-x,v.live||_!=null&&_.live){if(v.reloaded(_),_&&this.log("live playlist "+E+" "+(v.advanced?"REFRESHED "+v.lastPartSn+"-"+v.lastPartIndex:"MISSED")),_&&v.fragments.length>0&&Object(o.mergeDetails)(_,v),!this.canLoad||!v.live)return;var S,C=void 0,p=void 0;if(v.canBlockReload&&v.endSN&&v.advanced){var g=this.hls.config.lowLatencyMode,m=v.lastPartSn,D=v.endSN,b=v.lastPartIndex,T=b!==-1,P=m===D,M=g?0:b;T?(C=P?D+1:m,p=P?M:b+1):C=D+1;var O=v.age,R=O+v.ageHeader,I=Math.min(R-v.partTarget,v.targetduration*1.5);if(I>0){if(_&&I>_.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+_.tuneInGoal+" to: "+I+" with playlist age: "+v.age),I=0;else{var w=Math.floor(I/v.targetduration);if(C+=w,p!==void 0){var k=Math.round(I%v.targetduration/v.partTarget);p+=k}this.log("CDN Tune-in age: "+v.ageHeader+"s last advanced "+O.toFixed(2)+"s goal: "+I+" skip sn "+w+" to part "+p)}v.tuneInGoal=I}if(S=this.getDeliveryDirectives(v,L.deliveryDirectives,C,p),g||!P){this.loadPlaylist(S);return}}else S=this.getDeliveryDirectives(v,L.deliveryDirectives,C,p);var B=Object(o.computeReloadInterval)(v,f);C!==void 0&&v.canBlockReload&&(B-=v.partTarget||1),this.log("reload live playlist "+E+" in "+Math.round(B)+" ms"),this.timer=self.setTimeout(function(){return A.loadPlaylist(S)},B)}else this.clearTimer()},d.getDeliveryDirectives=function(E,L,_,A){var v=Object(a.getSkipValue)(E,_);return L!=null&&L.skip&&E.deltaUpdateFailed&&(_=L.msn,A=L.part,v=a.HlsSkip.No),new a.HlsUrlParameters(_,A,v)},d.retryLoadingOrFail=function(E){var L=this,_=this.hls.config,A=this.retryCount<_.levelLoadingMaxRetry;if(A){var v;if(this.retryCount++,E.details.indexOf("LoadTimeOut")>-1&&(v=E.context)!==null&&v!==void 0&&v.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+E.details+'"'),this.loadPlaylist();else{var f=Math.min(Math.pow(2,this.retryCount)*_.levelLoadingRetryDelay,_.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return L.loadPlaylist()},f),this.warn("retry playlist loading #"+this.retryCount+" in "+f+' ms after "'+E.details+'"')}}else this.warn('cannot recover from error "'+E.details+'"'),this.clearTimer(),E.fatal=!0;return A},h}()},"./src/controller/base-stream-controller.ts":function(n,i,r){r.r(i),r.d(i,"State",function(){return D}),r.d(i,"default",function(){return b});var s=r("./src/polyfills/number.ts"),a=r("./src/task-loop.ts"),o=r("./src/controller/fragment-tracker.ts"),l=r("./src/utils/buffer-helper.ts"),c=r("./src/utils/logger.ts"),u=r("./src/events.ts"),h=r("./src/errors.ts"),d=r("./src/types/transmuxer.ts"),y=r("./src/utils/mp4-tools.ts"),E=r("./src/utils/discontinuities.ts"),L=r("./src/controller/fragment-finders.ts"),_=r("./src/controller/level-helper.ts"),A=r("./src/loader/fragment-loader.ts"),v=r("./src/crypt/decrypter.ts"),f=r("./src/utils/time-ranges.ts"),x=r("./src/types/loader.ts");function S(T,P){for(var M=0;M<P.length;M++){var O=P[M];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(T,O.key,O)}}function C(T,P,M){return P&&S(T.prototype,P),M&&S(T,M),Object.defineProperty(T,"prototype",{writable:!1}),T}function p(T){if(T===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T}function g(T,P){T.prototype=Object.create(P.prototype),T.prototype.constructor=T,m(T,P)}function m(T,P){return m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(O,R){return O.__proto__=R,O},m(T,P)}var D={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},b=function(T){g(P,T);function P(O,R,I){var w;return w=T.call(this)||this,w.hls=void 0,w.fragPrevious=null,w.fragCurrent=null,w.fragmentTracker=void 0,w.transmuxer=null,w._state=D.STOPPED,w.media=null,w.mediaBuffer=null,w.config=void 0,w.bitrateTest=!1,w.lastCurrentTime=0,w.nextLoadPosition=0,w.startPosition=0,w.loadedmetadata=!1,w.fragLoadError=0,w.retryDate=0,w.levels=null,w.fragmentLoader=void 0,w.levelLastLoaded=null,w.startFragRequested=!1,w.decrypter=void 0,w.initPTS=[],w.onvseeking=null,w.onvended=null,w.logPrefix="",w.log=void 0,w.warn=void 0,w.logPrefix=I,w.log=c.logger.log.bind(c.logger,I+":"),w.warn=c.logger.warn.bind(c.logger,I+":"),w.hls=O,w.fragmentLoader=new A.default(O.config),w.fragmentTracker=R,w.config=O.config,w.decrypter=new v.default(O,O.config),O.on(u.Events.KEY_LOADED,w.onKeyLoaded,p(w)),O.on(u.Events.LEVEL_SWITCHING,w.onLevelSwitching,p(w)),w}var M=P.prototype;return M.doTick=function(){this.onTickEnd()},M.onTickEnd=function(){},M.startLoad=function(R){},M.stopLoad=function(){this.fragmentLoader.abort();var R=this.fragCurrent;R&&this.fragmentTracker.removeFragment(R),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=D.STOPPED},M._streamEnded=function(R,I){var w=this.fragCurrent,k=this.fragmentTracker;if(!I.live&&w&&this.media&&w.sn>=I.endSN&&!R.nextStart){var B=I.partList;if(B!=null&&B.length){var F=B[B.length-1],N=l.BufferHelper.isBuffered(this.media,F.start+F.duration/2);return N}var K=k.getState(w);return K===o.FragmentState.PARTIAL||K===o.FragmentState.OK}return!1},M.onMediaAttached=function(R,I){var w=this.media=this.mediaBuffer=I.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),w.addEventListener("seeking",this.onvseeking),w.addEventListener("ended",this.onvended);var k=this.config;this.levels&&k.autoStartLoad&&this.state===D.STOPPED&&this.startLoad(k.startPosition)},M.onMediaDetaching=function(){var R=this.media;R!=null&&R.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),R&&this.onvseeking&&this.onvended&&(R.removeEventListener("seeking",this.onvseeking),R.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},M.onMediaSeeking=function(){var R=this.config,I=this.fragCurrent,w=this.media,k=this.mediaBuffer,B=this.state,F=w?w.currentTime:0,N=l.BufferHelper.bufferInfo(k||w,F,R.maxBufferHole);if(this.log("media seeking to "+(Object(s.isFiniteNumber)(F)?F.toFixed(3):F)+", state: "+B),B===D.ENDED)this.resetLoadingState();else if(I&&!N.len){var K=R.maxFragLookUpTolerance,H=I.start-K,U=I.start+I.duration+K,j=F>U;(F<H||j)&&(j&&I.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),I.loader.abort()),this.resetLoadingState())}w&&(this.lastCurrentTime=F),!this.loadedmetadata&&!N.len&&(this.nextLoadPosition=this.startPosition=F),this.tickImmediate()},M.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},M.onKeyLoaded=function(R,I){if(!(this.state!==D.KEY_LOADING||I.frag!==this.fragCurrent||!this.levels)){this.state=D.IDLE;var w=this.levels[I.frag.level].details;w&&this.loadFragment(I.frag,w,I.frag.start)}},M.onLevelSwitching=function(R,I){this.fragLoadError=0},M.onHandlerDestroying=function(){this.stopLoad(),T.prototype.onHandlerDestroying.call(this)},M.onHandlerDestroyed=function(){this.state=D.STOPPED,this.hls.off(u.Events.KEY_LOADED,this.onKeyLoaded,this),this.hls.off(u.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,T.prototype.onHandlerDestroyed.call(this)},M.loadKey=function(R,I){this.log("Loading key for "+R.sn+" of ["+I.startSN+"-"+I.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+R.level),this.state=D.KEY_LOADING,this.fragCurrent=R,this.hls.trigger(u.Events.KEY_LOADING,{frag:R})},M.loadFragment=function(R,I,w){this._loadFragForPlayback(R,I,w)},M._loadFragForPlayback=function(R,I,w){var k=this,B=function(N){if(k.fragContextChanged(R)){k.warn("Fragment "+R.sn+(N.part?" p: "+N.part.index:"")+" of level "+R.level+" was dropped during download."),k.fragmentTracker.removeFragment(R);return}R.stats.chunkCount++,k._handleFragmentLoadProgress(N)};this._doFragLoad(R,I,w,B).then(function(F){if(!!F){k.fragLoadError=0;var N=k.state;if(k.fragContextChanged(R)){(N===D.FRAG_LOADING||!k.fragCurrent&&N===D.PARSING)&&(k.fragmentTracker.removeFragment(R),k.state=D.IDLE);return}"payload"in F&&(k.log("Loaded fragment "+R.sn+" of level "+R.level),k.hls.trigger(u.Events.FRAG_LOADED,F)),k._handleFragmentLoadComplete(F)}}).catch(function(F){k.state===D.STOPPED||k.state===D.ERROR||(k.warn(F),k.resetFragmentLoading(R))})},M.flushMainBuffer=function(R,I,w){if(w===void 0&&(w=null),!!(R-I)){var k={startOffset:R,endOffset:I,type:w};this.fragLoadError=0,this.hls.trigger(u.Events.BUFFER_FLUSHING,k)}},M._loadInitSegment=function(R){var I=this;this._doFragLoad(R).then(function(w){if(!w||I.fragContextChanged(R)||!I.levels)throw new Error("init load aborted");return w}).then(function(w){var k=I.hls,B=w.payload,F=R.decryptdata;if(B&&B.byteLength>0&&F&&F.key&&F.iv&&F.method==="AES-128"){var N=self.performance.now();return I.decrypter.webCryptoDecrypt(new Uint8Array(B),F.key.buffer,F.iv.buffer).then(function(K){var H=self.performance.now();return k.trigger(u.Events.FRAG_DECRYPTED,{frag:R,payload:K,stats:{tstart:N,tdecrypt:H}}),w.payload=K,w})}return w}).then(function(w){var k=I.fragCurrent,B=I.hls,F=I.levels;if(!F)throw new Error("init load aborted, missing levels");var N=F[R.level].details;console.assert(N,"Level details are defined when init segment is loaded");var K=R.stats;I.state=D.IDLE,I.fragLoadError=0,R.data=new Uint8Array(w.payload),K.parsing.start=K.buffering.start=self.performance.now(),K.parsing.end=K.buffering.end=self.performance.now(),w.frag===k&&B.trigger(u.Events.FRAG_BUFFERED,{stats:K,frag:k,part:null,id:R.type}),I.tick()}).catch(function(w){I.state===D.STOPPED||I.state===D.ERROR||(I.warn(w),I.resetFragmentLoading(R))})},M.fragContextChanged=function(R){var I=this.fragCurrent;return!R||!I||R.level!==I.level||R.sn!==I.sn||R.urlId!==I.urlId},M.fragBufferedComplete=function(R,I){var w=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+R.type+" sn: "+R.sn+(I?" part: "+I.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+R.level+" "+(w?f.default.toString(l.BufferHelper.getBuffered(w)):"(detached)")),this.state=D.IDLE,w&&(!this.loadedmetadata&&w.buffered.length&&this.fragCurrent===this.fragPrevious&&(this.loadedmetadata=!0,this.seekToStartPos()),this.tick())},M.seekToStartPos=function(){},M._handleFragmentLoadComplete=function(R){var I=this.transmuxer;if(!!I){var w=R.frag,k=R.part,B=R.partsLoaded,F=!B||B.length===0||B.some(function(K){return!K}),N=new d.ChunkMetadata(w.level,w.sn,w.stats.chunkCount+1,0,k?k.index:-1,!F);I.flush(N)}},M._handleFragmentLoadProgress=function(R){},M._doFragLoad=function(R,I,w,k){var B=this;if(w===void 0&&(w=null),!this.levels)throw new Error("frag load aborted, missing levels");if(w=Math.max(R.start,w||0),this.config.lowLatencyMode&&I){var F=I.partList;if(F&&k){w>R.end&&I.fragmentHint&&(R=I.fragmentHint);var N=this.getNextPart(F,R,w);if(N>-1){var K=F[N];return this.log("Loading part sn: "+R.sn+" p: "+K.index+" cc: "+R.cc+" of playlist ["+I.startSN+"-"+I.endSN+"] parts [0-"+N+"-"+(F.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+R.level+", target: "+parseFloat(w.toFixed(3))),this.nextLoadPosition=K.start+K.duration,this.state=D.FRAG_LOADING,this.hls.trigger(u.Events.FRAG_LOADING,{frag:R,part:F[N],targetBufferTime:w}),this.doFragPartsLoad(R,F,N,k).catch(function(H){return B.handleFragLoadError(H)})}else if(!R.url||this.loadedEndOfParts(F,w))return Promise.resolve(null)}}return this.log("Loading fragment "+R.sn+" cc: "+R.cc+" "+(I?"of ["+I.startSN+"-"+I.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+R.level+", target: "+parseFloat(w.toFixed(3))),Object(s.isFiniteNumber)(R.sn)&&!this.bitrateTest&&(this.nextLoadPosition=R.start+R.duration),this.state=D.FRAG_LOADING,this.hls.trigger(u.Events.FRAG_LOADING,{frag:R,targetBufferTime:w}),this.fragmentLoader.load(R,k).catch(function(H){return B.handleFragLoadError(H)})},M.doFragPartsLoad=function(R,I,w,k){var B=this;return new Promise(function(F,N){var K=[],H=function U(j){var $=I[j];B.fragmentLoader.loadPart(R,$,k).then(function(X){K[$.index]=X;var Z=X.part;B.hls.trigger(u.Events.FRAG_LOADED,X);var nt=I[j+1];if(nt&&nt.fragment===R)U(j+1);else return F({frag:R,part:Z,partsLoaded:K})}).catch(N)};H(w)})},M.handleFragLoadError=function(R){var I=R.data;return I&&I.details===h.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(I.frag,I.part):this.hls.trigger(u.Events.ERROR,I),null},M._handleTransmuxerFlush=function(R){var I=this.getCurrentContext(R);if(!I||this.state!==D.PARSING){this.fragCurrent||(this.state=D.IDLE);return}var w=I.frag,k=I.part,B=I.level,F=self.performance.now();w.stats.parsing.end=F,k&&(k.stats.parsing.end=F),this.updateLevelTiming(w,k,B,R.partial)},M.getCurrentContext=function(R){var I=this.levels,w=R.level,k=R.sn,B=R.part;if(!I||!I[w])return this.warn("Levels object was unset while buffering fragment "+k+" of level "+w+". The current chunk will not be buffered."),null;var F=I[w],N=B>-1?Object(_.getPartWith)(F,k,B):null,K=N?N.fragment:Object(_.getFragmentWithSN)(F,k,this.fragCurrent);return K?{frag:K,part:N,level:F}:null},M.bufferFragmentData=function(R,I,w,k){if(!(!R||this.state!==D.PARSING)){var B=R.data1,F=R.data2,N=B;if(B&&F&&(N=Object(y.appendUint8Array)(B,F)),!(!N||!N.length)){var K={type:R.type,frag:I,part:w,chunkMeta:k,parent:I.type,data:N};this.hls.trigger(u.Events.BUFFER_APPENDING,K),R.dropped&&R.independent&&!w&&this.flushBufferGap(I)}}},M.flushBufferGap=function(R){var I=this.media;if(!!I){if(!l.BufferHelper.isBuffered(I,I.currentTime)){this.flushMainBuffer(0,R.start);return}var w=I.currentTime,k=l.BufferHelper.bufferInfo(I,w,0),B=R.duration,F=Math.min(this.config.maxFragLookUpTolerance*2,B*.25),N=Math.max(Math.min(R.start-F,k.end-F),w+F);R.start-N>F&&this.flushMainBuffer(N,R.start)}},M.getFwdBufferInfo=function(R,I){var w=this.config,k=this.getLoadPosition();if(!Object(s.isFiniteNumber)(k))return null;var B=l.BufferHelper.bufferInfo(R,k,w.maxBufferHole);if(B.len===0&&B.nextStart!==void 0){var F=this.fragmentTracker.getBufferedFrag(k,I);if(F&&B.nextStart<F.end)return l.BufferHelper.bufferInfo(R,k,Math.max(B.nextStart,w.maxBufferHole))}return B},M.getMaxBufferLength=function(R){var I=this.config,w;return R?w=Math.max(8*I.maxBufferSize/R,I.maxBufferLength):w=I.maxBufferLength,Math.min(w,I.maxMaxBufferLength)},M.reduceMaxBufferLength=function(R){var I=this.config,w=R||I.maxBufferLength;return I.maxMaxBufferLength>=w?(I.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+I.maxMaxBufferLength+"s"),!0):!1},M.getNextFragment=function(R,I){var w=I.fragments,k=w.length;if(!k)return null;var B=this.config,F=w[0].start,N;if(I.live){var K=B.initialLiveManifestSize;if(k<K)return this.warn("Not enough fragments to start playback (have: "+k+", need: "+K+")"),null;!I.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(N=this.getInitialLiveFragment(I,w),this.startPosition=N?this.hls.liveSyncPosition||N.start:R)}else R<=F&&(N=w[0]);if(!N){var H=B.lowLatencyMode?I.partEnd:I.fragmentEnd;N=this.getFragmentAtPosition(R,H,I)}return this.mapToInitFragWhenRequired(N)},M.mapToInitFragWhenRequired=function(R){return R!=null&&R.initSegment&&!(R!=null&&R.initSegment.data)&&!this.bitrateTest?R.initSegment:R},M.getNextPart=function(R,I,w){for(var k=-1,B=!1,F=!0,N=0,K=R.length;N<K;N++){var H=R[N];if(F=F&&!H.independent,k>-1&&w<H.start)break;var U=H.loaded;!U&&(B||H.independent||F)&&H.fragment===I&&(k=N),B=U}return k},M.loadedEndOfParts=function(R,I){var w=R[R.length-1];return w&&I>w.start&&w.loaded},M.getInitialLiveFragment=function(R,I){var w=this.fragPrevious,k=null;if(w){if(R.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+w.programDateTime),k=Object(L.findFragmentByPDT)(I,w.endProgramDateTime,this.config.maxFragLookUpTolerance)),!k){var B=w.sn+1;if(B>=R.startSN&&B<=R.endSN){var F=I[B-R.startSN];w.cc===F.cc&&(k=F,this.log("Live playlist, switching playlist, load frag with next SN: "+k.sn))}k||(k=Object(L.findFragWithCC)(I,w.cc),k&&this.log("Live playlist, switching playlist, load frag with same CC: "+k.sn))}}else{var N=this.hls.liveSyncPosition;N!==null&&(k=this.getFragmentAtPosition(N,this.bitrateTest?R.fragmentEnd:R.edge,R))}return k},M.getFragmentAtPosition=function(R,I,w){var k=this.config,B=this.fragPrevious,F=w.fragments,N=w.endSN,K=w.fragmentHint,H=k.maxFragLookUpTolerance,U=!!(k.lowLatencyMode&&w.partList&&K);U&&K&&!this.bitrateTest&&(F=F.concat(K),N=K.sn);var j;if(R<I){var $=R>I-H?0:H;j=Object(L.findFragmentByPTS)(B,F,R,$)}else j=F[F.length-1];if(j){var X=j.sn-w.startSN;if(B&&j.sn===B.sn&&!U){var Z=B&&j.level===B.level;if(Z){var nt=F[X+1];j.sn<N&&this.fragmentTracker.getState(nt)!==o.FragmentState.OK?(this.log("SN "+j.sn+" just loaded, load next one: "+nt.sn),j=nt):j=null}}}return j},M.synchronizeToLiveEdge=function(R){var I=this.config,w=this.media;if(!!w){var k=this.hls.liveSyncPosition,B=w.currentTime,F=R.fragments[0].start,N=R.edge,K=B>=F-I.maxFragLookUpTolerance&&B<=N;if(k!==null&&w.duration>k&&(B<k||!K)){var H=I.liveMaxLatencyDuration!==void 0?I.liveMaxLatencyDuration:I.liveMaxLatencyDurationCount*R.targetduration;(!K&&w.readyState<4||B<N-H)&&(this.loadedmetadata||(this.nextLoadPosition=k),w.readyState&&(this.warn("Playback: "+B.toFixed(3)+" is located too far from the end of live sliding playlist: "+N+", reset currentTime to : "+k.toFixed(3)),w.currentTime=k))}}},M.alignPlaylists=function(R,I){var w=this.levels,k=this.levelLastLoaded,B=this.fragPrevious,F=k!==null?w[k]:null,N=R.fragments.length;if(!N)return this.warn("No fragments in live playlist"),0;var K=R.fragments[0].start,H=!I,U=R.alignedSliding&&Object(s.isFiniteNumber)(K);if(H||!U&&!K){Object(E.alignStream)(B,F,R);var j=R.fragments[0].start;return this.log("Live playlist sliding: "+j.toFixed(2)+" start-sn: "+(I?I.startSN:"na")+"->"+R.startSN+" prev-sn: "+(B?B.sn:"na")+" fragments: "+N),j}return K},M.waitForCdnTuneIn=function(R){var I=3;return R.live&&R.canBlockReload&&R.partTarget&&R.tuneInGoal>Math.max(R.partHoldBack,R.partTarget*I)},M.setStartPosition=function(R,I){var w=this.startPosition;if(w<I&&(w=-1),w===-1||this.lastCurrentTime===-1){var k=R.startTimeOffset;Object(s.isFiniteNumber)(k)?(w=I+k,k<0&&(w+=R.totalduration),w=Math.min(Math.max(I,w),I+R.totalduration),this.log("Start time offset "+k+" found in playlist, adjust startPosition to "+w),this.startPosition=w):R.live?w=this.hls.liveSyncPosition||I:this.startPosition=w=0,this.lastCurrentTime=w}this.nextLoadPosition=w},M.getLoadPosition=function(){var R=this.media,I=0;return this.loadedmetadata&&R?I=R.currentTime:this.nextLoadPosition&&(I=this.nextLoadPosition),I},M.handleFragLoadAborted=function(R,I){this.transmuxer&&R.sn!=="initSegment"&&R.stats.aborted&&(this.warn("Fragment "+R.sn+(I?" part"+I.index:"")+" of level "+R.level+" was aborted"),this.resetFragmentLoading(R))},M.resetFragmentLoading=function(R){(!this.fragCurrent||!this.fragContextChanged(R)&&this.state!==D.FRAG_LOADING_WAITING_RETRY)&&(this.state=D.IDLE)},M.onFragmentOrKeyLoadError=function(R,I){if(!I.fatal){var w=I.frag;if(!(!w||w.type!==R)){var k=this.fragCurrent;console.assert(k&&w.sn===k.sn&&w.level===k.level&&w.urlId===k.urlId,"Frag load error must match current frag to retry");var B=this.config;if(this.fragLoadError+1<=B.fragLoadingMaxRetry){this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition);var F=Math.min(Math.pow(2,this.fragLoadError)*B.fragLoadingRetryDelay,B.fragLoadingMaxRetryTimeout);this.warn("Fragment "+w.sn+" of "+R+" "+w.level+" failed to load, retrying in "+F+"ms"),this.retryDate=self.performance.now()+F,this.fragLoadError++,this.state=D.FRAG_LOADING_WAITING_RETRY}else I.levelRetry?(R===x.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=D.IDLE):(c.logger.error(I.details+" reaches max retry, redispatch as fatal ..."),I.fatal=!0,this.hls.stopLoad(),this.state=D.ERROR)}}},M.afterBufferFlushed=function(R,I,w){if(!!R){var k=l.BufferHelper.getBuffered(R);this.fragmentTracker.detectEvictedFragments(I,k,w),this.state===D.ENDED&&this.resetLoadingState()}},M.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=D.IDLE},M.resetStartWhenNotLoaded=function(R){if(!this.loadedmetadata){this.startFragRequested=!1;var I=this.levels?this.levels[R].details:null;I!=null&&I.live?(this.startPosition=-1,this.setStartPosition(I,0),this.resetLoadingState()):this.nextLoadPosition=this.startPosition}},M.updateLevelTiming=function(R,I,w,k){var B=this,F=w.details;console.assert(!!F,"level.details must be defined");var N=Object.keys(R.elementaryStreams).reduce(function(K,H){var U=R.elementaryStreams[H];if(U){var j=U.endPTS-U.startPTS;if(j<=0)return B.warn("Could not parse fragment "+R.sn+" "+H+" duration reliably ("+j+")"),K||!1;var $=k?0:Object(_.updateFragPTSDTS)(F,R,U.startPTS,U.endPTS,U.startDTS,U.endDTS);return B.hls.trigger(u.Events.LEVEL_PTS_UPDATED,{details:F,level:w,drift:$,type:H,frag:R,start:U.startPTS,end:U.endPTS}),!0}return K},!1);N||(this.warn("Found no media in fragment "+R.sn+" of level "+w.id+" resetting transmuxer to fallback to playlist timing"),this.resetTransmuxer()),this.state=D.PARSED,this.hls.trigger(u.Events.FRAG_PARSED,{frag:R,part:I})},M.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},C(P,[{key:"state",get:function(){return this._state},set:function(R){var I=this._state;I!==R&&(this._state=R,this.log(I+"->"+R))}}]),P}(a.default)},"./src/controller/buffer-controller.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return L});var s=r("./src/polyfills/number.ts"),a=r("./src/events.ts"),o=r("./src/utils/logger.ts"),l=r("./src/errors.ts"),c=r("./src/utils/buffer-helper.ts"),u=r("./src/utils/mediasource-helper.ts"),h=r("./src/loader/fragment.ts"),d=r("./src/controller/buffer-operation-queue.ts"),y=Object(u.getMediaSource)(),E=/([ha]vc.)(?:\.[^.,]+)+/,L=function(){function _(v){var f=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var x=f.hls,S=f.media,C=f.mediaSource;o.logger.log("[buffer-controller]: Media source opened"),S&&(f.updateMediaElementDuration(),x.trigger(a.Events.MEDIA_ATTACHED,{media:S})),C&&C.removeEventListener("sourceopen",f._onMediaSourceOpen),f.checkPendingTracks()},this._onMediaSourceClose=function(){o.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){o.logger.log("[buffer-controller]: Media source ended")},this.hls=v,this._initSourceBuffer(),this.registerListeners()}var A=_.prototype;return A.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},A.destroy=function(){this.unregisterListeners(),this.details=null},A.registerListeners=function(){var f=this.hls;f.on(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),f.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.on(a.Events.MANIFEST_PARSED,this.onManifestParsed,this),f.on(a.Events.BUFFER_RESET,this.onBufferReset,this),f.on(a.Events.BUFFER_APPENDING,this.onBufferAppending,this),f.on(a.Events.BUFFER_CODECS,this.onBufferCodecs,this),f.on(a.Events.BUFFER_EOS,this.onBufferEos,this),f.on(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),f.on(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this),f.on(a.Events.FRAG_PARSED,this.onFragParsed,this),f.on(a.Events.FRAG_CHANGED,this.onFragChanged,this)},A.unregisterListeners=function(){var f=this.hls;f.off(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),f.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.off(a.Events.MANIFEST_PARSED,this.onManifestParsed,this),f.off(a.Events.BUFFER_RESET,this.onBufferReset,this),f.off(a.Events.BUFFER_APPENDING,this.onBufferAppending,this),f.off(a.Events.BUFFER_CODECS,this.onBufferCodecs,this),f.off(a.Events.BUFFER_EOS,this.onBufferEos,this),f.off(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),f.off(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this),f.off(a.Events.FRAG_PARSED,this.onFragParsed,this),f.off(a.Events.FRAG_CHANGED,this.onFragChanged,this)},A._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new d.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},A.onManifestParsed=function(f,x){var S=2;(x.audio&&!x.video||!x.altAudio)&&(S=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=S,this.details=null,o.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},A.onMediaAttaching=function(f,x){var S=this.media=x.media;if(S&&y){var C=this.mediaSource=new y;C.addEventListener("sourceopen",this._onMediaSourceOpen),C.addEventListener("sourceended",this._onMediaSourceEnded),C.addEventListener("sourceclose",this._onMediaSourceClose),S.src=self.URL.createObjectURL(C),this._objectUrl=S.src}},A.onMediaDetaching=function(){var f=this.media,x=this.mediaSource,S=this._objectUrl;if(x){if(o.logger.log("[buffer-controller]: media source detaching"),x.readyState==="open")try{x.endOfStream()}catch(C){o.logger.warn("[buffer-controller]: onMediaDetaching: "+C.message+" while calling endOfStream")}this.onBufferReset(),x.removeEventListener("sourceopen",this._onMediaSourceOpen),x.removeEventListener("sourceended",this._onMediaSourceEnded),x.removeEventListener("sourceclose",this._onMediaSourceClose),f&&(S&&self.URL.revokeObjectURL(S),f.src===S?(f.removeAttribute("src"),f.load()):o.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(a.Events.MEDIA_DETACHED,void 0)},A.onBufferReset=function(){var f=this;this.getSourceBufferTypes().forEach(function(x){var S=f.sourceBuffer[x];try{S&&(f.removeBufferListeners(x),f.mediaSource&&f.mediaSource.removeSourceBuffer(S),f.sourceBuffer[x]=void 0)}catch(C){o.logger.warn("[buffer-controller]: Failed to reset the "+x+" buffer",C)}}),this._initSourceBuffer()},A.onBufferCodecs=function(f,x){var S=this,C=this.getSourceBufferTypes().length;Object.keys(x).forEach(function(p){if(C){var g=S.tracks[p];if(g&&typeof g.buffer.changeType=="function"){var m=x[p],D=m.id,b=m.codec,T=m.levelCodec,P=m.container,M=m.metadata,O=(g.levelCodec||g.codec).replace(E,"$1"),R=(T||b).replace(E,"$1");if(O!==R){var I=P+";codecs="+(T||b);S.appendChangeType(p,I),o.logger.log("[buffer-controller]: switching codec "+O+" to "+R),S.tracks[p]={buffer:g.buffer,codec:b,container:P,levelCodec:T,metadata:M,id:D}}}}else S.pendingTracks[p]=x[p]}),!C&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},A.appendChangeType=function(f,x){var S=this,C=this.operationQueue,p={execute:function(){var m=S.sourceBuffer[f];m&&(o.logger.log("[buffer-controller]: changing "+f+" sourceBuffer type to "+x),m.changeType(x)),C.shiftAndExecuteNext(f)},onStart:function(){},onComplete:function(){},onError:function(m){o.logger.warn("[buffer-controller]: Failed to change "+f+" SourceBuffer type",m)}};C.append(p,f)},A.onBufferAppending=function(f,x){var S=this,C=this.hls,p=this.operationQueue,g=this.tracks,m=x.data,D=x.type,b=x.frag,T=x.part,P=x.chunkMeta,M=P.buffering[D],O=self.performance.now();M.start=O;var R=b.stats.buffering,I=T?T.stats.buffering:null;R.start===0&&(R.start=O),I&&I.start===0&&(I.start=O);var w=g.audio,k=D==="audio"&&P.id===1&&(w==null?void 0:w.container)==="audio/mpeg",B={execute:function(){if(M.executeStart=self.performance.now(),k){var N=S.sourceBuffer[D];if(N){var K=b.start-N.timestampOffset;Math.abs(K)>=.1&&(o.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+b.start+" (delta: "+K+") sn: "+b.sn+")"),N.timestampOffset=b.start)}}S.appendExecutor(m,D)},onStart:function(){},onComplete:function(){var N=self.performance.now();M.executeEnd=M.end=N,R.first===0&&(R.first=N),I&&I.first===0&&(I.first=N);var K=S.sourceBuffer,H={};for(var U in K)H[U]=c.BufferHelper.getBuffered(K[U]);S.appendError=0,S.hls.trigger(a.Events.BUFFER_APPENDED,{type:D,frag:b,part:T,chunkMeta:P,parent:b.type,timeRanges:H})},onError:function(N){o.logger.error("[buffer-controller]: Error encountered while trying to append to the "+D+" SourceBuffer",N);var K={type:l.ErrorTypes.MEDIA_ERROR,parent:b.type,details:l.ErrorDetails.BUFFER_APPEND_ERROR,err:N,fatal:!1};N.code===DOMException.QUOTA_EXCEEDED_ERR?K.details=l.ErrorDetails.BUFFER_FULL_ERROR:(S.appendError++,K.details=l.ErrorDetails.BUFFER_APPEND_ERROR,S.appendError>C.config.appendErrorMaxRetry&&(o.logger.error("[buffer-controller]: Failed "+C.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),K.fatal=!0,C.stopLoad())),C.trigger(a.Events.ERROR,K)}};p.append(B,D)},A.onBufferFlushing=function(f,x){var S=this,C=this.operationQueue,p=function(m){return{execute:S.removeExecutor.bind(S,m,x.startOffset,x.endOffset),onStart:function(){},onComplete:function(){S.hls.trigger(a.Events.BUFFER_FLUSHED,{type:m})},onError:function(b){o.logger.warn("[buffer-controller]: Failed to remove from "+m+" SourceBuffer",b)}}};x.type?C.append(p(x.type),x.type):this.getSourceBufferTypes().forEach(function(g){C.append(p(g),g)})},A.onFragParsed=function(f,x){var S=this,C=x.frag,p=x.part,g=[],m=p?p.elementaryStreams:C.elementaryStreams;m[h.ElementaryStreamTypes.AUDIOVIDEO]?g.push("audiovideo"):(m[h.ElementaryStreamTypes.AUDIO]&&g.push("audio"),m[h.ElementaryStreamTypes.VIDEO]&&g.push("video"));var D=function(){var T=self.performance.now();C.stats.buffering.end=T,p&&(p.stats.buffering.end=T);var P=p?p.stats:C.stats;S.hls.trigger(a.Events.FRAG_BUFFERED,{frag:C,part:p,stats:P,id:C.type})};g.length===0&&o.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+C.type+" level: "+C.level+" sn: "+C.sn),this.blockBuffers(D,g)},A.onFragChanged=function(f,x){this.flushBackBuffer()},A.onBufferEos=function(f,x){var S=this,C=this.getSourceBufferTypes().reduce(function(p,g){var m=S.sourceBuffer[g];return(!x.type||x.type===g)&&m&&!m.ended&&(m.ended=!0,o.logger.log("[buffer-controller]: "+g+" sourceBuffer now EOS")),p&&!!(!m||m.ended)},!0);C&&this.blockBuffers(function(){var p=S.mediaSource;!p||p.readyState!=="open"||p.endOfStream()})},A.onLevelUpdated=function(f,x){var S=x.details;!S.fragments.length||(this.details=S,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},A.flushBackBuffer=function(){var f=this.hls,x=this.details,S=this.media,C=this.sourceBuffer;if(!(!S||x===null)){var p=this.getSourceBufferTypes();if(!!p.length){var g=x.live&&f.config.liveBackBufferLength!==null?f.config.liveBackBufferLength:f.config.backBufferLength;if(!(!Object(s.isFiniteNumber)(g)||g<0)){var m=S.currentTime,D=x.levelTargetDuration,b=Math.max(g,D),T=Math.floor(m/D)*D-b;p.forEach(function(P){var M=C[P];if(M){var O=c.BufferHelper.getBuffered(M);O.length>0&&T>O.start(0)&&(f.trigger(a.Events.BACK_BUFFER_REACHED,{bufferEnd:T}),x.live&&f.trigger(a.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:T}),f.trigger(a.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:T,type:P}))}})}}}},A.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var f=this.details,x=this.hls,S=this.media,C=this.mediaSource,p=f.fragments[0].start+f.totalduration,g=S.duration,m=Object(s.isFiniteNumber)(C.duration)?C.duration:0;f.live&&x.config.liveDurationInfinity?(o.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),C.duration=1/0,this.updateSeekableRange(f)):(p>m&&p>g||!Object(s.isFiniteNumber)(g))&&(o.logger.log("[buffer-controller]: Updating Media Source duration to "+p.toFixed(3)),C.duration=p)}},A.updateSeekableRange=function(f){var x=this.mediaSource,S=f.fragments,C=S.length;if(C&&f.live&&x!==null&&x!==void 0&&x.setLiveSeekableRange){var p=Math.max(0,S[0].start),g=Math.max(p,p+f.totalduration);x.setLiveSeekableRange(p,g)}},A.checkPendingTracks=function(){var f=this.bufferCodecEventsExpected,x=this.operationQueue,S=this.pendingTracks,C=Object.keys(S).length;if(C&&!f||C===2){this.createSourceBuffers(S),this.pendingTracks={};var p=this.getSourceBufferTypes();if(p.length===0){this.hls.trigger(a.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}p.forEach(function(g){x.executeNext(g)})}},A.createSourceBuffers=function(f){var x=this.sourceBuffer,S=this.mediaSource;if(!S)throw Error("createSourceBuffers called when mediaSource was null");var C=0;for(var p in f)if(!x[p]){var g=f[p];if(!g)throw Error("source buffer exists for track "+p+", however track does not");var m=g.levelCodec||g.codec,D=g.container+";codecs="+m;o.logger.log("[buffer-controller]: creating sourceBuffer("+D+")");try{var b=x[p]=S.addSourceBuffer(D),T=p;this.addBufferListener(T,"updatestart",this._onSBUpdateStart),this.addBufferListener(T,"updateend",this._onSBUpdateEnd),this.addBufferListener(T,"error",this._onSBUpdateError),this.tracks[p]={buffer:b,codec:m,container:g.container,levelCodec:g.levelCodec,metadata:g.metadata,id:g.id},C++}catch(P){o.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+P.message),this.hls.trigger(a.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:P,mimeType:D})}}C&&this.hls.trigger(a.Events.BUFFER_CREATED,{tracks:this.tracks})},A._onSBUpdateStart=function(f){var x=this.operationQueue,S=x.current(f);S.onStart()},A._onSBUpdateEnd=function(f){var x=this.operationQueue,S=x.current(f);S.onComplete(),x.shiftAndExecuteNext(f)},A._onSBUpdateError=function(f,x){o.logger.error("[buffer-controller]: "+f+" SourceBuffer error",x),this.hls.trigger(a.Events.ERROR,{type:l.ErrorTypes.MEDIA_ERROR,details:l.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var S=this.operationQueue.current(f);S&&S.onError(x)},A.removeExecutor=function(f,x,S){var C=this.media,p=this.mediaSource,g=this.operationQueue,m=this.sourceBuffer,D=m[f];if(!C||!p||!D){o.logger.warn("[buffer-controller]: Attempting to remove from the "+f+" SourceBuffer, but it does not exist"),g.shiftAndExecuteNext(f);return}var b=Object(s.isFiniteNumber)(C.duration)?C.duration:1/0,T=Object(s.isFiniteNumber)(p.duration)?p.duration:1/0,P=Math.max(0,x),M=Math.min(S,b,T);M>P?(o.logger.log("[buffer-controller]: Removing ["+P+","+M+"] from the "+f+" SourceBuffer"),console.assert(!D.updating,f+" sourceBuffer must not be updating"),D.remove(P,M)):g.shiftAndExecuteNext(f)},A.appendExecutor=function(f,x){var S=this.operationQueue,C=this.sourceBuffer,p=C[x];if(!p){o.logger.warn("[buffer-controller]: Attempting to append to the "+x+" SourceBuffer, but it does not exist"),S.shiftAndExecuteNext(x);return}p.ended=!1,console.assert(!p.updating,x+" sourceBuffer must not be updating"),p.appendBuffer(f)},A.blockBuffers=function(f,x){var S=this;if(x===void 0&&(x=this.getSourceBufferTypes()),!x.length){o.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve().then(f);return}var C=this.operationQueue,p=x.map(function(g){return C.appendBlocker(g)});Promise.all(p).then(function(){f(),x.forEach(function(g){var m=S.sourceBuffer[g];(!m||!m.updating)&&C.shiftAndExecuteNext(g)})})},A.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},A.addBufferListener=function(f,x,S){var C=this.sourceBuffer[f];if(!!C){var p=S.bind(this,f);this.listeners[f].push({event:x,listener:p}),C.addEventListener(x,p)}},A.removeBufferListeners=function(f){var x=this.sourceBuffer[f];!x||this.listeners[f].forEach(function(S){x.removeEventListener(S.event,S.listener)})},_}()},"./src/controller/buffer-operation-queue.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return a});var s=r("./src/utils/logger.ts"),a=function(){function o(c){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=c}var l=o.prototype;return l.append=function(u,h){var d=this.queues[h];d.push(u),d.length===1&&this.buffers[h]&&this.executeNext(h)},l.insertAbort=function(u,h){var d=this.queues[h];d.unshift(u),this.executeNext(h)},l.appendBlocker=function(u){var h,d=new Promise(function(E){h=E}),y={execute:h,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(y,u),d},l.executeNext=function(u){var h=this.buffers,d=this.queues,y=h[u],E=d[u];if(E.length){var L=E[0];try{L.execute()}catch(_){s.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),L.onError(_),(!y||!y.updating)&&(E.shift(),this.executeNext(u))}}},l.shiftAndExecuteNext=function(u){this.queues[u].shift(),this.executeNext(u)},l.current=function(u){return this.queues[u][0]},o}()},"./src/controller/cap-level-controller.ts":function(n,i,r){r.r(i);var s=r("./src/events.ts");function a(c,u){for(var h=0;h<u.length;h++){var d=u[h];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}function o(c,u,h){return u&&a(c.prototype,u),h&&a(c,h),Object.defineProperty(c,"prototype",{writable:!1}),c}var l=function(){function c(h){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=h,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var u=c.prototype;return u.setStreamController=function(d){this.streamController=d},u.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},u.registerListeners=function(){var d=this.hls;d.on(s.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),d.on(s.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),d.on(s.Events.MANIFEST_PARSED,this.onManifestParsed,this),d.on(s.Events.BUFFER_CODECS,this.onBufferCodecs,this),d.on(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},u.unregisterListener=function(){var d=this.hls;d.off(s.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),d.off(s.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),d.off(s.Events.MANIFEST_PARSED,this.onManifestParsed,this),d.off(s.Events.BUFFER_CODECS,this.onBufferCodecs,this),d.off(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},u.onFpsDropLevelCapping=function(d,y){c.isLevelAllowed(y.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(y.droppedLevel)},u.onMediaAttaching=function(d,y){this.media=y.media instanceof HTMLVideoElement?y.media:null},u.onManifestParsed=function(d,y){var E=this.hls;this.restrictedLevels=[],this.firstLevel=y.firstLevel,E.config.capLevelToPlayerSize&&y.video&&this.startCapping()},u.onBufferCodecs=function(d,y){var E=this.hls;E.config.capLevelToPlayerSize&&y.video&&this.startCapping()},u.onMediaDetaching=function(){this.stopCapping()},u.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var d=this.hls.levels;if(d.length){var y=this.hls;y.autoLevelCapping=this.getMaxLevel(d.length-1),y.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=y.autoLevelCapping}}},u.getMaxLevel=function(d){var y=this,E=this.hls.levels;if(!E.length)return-1;var L=E.filter(function(_,A){return c.isLevelAllowed(A,y.restrictedLevels)&&A<=d});return this.clientRect=null,c.getMaxLevelByMediaSize(L,this.mediaWidth,this.mediaHeight)},u.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},u.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},u.getDimensions=function(){if(this.clientRect)return this.clientRect;var d=this.media,y={width:0,height:0};if(d){var E=d.getBoundingClientRect();y.width=E.width,y.height=E.height,!y.width&&!y.height&&(y.width=E.right-E.left||d.width||0,y.height=E.bottom-E.top||d.height||0)}return this.clientRect=y,y},c.isLevelAllowed=function(d,y){return y===void 0&&(y=[]),y.indexOf(d)===-1},c.getMaxLevelByMediaSize=function(d,y,E){if(!d||!d.length)return-1;for(var L=function(x,S){return S?x.width!==S.width||x.height!==S.height:!0},_=d.length-1,A=0;A<d.length;A+=1){var v=d[A];if((v.width>=y||v.height>=E)&&L(v,d[A+1])){_=A;break}}return _},o(c,[{key:"mediaWidth",get:function(){return this.getDimensions().width*this.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*this.contentScaleFactor}},{key:"contentScaleFactor",get:function(){var d=1;if(!this.hls.config.ignoreDevicePixelRatio)try{d=self.devicePixelRatio}catch{}return d}}]),c}();i.default=l},"./src/controller/cmcd-controller.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return L});var s=r("./src/events.ts"),a=r("./src/types/cmcd.ts"),o=r("./src/utils/buffer-helper.ts"),l=r("./src/utils/logger.ts");function c(_,A){for(var v=0;v<A.length;v++){var f=A[v];f.enumerable=f.enumerable||!1,f.configurable=!0,"value"in f&&(f.writable=!0),Object.defineProperty(_,f.key,f)}}function u(_,A,v){return A&&c(_.prototype,A),v&&c(_,v),Object.defineProperty(_,"prototype",{writable:!1}),_}function h(_,A){var v=typeof Symbol<"u"&&_[Symbol.iterator]||_["@@iterator"];if(v)return(v=v.call(_)).next.bind(v);if(Array.isArray(_)||(v=d(_))||A&&_&&typeof _.length=="number"){v&&(_=v);var f=0;return function(){return f>=_.length?{done:!0}:{done:!1,value:_[f++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d(_,A){if(!!_){if(typeof _=="string")return y(_,A);var v=Object.prototype.toString.call(_).slice(8,-1);if(v==="Object"&&_.constructor&&(v=_.constructor.name),v==="Map"||v==="Set")return Array.from(_);if(v==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(v))return y(_,A)}}function y(_,A){(A==null||A>_.length)&&(A=_.length);for(var v=0,f=new Array(A);v<A;v++)f[v]=_[v];return f}function E(){return E=Object.assign?Object.assign.bind():function(_){for(var A=1;A<arguments.length;A++){var v=arguments[A];for(var f in v)Object.prototype.hasOwnProperty.call(v,f)&&(_[f]=v[f])}return _},E.apply(this,arguments)}var L=function(){function _(v){var f=this;this.hls=void 0,this.config=void 0,this.media=void 0,this.sid=void 0,this.cid=void 0,this.useHeaders=!1,this.initialized=!1,this.starved=!1,this.buffering=!0,this.audioBuffer=void 0,this.videoBuffer=void 0,this.onWaiting=function(){f.initialized&&(f.starved=!0),f.buffering=!0},this.onPlaying=function(){f.initialized||(f.initialized=!0),f.buffering=!1},this.applyPlaylistData=function(C){try{f.apply(C,{ot:a.CMCDObjectType.MANIFEST,su:!f.initialized})}catch(p){l.logger.warn("Could not generate manifest CMCD data.",p)}},this.applyFragmentData=function(C){try{var p=C.frag,g=f.hls.levels[p.level],m=f.getObjectType(p),D={d:p.duration*1e3,ot:m};(m===a.CMCDObjectType.VIDEO||m===a.CMCDObjectType.AUDIO||m==a.CMCDObjectType.MUXED)&&(D.br=g.bitrate/1e3,D.tb=f.getTopBandwidth(m)/1e3,D.bl=f.getBufferLength(m)),f.apply(C,D)}catch(b){l.logger.warn("Could not generate segment CMCD data.",b)}},this.hls=v;var x=this.config=v.config,S=x.cmcd;S!=null&&(x.pLoader=this.createPlaylistLoader(),x.fLoader=this.createFragmentLoader(),this.sid=S.sessionId||_.uuid(),this.cid=S.contentId,this.useHeaders=S.useHeaders===!0,this.registerListeners())}var A=_.prototype;return A.registerListeners=function(){var f=this.hls;f.on(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.on(s.Events.MEDIA_DETACHED,this.onMediaDetached,this),f.on(s.Events.BUFFER_CREATED,this.onBufferCreated,this)},A.unregisterListeners=function(){var f=this.hls;f.off(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.off(s.Events.MEDIA_DETACHED,this.onMediaDetached,this),f.off(s.Events.BUFFER_CREATED,this.onBufferCreated,this),this.onMediaDetached()},A.destroy=function(){this.unregisterListeners(),this.hls=this.config=this.audioBuffer=this.videoBuffer=null},A.onMediaAttached=function(f,x){this.media=x.media,this.media.addEventListener("waiting",this.onWaiting),this.media.addEventListener("playing",this.onPlaying)},A.onMediaDetached=function(){!this.media||(this.media.removeEventListener("waiting",this.onWaiting),this.media.removeEventListener("playing",this.onPlaying),this.media=null)},A.onBufferCreated=function(f,x){var S,C;this.audioBuffer=(S=x.tracks.audio)===null||S===void 0?void 0:S.buffer,this.videoBuffer=(C=x.tracks.video)===null||C===void 0?void 0:C.buffer},A.createData=function(){var f;return{v:a.CMCDVersion,sf:a.CMCDStreamingFormat.HLS,sid:this.sid,cid:this.cid,pr:(f=this.media)===null||f===void 0?void 0:f.playbackRate,mtp:this.hls.bandwidthEstimate/1e3}},A.apply=function(f,x){x===void 0&&(x={}),E(x,this.createData());var S=x.ot===a.CMCDObjectType.INIT||x.ot===a.CMCDObjectType.VIDEO||x.ot===a.CMCDObjectType.MUXED;if(this.starved&&S&&(x.bs=!0,x.su=!0,this.starved=!1),x.su==null&&(x.su=this.buffering),this.useHeaders){var C=_.toHeaders(x);if(!Object.keys(C).length)return;f.headers||(f.headers={}),E(f.headers,C)}else{var p=_.toQuery(x);if(!p)return;f.url=_.appendQueryToUri(f.url,p)}},A.getObjectType=function(f){var x=f.type;if(x==="subtitle")return a.CMCDObjectType.TIMED_TEXT;if(f.sn==="initSegment")return a.CMCDObjectType.INIT;if(x==="audio")return a.CMCDObjectType.AUDIO;if(x==="main")return this.hls.audioTracks.length?a.CMCDObjectType.VIDEO:a.CMCDObjectType.MUXED},A.getTopBandwidth=function(f){var x=0,S,C=this.hls;if(f===a.CMCDObjectType.AUDIO)S=C.audioTracks;else{var p=C.maxAutoLevel,g=p>-1?p+1:C.levels.length;S=C.levels.slice(0,g)}for(var m=h(S),D;!(D=m()).done;){var b=D.value;b.bitrate>x&&(x=b.bitrate)}return x>0?x:NaN},A.getBufferLength=function(f){var x=this.hls.media,S=f===a.CMCDObjectType.AUDIO?this.audioBuffer:this.videoBuffer;if(!S||!x)return NaN;var C=o.BufferHelper.bufferInfo(S,x.currentTime,this.config.maxBufferHole);return C.len*1e3},A.createPlaylistLoader=function(){var f=this.config.pLoader,x=this.applyPlaylistData,S=f||this.config.loader;return function(){function C(g){this.loader=void 0,this.loader=new S(g)}var p=C.prototype;return p.destroy=function(){this.loader.destroy()},p.abort=function(){this.loader.abort()},p.load=function(m,D,b){x(m),this.loader.load(m,D,b)},u(C,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),C}()},A.createFragmentLoader=function(){var f=this.config.fLoader,x=this.applyFragmentData,S=f||this.config.loader;return function(){function C(g){this.loader=void 0,this.loader=new S(g)}var p=C.prototype;return p.destroy=function(){this.loader.destroy()},p.abort=function(){this.loader.abort()},p.load=function(m,D,b){x(m),this.loader.load(m,D,b)},u(C,[{key:"stats",get:function(){return this.loader.stats}},{key:"context",get:function(){return this.loader.context}}]),C}()},_.uuid=function(){var f=URL.createObjectURL(new Blob),x=f.toString();return URL.revokeObjectURL(f),x.slice(x.lastIndexOf("/")+1)},_.serialize=function(f){for(var x=[],S=function(k){return!Number.isNaN(k)&&k!=null&&k!==""&&k!==!1},C=function(k){return Math.round(k)},p=function(k){return C(k/100)*100},g=function(k){return encodeURIComponent(k)},m={br:C,d:C,bl:p,dl:p,mtp:p,nor:g,rtp:p,tb:C},D=Object.keys(f||{}).sort(),b=h(D),T;!(T=b()).done;){var P=T.value,M=f[P];if(!!S(M)&&!(P==="v"&&M===1)&&!(P=="pr"&&M===1)){var O=m[P];O&&(M=O(M));var R=typeof M,I=void 0;P==="ot"||P==="sf"||P==="st"?I=P+"="+M:R==="boolean"?I=P:R==="number"?I=P+"="+M:I=P+"="+JSON.stringify(M),x.push(I)}}return x.join(",")},_.toHeaders=function(f){for(var x=Object.keys(f),S={},C=["Object","Request","Session","Status"],p=[{},{},{},{}],g={br:0,d:0,ot:0,tb:0,bl:1,dl:1,mtp:1,nor:1,nrr:1,su:1,cid:2,pr:2,sf:2,sid:2,st:2,v:2,bs:3,rtp:3},m=0,D=x;m<D.length;m++){var b=D[m],T=g[b]!=null?g[b]:1;p[T][b]=f[b]}for(var P=0;P<p.length;P++){var M=_.serialize(p[P]);M&&(S["CMCD-"+C[P]]=M)}return S},_.toQuery=function(f){return"CMCD="+encodeURIComponent(_.serialize(f))},_.appendQueryToUri=function(f,x){if(!x)return f;var S=f.includes("?")?"&":"?";return""+f+S+x},_}()},"./src/controller/eme-controller.ts":function(n,i,r){r.r(i);var s=r("./src/events.ts"),a=r("./src/errors.ts"),o=r("./src/utils/logger.ts"),l=r("./src/utils/mediakeys-helper.ts");function c(L,_){for(var A=0;A<_.length;A++){var v=_[A];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(L,v.key,v)}}function u(L,_,A){return _&&c(L.prototype,_),A&&c(L,A),Object.defineProperty(L,"prototype",{writable:!1}),L}var h=3,d=function(_,A,v){var f={audioCapabilities:[],videoCapabilities:[]};return _.forEach(function(x){f.audioCapabilities.push({contentType:'audio/mp4; codecs="'+x+'"',robustness:v.audioRobustness||""})}),A.forEach(function(x){f.videoCapabilities.push({contentType:'video/mp4; codecs="'+x+'"',robustness:v.videoRobustness||""})}),[f]},y=function(_,A,v,f){switch(_){case l.KeySystems.WIDEVINE:return d(A,v,f);default:throw new Error("Unknown key-system: "+_)}},E=function(){function L(A){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=A,this._config=A.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var _=L.prototype;return _.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},_._registerListeners=function(){this.hls.on(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(s.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(s.Events.MANIFEST_PARSED,this.onManifestParsed,this)},_._unregisterListeners=function(){this.hls.off(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(s.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(s.Events.MANIFEST_PARSED,this.onManifestParsed,this)},_.getLicenseServerUrl=function(v){switch(v){case l.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+v+'"')},_._attemptKeySystemAccess=function(v,f,x){var S=this,C=y(v,f,x,this._drmSystemOptions);o.logger.log("Requesting encrypted media key-system access");var p=this.requestMediaKeySystemAccess(v,C);this.mediaKeysPromise=p.then(function(g){return S._onMediaKeySystemAccessObtained(v,g)}),p.catch(function(g){o.logger.error('Failed to obtain key-system "'+v+'" access:',g)})},_._onMediaKeySystemAccessObtained=function(v,f){var x=this;o.logger.log('Access for key-system "'+v+'" obtained');var S={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:f,mediaKeySystemDomain:v};this._mediaKeysList.push(S);var C=Promise.resolve().then(function(){return f.createMediaKeys()}).then(function(p){return S.mediaKeys=p,o.logger.log('Media-keys created for key-system "'+v+'"'),x._onMediaKeysCreated(),p});return C.catch(function(p){o.logger.error("Failed to create media-keys:",p)}),C},_._onMediaKeysCreated=function(){var v=this;this._mediaKeysList.forEach(function(f){f.mediaKeysSession||(f.mediaKeysSession=f.mediaKeys.createSession(),v._onNewMediaKeySession(f.mediaKeysSession))})},_._onNewMediaKeySession=function(v){var f=this;o.logger.log("New key-system session "+v.sessionId),v.addEventListener("message",function(x){f._onKeySessionMessage(v,x.message)},!1)},_._onKeySessionMessage=function(v,f){o.logger.log("Got EME message event, creating license request"),this._requestLicense(f,function(x){o.logger.log("Received license data (length: "+(x&&x.byteLength)+"), updating key-session"),v.update(x).catch(function(S){o.logger.warn("Updating key-session failed: "+S)})})},_.onMediaEncrypted=function(v){var f=this;if(o.logger.log('Media is encrypted using "'+v.initDataType+'" init data type'),!this.mediaKeysPromise){o.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var x=function(C){!f._media||(f._attemptSetMediaKeys(C),f._generateRequestWithPreferredKeySession(v.initDataType,v.initData))};this.mediaKeysPromise.then(x).catch(x)},_._attemptSetMediaKeys=function(v){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var f=this._mediaKeysList[0];if(!f||!f.mediaKeys){o.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}o.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(f.mediaKeys),this._hasSetMediaKeys=!0}},_._generateRequestWithPreferredKeySession=function(v,f){var x=this,S=this._mediaKeysList[0];if(!S){o.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(S.mediaKeysSessionInitialized){o.logger.warn("Key-Session already initialized but requested again");return}var C=S.mediaKeysSession;if(!C){o.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!f){o.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}o.logger.log('Generating key-session request for "'+v+'" init data type'),S.mediaKeysSessionInitialized=!0,C.generateRequest(v,f).then(function(){o.logger.debug("Key-session generation succeeded")}).catch(function(p){o.logger.error("Error generating key-session request:",p),x.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},_._createLicenseXhr=function(v,f,x){var S=new XMLHttpRequest;S.responseType="arraybuffer",S.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,S,v,f,x);var C=this._licenseXhrSetup;if(C)try{C.call(this.hls,S,v),C=void 0}catch(p){o.logger.error(p)}try{S.readyState||S.open("POST",v,!0),C&&C.call(this.hls,S,v)}catch(p){throw new Error("issue setting up KeySystem license XHR "+p)}return S},_._onLicenseRequestReadyStageChange=function(v,f,x,S){switch(v.readyState){case 4:if(v.status===200){this._requestLicenseFailureCount=0,o.logger.log("License request succeeded");var C=v.response,p=this._licenseResponseCallback;if(p)try{C=p.call(this.hls,v,f)}catch(m){o.logger.error(m)}S(C)}else{if(o.logger.error("License Request XHR failed ("+f+"). Status: "+v.status+" ("+v.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>h){this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var g=h-this._requestLicenseFailureCount+1;o.logger.warn("Retrying license request, "+g+" attempts left"),this._requestLicense(x,S)}break}},_._generateLicenseRequestChallenge=function(v,f){switch(v.mediaKeySystemDomain){case l.KeySystems.WIDEVINE:return f}throw new Error("unsupported key-system: "+v.mediaKeySystemDomain)},_._requestLicense=function(v,f){o.logger.log("Requesting content license for key-system");var x=this._mediaKeysList[0];if(!x){o.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var S=this.getLicenseServerUrl(x.mediaKeySystemDomain),C=this._createLicenseXhr(S,v,f);o.logger.log("Sending license request to URL: "+S);var p=this._generateLicenseRequestChallenge(x,v);C.send(p)}catch(g){o.logger.error("Failure requesting DRM license: "+g),this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.KEY_SYSTEM_ERROR,details:a.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},_.onMediaAttached=function(v,f){if(!!this._emeEnabled){var x=f.media;this._media=x,x.addEventListener("encrypted",this._onMediaEncrypted)}},_.onMediaDetached=function(){var v=this._media,f=this._mediaKeysList;!v||(v.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(f.map(function(x){if(x.mediaKeysSession)return x.mediaKeysSession.close().catch(function(){})})).then(function(){return v.setMediaKeys(null)}).catch(function(){}))},_.onManifestParsed=function(v,f){if(!!this._emeEnabled){var x=f.levels.map(function(C){return C.audioCodec}).filter(function(C){return!!C}),S=f.levels.map(function(C){return C.videoCodec}).filter(function(C){return!!C});this._attemptKeySystemAccess(l.KeySystems.WIDEVINE,x,S)}},u(L,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),L}();i.default=E},"./src/controller/fps-controller.ts":function(n,i,r){r.r(i);var s=r("./src/events.ts"),a=r("./src/utils/logger.ts"),o=function(){function l(u){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=u,this.registerListeners()}var c=l.prototype;return c.setStreamController=function(h){this.streamController=h},c.registerListeners=function(){this.hls.on(s.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},c.unregisterListeners=function(){this.hls.off(s.Events.MEDIA_ATTACHING,this.onMediaAttaching)},c.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},c.onMediaAttaching=function(h,d){var y=this.hls.config;if(y.capLevelOnFPSDrop){var E=d.media instanceof self.HTMLVideoElement?d.media:null;this.media=E,E&&typeof E.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),y.fpsDroppedMonitoringPeriod)}},c.checkFPS=function(h,d,y){var E=performance.now();if(d){if(this.lastTime){var L=E-this.lastTime,_=y-this.lastDroppedFrames,A=d-this.lastDecodedFrames,v=1e3*_/L,f=this.hls;if(f.trigger(s.Events.FPS_DROP,{currentDropped:_,currentDecoded:A,totalDroppedFrames:y}),v>0&&_>f.config.fpsDroppedMonitoringThreshold*A){var x=f.currentLevel;a.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+x),x>0&&(f.autoLevelCapping===-1||f.autoLevelCapping>=x)&&(x=x-1,f.trigger(s.Events.FPS_DROP_LEVEL_CAPPING,{level:x,droppedLevel:f.currentLevel}),f.autoLevelCapping=x,this.streamController.nextLevelSwitch())}}this.lastTime=E,this.lastDroppedFrames=y,this.lastDecodedFrames=d}},c.checkFPSInterval=function(){var h=this.media;if(h)if(this.isVideoPlaybackQualityAvailable){var d=h.getVideoPlaybackQuality();this.checkFPS(h,d.totalVideoFrames,d.droppedVideoFrames)}else this.checkFPS(h,h.webkitDecodedFrameCount,h.webkitDroppedFrameCount)},l}();i.default=o},"./src/controller/fragment-finders.ts":function(n,i,r){r.r(i),r.d(i,"findFragmentByPDT",function(){return o}),r.d(i,"findFragmentByPTS",function(){return l}),r.d(i,"fragmentWithinToleranceTest",function(){return c}),r.d(i,"pdtWithinToleranceTest",function(){return u}),r.d(i,"findFragWithCC",function(){return h});var s=r("./src/polyfills/number.ts"),a=r("./src/utils/binary-search.ts");function o(d,y,E){if(y===null||!Array.isArray(d)||!d.length||!Object(s.isFiniteNumber)(y))return null;var L=d[0].programDateTime;if(y<(L||0))return null;var _=d[d.length-1].endProgramDateTime;if(y>=(_||0))return null;E=E||0;for(var A=0;A<d.length;++A){var v=d[A];if(u(y,E,v))return v}return null}function l(d,y,E,L){E===void 0&&(E=0),L===void 0&&(L=0);var _=null;if(d?_=y[d.sn-y[0].sn+1]||null:E===0&&y[0].start===0&&(_=y[0]),_&&c(E,L,_)===0)return _;var A=a.default.search(y,c.bind(null,E,L));return A||_}function c(d,y,E){d===void 0&&(d=0),y===void 0&&(y=0);var L=Math.min(y,E.duration+(E.deltaPTS?E.deltaPTS:0));return E.start+E.duration-L<=d?1:E.start-L>d&&E.start?-1:0}function u(d,y,E){var L=Math.min(y,E.duration+(E.deltaPTS?E.deltaPTS:0))*1e3,_=E.endProgramDateTime||0;return _-L>d}function h(d,y){return a.default.search(d,function(E){return E.cc<y?1:E.cc>y?-1:0})}},"./src/controller/fragment-tracker.ts":function(n,i,r){r.r(i),r.d(i,"FragmentState",function(){return o}),r.d(i,"FragmentTracker",function(){return l});var s=r("./src/events.ts"),a=r("./src/types/loader.ts"),o;(function(h){h.NOT_LOADED="NOT_LOADED",h.APPENDING="APPENDING",h.PARTIAL="PARTIAL",h.OK="OK"})(o||(o={}));var l=function(){function h(y){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=y,this._registerListeners()}var d=h.prototype;return d._registerListeners=function(){var E=this.hls;E.on(s.Events.BUFFER_APPENDED,this.onBufferAppended,this),E.on(s.Events.FRAG_BUFFERED,this.onFragBuffered,this),E.on(s.Events.FRAG_LOADED,this.onFragLoaded,this)},d._unregisterListeners=function(){var E=this.hls;E.off(s.Events.BUFFER_APPENDED,this.onBufferAppended,this),E.off(s.Events.FRAG_BUFFERED,this.onFragBuffered,this),E.off(s.Events.FRAG_LOADED,this.onFragLoaded,this)},d.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},d.getAppendedFrag=function(E,L){if(L===a.PlaylistLevelType.MAIN){var _=this.activeFragment,A=this.activeParts;if(!_)return null;if(A)for(var v=A.length;v--;){var f=A[v],x=f?f.end:_.appendedPTS;if(f.start<=E&&x!==void 0&&E<=x)return v>9&&(this.activeParts=A.slice(v-9)),f}else if(_.start<=E&&_.appendedPTS!==void 0&&E<=_.appendedPTS)return _}return this.getBufferedFrag(E,L)},d.getBufferedFrag=function(E,L){for(var _=this.fragments,A=Object.keys(_),v=A.length;v--;){var f=_[A[v]];if((f==null?void 0:f.body.type)===L&&f.buffered){var x=f.body;if(x.start<=E&&E<=x.end)return x}}return null},d.detectEvictedFragments=function(E,L,_){var A=this;Object.keys(this.fragments).forEach(function(v){var f=A.fragments[v];if(!!f){if(!f.buffered){f.body.type===_&&A.removeFragment(f.body);return}var x=f.range[E];!x||x.time.some(function(S){var C=!A.isTimeBuffered(S.startPTS,S.endPTS,L);return C&&A.removeFragment(f.body),C})}})},d.detectPartialFragments=function(E){var L=this,_=this.timeRanges,A=E.frag,v=E.part;if(!(!_||A.sn==="initSegment")){var f=u(A),x=this.fragments[f];!x||(Object.keys(_).forEach(function(S){var C=A.elementaryStreams[S];if(!!C){var p=_[S],g=v!==null||C.partial===!0;x.range[S]=L.getBufferedTimes(A,v,g,p)}}),x.loaded=null,Object.keys(x.range).length?x.buffered=!0:this.removeFragment(x.body))}},d.fragBuffered=function(E){var L=u(E),_=this.fragments[L];_&&(_.loaded=null,_.buffered=!0)},d.getBufferedTimes=function(E,L,_,A){for(var v={time:[],partial:_},f=L?L.start:E.start,x=L?L.end:E.end,S=E.minEndPTS||x,C=E.maxStartPTS||f,p=0;p<A.length;p++){var g=A.start(p)-this.bufferPadding,m=A.end(p)+this.bufferPadding;if(C>=g&&S<=m){v.time.push({startPTS:Math.max(f,A.start(p)),endPTS:Math.min(x,A.end(p))});break}else if(f<m&&x>g)v.partial=!0,v.time.push({startPTS:Math.max(f,A.start(p)),endPTS:Math.min(x,A.end(p))});else if(x<=g)break}return v},d.getPartialFragment=function(E){var L=null,_,A,v,f=0,x=this.bufferPadding,S=this.fragments;return Object.keys(S).forEach(function(C){var p=S[C];!p||c(p)&&(A=p.body.start-x,v=p.body.end+x,E>=A&&E<=v&&(_=Math.min(E-A,v-E),f<=_&&(L=p.body,f=_)))}),L},d.getState=function(E){var L=u(E),_=this.fragments[L];return _?_.buffered?c(_)?o.PARTIAL:o.OK:o.APPENDING:o.NOT_LOADED},d.isTimeBuffered=function(E,L,_){for(var A,v,f=0;f<_.length;f++){if(A=_.start(f)-this.bufferPadding,v=_.end(f)+this.bufferPadding,E>=A&&L<=v)return!0;if(L<=A)return!1}return!1},d.onFragLoaded=function(E,L){var _=L.frag,A=L.part;if(!(_.sn==="initSegment"||_.bitrateTest||A)){var v=u(_);this.fragments[v]={body:_,loaded:L,buffered:!1,range:Object.create(null)}}},d.onBufferAppended=function(E,L){var _=this,A=L.frag,v=L.part,f=L.timeRanges;if(A.type===a.PlaylistLevelType.MAIN)if(this.activeFragment=A,v){var x=this.activeParts;x||(this.activeParts=x=[]),x.push(v)}else this.activeParts=null;this.timeRanges=f,Object.keys(f).forEach(function(S){var C=f[S];if(_.detectEvictedFragments(S,C),!v)for(var p=0;p<C.length;p++)A.appendedPTS=Math.max(C.end(p),A.appendedPTS||0)})},d.onFragBuffered=function(E,L){this.detectPartialFragments(L)},d.hasFragment=function(E){var L=u(E);return!!this.fragments[L]},d.removeFragmentsInRange=function(E,L,_){var A=this;Object.keys(this.fragments).forEach(function(v){var f=A.fragments[v];if(!!f&&f.buffered){var x=f.body;x.type===_&&x.start<L&&x.end>E&&A.removeFragment(x)}})},d.removeFragment=function(E){var L=u(E);E.stats.loaded=0,E.clearElementaryStreamInfo(),delete this.fragments[L]},d.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},h}();function c(h){var d,y;return h.buffered&&(((d=h.range.video)===null||d===void 0?void 0:d.partial)||((y=h.range.audio)===null||y===void 0?void 0:y.partial))}function u(h){return h.type+"_"+h.level+"_"+h.urlId+"_"+h.sn}},"./src/controller/gap-controller.ts":function(n,i,r){r.r(i),r.d(i,"STALL_MINIMUM_DURATION_MS",function(){return c}),r.d(i,"MAX_START_GAP_JUMP",function(){return u}),r.d(i,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return h}),r.d(i,"SKIP_BUFFER_RANGE_START",function(){return d}),r.d(i,"default",function(){return y});var s=r("./src/utils/buffer-helper.ts"),a=r("./src/errors.ts"),o=r("./src/events.ts"),l=r("./src/utils/logger.ts"),c=250,u=2,h=.1,d=.05,y=function(){function E(_,A,v,f){this.config=void 0,this.media=null,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=_,this.media=A,this.fragmentTracker=v,this.hls=f}var L=E.prototype;return L.destroy=function(){this.media=null,this.hls=this.fragmentTracker=null},L.poll=function(A,v){var f=this.config,x=this.media,S=this.stalled;if(x!==null){var C=x.currentTime,p=x.seeking,g=this.seeking&&!p,m=!this.seeking&&p;if(this.seeking=p,C!==A){if(this.moved=!0,S!==null){if(this.stallReported){var D=self.performance.now()-S;l.logger.warn("playback not stuck anymore @"+C+", after "+Math.round(D)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((m||g)&&(this.stalled=null),!(x.paused&&!p||x.ended||x.playbackRate===0||!s.BufferHelper.getBuffered(x).length)){var b=s.BufferHelper.bufferInfo(x,C,0),T=b.len>0,P=b.nextStart||0;if(!(!T&&!P)){if(p){var M=b.len>u,O=!P||v&&v.start<=C||P-C>u&&!this.fragmentTracker.getPartialFragment(C);if(M||O)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var R,I=Math.max(P,b.start||0)-C,w=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,k=w==null||(R=w.details)===null||R===void 0?void 0:R.live,B=k?w.details.targetduration*2:u;if(I>0&&I<=B){this._trySkipBufferHole(null);return}}var F=self.performance.now();if(S===null){this.stalled=F;return}var N=F-S;if(!(!p&&N>=c&&(this._reportStall(b),!this.media))){var K=s.BufferHelper.bufferInfo(x,C,f.maxBufferHole);this._tryFixBufferStall(K,N)}}}}},L._tryFixBufferStall=function(A,v){var f=this.config,x=this.fragmentTracker,S=this.media;if(S!==null){var C=S.currentTime,p=x.getPartialFragment(C);if(p){var g=this._trySkipBufferHole(p);if(g||!this.media)return}A.len>f.maxBufferHole&&v>f.highBufferWatchdogPeriod*1e3&&(l.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())}},L._reportStall=function(A){var v=this.hls,f=this.media,x=this.stallReported;!x&&f&&(this.stallReported=!0,l.logger.warn("Playback stalling at @"+f.currentTime+" due to low buffer ("+JSON.stringify(A)+")"),v.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:A.len}))},L._trySkipBufferHole=function(A){var v=this.config,f=this.hls,x=this.media;if(x===null)return 0;for(var S=x.currentTime,C=0,p=s.BufferHelper.getBuffered(x),g=0;g<p.length;g++){var m=p.start(g);if(S+v.maxBufferHole>=C&&S<m){var D=Math.max(m+d,x.currentTime+h);return l.logger.warn("skipping hole, adjusting currentTime from "+S+" to "+D),this.moved=!0,this.stalled=null,x.currentTime=D,A&&f.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+S+" to "+D,frag:A}),D}C=p.end(g)}return 0},L._tryNudgeBuffer=function(){var A=this.config,v=this.hls,f=this.media,x=this.nudgeRetry;if(f!==null){var S=f.currentTime;if(this.nudgeRetry++,x<A.nudgeMaxRetry){var C=S+(x+1)*A.nudgeOffset;l.logger.warn("Nudging 'currentTime' from "+S+" to "+C),f.currentTime=C,v.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else l.logger.error("Playhead still not moving while enough data buffered @"+S+" after "+A.nudgeMaxRetry+" nudges"),v.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})}},E}()},"./src/controller/id3-track-controller.ts":function(n,i,r){r.r(i);var s=r("./src/polyfills/number.ts"),a=r("./src/events.ts"),o=r("./src/utils/texttrack-utils.ts"),l=r("./src/demux/id3.ts"),c=r("./src/loader/date-range.ts"),u=r("./src/types/demuxer.ts"),h=.25;function d(){return self.WebKitDataCue||self.VTTCue||self.TextTrackCue}function y(_,A){return _.getTime()/1e3-A}function E(_){return Uint8Array.from(_.replace(/^0x/,"").replace(/([\da-fA-F]{2}) ?/g,"0x$1 ").replace(/ +$/,"").split(" ")).buffer}var L=function(){function _(v){this.hls=void 0,this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=v,this._registerListeners()}var A=_.prototype;return A.destroy=function(){this._unregisterListeners(),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={},this.hls=null},A._registerListeners=function(){var f=this.hls;f.on(a.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.on(a.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),f.on(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),f.on(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},A._unregisterListeners=function(){var f=this.hls;f.off(a.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.off(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.off(a.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),f.off(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),f.off(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this)},A.onMediaAttached=function(f,x){this.media=x.media},A.onMediaDetaching=function(){!this.id3Track||(Object(o.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null,this.dateRangeCuesAppended={})},A.onManifestLoading=function(){this.dateRangeCuesAppended={}},A.createTrack=function(f){var x=this.getID3Track(f.textTracks);return x.mode="hidden",x},A.getID3Track=function(f){if(!!this.media){for(var x=0;x<f.length;x++){var S=f[x];if(S.kind==="metadata"&&S.label==="id3")return Object(o.sendAddTrackEvent)(S,this.media),S}return this.media.addTextTrack("metadata","id3")}},A.onFragParsingMetadata=function(f,x){if(!!this.media){var S=this.hls.config,C=S.enableEmsgMetadataCues,p=S.enableID3MetadataCues;if(!(!C&&!p)){var g=x.frag,m=x.samples,D=x.details;this.id3Track||(this.id3Track=this.createTrack(this.media));for(var b=D.edge||g.end,T=d(),P=!1,M={},O=0;O<m.length;O++){var R=m[O].type;if(!(R===u.MetadataSchema.emsg&&!C||!p)){var I=l.getID3Frames(m[O].data);if(I){var w=m[O].pts,k=b,B=k-w;B<=0&&(k=w+h);for(var F=0;F<I.length;F++){var N=I[F];if(!l.isTimeStampFrame(N)){var K=new T(w,k,"");K.value=N,R&&(K.type=R),this.id3Track.addCue(K),M[N.key]=null,P=!0}}}}}P&&this.updateId3CueEnds(M)}}},A.updateId3CueEnds=function(f){var x,S=(x=this.id3Track)===null||x===void 0?void 0:x.cues;if(S)for(var C=S.length;C--;){var p,g=S[C],m=(p=g.value)===null||p===void 0?void 0:p.key;if(m&&m in f){var D=f[m];D&&g.endTime!==D&&(g.endTime=D),f[m]=g.startTime}}},A.onBufferFlushing=function(f,x){var S=x.startOffset,C=x.endOffset,p=x.type,g=this.id3Track,m=this.hls;if(!!m){var D=m.config,b=D.enableEmsgMetadataCues,T=D.enableID3MetadataCues;if(g&&(b||T)){var P;p==="audio"?P=function(O){return O.type===u.MetadataSchema.audioId3&&T}:p==="video"?P=function(O){return O.type===u.MetadataSchema.emsg&&b}:P=function(O){return O.type===u.MetadataSchema.audioId3&&T||O.type===u.MetadataSchema.emsg&&b},Object(o.removeCuesInRange)(g,S,C,P)}}},A.onLevelUpdated=function(f,x){var S=this,C=x.details;if(!(!this.media||!C.hasProgramDateTime||!this.hls.config.enableDateRangeMetadataCues)){var p=this.dateRangeCuesAppended,g=this.id3Track,m=C.dateRanges,D=Object.keys(m);if(g)for(var b=Object.keys(p).filter(function(B){return!D.includes(B)}),T=function(F){var N=b[F];Object.keys(p[N].cues).forEach(function(K){g.removeCue(p[N].cues[K])}),delete p[N]},P=b.length;P--;)T(P);var M=C.fragments[C.fragments.length-1];if(!(D.length===0||!Object(s.isFiniteNumber)(M==null?void 0:M.programDateTime))){this.id3Track||(this.id3Track=this.createTrack(this.media));for(var O=M.programDateTime/1e3-M.start,R=C.edge||M.end,I=d(),w=function(F){var N=D[F],K=m[N],H=p[N],U=(H==null?void 0:H.cues)||{},j=(H==null?void 0:H.durationKnown)||!1,$=y(K.startDate,O),X=R,Z=K.endDate;if(Z)X=y(Z,O),j=!0;else if(K.endOnNext&&!j){var nt=D.reduce(function(Y,Q){var J=m[Q];return J.class===K.class&&J.id!==Q&&J.startDate>K.startDate&&Y.push(J),Y},[]).sort(function(Y,Q){return Y.startDate.getTime()-Q.startDate.getTime()})[0];nt&&(X=y(nt.startDate,O),j=!0)}for(var at=Object.keys(K.attr),it=0;it<at.length;it++){var W=at[it];if(!(W===c.DateRangeAttribute.ID||W===c.DateRangeAttribute.CLASS||W===c.DateRangeAttribute.START_DATE||W===c.DateRangeAttribute.DURATION||W===c.DateRangeAttribute.END_DATE||W===c.DateRangeAttribute.END_ON_NEXT)){var V=U[W];if(V)j&&!H.durationKnown&&(V.endTime=X);else{var z=K.attr[W];V=new I($,X,""),(W===c.DateRangeAttribute.SCTE35_OUT||W===c.DateRangeAttribute.SCTE35_IN)&&(z=E(z)),V.value={key:W,data:z},V.type=u.MetadataSchema.dateRange,S.id3Track.addCue(V),U[W]=V}}}p[N]={cues:U,dateRange:K,durationKnown:j}},k=0;k<D.length;k++)w(k)}}},_}();i.default=L},"./src/controller/latency-controller.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return u});var s=r("./src/errors.ts"),a=r("./src/events.ts"),o=r("./src/utils/logger.ts");function l(h,d){for(var y=0;y<d.length;y++){var E=d[y];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(h,E.key,E)}}function c(h,d,y){return d&&l(h.prototype,d),y&&l(h,y),Object.defineProperty(h,"prototype",{writable:!1}),h}var u=function(){function h(y){var E=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return E.timeupdate()},this.hls=y,this.config=y.config,this.registerListeners()}var d=h.prototype;return d.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},d.registerListeners=function(){this.hls.on(a.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(a.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(a.Events.ERROR,this.onError,this)},d.unregisterListeners=function(){this.hls.off(a.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(a.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(a.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(a.Events.ERROR,this.onError)},d.onMediaAttached=function(E,L){this.media=L.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},d.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},d.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},d.onLevelUpdated=function(E,L){var _=L.details;this.levelDetails=_,_.advanced&&this.timeupdate(),!_.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},d.onError=function(E,L){L.details===s.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,o.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},d.timeupdate=function(){var E=this.media,L=this.levelDetails;if(!(!E||!L)){this.currentTime=E.currentTime;var _=this.computeLatency();if(_!==null){this._latency=_;var A=this.config,v=A.lowLatencyMode,f=A.maxLiveSyncPlaybackRate;if(!(!v||f===1)){var x=this.targetLatency;if(x!==null){var S=_-x,C=Math.min(this.maxLatency,x+L.targetduration),p=S<C;if(L.live&&p&&S>.05&&this.forwardBufferLength>1){var g=Math.min(2,Math.max(1,f)),m=Math.round(2/(1+Math.exp(-.75*S-this.edgeStalled))*20)/20;E.playbackRate=Math.min(g,Math.max(1,m))}else E.playbackRate!==1&&E.playbackRate!==0&&(E.playbackRate=1)}}}}},d.estimateLiveEdge=function(){var E=this.levelDetails;return E===null?null:E.edge+E.age},d.computeLatency=function(){var E=this.estimateLiveEdge();return E===null?null:E-this.currentTime},c(h,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var E=this.config,L=this.levelDetails;return E.liveMaxLatencyDuration!==void 0?E.liveMaxLatencyDuration:L?E.liveMaxLatencyDurationCount*L.targetduration:0}},{key:"targetLatency",get:function(){var E=this.levelDetails;if(E===null)return null;var L=E.holdBack,_=E.partHoldBack,A=E.targetduration,v=this.config,f=v.liveSyncDuration,x=v.liveSyncDurationCount,S=v.lowLatencyMode,C=this.hls.userConfig,p=S&&_||L;(C.liveSyncDuration||C.liveSyncDurationCount||p===0)&&(p=f!==void 0?f:x*A);var g=A,m=1;return p+Math.min(this.stallCount*m,g)}},{key:"liveSyncPosition",get:function(){var E=this.estimateLiveEdge(),L=this.targetLatency,_=this.levelDetails;if(E===null||L===null||_===null)return null;var A=_.edge,v=E-L-this.edgeStalled,f=A-_.totalduration,x=A-(this.config.lowLatencyMode&&_.partTarget||_.targetduration);return Math.min(Math.max(f,v),x)}},{key:"drift",get:function(){var E=this.levelDetails;return E===null?1:E.drift}},{key:"edgeStalled",get:function(){var E=this.levelDetails;if(E===null)return 0;var L=(this.config.lowLatencyMode&&E.partTarget||E.targetduration)*3;return Math.max(E.age-L,0)}},{key:"forwardBufferLength",get:function(){var E=this.media,L=this.levelDetails;if(!E||!L)return 0;var _=E.buffered.length;return(_?E.buffered.end(_-1):L.edge)-this.currentTime}}]),h}()},"./src/controller/level-controller.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return v});var s=r("./src/types/level.ts"),a=r("./src/events.ts"),o=r("./src/errors.ts"),l=r("./src/utils/codecs.ts"),c=r("./src/controller/level-helper.ts"),u=r("./src/controller/base-playlist-controller.ts"),h=r("./src/types/loader.ts");function d(){return d=Object.assign?Object.assign.bind():function(f){for(var x=1;x<arguments.length;x++){var S=arguments[x];for(var C in S)Object.prototype.hasOwnProperty.call(S,C)&&(f[C]=S[C])}return f},d.apply(this,arguments)}function y(f,x){for(var S=0;S<x.length;S++){var C=x[S];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(f,C.key,C)}}function E(f,x,S){return x&&y(f.prototype,x),S&&y(f,S),Object.defineProperty(f,"prototype",{writable:!1}),f}function L(f,x){f.prototype=Object.create(x.prototype),f.prototype.constructor=f,_(f,x)}function _(f,x){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(C,p){return C.__proto__=p,C},_(f,x)}var A=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),v=function(f){L(x,f);function x(C){var p;return p=f.call(this,C,"[level-controller]")||this,p._levels=[],p._firstLevel=-1,p._startLevel=void 0,p.currentLevelIndex=-1,p.manualLevelIndex=-1,p.onParsedComplete=void 0,p._registerListeners(),p}var S=x.prototype;return S._registerListeners=function(){var p=this.hls;p.on(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),p.on(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),p.on(a.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),p.on(a.Events.FRAG_LOADED,this.onFragLoaded,this),p.on(a.Events.ERROR,this.onError,this)},S._unregisterListeners=function(){var p=this.hls;p.off(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),p.off(a.Events.LEVEL_LOADED,this.onLevelLoaded,this),p.off(a.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),p.off(a.Events.FRAG_LOADED,this.onFragLoaded,this),p.off(a.Events.ERROR,this.onError,this)},S.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,f.prototype.destroy.call(this)},S.startLoad=function(){var p=this._levels;p.forEach(function(g){g.loadError=0}),f.prototype.startLoad.call(this)},S.onManifestLoaded=function(p,g){var m=[],D=[],b=[],T,P={},M,O=!1,R=!1,I=!1;if(g.levels.forEach(function(F){var N=F.attrs;O=O||!!(F.width&&F.height),R=R||!!F.videoCodec,I=I||!!F.audioCodec,A&&F.audioCodec&&F.audioCodec.indexOf("mp4a.40.34")!==-1&&(F.audioCodec=void 0);var K=F.bitrate+"-"+F.attrs.RESOLUTION+"-"+F.attrs.CODECS;M=P[K],M?M.url.push(F.url):(M=new s.Level(F),P[K]=M,m.push(M)),N&&(N.AUDIO&&Object(c.addGroupId)(M,"audio",N.AUDIO),N.SUBTITLES&&Object(c.addGroupId)(M,"text",N.SUBTITLES))}),(O||R)&&I&&(m=m.filter(function(F){var N=F.videoCodec,K=F.width,H=F.height;return!!N||!!(K&&H)})),m=m.filter(function(F){var N=F.audioCodec,K=F.videoCodec;return(!N||Object(l.isCodecSupportedInMp4)(N,"audio"))&&(!K||Object(l.isCodecSupportedInMp4)(K,"video"))}),g.audioTracks&&(D=g.audioTracks.filter(function(F){return!F.audioCodec||Object(l.isCodecSupportedInMp4)(F.audioCodec,"audio")}),Object(c.assignTrackIdsByGroup)(D)),g.subtitles&&(b=g.subtitles,Object(c.assignTrackIdsByGroup)(b)),m.length>0){T=m[0].bitrate,m.sort(function(F,N){return F.bitrate-N.bitrate}),this._levels=m;for(var w=0;w<m.length;w++)if(m[w].bitrate===T){this._firstLevel=w,this.log("manifest loaded, "+m.length+" level(s) found, first bitrate: "+T);break}var k=I&&!R,B={levels:m,audioTracks:D,subtitleTracks:b,firstLevel:this._firstLevel,stats:g.stats,audio:I,video:R,altAudio:!k&&D.some(function(F){return!!F.url})};this.hls.trigger(a.Events.MANIFEST_PARSED,B),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(a.Events.ERROR,{type:o.ErrorTypes.MEDIA_ERROR,details:o.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:g.url,reason:"no level with compatible codecs found in manifest"})},S.onError=function(p,g){var m;if(f.prototype.onError.call(this,p,g),!g.fatal){var D=g.context,b=this._levels[this.currentLevelIndex];if(D&&(D.type===h.PlaylistContextType.AUDIO_TRACK&&b.audioGroupIds&&D.groupId===b.audioGroupIds[b.urlId]||D.type===h.PlaylistContextType.SUBTITLE_TRACK&&b.textGroupIds&&D.groupId===b.textGroupIds[b.urlId])){this.redundantFailover(this.currentLevelIndex);return}var T=!1,P=!0,M;switch(g.details){case o.ErrorDetails.FRAG_LOAD_ERROR:case o.ErrorDetails.FRAG_LOAD_TIMEOUT:case o.ErrorDetails.KEY_LOAD_ERROR:case o.ErrorDetails.KEY_LOAD_TIMEOUT:if(g.frag){var O=g.frag.type===h.PlaylistLevelType.MAIN?g.frag.level:this.currentLevelIndex,R=this._levels[O];R?(R.fragmentError++,R.fragmentError>this.hls.config.fragLoadingMaxRetry&&(M=O)):M=O}break;case o.ErrorDetails.LEVEL_LOAD_ERROR:case o.ErrorDetails.LEVEL_LOAD_TIMEOUT:D&&(D.deliveryDirectives&&(P=!1),M=D.level),T=!0;break;case o.ErrorDetails.REMUX_ALLOC_ERROR:M=(m=g.level)!=null?m:this.currentLevelIndex,T=!0;break}M!==void 0&&this.recoverLevel(g,M,T,P)}},S.recoverLevel=function(p,g,m,D){var b=p.details,T=this._levels[g];if(T.loadError++,m){var P=this.retryLoadingOrFail(p);if(P)p.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(D){var M=T.url.length;if(M>1&&T.loadError<M)p.levelRetry=!0,this.redundantFailover(g);else if(this.manualLevelIndex===-1){for(var O=-1,R=this._levels,I=R.length;I--;){var w=(I+this.currentLevelIndex)%R.length;if(w!==this.currentLevelIndex&&R[w].loadError===0){O=w;break}}O>-1&&this.currentLevelIndex!==O&&(this.warn(b+": switch to "+O),p.levelRetry=!0,this.hls.nextAutoLevel=O)}}},S.redundantFailover=function(p){var g=this._levels[p],m=g.url.length;if(m>1){var D=(g.urlId+1)%m;this.warn("Switching to redundant URL-id "+D),this._levels.forEach(function(b){b.urlId=D}),this.level=p}},S.onFragLoaded=function(p,g){var m=g.frag;if(m!==void 0&&m.type===h.PlaylistLevelType.MAIN){var D=this._levels[m.level];D!==void 0&&(D.fragmentError=0,D.loadError=0)}},S.onLevelLoaded=function(p,g){var m,D=g.level,b=g.details,T=this._levels[D];if(!T){var P;this.warn("Invalid level index "+D),(P=g.deliveryDirectives)!==null&&P!==void 0&&P.skip&&(b.deltaUpdateFailed=!0);return}D===this.currentLevelIndex?(T.fragmentError===0&&(T.loadError=0,this.retryCount=0),this.playlistLoaded(D,g,T.details)):(m=g.deliveryDirectives)!==null&&m!==void 0&&m.skip&&(b.deltaUpdateFailed=!0)},S.onAudioTrackSwitched=function(p,g){var m=this.hls.levels[this.currentLevelIndex];if(!!m&&m.audioGroupIds){for(var D=-1,b=this.hls.audioTracks[g.id].groupId,T=0;T<m.audioGroupIds.length;T++)if(m.audioGroupIds[T]===b){D=T;break}D!==m.urlId&&(m.urlId=D,this.startLoad())}},S.loadPlaylist=function(p){var g=this.currentLevelIndex,m=this._levels[g];if(this.canLoad&&m&&m.url.length>0){var D=m.urlId,b=m.url[D];if(p)try{b=p.addDirectives(b)}catch(T){this.warn("Could not construct new URL with HLS Delivery Directives: "+T)}this.log("Attempt loading level index "+g+(p?" at sn "+p.msn+" part "+p.part:"")+" with URL-id "+D+" "+b),this.clearTimer(),this.hls.trigger(a.Events.LEVEL_LOADING,{url:b,level:g,id:D,deliveryDirectives:p||null})}},S.removeLevel=function(p,g){var m=function(T,P){return P!==g},D=this._levels.filter(function(b,T){return T!==p?!0:b.url.length>1&&g!==void 0?(b.url=b.url.filter(m),b.audioGroupIds&&(b.audioGroupIds=b.audioGroupIds.filter(m)),b.textGroupIds&&(b.textGroupIds=b.textGroupIds.filter(m)),b.urlId=0,!0):!1}).map(function(b,T){var P=b.details;return P!=null&&P.fragments&&P.fragments.forEach(function(M){M.level=T}),b});this._levels=D,this.hls.trigger(a.Events.LEVELS_UPDATED,{levels:D})},E(x,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(p){var g,m=this._levels;if(m.length!==0&&!(this.currentLevelIndex===p&&(g=m[p])!==null&&g!==void 0&&g.details)){if(p<0||p>=m.length){var D=p<0;if(this.hls.trigger(a.Events.ERROR,{type:o.ErrorTypes.OTHER_ERROR,details:o.ErrorDetails.LEVEL_SWITCH_ERROR,level:p,fatal:D,reason:"invalid level idx"}),D)return;p=Math.min(p,m.length-1)}this.clearTimer();var b=this.currentLevelIndex,T=m[b],P=m[p];this.log("switching to level "+p+" from "+b),this.currentLevelIndex=p;var M=d({},P,{level:p,maxBitrate:P.maxBitrate,uri:P.uri,urlId:P.urlId});delete M._urlId,this.hls.trigger(a.Events.LEVEL_SWITCHING,M);var O=P.details;if(!O||O.live){var R=this.switchParams(P.uri,T==null?void 0:T.details);this.loadPlaylist(R)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(p){this.manualLevelIndex=p,this._startLevel===void 0&&(this._startLevel=p),p!==-1&&(this.level=p)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(p){this._firstLevel=p}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var p=this.hls.config.startLevel;return p!==void 0?p:this._firstLevel}else return this._startLevel},set:function(p){this._startLevel=p}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(p){this.level=p,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=p)}}]),x}(u.default)},"./src/controller/level-helper.ts":function(n,i,r){r.r(i),r.d(i,"addGroupId",function(){return c}),r.d(i,"assignTrackIdsByGroup",function(){return u}),r.d(i,"updatePTS",function(){return h}),r.d(i,"updateFragPTSDTS",function(){return y}),r.d(i,"mergeDetails",function(){return E}),r.d(i,"mapPartIntersection",function(){return _}),r.d(i,"mapFragmentIntersection",function(){return A}),r.d(i,"adjustSliding",function(){return v}),r.d(i,"addSliding",function(){return f}),r.d(i,"computeReloadInterval",function(){return x}),r.d(i,"getFragmentWithSN",function(){return S}),r.d(i,"getPartWith",function(){return C});var s=r("./src/polyfills/number.ts"),a=r("./src/utils/logger.ts"),o=r("./src/loader/date-range.ts");function l(){return l=Object.assign?Object.assign.bind():function(p){for(var g=1;g<arguments.length;g++){var m=arguments[g];for(var D in m)Object.prototype.hasOwnProperty.call(m,D)&&(p[D]=m[D])}return p},l.apply(this,arguments)}function c(p,g,m){switch(g){case"audio":p.audioGroupIds||(p.audioGroupIds=[]),p.audioGroupIds.push(m);break;case"text":p.textGroupIds||(p.textGroupIds=[]),p.textGroupIds.push(m);break}}function u(p){var g={};p.forEach(function(m){var D=m.groupId||"";m.id=g[D]=g[D]||0,g[D]++})}function h(p,g,m){var D=p[g],b=p[m];d(D,b)}function d(p,g){var m=g.startPTS;if(Object(s.isFiniteNumber)(m)){var D=0,b;g.sn>p.sn?(D=m-p.start,b=p):(D=p.start-m,b=g),b.duration!==D&&(b.duration=D)}else if(g.sn>p.sn){var T=p.cc===g.cc;T&&p.minEndPTS?g.start=p.start+(p.minEndPTS-p.start):g.start=p.start+p.duration}else g.start=Math.max(p.start-g.duration,0)}function y(p,g,m,D,b,T){var P=D-m;P<=0&&(a.logger.warn("Fragment should have a positive duration",g),D=m+g.duration,T=b+g.duration);var M=m,O=D,R=g.startPTS,I=g.endPTS;if(Object(s.isFiniteNumber)(R)){var w=Math.abs(R-m);Object(s.isFiniteNumber)(g.deltaPTS)?g.deltaPTS=Math.max(w,g.deltaPTS):g.deltaPTS=w,M=Math.max(m,R),m=Math.min(m,R),b=Math.min(b,g.startDTS),O=Math.min(D,I),D=Math.max(D,I),T=Math.max(T,g.endDTS)}g.duration=D-m;var k=m-g.start;g.appendedPTS=D,g.start=g.startPTS=m,g.maxStartPTS=M,g.startDTS=b,g.endPTS=D,g.minEndPTS=O,g.endDTS=T;var B=g.sn;if(!p||B<p.startSN||B>p.endSN)return 0;var F,N=B-p.startSN,K=p.fragments;for(K[N]=g,F=N;F>0;F--)d(K[F],K[F-1]);for(F=N;F<K.length-1;F++)d(K[F],K[F+1]);return p.fragmentHint&&d(K[K.length-1],p.fragmentHint),p.PTSKnown=p.alignedSliding=!0,k}function E(p,g){for(var m=null,D=p.fragments,b=D.length-1;b>=0;b--){var T=D[b].initSegment;if(T){m=T;break}}p.fragmentHint&&delete p.fragmentHint.endPTS;var P=0,M;if(A(p,g,function(F,N){F.relurl&&(P=F.cc-N.cc),Object(s.isFiniteNumber)(F.startPTS)&&Object(s.isFiniteNumber)(F.endPTS)&&(N.start=N.startPTS=F.startPTS,N.startDTS=F.startDTS,N.appendedPTS=F.appendedPTS,N.maxStartPTS=F.maxStartPTS,N.endPTS=F.endPTS,N.endDTS=F.endDTS,N.minEndPTS=F.minEndPTS,N.duration=F.endPTS-F.startPTS,N.duration&&(M=N),g.PTSKnown=g.alignedSliding=!0),N.elementaryStreams=F.elementaryStreams,N.loader=F.loader,N.stats=F.stats,N.urlId=F.urlId,F.initSegment&&(N.initSegment=F.initSegment,m=F.initSegment)}),m){var O=g.fragmentHint?g.fragments.concat(g.fragmentHint):g.fragments;O.forEach(function(F){var N;(!F.initSegment||F.initSegment.relurl===((N=m)===null||N===void 0?void 0:N.relurl))&&(F.initSegment=m)})}if(g.skippedSegments)if(g.deltaUpdateFailed=g.fragments.some(function(F){return!F}),g.deltaUpdateFailed){a.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var R=g.skippedSegments;R--;)g.fragments.shift();g.startSN=g.fragments[0].sn,g.startCC=g.fragments[0].cc}else g.canSkipDateRanges&&(g.dateRanges=L(p.dateRanges,g.dateRanges,g.recentlyRemovedDateranges));var I=g.fragments;if(P){a.logger.warn("discontinuity sliding from playlist, take drift into account");for(var w=0;w<I.length;w++)I[w].cc+=P}g.skippedSegments&&(g.startCC=g.fragments[0].cc),_(p.partList,g.partList,function(F,N){N.elementaryStreams=F.elementaryStreams,N.stats=F.stats}),M?y(g,M,M.startPTS,M.endPTS,M.startDTS,M.endDTS):v(p,g),I.length&&(g.totalduration=g.edge-I[0].start),g.driftStartTime=p.driftStartTime,g.driftStart=p.driftStart;var k=g.advancedDateTime;if(g.advanced&&k){var B=g.edge;g.driftStart||(g.driftStartTime=k,g.driftStart=B),g.driftEndTime=k,g.driftEnd=B}else g.driftEndTime=p.driftEndTime,g.driftEnd=p.driftEnd,g.advancedDateTime=p.advancedDateTime}function L(p,g,m){var D=l({},p);return m&&m.forEach(function(b){delete D[b]}),Object.keys(g).forEach(function(b){var T=new o.DateRange(g[b].attr,D[b]);T.isValid?D[b]=T:a.logger.warn('Ignoring invalid Playlist Delta Update DATERANGE tag: "'+JSON.stringify(g[b].attr)+'"')}),D}function _(p,g,m){if(p&&g)for(var D=0,b=0,T=p.length;b<=T;b++){var P=p[b],M=g[b+D];P&&M&&P.index===M.index&&P.fragment.sn===M.fragment.sn?m(P,M):D--}}function A(p,g,m){for(var D=g.skippedSegments,b=Math.max(p.startSN,g.startSN)-g.startSN,T=(p.fragmentHint?1:0)+(D?g.endSN:Math.min(p.endSN,g.endSN))-g.startSN,P=g.startSN-p.startSN,M=g.fragmentHint?g.fragments.concat(g.fragmentHint):g.fragments,O=p.fragmentHint?p.fragments.concat(p.fragmentHint):p.fragments,R=b;R<=T;R++){var I=O[P+R],w=M[R];D&&!w&&R<D&&(w=g.fragments[R]=I),I&&w&&m(I,w)}}function v(p,g){var m=g.startSN+g.skippedSegments-p.startSN,D=p.fragments;m<0||m>=D.length||f(g,D[m].start)}function f(p,g){if(g){for(var m=p.fragments,D=p.skippedSegments;D<m.length;D++)m[D].start+=g;p.fragmentHint&&(p.fragmentHint.start+=g)}}function x(p,g){var m=1e3*p.levelTargetDuration,D=m/2,b=p.age,T=b>0&&b<m*3,P=g.loading.end-g.loading.start,M,O=p.availabilityDelay;if(p.updated===!1)if(T){var R=333*p.misses;M=Math.max(Math.min(D,P*2),R),p.availabilityDelay=(p.availabilityDelay||0)+M}else M=D;else T?(O=Math.min(O||m/2,b),p.availabilityDelay=O,M=O+m-b):M=m-P;return Math.round(M)}function S(p,g,m){if(!p||!p.details)return null;var D=p.details,b=D.fragments[g-D.startSN];return b||(b=D.fragmentHint,b&&b.sn===g)?b:g<D.startSN&&m&&m.sn===g?m:null}function C(p,g,m){if(!p||!p.details)return null;var D=p.details.partList;if(D)for(var b=D.length;b--;){var T=D[b];if(T.index===m&&T.fragment.sn===g)return T}return null}},"./src/controller/stream-controller.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return C});var s=r("./src/polyfills/number.ts"),a=r("./src/controller/base-stream-controller.ts"),o=r("./src/is-supported.ts"),l=r("./src/events.ts"),c=r("./src/utils/buffer-helper.ts"),u=r("./src/controller/fragment-tracker.ts"),h=r("./src/types/loader.ts"),d=r("./src/loader/fragment.ts"),y=r("./src/demux/transmuxer-interface.ts"),E=r("./src/types/transmuxer.ts"),L=r("./src/controller/gap-controller.ts"),_=r("./src/errors.ts");function A(p,g){for(var m=0;m<g.length;m++){var D=g[m];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(p,D.key,D)}}function v(p,g,m){return g&&A(p.prototype,g),m&&A(p,m),Object.defineProperty(p,"prototype",{writable:!1}),p}function f(p,g){p.prototype=Object.create(g.prototype),p.prototype.constructor=p,x(p,g)}function x(p,g){return x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(D,b){return D.__proto__=b,D},x(p,g)}var S=100,C=function(p){f(g,p);function g(D,b){var T;return T=p.call(this,D,b,"[stream-controller]")||this,T.audioCodecSwap=!1,T.gapController=null,T.level=-1,T._forceStartLoad=!1,T.altAudio=!1,T.audioOnly=!1,T.fragPlaying=null,T.onvplaying=null,T.onvseeked=null,T.fragLastKbps=0,T.couldBacktrack=!1,T.backtrackFragment=null,T.audioCodecSwitch=!1,T.videoBuffer=null,T._registerListeners(),T}var m=g.prototype;return m._registerListeners=function(){var b=this.hls;b.on(l.Events.MEDIA_ATTACHED,this.onMediaAttached,this),b.on(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this),b.on(l.Events.MANIFEST_LOADING,this.onManifestLoading,this),b.on(l.Events.MANIFEST_PARSED,this.onManifestParsed,this),b.on(l.Events.LEVEL_LOADING,this.onLevelLoading,this),b.on(l.Events.LEVEL_LOADED,this.onLevelLoaded,this),b.on(l.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),b.on(l.Events.ERROR,this.onError,this),b.on(l.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),b.on(l.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),b.on(l.Events.BUFFER_CREATED,this.onBufferCreated,this),b.on(l.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),b.on(l.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),b.on(l.Events.FRAG_BUFFERED,this.onFragBuffered,this)},m._unregisterListeners=function(){var b=this.hls;b.off(l.Events.MEDIA_ATTACHED,this.onMediaAttached,this),b.off(l.Events.MEDIA_DETACHING,this.onMediaDetaching,this),b.off(l.Events.MANIFEST_LOADING,this.onManifestLoading,this),b.off(l.Events.MANIFEST_PARSED,this.onManifestParsed,this),b.off(l.Events.LEVEL_LOADED,this.onLevelLoaded,this),b.off(l.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),b.off(l.Events.ERROR,this.onError,this),b.off(l.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),b.off(l.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),b.off(l.Events.BUFFER_CREATED,this.onBufferCreated,this),b.off(l.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),b.off(l.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),b.off(l.Events.FRAG_BUFFERED,this.onFragBuffered,this)},m.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},m.startLoad=function(b){if(this.levels){var T=this.lastCurrentTime,P=this.hls;if(this.stopLoad(),this.setInterval(S),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var M=P.startLevel;M===-1&&(P.config.testBandwidth&&this.levels.length>1?(M=0,this.bitrateTest=!0):M=P.nextAutoLevel),this.level=P.nextLoadLevel=M,this.loadedmetadata=!1}T>0&&b===-1&&(this.log("Override startPosition with lastCurrentTime @"+T.toFixed(3)),b=T),this.state=a.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=b,this.tick()}else this._forceStartLoad=!0,this.state=a.State.STOPPED},m.stopLoad=function(){this._forceStartLoad=!1,p.prototype.stopLoad.call(this)},m.doTick=function(){switch(this.state){case a.State.IDLE:this.doTickIdle();break;case a.State.WAITING_LEVEL:{var b,T=this.levels,P=this.level,M=T==null||(b=T[P])===null||b===void 0?void 0:b.details;if(M&&(!M.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(M))break;this.state=a.State.IDLE;break}break}case a.State.FRAG_LOADING_WAITING_RETRY:{var O,R=self.performance.now(),I=this.retryDate;(!I||R>=I||(O=this.media)!==null&&O!==void 0&&O.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.resetStartWhenNotLoaded(this.level),this.state=a.State.IDLE)}break}this.onTickEnd()},m.onTickEnd=function(){p.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},m.doTickIdle=function(){var b,T,P=this.hls,M=this.levelLastLoaded,O=this.levels,R=this.media,I=P.config,w=P.nextLoadLevel;if(!(M===null||!R&&(this.startFragRequested||!I.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!O||!O[w])){var k=O[w];this.level=P.nextLoadLevel=w;var B=k.details;if(!B||this.state===a.State.WAITING_LEVEL||B.live&&this.levelLastLoaded!==w){this.state=a.State.WAITING_LEVEL;return}var F=this.getMainFwdBufferInfo();if(F!==null){var N=F.len,K=this.getMaxBufferLength(k.maxBitrate);if(!(N>=K)){if(this._streamEnded(F,B)){var H={};this.altAudio&&(H.type="video"),this.hls.trigger(l.Events.BUFFER_EOS,H),this.state=a.State.ENDED;return}this.backtrackFragment&&this.backtrackFragment.start>F.end&&(this.backtrackFragment=null);var U=this.backtrackFragment?this.backtrackFragment.start:F.end,j=this.getNextFragment(U,B);if(this.couldBacktrack&&!this.fragPrevious&&j&&j.sn!=="initSegment"&&this.fragmentTracker.getState(j)!==u.FragmentState.OK){var $,X=(($=this.backtrackFragment)!=null?$:j).sn,Z=X-B.startSN,nt=B.fragments[Z-1];nt&&j.cc===nt.cc&&(j=nt,this.fragmentTracker.removeFragment(nt))}else this.backtrackFragment&&F.len&&(this.backtrackFragment=null);if(j&&this.fragmentTracker.getState(j)===u.FragmentState.OK&&this.nextLoadPosition>U){var at=this.audioOnly&&!this.altAudio?d.ElementaryStreamTypes.AUDIO:d.ElementaryStreamTypes.VIDEO;R&&this.afterBufferFlushed(R,at,h.PlaylistLevelType.MAIN),j=this.getNextFragment(this.nextLoadPosition,B)}!j||(j.initSegment&&!j.initSegment.data&&!this.bitrateTest&&(j=j.initSegment),((b=j.decryptdata)===null||b===void 0?void 0:b.keyFormat)==="identity"&&!((T=j.decryptdata)!==null&&T!==void 0&&T.key)?this.loadKey(j,B):this.loadFragment(j,B,U))}}}},m.loadFragment=function(b,T,P){var M,O=this.fragmentTracker.getState(b);this.fragCurrent=b,O===u.FragmentState.NOT_LOADED?b.sn==="initSegment"?this._loadInitSegment(b):this.bitrateTest?(this.log("Fragment "+b.sn+" of level "+b.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(b)):(this.startFragRequested=!0,p.prototype.loadFragment.call(this,b,T,P)):O===u.FragmentState.APPENDING?this.reduceMaxBufferLength(b.duration)&&this.fragmentTracker.removeFragment(b):((M=this.media)===null||M===void 0?void 0:M.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},m.getAppendedFrag=function(b){var T=this.fragmentTracker.getAppendedFrag(b,h.PlaylistLevelType.MAIN);return T&&"fragment"in T?T.fragment:T},m.getBufferedFrag=function(b){return this.fragmentTracker.getBufferedFrag(b,h.PlaylistLevelType.MAIN)},m.followingBufferedFrag=function(b){return b?this.getBufferedFrag(b.end+.5):null},m.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},m.nextLevelSwitch=function(){var b=this.levels,T=this.media;if(T!=null&&T.readyState){var P,M=this.getAppendedFrag(T.currentTime);if(M&&M.start>1&&this.flushMainBuffer(0,M.start-1),!T.paused&&b){var O=this.hls.nextLoadLevel,R=b[O],I=this.fragLastKbps;I&&this.fragCurrent?P=this.fragCurrent.duration*R.maxBitrate/(1e3*I)+1:P=0}else P=0;var w=this.getBufferedFrag(T.currentTime+P);if(w){var k=this.followingBufferedFrag(w);if(k){this.abortCurrentFrag();var B=k.maxStartPTS?k.maxStartPTS:k.start,F=k.duration,N=Math.max(w.end,B+Math.min(Math.max(F-this.config.maxFragLookUpTolerance,F*.5),F*.75));this.flushMainBuffer(N,Number.POSITIVE_INFINITY)}}}},m.abortCurrentFrag=function(){var b=this.fragCurrent;switch(this.fragCurrent=null,this.backtrackFragment=null,b!=null&&b.loader&&b.loader.abort(),this.state){case a.State.KEY_LOADING:case a.State.FRAG_LOADING:case a.State.FRAG_LOADING_WAITING_RETRY:case a.State.PARSING:case a.State.PARSED:this.state=a.State.IDLE;break}this.nextLoadPosition=this.getLoadPosition()},m.flushMainBuffer=function(b,T){p.prototype.flushMainBuffer.call(this,b,T,this.altAudio?"video":null)},m.onMediaAttached=function(b,T){p.prototype.onMediaAttached.call(this,b,T);var P=T.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),P.addEventListener("playing",this.onvplaying),P.addEventListener("seeked",this.onvseeked),this.gapController=new L.default(this.config,P,this.fragmentTracker,this.hls)},m.onMediaDetaching=function(){var b=this.media;b&&this.onvplaying&&this.onvseeked&&(b.removeEventListener("playing",this.onvplaying),b.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),p.prototype.onMediaDetaching.call(this)},m.onMediaPlaying=function(){this.tick()},m.onMediaSeeked=function(){var b=this.media,T=b?b.currentTime:null;Object(s.isFiniteNumber)(T)&&this.log("Media seeked to "+T.toFixed(3)),this.tick()},m.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(l.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null,this.backtrackFragment=null},m.onManifestParsed=function(b,T){var P=!1,M=!1,O;T.levels.forEach(function(R){O=R.audioCodec,O&&(O.indexOf("mp4a.40.2")!==-1&&(P=!0),O.indexOf("mp4a.40.5")!==-1&&(M=!0))}),this.audioCodecSwitch=P&&M&&!Object(o.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=T.levels,this.startFragRequested=!1},m.onLevelLoading=function(b,T){var P=this.levels;if(!(!P||this.state!==a.State.IDLE)){var M=P[T.level];(!M.details||M.details.live&&this.levelLastLoaded!==T.level||this.waitForCdnTuneIn(M.details))&&(this.state=a.State.WAITING_LEVEL)}},m.onLevelLoaded=function(b,T){var P,M=this.levels,O=T.level,R=T.details,I=R.totalduration;if(!M){this.warn("Levels were reset while loading level "+O);return}this.log("Level "+O+" loaded ["+R.startSN+","+R.endSN+"], cc ["+R.startCC+", "+R.endCC+"] duration:"+I);var w=this.fragCurrent;w&&(this.state===a.State.FRAG_LOADING||this.state===a.State.FRAG_LOADING_WAITING_RETRY)&&w.level!==T.level&&w.loader&&(this.state=a.State.IDLE,this.backtrackFragment=null,w.loader.abort());var k=M[O],B=0;if(R.live||(P=k.details)!==null&&P!==void 0&&P.live){if(R.fragments[0]||(R.deltaUpdateFailed=!0),R.deltaUpdateFailed)return;B=this.alignPlaylists(R,k.details)}if(k.details=R,this.levelLastLoaded=O,this.hls.trigger(l.Events.LEVEL_UPDATED,{details:R,level:O}),this.state===a.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(R))return;this.state=a.State.IDLE}this.startFragRequested?R.live&&this.synchronizeToLiveEdge(R):this.setStartPosition(R,B),this.tick()},m._handleFragmentLoadProgress=function(b){var T,P=b.frag,M=b.part,O=b.payload,R=this.levels;if(!R){this.warn("Levels were reset while fragment load was in progress. Fragment "+P.sn+" of level "+P.level+" will not be buffered");return}var I=R[P.level],w=I.details;if(!w){this.warn("Dropping fragment "+P.sn+" of level "+P.level+" after level details were reset");return}var k=I.videoCodec,B=w.PTSKnown||!w.live,F=(T=P.initSegment)===null||T===void 0?void 0:T.data,N=this._getAudioCodec(I),K=this.transmuxer=this.transmuxer||new y.default(this.hls,h.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),H=M?M.index:-1,U=H!==-1,j=new E.ChunkMetadata(P.level,P.sn,P.stats.chunkCount,O.byteLength,H,U),$=this.initPTS[P.cc];K.push(O,F,N,k,P,M,w.totalduration,B,j,$)},m.onAudioTrackSwitching=function(b,T){var P=this.altAudio,M=!!T.url,O=T.id;if(!M){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var R=this.fragCurrent;R!=null&&R.loader&&(this.log("Switching to main audio track, cancel main fragment load"),R.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var I=this.hls;P&&I.trigger(l.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),I.trigger(l.Events.AUDIO_TRACK_SWITCHED,{id:O})}},m.onAudioTrackSwitched=function(b,T){var P=T.id,M=!!this.hls.audioTracks[P].url;if(M){var O=this.videoBuffer;O&&this.mediaBuffer!==O&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=O)}this.altAudio=M,this.tick()},m.onBufferCreated=function(b,T){var P=T.tracks,M,O,R=!1;for(var I in P){var w=P[I];if(w.id==="main"){if(O=I,M=w,I==="video"){var k=P[I];k&&(this.videoBuffer=k.buffer)}}else R=!0}R&&M?(this.log("Alternate track found, use "+O+".buffered to schedule main fragment loading"),this.mediaBuffer=M.buffer):this.mediaBuffer=this.media},m.onFragBuffered=function(b,T){var P=T.frag,M=T.part;if(!(P&&P.type!==h.PlaylistLevelType.MAIN)){if(this.fragContextChanged(P)){this.warn("Fragment "+P.sn+(M?" p: "+M.index:"")+" of level "+P.level+" finished buffering, but was aborted. state: "+this.state),this.state===a.State.PARSED&&(this.state=a.State.IDLE);return}var O=M?M.stats:P.stats;this.fragLastKbps=Math.round(8*O.total/(O.buffering.end-O.loading.first)),P.sn!=="initSegment"&&(this.fragPrevious=P),this.fragBufferedComplete(P,M)}},m.onError=function(b,T){switch(T.details){case _.ErrorDetails.FRAG_LOAD_ERROR:case _.ErrorDetails.FRAG_LOAD_TIMEOUT:case _.ErrorDetails.KEY_LOAD_ERROR:case _.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(h.PlaylistLevelType.MAIN,T);break;case _.ErrorDetails.LEVEL_LOAD_ERROR:case _.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==a.State.ERROR&&(T.fatal?(this.warn(""+T.details),this.state=a.State.ERROR):!T.levelRetry&&this.state===a.State.WAITING_LEVEL&&(this.state=a.State.IDLE));break;case _.ErrorDetails.BUFFER_FULL_ERROR:if(T.parent==="main"&&(this.state===a.State.PARSING||this.state===a.State.PARSED)){var P=!0,M=this.getFwdBufferInfo(this.media,h.PlaylistLevelType.MAIN);M&&M.len>.5&&(P=!this.reduceMaxBufferLength(M.len)),P&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break}},m.checkBuffer=function(){var b=this.media,T=this.gapController;if(!(!b||!T||!b.readyState)){if(this.loadedmetadata||!c.BufferHelper.getBuffered(b).length){var P=this.state!==a.State.IDLE?this.fragCurrent:null;T.poll(this.lastCurrentTime,P)}this.lastCurrentTime=b.currentTime}},m.onFragLoadEmergencyAborted=function(){this.state=a.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},m.onBufferFlushed=function(b,T){var P=T.type;if(P!==d.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var M=(P===d.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(M,P,h.PlaylistLevelType.MAIN)}},m.onLevelsUpdated=function(b,T){this.levels=T.levels},m.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},m.seekToStartPos=function(){var b=this.media;if(!!b){var T=b.currentTime,P=this.startPosition;if(P>=0&&T<P){if(b.seeking){this.log("could not seek to "+P+", already seeking at "+T);return}var M=c.BufferHelper.getBuffered(b),O=M.length?M.start(0):0,R=O-P;R>0&&(R<this.config.maxBufferHole||R<this.config.maxFragLookUpTolerance)&&(this.log("adjusting start position by "+R+" to match buffer start"),P+=R,this.startPosition=P),this.log("seek to target start position "+P+" from current time "+T),b.currentTime=P}}},m._getAudioCodec=function(b){var T=this.config.defaultAudioCodec||b.audioCodec;return this.audioCodecSwap&&T&&(this.log("Swapping audio codec"),T.indexOf("mp4a.40.5")!==-1?T="mp4a.40.2":T="mp4a.40.5"),T},m._loadBitrateTestFrag=function(b){var T=this;b.bitrateTest=!0,this._doFragLoad(b).then(function(P){var M=T.hls;if(!(!P||M.nextLoadLevel||T.fragContextChanged(b))){T.fragLoadError=0,T.state=a.State.IDLE,T.startFragRequested=!1,T.bitrateTest=!1;var O=b.stats;O.parsing.start=O.parsing.end=O.buffering.start=O.buffering.end=self.performance.now(),M.trigger(l.Events.FRAG_LOADED,P),b.bitrateTest=!1}})},m._handleTransmuxComplete=function(b){var T,P="main",M=this.hls,O=b.remuxResult,R=b.chunkMeta,I=this.getCurrentContext(R);if(!I){this.warn("The loading context changed while buffering fragment "+R.sn+" of level "+R.level+". This chunk will not be buffered."),this.resetStartWhenNotLoaded(R.level);return}var w=I.frag,k=I.part,B=I.level,F=O.video,N=O.text,K=O.id3,H=O.initSegment,U=B.details,j=this.altAudio?void 0:O.audio;if(!this.fragContextChanged(w)){if(this.state=a.State.PARSING,H){H.tracks&&(this._bufferInitSegment(B,H.tracks,w,R),M.trigger(l.Events.FRAG_PARSING_INIT_SEGMENT,{frag:w,id:P,tracks:H.tracks}));var $=H.initPTS,X=H.timescale;Object(s.isFiniteNumber)($)&&(this.initPTS[w.cc]=$,M.trigger(l.Events.INIT_PTS_FOUND,{frag:w,id:P,initPTS:$,timescale:X}))}if(F&&O.independent!==!1){if(U){var Z=F.startPTS,nt=F.endPTS,at=F.startDTS,it=F.endDTS;if(k)k.elementaryStreams[F.type]={startPTS:Z,endPTS:nt,startDTS:at,endDTS:it};else if(F.firstKeyFrame&&F.independent&&(this.couldBacktrack=!0),F.dropped&&F.independent){var W=this.getMainFwdBufferInfo(),V=(W?W.end:this.getLoadPosition())+this.config.maxBufferHole,z=F.firstKeyFramePTS?F.firstKeyFramePTS:Z;if(V<z-this.config.maxBufferHole){this.backtrack(w);return}w.setElementaryStreamInfo(F.type,w.start,nt,w.start,it,!0)}w.setElementaryStreamInfo(F.type,Z,nt,at,it),this.backtrackFragment&&(this.backtrackFragment=w),this.bufferFragmentData(F,w,k,R)}}else if(O.independent===!1){this.backtrack(w);return}if(j){var Y=j.startPTS,Q=j.endPTS,J=j.startDTS,rt=j.endDTS;k&&(k.elementaryStreams[d.ElementaryStreamTypes.AUDIO]={startPTS:Y,endPTS:Q,startDTS:J,endDTS:rt}),w.setElementaryStreamInfo(d.ElementaryStreamTypes.AUDIO,Y,Q,J,rt),this.bufferFragmentData(j,w,k,R)}if(U&&K!==null&&K!==void 0&&(T=K.samples)!==null&&T!==void 0&&T.length){var tt={id:P,frag:w,details:U,samples:K.samples};M.trigger(l.Events.FRAG_PARSING_METADATA,tt)}if(U&&N){var et={id:P,frag:w,details:U,samples:N.samples};M.trigger(l.Events.FRAG_PARSING_USERDATA,et)}}},m._bufferInitSegment=function(b,T,P,M){var O=this;if(this.state===a.State.PARSING){this.audioOnly=!!T.audio&&!T.video,this.altAudio&&!this.audioOnly&&delete T.audio;var R=T.audio,I=T.video,w=T.audiovideo;if(R){var k=b.audioCodec,B=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(k&&(k.indexOf("mp4a.40.5")!==-1?k="mp4a.40.2":k="mp4a.40.5"),R.metadata.channelCount!==1&&B.indexOf("firefox")===-1&&(k="mp4a.40.5")),B.indexOf("android")!==-1&&R.container!=="audio/mpeg"&&(k="mp4a.40.2",this.log("Android: force audio codec to "+k)),b.audioCodec&&b.audioCodec!==k&&this.log('Swapping manifest audio codec "'+b.audioCodec+'" for "'+k+'"'),R.levelCodec=k,R.id="main",this.log("Init audio buffer, container:"+R.container+", codecs[selected/level/parsed]=["+(k||"")+"/"+(b.audioCodec||"")+"/"+R.codec+"]")}I&&(I.levelCodec=b.videoCodec,I.id="main",this.log("Init video buffer, container:"+I.container+", codecs[level/parsed]=["+(b.videoCodec||"")+"/"+I.codec+"]")),w&&this.log("Init audiovideo buffer, container:"+w.container+", codecs[level/parsed]=["+(b.attrs.CODECS||"")+"/"+w.codec+"]"),this.hls.trigger(l.Events.BUFFER_CODECS,T),Object.keys(T).forEach(function(F){var N=T[F],K=N.initSegment;K!=null&&K.byteLength&&O.hls.trigger(l.Events.BUFFER_APPENDING,{type:F,data:K,frag:P,part:null,chunkMeta:M,parent:P.type})}),this.tick()}},m.getMainFwdBufferInfo=function(){return this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,h.PlaylistLevelType.MAIN)},m.backtrack=function(b){this.couldBacktrack=!0,this.backtrackFragment=b,this.resetTransmuxer(),this.flushBufferGap(b),this.fragmentTracker.removeFragment(b),this.fragPrevious=null,this.nextLoadPosition=b.start,this.state=a.State.IDLE},m.checkFragmentChanged=function(){var b=this.media,T=null;if(b&&b.readyState>1&&b.seeking===!1){var P=b.currentTime;if(c.BufferHelper.isBuffered(b,P)?T=this.getAppendedFrag(P):c.BufferHelper.isBuffered(b,P+.1)&&(T=this.getAppendedFrag(P+.1)),T){this.backtrackFragment=null;var M=this.fragPlaying,O=T.level;(!M||T.sn!==M.sn||M.level!==O||T.urlId!==M.urlId)&&(this.hls.trigger(l.Events.FRAG_CHANGED,{frag:T}),(!M||M.level!==O)&&this.hls.trigger(l.Events.LEVEL_SWITCHED,{level:O}),this.fragPlaying=T)}}},v(g,[{key:"nextLevel",get:function(){var b=this.nextBufferedFrag;return b?b.level:-1}},{key:"currentFrag",get:function(){var b=this.media;return b?this.fragPlaying||this.getAppendedFrag(b.currentTime):null}},{key:"currentProgramDateTime",get:function(){var b=this.media;if(b){var T=b.currentTime,P=this.currentFrag;if(P&&Object(s.isFiniteNumber)(T)&&Object(s.isFiniteNumber)(P.programDateTime)){var M=P.programDateTime+(T-P.start)*1e3;return new Date(M)}}return null}},{key:"currentLevel",get:function(){var b=this.currentFrag;return b?b.level:-1}},{key:"nextBufferedFrag",get:function(){var b=this.currentFrag;return b?this.followingBufferedFrag(b):null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),g}(a.default)},"./src/controller/subtitle-stream-controller.ts":function(n,i,r){r.r(i),r.d(i,"SubtitleStreamController",function(){return f});var s=r("./src/events.ts"),a=r("./src/utils/buffer-helper.ts"),o=r("./src/controller/fragment-finders.ts"),l=r("./src/utils/discontinuities.ts"),c=r("./src/controller/level-helper.ts"),u=r("./src/controller/fragment-tracker.ts"),h=r("./src/controller/base-stream-controller.ts"),d=r("./src/types/loader.ts"),y=r("./src/types/level.ts");function E(S,C){for(var p=0;p<C.length;p++){var g=C[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(S,g.key,g)}}function L(S,C,p){return C&&E(S.prototype,C),p&&E(S,p),Object.defineProperty(S,"prototype",{writable:!1}),S}function _(S,C){S.prototype=Object.create(C.prototype),S.prototype.constructor=S,A(S,C)}function A(S,C){return A=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(g,m){return g.__proto__=m,g},A(S,C)}var v=500,f=function(S){_(C,S);function C(g,m){var D;return D=S.call(this,g,m,"[subtitle-stream-controller]")||this,D.levels=[],D.currentTrackId=-1,D.tracksBuffered=[],D.mainDetails=null,D._registerListeners(),D}var p=C.prototype;return p.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},p._registerListeners=function(){var m=this.hls;m.on(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),m.on(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this),m.on(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),m.on(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),m.on(s.Events.ERROR,this.onError,this),m.on(s.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),m.on(s.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),m.on(s.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),m.on(s.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),m.on(s.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},p._unregisterListeners=function(){var m=this.hls;m.off(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),m.off(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this),m.off(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),m.off(s.Events.LEVEL_LOADED,this.onLevelLoaded,this),m.off(s.Events.ERROR,this.onError,this),m.off(s.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),m.off(s.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),m.off(s.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),m.off(s.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),m.off(s.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},p.startLoad=function(){this.stopLoad(),this.state=h.State.IDLE,this.setInterval(v),this.tick()},p.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},p.onLevelLoaded=function(m,D){this.mainDetails=D.details},p.onSubtitleFragProcessed=function(m,D){var b=D.frag,T=D.success;if(this.fragPrevious=b,this.state=h.State.IDLE,!!T){var P=this.tracksBuffered[this.currentTrackId];if(!!P){for(var M,O=b.start,R=0;R<P.length;R++)if(O>=P[R].start&&O<=P[R].end){M=P[R];break}var I=b.start+b.duration;M?M.end=I:(M={start:O,end:I},P.push(M)),this.fragmentTracker.fragBuffered(b)}}},p.onBufferFlushing=function(m,D){var b=D.startOffset,T=D.endOffset;if(b===0&&T!==Number.POSITIVE_INFINITY){var P=this.currentTrackId,M=this.levels;if(!M.length||!M[P]||!M[P].details)return;var O=M[P].details,R=O.targetduration,I=T-R;if(I<=0)return;D.endOffsetSubtitles=Math.max(0,I),this.tracksBuffered.forEach(function(w){for(var k=0;k<w.length;){if(w[k].end<=I){w.shift();continue}else if(w[k].start<I)w[k].start=I;else break;k++}}),this.fragmentTracker.removeFragmentsInRange(b,I,d.PlaylistLevelType.SUBTITLE)}},p.onError=function(m,D){var b,T=D.frag;!T||T.type!==d.PlaylistLevelType.SUBTITLE||((b=this.fragCurrent)!==null&&b!==void 0&&b.loader&&this.fragCurrent.loader.abort(),this.state=h.State.IDLE)},p.onSubtitleTracksUpdated=function(m,D){var b=this,T=D.subtitleTracks;this.tracksBuffered=[],this.levels=T.map(function(P){return new y.Level(P)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(P){b.tracksBuffered[P.id]=[]}),this.mediaBuffer=null},p.onSubtitleTrackSwitch=function(m,D){if(this.currentTrackId=D.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var b=this.levels[this.currentTrackId];b!=null&&b.details?this.mediaBuffer=this.mediaBufferTimeRanges:this.mediaBuffer=null,b&&this.setInterval(v)},p.onSubtitleTrackLoaded=function(m,D){var b,T=D.details,P=D.id,M=this.currentTrackId,O=this.levels;if(!!O.length){var R=O[M];if(!(P>=O.length||P!==M||!R)){if(this.mediaBuffer=this.mediaBufferTimeRanges,T.live||(b=R.details)!==null&&b!==void 0&&b.live){var I=this.mainDetails;if(T.deltaUpdateFailed||!I)return;var w=I.fragments[0];if(!R.details)T.hasProgramDateTime&&I.hasProgramDateTime?Object(l.alignMediaPlaylistByPDT)(T,I):w&&Object(c.addSliding)(T,w.start);else{var k=this.alignPlaylists(T,R.details);k===0&&w&&Object(c.addSliding)(T,w.start)}}if(R.details=T,this.levelLastLoaded=P,this.tick(),T.live&&!this.fragCurrent&&this.media&&this.state===h.State.IDLE){var B=Object(o.findFragmentByPTS)(null,T.fragments,this.media.currentTime,0);B||(this.warn("Subtitle playlist not aligned with playback"),R.details=void 0)}}}},p._handleFragmentLoadComplete=function(m){var D=m.frag,b=m.payload,T=D.decryptdata,P=this.hls;if(!this.fragContextChanged(D)&&b&&b.byteLength>0&&T&&T.key&&T.iv&&T.method==="AES-128"){var M=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(b),T.key.buffer,T.iv.buffer).then(function(O){var R=performance.now();P.trigger(s.Events.FRAG_DECRYPTED,{frag:D,payload:O,stats:{tstart:M,tdecrypt:R}})})}},p.doTick=function(){if(!this.media){this.state=h.State.IDLE;return}if(this.state===h.State.IDLE){var m=this.currentTrackId,D=this.levels;if(!D.length||!D[m]||!D[m].details)return;var b=D[m].details,T=b.targetduration,P=this.config,M=this.media,O=a.BufferHelper.bufferedInfo(this.tracksBuffered[this.currentTrackId]||[],M.currentTime-T,P.maxBufferHole),R=O.end,I=O.len,w=this.getMaxBufferLength()+T;if(I>w)return;console.assert(b,"Subtitle track details are defined on idle subtitle stream controller tick");var k=b.fragments,B=k.length,F=b.edge,N,K=this.fragPrevious;if(R<F){var H=P.maxFragLookUpTolerance;N=Object(o.findFragmentByPTS)(K,k,Math.max(k[0].start,R),H),!N&&K&&K.start<k[0].start&&(N=k[0])}else N=k[B-1];if(N=this.mapToInitFragWhenRequired(N),!N||this.fragmentTracker.getState(N)!==u.FragmentState.NOT_LOADED)return;N.encrypted?this.loadKey(N,b):this.loadFragment(N,b,R)}},p.loadFragment=function(m,D,b){this.fragCurrent=m,m.sn==="initSegment"?this._loadInitSegment(m):S.prototype.loadFragment.call(this,m,D,b)},L(C,[{key:"mediaBufferTimeRanges",get:function(){return new x(this.tracksBuffered[this.currentTrackId]||[])}}]),C}(h.default),x=function(C){this.buffered=void 0;var p=function(m,D,b){if(D=D>>>0,D>b-1)throw new DOMException("Failed to execute '"+m+"' on 'TimeRanges': The index provided ("+D+") is greater than the maximum bound ("+b+")");return C[D][m]};this.buffered={get length(){return C.length},end:function(m){return p("end",m,C.length)},start:function(m){return p("start",m,C.length)}}}},"./src/controller/subtitle-track-controller.ts":function(n,i,r){r.r(i);var s=r("./src/events.ts"),a=r("./src/utils/texttrack-utils.ts"),o=r("./src/controller/base-playlist-controller.ts"),l=r("./src/types/loader.ts");function c(L,_){for(var A=0;A<_.length;A++){var v=_[A];v.enumerable=v.enumerable||!1,v.configurable=!0,"value"in v&&(v.writable=!0),Object.defineProperty(L,v.key,v)}}function u(L,_,A){return _&&c(L.prototype,_),A&&c(L,A),Object.defineProperty(L,"prototype",{writable:!1}),L}function h(L,_){L.prototype=Object.create(_.prototype),L.prototype.constructor=L,d(L,_)}function d(L,_){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(v,f){return v.__proto__=f,v},d(L,_)}var y=function(L){h(_,L);function _(v){var f;return f=L.call(this,v,"[subtitle-track-controller]")||this,f.media=null,f.tracks=[],f.groupId=null,f.tracksInGroup=[],f.trackId=-1,f.selectDefaultTrack=!0,f.queuedDefaultTrack=-1,f.trackChangeListener=function(){return f.onTextTracksChanged()},f.asyncPollTrackChange=function(){return f.pollTrackChange(0)},f.useTextTrackPolling=!1,f.subtitlePollingInterval=-1,f._subtitleDisplay=!0,f.registerListeners(),f}var A=_.prototype;return A.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,L.prototype.destroy.call(this)},A.registerListeners=function(){var f=this.hls;f.on(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.on(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.on(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.on(s.Events.MANIFEST_PARSED,this.onManifestParsed,this),f.on(s.Events.LEVEL_LOADING,this.onLevelLoading,this),f.on(s.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),f.on(s.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),f.on(s.Events.ERROR,this.onError,this)},A.unregisterListeners=function(){var f=this.hls;f.off(s.Events.MEDIA_ATTACHED,this.onMediaAttached,this),f.off(s.Events.MEDIA_DETACHING,this.onMediaDetaching,this),f.off(s.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.off(s.Events.MANIFEST_PARSED,this.onManifestParsed,this),f.off(s.Events.LEVEL_LOADING,this.onLevelLoading,this),f.off(s.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),f.off(s.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),f.off(s.Events.ERROR,this.onError,this)},A.onMediaAttached=function(f,x){this.media=x.media,this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},A.pollTrackChange=function(f){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,f)},A.onMediaDetaching=function(){if(!!this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var f=E(this.media.textTracks);f.forEach(function(x){Object(a.clearCurrentCues)(x)}),this.subtitleTrack=-1,this.media=null}},A.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},A.onManifestParsed=function(f,x){this.tracks=x.subtitleTracks},A.onSubtitleTrackLoaded=function(f,x){var S=x.id,C=x.details,p=this.trackId,g=this.tracksInGroup[p];if(!g){this.warn("Invalid subtitle track id "+S);return}var m=g.details;g.details=x.details,this.log("subtitle track "+S+" loaded ["+C.startSN+"-"+C.endSN+"]"),S===this.trackId&&(this.retryCount=0,this.playlistLoaded(S,x,m))},A.onLevelLoading=function(f,x){this.switchLevel(x.level)},A.onLevelSwitching=function(f,x){this.switchLevel(x.level)},A.switchLevel=function(f){var x=this.hls.levels[f];if(!!(x!=null&&x.textGroupIds)){var S=x.textGroupIds[x.urlId];if(this.groupId!==S){var C=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,p=this.tracks.filter(function(D){return!S||D.groupId===S});this.tracksInGroup=p;var g=this.findTrackId(C==null?void 0:C.name)||this.findTrackId();this.groupId=S;var m={subtitleTracks:p};this.log("Updating subtitle tracks, "+p.length+' track(s) found in "'+S+'" group-id'),this.hls.trigger(s.Events.SUBTITLE_TRACKS_UPDATED,m),g!==-1&&this.setSubtitleTrack(g,C)}}},A.findTrackId=function(f){for(var x=this.tracksInGroup,S=0;S<x.length;S++){var C=x[S];if((!this.selectDefaultTrack||C.default)&&(!f||f===C.name))return C.id}return-1},A.onError=function(f,x){L.prototype.onError.call(this,f,x),!(x.fatal||!x.context)&&x.context.type===l.PlaylistContextType.SUBTITLE_TRACK&&x.context.id===this.trackId&&x.context.groupId===this.groupId&&this.retryLoadingOrFail(x)},A.loadPlaylist=function(f){var x=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(x)){var S=x.id,C=x.groupId,p=x.url;if(f)try{p=f.addDirectives(p)}catch(g){this.warn("Could not construct new URL with HLS Delivery Directives: "+g)}this.log("Loading subtitle playlist for id "+S),this.hls.trigger(s.Events.SUBTITLE_TRACK_LOADING,{url:p,id:S,groupId:C,deliveryDirectives:f||null})}},A.toggleTrackModes=function(f){var x=this,S=this.media,C=this.trackId;if(!!S){var p=E(S.textTracks),g=p.filter(function(b){return b.groupId===x.groupId});if(f===-1)[].slice.call(p).forEach(function(b){b.mode="disabled"});else{var m=g[C];m&&(m.mode="disabled")}var D=g[f];D&&(D.mode=this.subtitleDisplay?"showing":"hidden")}},A.setSubtitleTrack=function(f,x){var S,C=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=f;return}if(this.trackId!==f&&this.toggleTrackModes(f),!(this.trackId===f&&(f===-1||(S=C[f])!==null&&S!==void 0&&S.details)||f<-1||f>=C.length)){this.clearTimer();var p=C[f];if(this.log("Switching to subtitle track "+f),this.trackId=f,p){var g=p.id,m=p.groupId,D=m===void 0?"":m,b=p.name,T=p.type,P=p.url;this.hls.trigger(s.Events.SUBTITLE_TRACK_SWITCH,{id:g,groupId:D,name:b,type:T,url:P});var M=this.switchParams(p.url,x==null?void 0:x.details);this.loadPlaylist(M)}else this.hls.trigger(s.Events.SUBTITLE_TRACK_SWITCH,{id:f})}},A.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var f=-1,x=E(this.media.textTracks),S=0;S<x.length;S++)if(x[S].mode==="hidden")f=S;else if(x[S].mode==="showing"){f=S;break}this.subtitleTrack!==f&&(this.subtitleTrack=f)}},u(_,[{key:"subtitleDisplay",get:function(){return this._subtitleDisplay},set:function(f){this._subtitleDisplay=f,this.trackId>-1&&this.toggleTrackModes(this.trackId)}},{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(f){this.selectDefaultTrack=!1;var x=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(f,x)}}]),_}(o.default);function E(L){for(var _=[],A=0;A<L.length;A++){var v=L[A];v.kind==="subtitles"&&v.label&&_.push(L[A])}return _}i.default=y},"./src/controller/timeline-controller.ts":function(n,i,r){r.r(i),r.d(i,"TimelineController",function(){return L});var s=r("./src/polyfills/number.ts"),a=r("./src/events.ts"),o=r("./src/utils/cea-608-parser.ts"),l=r("./src/utils/output-filter.ts"),c=r("./src/utils/webvtt-parser.ts"),u=r("./src/utils/texttrack-utils.ts"),h=r("./src/utils/imsc1-ttml-parser.ts"),d=r("./src/utils/mp4-tools.ts"),y=r("./src/types/loader.ts"),E=r("./src/utils/logger.ts"),L=function(){function f(S){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=v(),this.captionsProperties=void 0,this.hls=S,this.config=S.config,this.Cues=S.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var C=new l.default(this,"textTrack1"),p=new l.default(this,"textTrack2"),g=new l.default(this,"textTrack3"),m=new l.default(this,"textTrack4");this.cea608Parser1=new o.default(1,C,p),this.cea608Parser2=new o.default(3,g,m)}S.on(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),S.on(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),S.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),S.on(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),S.on(a.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),S.on(a.Events.FRAG_LOADING,this.onFragLoading,this),S.on(a.Events.FRAG_LOADED,this.onFragLoaded,this),S.on(a.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),S.on(a.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),S.on(a.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),S.on(a.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),S.on(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var x=f.prototype;return x.destroy=function(){var C=this.hls;C.off(a.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),C.off(a.Events.MEDIA_DETACHING,this.onMediaDetaching,this),C.off(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),C.off(a.Events.MANIFEST_LOADED,this.onManifestLoaded,this),C.off(a.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),C.off(a.Events.FRAG_LOADING,this.onFragLoading,this),C.off(a.Events.FRAG_LOADED,this.onFragLoaded,this),C.off(a.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),C.off(a.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),C.off(a.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),C.off(a.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),C.off(a.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},x.addCues=function(C,p,g,m,D){for(var b=!1,T=D.length;T--;){var P=D[T],M=A(P[0],P[1],p,g);if(M>=0&&(P[0]=Math.min(P[0],p),P[1]=Math.max(P[1],g),b=!0,M/(g-p)>.5))return}if(b||D.push([p,g]),this.config.renderTextTracksNatively){var O=this.captionsTracks[C];this.Cues.newCue(O,p,g,m)}else{var R=this.Cues.newCue(null,p,g,m);this.hls.trigger(a.Events.CUES_PARSED,{type:"captions",cues:R,track:C})}},x.onInitPtsFound=function(C,p){var g=this,m=p.frag,D=p.id,b=p.initPTS,T=p.timescale,P=this.unparsedVttFrags;D==="main"&&(this.initPTS[m.cc]=b,this.timescale[m.cc]=T),P.length&&(this.unparsedVttFrags=[],P.forEach(function(M){g.onFragLoaded(a.Events.FRAG_LOADED,M)}))},x.getExistingTrack=function(C){var p=this.media;if(p)for(var g=0;g<p.textTracks.length;g++){var m=p.textTracks[g];if(m[C])return m}return null},x.createCaptionsTrack=function(C){this.config.renderTextTracksNatively?this.createNativeTrack(C):this.createNonNativeTrack(C)},x.createNativeTrack=function(C){if(!this.captionsTracks[C]){var p=this.captionsProperties,g=this.captionsTracks,m=this.media,D=p[C],b=D.label,T=D.languageCode,P=this.getExistingTrack(C);if(P)g[C]=P,Object(u.clearCurrentCues)(g[C]),Object(u.sendAddTrackEvent)(g[C],m);else{var M=this.createTextTrack("captions",b,T);M&&(M[C]=!0,g[C]=M)}}},x.createNonNativeTrack=function(C){if(!this.nonNativeCaptionsTracks[C]){var p=this.captionsProperties[C];if(!!p){var g=p.label,m={_id:C,label:g,kind:"captions",default:p.media?!!p.media.default:!1,closedCaptions:p.media};this.nonNativeCaptionsTracks[C]=m,this.hls.trigger(a.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[m]})}}},x.createTextTrack=function(C,p,g){var m=this.media;if(!!m)return m.addTextTrack(C,p,g)},x.onMediaAttaching=function(C,p){this.media=p.media,this._cleanTracks()},x.onMediaDetaching=function(){var C=this.captionsTracks;Object.keys(C).forEach(function(p){Object(u.clearCurrentCues)(C[p]),delete C[p]}),this.nonNativeCaptionsTracks={}},x.onManifestLoading=function(){this.lastSn=-1,this.lastPartIndex=-1,this.prevCC=-1,this.vttCCs=v(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},x._cleanTracks=function(){var C=this.media;if(!!C){var p=C.textTracks;if(p)for(var g=0;g<p.length;g++)Object(u.clearCurrentCues)(p[g])}},x.onSubtitleTracksUpdated=function(C,p){var g=this;this.textTracks=[];var m=p.subtitleTracks||[],D=m.some(function(M){return M.textCodec===h.IMSC1_CODEC});if(this.config.enableWebVTT||D&&this.config.enableIMSC1){var b=this.tracks&&m&&this.tracks.length===m.length;if(this.tracks=m||[],this.config.renderTextTracksNatively){var T=this.media?this.media.textTracks:[];this.tracks.forEach(function(M,O){var R;if(O<T.length){for(var I=null,w=0;w<T.length;w++)if(_(T[w],M)){I=T[w];break}I&&(R=I)}if(R)Object(u.clearCurrentCues)(R);else{var k=g._captionsOrSubtitlesFromCharacteristics(M);R=g.createTextTrack(k,M.name,M.lang),R&&(R.mode="disabled")}R&&(R.groupId=M.groupId,g.textTracks.push(R))})}else if(!b&&this.tracks&&this.tracks.length){var P=this.tracks.map(function(M){return{label:M.name,kind:M.type.toLowerCase(),default:M.default,subtitleTrack:M}});this.hls.trigger(a.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:P})}}},x._captionsOrSubtitlesFromCharacteristics=function(C){var p;if((p=C.attrs)!==null&&p!==void 0&&p.CHARACTERISTICS){var g=/transcribes-spoken-dialog/gi.test(C.attrs.CHARACTERISTICS),m=/describes-music-and-sound/gi.test(C.attrs.CHARACTERISTICS);if(g&&m)return"captions"}return"subtitles"},x.onManifestLoaded=function(C,p){var g=this;this.config.enableCEA708Captions&&p.captions&&p.captions.forEach(function(m){var D=/(?:CC|SERVICE)([1-4])/.exec(m.instreamId);if(!!D){var b="textTrack"+D[1],T=g.captionsProperties[b];!T||(T.label=m.name,m.lang&&(T.languageCode=m.lang),T.media=m)}})},x.onFragLoading=function(C,p){var g=this.cea608Parser1,m=this.cea608Parser2,D=this.lastSn,b=this.lastPartIndex;if(!(!this.enabled||!(g&&m))&&p.frag.type===y.PlaylistLevelType.MAIN){var T,P,M=p.frag.sn,O=(T=p==null||(P=p.part)===null||P===void 0?void 0:P.index)!=null?T:-1;M===D+1||M===D&&O===b+1||(g.reset(),m.reset()),this.lastSn=M,this.lastPartIndex=O}},x.onFragLoaded=function(C,p){var g=p.frag,m=p.payload,D=this.initPTS,b=this.unparsedVttFrags;if(g.type===y.PlaylistLevelType.SUBTITLE)if(m.byteLength){if(!Object(s.isFiniteNumber)(D[g.cc])){b.push(p),D.length&&this.hls.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:g,error:new Error("Missing initial subtitle PTS")});return}var T=g.decryptdata,P="stats"in p;if(T==null||T.key==null||T.method!=="AES-128"||P){var M=this.tracks[g.level],O=this.vttCCs;O[g.cc]||(O[g.cc]={start:g.start,prevCC:this.prevCC,new:!0},this.prevCC=g.cc),M&&M.textCodec===h.IMSC1_CODEC?this._parseIMSC1(g,m):this._parseVTTs(g,m,O)}}else this.hls.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:g,error:new Error("Empty subtitle payload")})},x._parseIMSC1=function(C,p){var g=this,m=this.hls;Object(h.parseIMSC1)(p,this.initPTS[C.cc],this.timescale[C.cc],function(D){g._appendCues(D,C.level),m.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:C})},function(D){E.logger.log("Failed to parse IMSC1: "+D),m.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:C,error:D})})},x._parseVTTs=function(C,p,g){var m,D=this,b=this.hls,T=(m=C.initSegment)!==null&&m!==void 0&&m.data?Object(d.appendUint8Array)(C.initSegment.data,new Uint8Array(p)):p;Object(c.parseWebVTT)(T,this.initPTS[C.cc],this.timescale[C.cc],g,C.cc,C.start,function(P){D._appendCues(P,C.level),b.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:C})},function(P){D._fallbackToIMSC1(C,p),E.logger.log("Failed to parse VTT cue: "+P),b.trigger(a.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:C,error:P})})},x._fallbackToIMSC1=function(C,p){var g=this,m=this.tracks[C.level];m.textCodec||Object(h.parseIMSC1)(p,this.initPTS[C.cc],this.timescale[C.cc],function(){m.textCodec=h.IMSC1_CODEC,g._parseIMSC1(C,p)},function(){m.textCodec="wvtt"})},x._appendCues=function(C,p){var g=this.hls;if(this.config.renderTextTracksNatively){var m=this.textTracks[p];if(!m||m.mode==="disabled")return;C.forEach(function(T){return Object(u.addCueToTrack)(m,T)})}else{var D=this.tracks[p];if(!D)return;var b=D.default?"default":"subtitles"+p;g.trigger(a.Events.CUES_PARSED,{type:"subtitles",cues:C,track:b})}},x.onFragDecrypted=function(C,p){var g=p.frag;if(g.type===y.PlaylistLevelType.SUBTITLE){if(!Object(s.isFiniteNumber)(this.initPTS[g.cc])){this.unparsedVttFrags.push(p);return}this.onFragLoaded(a.Events.FRAG_LOADED,p)}},x.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},x.onFragParsingUserdata=function(C,p){var g=this.cea608Parser1,m=this.cea608Parser2;if(!(!this.enabled||!(g&&m)))for(var D=0;D<p.samples.length;D++){var b=p.samples[D].bytes;if(b){var T=this.extractCea608Data(b);g.addData(p.samples[D].pts,T[0]),m.addData(p.samples[D].pts,T[1])}}},x.onBufferFlushing=function(C,p){var g=p.startOffset,m=p.endOffset,D=p.endOffsetSubtitles,b=p.type,T=this.media;if(!(!T||T.currentTime<m)){if(!b||b==="video"){var P=this.captionsTracks;Object.keys(P).forEach(function(O){return Object(u.removeCuesInRange)(P[O],g,m)})}if(this.config.renderTextTracksNatively&&g===0&&D!==void 0){var M=this.textTracks;Object.keys(M).forEach(function(O){return Object(u.removeCuesInRange)(M[O],g,D)})}}},x.extractCea608Data=function(C){for(var p=[[],[]],g=C[0]&31,m=2,D=0;D<g;D++){var b=C[m++],T=127&C[m++],P=127&C[m++];if(!(T===0&&P===0)){var M=(4&b)!==0;if(M){var O=3&b;(O===0||O===1)&&(p[O].push(T),p[O].push(P))}}}return p},f}();function _(f,x){return f&&f.label===x.name&&!(f.textTrack1||f.textTrack2)}function A(f,x,S,C){return Math.min(x,C)-Math.max(f,S)}function v(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!0}}}},"./src/crypt/aes-crypto.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return s});var s=function(){function a(l,c){this.subtle=void 0,this.aesIV=void 0,this.subtle=l,this.aesIV=c}var o=a.prototype;return o.decrypt=function(c,u){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},u,c)},a}()},"./src/crypt/aes-decryptor.ts":function(n,i,r){r.r(i),r.d(i,"removePadding",function(){return a}),r.d(i,"default",function(){return o});var s=r("./src/utils/typed-array.ts");function a(l){var c=l.byteLength,u=c&&new DataView(l.buffer).getUint8(c-1);return u?Object(s.sliceUint8)(l,0,c-u):l}var o=function(){function l(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var c=l.prototype;return c.uint8ArrayToUint32Array_=function(h){for(var d=new DataView(h),y=new Uint32Array(4),E=0;E<4;E++)y[E]=d.getUint32(E*4);return y},c.initTable=function(){var h=this.sBox,d=this.invSBox,y=this.subMix,E=y[0],L=y[1],_=y[2],A=y[3],v=this.invSubMix,f=v[0],x=v[1],S=v[2],C=v[3],p=new Uint32Array(256),g=0,m=0,D=0;for(D=0;D<256;D++)D<128?p[D]=D<<1:p[D]=D<<1^283;for(D=0;D<256;D++){var b=m^m<<1^m<<2^m<<3^m<<4;b=b>>>8^b&255^99,h[g]=b,d[b]=g;var T=p[g],P=p[T],M=p[P],O=p[b]*257^b*16843008;E[g]=O<<24|O>>>8,L[g]=O<<16|O>>>16,_[g]=O<<8|O>>>24,A[g]=O,O=M*16843009^P*65537^T*257^g*16843008,f[b]=O<<24|O>>>8,x[b]=O<<16|O>>>16,S[b]=O<<8|O>>>24,C[b]=O,g?(g=T^p[p[p[M^T]]],m^=p[p[m]]):g=m=1}},c.expandKey=function(h){for(var d=this.uint8ArrayToUint32Array_(h),y=!0,E=0;E<d.length&&y;)y=d[E]===this.key[E],E++;if(!y){this.key=d;var L=this.keySize=d.length;if(L!==4&&L!==6&&L!==8)throw new Error("Invalid aes key size="+L);var _=this.ksRows=(L+6+1)*4,A,v,f=this.keySchedule=new Uint32Array(_),x=this.invKeySchedule=new Uint32Array(_),S=this.sBox,C=this.rcon,p=this.invSubMix,g=p[0],m=p[1],D=p[2],b=p[3],T,P;for(A=0;A<_;A++){if(A<L){T=f[A]=d[A];continue}P=T,A%L===0?(P=P<<8|P>>>24,P=S[P>>>24]<<24|S[P>>>16&255]<<16|S[P>>>8&255]<<8|S[P&255],P^=C[A/L|0]<<24):L>6&&A%L===4&&(P=S[P>>>24]<<24|S[P>>>16&255]<<16|S[P>>>8&255]<<8|S[P&255]),f[A]=T=(f[A-L]^P)>>>0}for(v=0;v<_;v++)A=_-v,v&3?P=f[A]:P=f[A-4],v<4||A<=4?x[v]=P:x[v]=g[S[P>>>24]]^m[S[P>>>16&255]]^D[S[P>>>8&255]]^b[S[P&255]],x[v]=x[v]>>>0}},c.networkToHostOrderSwap=function(h){return h<<24|(h&65280)<<8|(h&16711680)>>8|h>>>24},c.decrypt=function(h,d,y){for(var E=this.keySize+6,L=this.invKeySchedule,_=this.invSBox,A=this.invSubMix,v=A[0],f=A[1],x=A[2],S=A[3],C=this.uint8ArrayToUint32Array_(y),p=C[0],g=C[1],m=C[2],D=C[3],b=new Int32Array(h),T=new Int32Array(b.length),P,M,O,R,I,w,k,B,F,N,K,H,U,j,$=this.networkToHostOrderSwap;d<b.length;){for(F=$(b[d]),N=$(b[d+1]),K=$(b[d+2]),H=$(b[d+3]),I=F^L[0],w=H^L[1],k=K^L[2],B=N^L[3],U=4,j=1;j<E;j++)P=v[I>>>24]^f[w>>16&255]^x[k>>8&255]^S[B&255]^L[U],M=v[w>>>24]^f[k>>16&255]^x[B>>8&255]^S[I&255]^L[U+1],O=v[k>>>24]^f[B>>16&255]^x[I>>8&255]^S[w&255]^L[U+2],R=v[B>>>24]^f[I>>16&255]^x[w>>8&255]^S[k&255]^L[U+3],I=P,w=M,k=O,B=R,U=U+4;P=_[I>>>24]<<24^_[w>>16&255]<<16^_[k>>8&255]<<8^_[B&255]^L[U],M=_[w>>>24]<<24^_[k>>16&255]<<16^_[B>>8&255]<<8^_[I&255]^L[U+1],O=_[k>>>24]<<24^_[B>>16&255]<<16^_[I>>8&255]<<8^_[w&255]^L[U+2],R=_[B>>>24]<<24^_[I>>16&255]<<16^_[w>>8&255]<<8^_[k&255]^L[U+3],T[d]=$(P^p),T[d+1]=$(R^g),T[d+2]=$(O^m),T[d+3]=$(M^D),p=F,g=N,m=K,D=H,d=d+4}return T.buffer},l}()},"./src/crypt/decrypter.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return d});var s=r("./src/crypt/aes-crypto.ts"),a=r("./src/crypt/fast-aes-key.ts"),o=r("./src/crypt/aes-decryptor.ts"),l=r("./src/utils/logger.ts"),c=r("./src/utils/mp4-tools.ts"),u=r("./src/utils/typed-array.ts"),h=16,d=function(){function y(L,_,A){var v=A===void 0?{}:A,f=v.removePKCS7Padding,x=f===void 0?!0:f;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=L,this.config=_,this.removePKCS7Padding=x,x)try{var S=self.crypto;S&&(this.subtle=S.subtle||S.webkitSubtle)}catch{}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var E=y.prototype;return E.destroy=function(){this.observer=null},E.isSync=function(){return this.config.enableSoftwareAES},E.flush=function(){var _=this.currentResult;if(!_){this.reset();return}var A=new Uint8Array(_);return this.reset(),this.removePKCS7Padding?Object(o.removePadding)(A):A},E.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},E.decrypt=function(_,A,v,f){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(_),A,v);var x=this.flush();x&&f(x.buffer)}else this.webCryptoDecrypt(new Uint8Array(_),A,v).then(f)},E.softwareDecrypt=function(_,A,v){var f=this.currentIV,x=this.currentResult,S=this.remainderData;this.logOnce("JS AES decrypt"),S&&(_=Object(c.appendUint8Array)(S,_),this.remainderData=null);var C=this.getValidChunk(_);if(!C.length)return null;f&&(v=f);var p=this.softwareDecrypter;p||(p=this.softwareDecrypter=new o.default),p.expandKey(A);var g=x;return this.currentResult=p.decrypt(C.buffer,0,v),this.currentIV=Object(u.sliceUint8)(C,-16).buffer,g||null},E.webCryptoDecrypt=function(_,A,v){var f=this,x=this.subtle;return(this.key!==A||!this.fastAesKey)&&(this.key=A,this.fastAesKey=new a.default(x,A)),this.fastAesKey.expandKey().then(function(S){if(!x)return Promise.reject(new Error("web crypto not initialized"));var C=new s.default(x,v);return C.decrypt(_.buffer,S)}).catch(function(S){return f.onWebCryptoError(S,_,A,v)})},E.onWebCryptoError=function(_,A,v,f){return l.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",_),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(A,v,f)},E.getValidChunk=function(_){var A=_,v=_.length-_.length%h;return v!==_.length&&(A=Object(u.sliceUint8)(_,0,v),this.remainderData=Object(u.sliceUint8)(_,v)),A},E.logOnce=function(_){!this.logEnabled||(l.logger.log("[decrypter.ts]: "+_),this.logEnabled=!1)},y}()},"./src/crypt/fast-aes-key.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return s});var s=function(){function a(l,c){this.subtle=void 0,this.key=void 0,this.subtle=l,this.key=c}var o=a.prototype;return o.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},a}()},"./src/demux/aacdemuxer.ts":function(n,i,r){r.r(i);var s=r("./src/demux/base-audio-demuxer.ts"),a=r("./src/demux/adts.ts"),o=r("./src/utils/logger.ts"),l=r("./src/demux/id3.ts");function c(d,y){d.prototype=Object.create(y.prototype),d.prototype.constructor=d,u(d,y)}function u(d,y){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(L,_){return L.__proto__=_,L},u(d,y)}var h=function(d){c(y,d);function y(L,_){var A;return A=d.call(this)||this,A.observer=void 0,A.config=void 0,A.observer=L,A.config=_,A}var E=y.prototype;return E.resetInitSegment=function(_,A,v,f){d.prototype.resetInitSegment.call(this,_,A,v,f),this._audioTrack={container:"audio/adts",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"aac",samples:[],manifestCodec:A,duration:f,inputTimeScale:9e4,dropped:0}},y.probe=function(_){if(!_)return!1;for(var A=l.getID3Data(_,0)||[],v=A.length,f=_.length;v<f;v++)if(a.probe(_,v))return o.logger.log("ADTS sync word found !"),!0;return!1},E.canParse=function(_,A){return a.canParse(_,A)},E.appendFrame=function(_,A,v){a.initTrackConfig(_,this.observer,A,v,_.manifestCodec);var f=a.appendFrame(_,A,v,this.basePTS,this.frameIndex);if(f&&f.missing===0)return f},y}(s.default);i.default=h},"./src/demux/adts.ts":function(n,i,r){r.r(i),r.d(i,"getAudioConfig",function(){return l}),r.d(i,"isHeaderPattern",function(){return c}),r.d(i,"getHeaderLength",function(){return u}),r.d(i,"getFullFrameLength",function(){return h}),r.d(i,"canGetFrameLength",function(){return d}),r.d(i,"isHeader",function(){return y}),r.d(i,"canParse",function(){return E}),r.d(i,"probe",function(){return L}),r.d(i,"initTrackConfig",function(){return _}),r.d(i,"getFrameDuration",function(){return A}),r.d(i,"parseFrameHeader",function(){return v}),r.d(i,"appendFrame",function(){return f});var s=r("./src/utils/logger.ts"),a=r("./src/errors.ts"),o=r("./src/events.ts");function l(x,S,C,p){var g,m,D,b,T=navigator.userAgent.toLowerCase(),P=p,M=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];g=((S[C+2]&192)>>>6)+1;var O=(S[C+2]&60)>>>2;if(O>M.length-1){x.trigger(o.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+O});return}return D=(S[C+2]&1)<<2,D|=(S[C+3]&192)>>>6,s.logger.log("manifest codec:"+p+", ADTS type:"+g+", samplingIndex:"+O),/firefox/i.test(T)?O>=6?(g=5,b=new Array(4),m=O-3):(g=2,b=new Array(2),m=O):T.indexOf("android")!==-1?(g=2,b=new Array(2),m=O):(g=5,b=new Array(4),p&&(p.indexOf("mp4a.40.29")!==-1||p.indexOf("mp4a.40.5")!==-1)||!p&&O>=6?m=O-3:((p&&p.indexOf("mp4a.40.2")!==-1&&(O>=6&&D===1||/vivaldi/i.test(T))||!p&&D===1)&&(g=2,b=new Array(2)),m=O)),b[0]=g<<3,b[0]|=(O&14)>>1,b[1]|=(O&1)<<7,b[1]|=D<<3,g===5&&(b[1]|=(m&14)>>1,b[2]=(m&1)<<7,b[2]|=2<<2,b[3]=0),{config:b,samplerate:M[O],channelCount:D,codec:"mp4a.40."+g,manifestCodec:P}}function c(x,S){return x[S]===255&&(x[S+1]&246)===240}function u(x,S){return x[S+1]&1?7:9}function h(x,S){return(x[S+3]&3)<<11|x[S+4]<<3|(x[S+5]&224)>>>5}function d(x,S){return S+5<x.length}function y(x,S){return S+1<x.length&&c(x,S)}function E(x,S){return d(x,S)&&c(x,S)&&h(x,S)<=x.length-S}function L(x,S){if(y(x,S)){var C=u(x,S);if(S+C>=x.length)return!1;var p=h(x,S);if(p<=C)return!1;var g=S+p;return g===x.length||y(x,g)}return!1}function _(x,S,C,p,g){if(!x.samplerate){var m=l(S,C,p,g);if(!m)return;x.config=m.config,x.samplerate=m.samplerate,x.channelCount=m.channelCount,x.codec=m.codec,x.manifestCodec=m.manifestCodec,s.logger.log("parsed codec:"+x.codec+", rate:"+m.samplerate+", channels:"+m.channelCount)}}function A(x){return 1024*9e4/x}function v(x,S){var C=u(x,S);if(S+C<=x.length){var p=h(x,S)-C;if(p>0)return{headerLength:C,frameLength:p}}}function f(x,S,C,p,g){var m=A(x.samplerate),D=p+g*m,b=v(S,C),T;if(b){var P=b.frameLength,M=b.headerLength,O=M+P,R=Math.max(0,C+O-S.length);R?(T=new Uint8Array(O-M),T.set(S.subarray(C+M,S.length),0)):T=S.subarray(C+M,C+O);var I={unit:T,pts:D};return R||x.samples.push(I),{sample:I,length:O,missing:R}}var w=S.length-C;T=new Uint8Array(w),T.set(S.subarray(C,S.length),0);var k={unit:T,pts:D};return{sample:k,length:w,missing:-1}}},"./src/demux/base-audio-demuxer.ts":function(n,i,r){r.r(i),r.d(i,"initPTSFn",function(){return d});var s=r("./src/polyfills/number.ts"),a=r("./src/demux/id3.ts"),o=r("./src/types/demuxer.ts"),l=r("./src/demux/dummy-demuxed-track.ts"),c=r("./src/utils/mp4-tools.ts"),u=r("./src/utils/typed-array.ts"),h=function(){function y(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.basePTS=null,this.initPTS=null}var E=y.prototype;return E.resetInitSegment=function(_,A,v,f){this._id3Track={type:"id3",id:3,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},E.resetTimeStamp=function(_){this.initPTS=_,this.resetContiguity()},E.resetContiguity=function(){this.basePTS=null,this.frameIndex=0},E.canParse=function(_,A){return!1},E.appendFrame=function(_,A,v){},E.demux=function(_,A){this.cachedData&&(_=Object(c.appendUint8Array)(this.cachedData,_),this.cachedData=null);var v=a.getID3Data(_,0),f=v?v.length:0,x,S,C=this._audioTrack,p=this._id3Track,g=v?a.getTimeStamp(v):void 0,m=_.length;for((this.basePTS===null||this.frameIndex===0&&Object(s.isFiniteNumber)(g))&&(this.basePTS=d(g,A,this.initPTS)),v&&v.length>0&&p.samples.push({pts:this.basePTS,dts:this.basePTS,data:v,type:o.MetadataSchema.audioId3}),S=this.basePTS;f<m;){if(this.canParse(_,f)){var D=this.appendFrame(C,_,f);D?(this.frameIndex++,S=D.sample.pts,f+=D.length,x=f):f=m}else a.canParse(_,f)?(v=a.getID3Data(_,f),p.samples.push({pts:S,dts:S,data:v,type:o.MetadataSchema.audioId3}),f+=v.length,x=f):f++;if(f===m&&x!==m){var b=Object(u.sliceUint8)(_,x);this.cachedData?this.cachedData=Object(c.appendUint8Array)(this.cachedData,b):this.cachedData=b}}return{audioTrack:C,videoTrack:Object(l.dummyTrack)(),id3Track:p,textTrack:Object(l.dummyTrack)()}},E.demuxSampleAes=function(_,A,v){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},E.flush=function(_){var A=this.cachedData;return A&&(this.cachedData=null,this.demux(A,0)),{audioTrack:this._audioTrack,videoTrack:Object(l.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(l.dummyTrack)()}},E.destroy=function(){},y}(),d=function(E,L,_){return Object(s.isFiniteNumber)(E)?E*90:L*9e4+(_||0)};i.default=h},"./src/demux/chunk-cache.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return s});var s=function(){function o(){this.chunks=[],this.dataLength=0}var l=o.prototype;return l.push=function(u){this.chunks.push(u),this.dataLength+=u.length},l.flush=function(){var u=this.chunks,h=this.dataLength,d;if(u.length)u.length===1?d=u[0]:d=a(u,h);else return new Uint8Array(0);return this.reset(),d},l.reset=function(){this.chunks.length=0,this.dataLength=0},o}();function a(o,l){for(var c=new Uint8Array(l),u=0,h=0;h<o.length;h++){var d=o[h];c.set(d,u),u+=d.length}return c}},"./src/demux/dummy-demuxed-track.ts":function(n,i,r){r.r(i),r.d(i,"dummyTrack",function(){return s});function s(a,o){return a===void 0&&(a=""),o===void 0&&(o=9e4),{type:a,id:-1,pid:-1,inputTimeScale:o,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":function(n,i,r){r.r(i);var s=r("./src/utils/logger.ts"),a=function(){function o(c){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=c,this.bytesAvailable=c.byteLength,this.word=0,this.bitsAvailable=0}var l=o.prototype;return l.loadWord=function(){var u=this.data,h=this.bytesAvailable,d=u.byteLength-h,y=new Uint8Array(4),E=Math.min(4,h);if(E===0)throw new Error("no bytes available");y.set(u.subarray(d,d+E)),this.word=new DataView(y.buffer).getUint32(0),this.bitsAvailable=E*8,this.bytesAvailable-=E},l.skipBits=function(u){var h;this.bitsAvailable>u?(this.word<<=u,this.bitsAvailable-=u):(u-=this.bitsAvailable,h=u>>3,u-=h>>3,this.bytesAvailable-=h,this.loadWord(),this.word<<=u,this.bitsAvailable-=u)},l.readBits=function(u){var h=Math.min(this.bitsAvailable,u),d=this.word>>>32-h;return u>32&&s.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=h,this.bitsAvailable>0?this.word<<=h:this.bytesAvailable>0&&this.loadWord(),h=u-h,h>0&&this.bitsAvailable?d<<h|this.readBits(h):d},l.skipLZ=function(){var u;for(u=0;u<this.bitsAvailable;++u)if((this.word&2147483648>>>u)!==0)return this.word<<=u,this.bitsAvailable-=u,u;return this.loadWord(),u+this.skipLZ()},l.skipUEG=function(){this.skipBits(1+this.skipLZ())},l.skipEG=function(){this.skipBits(1+this.skipLZ())},l.readUEG=function(){var u=this.skipLZ();return this.readBits(u+1)-1},l.readEG=function(){var u=this.readUEG();return 1&u?1+u>>>1:-1*(u>>>1)},l.readBoolean=function(){return this.readBits(1)===1},l.readUByte=function(){return this.readBits(8)},l.readUShort=function(){return this.readBits(16)},l.readUInt=function(){return this.readBits(32)},l.skipScalingList=function(u){for(var h=8,d=8,y,E=0;E<u;E++)d!==0&&(y=this.readEG(),d=(h+y+256)%256),h=d===0?h:d},l.readSPS=function(){var u=0,h=0,d=0,y=0,E,L,_,A=this.readUByte.bind(this),v=this.readBits.bind(this),f=this.readUEG.bind(this),x=this.readBoolean.bind(this),S=this.skipBits.bind(this),C=this.skipEG.bind(this),p=this.skipUEG.bind(this),g=this.skipScalingList.bind(this);A();var m=A();if(v(5),S(3),A(),p(),m===100||m===110||m===122||m===244||m===44||m===83||m===86||m===118||m===128){var D=f();if(D===3&&S(1),p(),p(),S(1),x())for(L=D!==3?8:12,_=0;_<L;_++)x()&&(_<6?g(16):g(64))}p();var b=f();if(b===0)f();else if(b===1)for(S(1),C(),C(),E=f(),_=0;_<E;_++)C();p(),S(1);var T=f(),P=f(),M=v(1);M===0&&S(1),S(1),x()&&(u=f(),h=f(),d=f(),y=f());var O=[1,1];if(x()&&x()){var R=A();switch(R){case 1:O=[1,1];break;case 2:O=[12,11];break;case 3:O=[10,11];break;case 4:O=[16,11];break;case 5:O=[40,33];break;case 6:O=[24,11];break;case 7:O=[20,11];break;case 8:O=[32,11];break;case 9:O=[80,33];break;case 10:O=[18,11];break;case 11:O=[15,11];break;case 12:O=[64,33];break;case 13:O=[160,99];break;case 14:O=[4,3];break;case 15:O=[3,2];break;case 16:O=[2,1];break;case 255:{O=[A()<<8|A(),A()<<8|A()];break}}}return{width:Math.ceil((T+1)*16-u*2-h*2),height:(2-M)*(P+1)*16-(M?2:4)*(d+y),pixelRatio:O}},l.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},o}();i.default=a},"./src/demux/id3.ts":function(n,i,r){r.r(i),r.d(i,"isHeader",function(){return s}),r.d(i,"isFooter",function(){return a}),r.d(i,"getID3Data",function(){return o}),r.d(i,"canParse",function(){return c}),r.d(i,"getTimeStamp",function(){return u}),r.d(i,"isTimeStampFrame",function(){return h}),r.d(i,"getID3Frames",function(){return y}),r.d(i,"decodeFrame",function(){return E}),r.d(i,"utf8ArrayToStr",function(){return f}),r.d(i,"testables",function(){return x});var s=function(g,m){return m+10<=g.length&&g[m]===73&&g[m+1]===68&&g[m+2]===51&&g[m+3]<255&&g[m+4]<255&&g[m+6]<128&&g[m+7]<128&&g[m+8]<128&&g[m+9]<128},a=function(g,m){return m+10<=g.length&&g[m]===51&&g[m+1]===68&&g[m+2]===73&&g[m+3]<255&&g[m+4]<255&&g[m+6]<128&&g[m+7]<128&&g[m+8]<128&&g[m+9]<128},o=function(g,m){for(var D=m,b=0;s(g,m);){b+=10;var T=l(g,m+6);b+=T,a(g,m+10)&&(b+=10),m+=b}if(b>0)return g.subarray(D,D+b)},l=function(g,m){var D=0;return D=(g[m]&127)<<21,D|=(g[m+1]&127)<<14,D|=(g[m+2]&127)<<7,D|=g[m+3]&127,D},c=function(g,m){return s(g,m)&&l(g,m+6)+10<=g.length-m},u=function(g){for(var m=y(g),D=0;D<m.length;D++){var b=m[D];if(h(b))return v(b)}},h=function(g){return g&&g.key==="PRIV"&&g.info==="com.apple.streaming.transportStreamTimestamp"},d=function(g){var m=String.fromCharCode(g[0],g[1],g[2],g[3]),D=l(g,4),b=10;return{type:m,size:D,data:g.subarray(b,b+D)}},y=function(g){for(var m=0,D=[];s(g,m);){var b=l(g,m+6);m+=10;for(var T=m+b;m+8<T;){var P=d(g.subarray(m)),M=E(P);M&&D.push(M),m+=P.size+10}a(g,m)&&(m+=10)}return D},E=function(g){return g.type==="PRIV"?L(g):g.type[0]==="W"?A(g):_(g)},L=function(g){if(!(g.size<2)){var m=f(g.data,!0),D=new Uint8Array(g.data.subarray(m.length+1));return{key:g.type,info:m,data:D.buffer}}},_=function(g){if(!(g.size<2)){if(g.type==="TXXX"){var m=1,D=f(g.data.subarray(m),!0);m+=D.length+1;var b=f(g.data.subarray(m));return{key:g.type,info:D,data:b}}var T=f(g.data.subarray(1));return{key:g.type,data:T}}},A=function(g){if(g.type==="WXXX"){if(g.size<2)return;var m=1,D=f(g.data.subarray(m),!0);m+=D.length+1;var b=f(g.data.subarray(m));return{key:g.type,info:D,data:b}}var T=f(g.data);return{key:g.type,data:T}},v=function(g){if(g.data.byteLength===8){var m=new Uint8Array(g.data),D=m[3]&1,b=(m[4]<<23)+(m[5]<<15)+(m[6]<<7)+m[7];return b/=45,D&&(b+=4772185884e-2),Math.round(b)}},f=function(g,m){m===void 0&&(m=!1);var D=C();if(D){var b=D.decode(g);if(m){var T=b.indexOf("\0");return T!==-1?b.substring(0,T):b}return b.replace(/\0/g,"")}for(var P=g.length,M,O,R,I="",w=0;w<P;){if(M=g[w++],M===0&&m)return I;if(M===0||M===3)continue;switch(M>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:I+=String.fromCharCode(M);break;case 12:case 13:O=g[w++],I+=String.fromCharCode((M&31)<<6|O&63);break;case 14:O=g[w++],R=g[w++],I+=String.fromCharCode((M&15)<<12|(O&63)<<6|(R&63)<<0);break}}return I},x={decodeTextFrame:_},S;function C(){return!S&&typeof self.TextDecoder<"u"&&(S=new self.TextDecoder("utf-8")),S}},"./src/demux/mp3demuxer.ts":function(n,i,r){r.r(i);var s=r("./src/demux/base-audio-demuxer.ts"),a=r("./src/demux/id3.ts"),o=r("./src/utils/logger.ts"),l=r("./src/demux/mpegaudio.ts");function c(d,y){d.prototype=Object.create(y.prototype),d.prototype.constructor=d,u(d,y)}function u(d,y){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(L,_){return L.__proto__=_,L},u(d,y)}var h=function(d){c(y,d);function y(){return d.apply(this,arguments)||this}var E=y.prototype;return E.resetInitSegment=function(_,A,v,f){d.prototype.resetInitSegment.call(this,_,A,v,f),this._audioTrack={container:"audio/mpeg",type:"audio",id:2,pid:-1,sequenceNumber:0,segmentCodec:"mp3",samples:[],manifestCodec:A,duration:f,inputTimeScale:9e4,dropped:0}},y.probe=function(_){if(!_)return!1;for(var A=a.getID3Data(_,0)||[],v=A.length,f=_.length;v<f;v++)if(l.probe(_,v))return o.logger.log("MPEG Audio sync word found !"),!0;return!1},E.canParse=function(_,A){return l.canParse(_,A)},E.appendFrame=function(_,A,v){if(this.basePTS!==null)return l.appendFrame(_,A,v,this.basePTS,this.frameIndex)},y}(s.default);i.default=h},"./src/demux/mp4demuxer.ts":function(n,i,r){r.r(i);var s=r("./src/polyfills/number.ts"),a=r("./src/types/demuxer.ts"),o=r("./src/utils/mp4-tools.ts"),l=r("./src/demux/dummy-demuxed-track.ts"),c=/\/emsg[-/]ID3/i,u=function(){function h(y,E){this.remainderData=null,this.timeOffset=0,this.config=void 0,this.videoTrack=void 0,this.audioTrack=void 0,this.id3Track=void 0,this.txtTrack=void 0,this.config=E}var d=h.prototype;return d.resetTimeStamp=function(){},d.resetInitSegment=function(E,L,_,A){var v=Object(o.parseInitSegment)(E),f=this.videoTrack=Object(l.dummyTrack)("video",1),x=this.audioTrack=Object(l.dummyTrack)("audio",1),S=this.txtTrack=Object(l.dummyTrack)("text",1);if(this.id3Track=Object(l.dummyTrack)("id3",1),this.timeOffset=0,v.video){var C=v.video,p=C.id,g=C.timescale,m=C.codec;f.id=p,f.timescale=S.timescale=g,f.codec=m}if(v.audio){var D=v.audio,b=D.id,T=D.timescale,P=D.codec;x.id=b,x.timescale=T,x.codec=P}S.id=o.RemuxerTrackIdConfig.text,f.sampleDuration=0,f.duration=x.duration=A},d.resetContiguity=function(){},h.probe=function(E){return E=E.length>16384?E.subarray(0,16384):E,Object(o.findBox)(E,["moof"]).length>0},d.demux=function(E,L){this.timeOffset=L;var _=E,A=this.videoTrack,v=this.txtTrack;if(this.config.progressive){this.remainderData&&(_=Object(o.appendUint8Array)(this.remainderData,E));var f=Object(o.segmentValidRange)(_);this.remainderData=f.remainder,A.samples=f.valid||new Uint8Array}else A.samples=_;var x=this.extractID3Track(A,L);return v.samples=Object(o.parseSamples)(L,A),{videoTrack:A,audioTrack:this.audioTrack,id3Track:x,textTrack:this.txtTrack}},d.flush=function(){var E=this.timeOffset,L=this.videoTrack,_=this.txtTrack;L.samples=this.remainderData||new Uint8Array,this.remainderData=null;var A=this.extractID3Track(L,this.timeOffset);return _.samples=Object(o.parseSamples)(E,L),{videoTrack:L,audioTrack:Object(l.dummyTrack)(),id3Track:A,textTrack:Object(l.dummyTrack)()}},d.extractID3Track=function(E,L){var _=this.id3Track;if(E.samples.length){var A=Object(o.findBox)(E.samples,["emsg"]);A&&A.forEach(function(v){var f=Object(o.parseEmsg)(v);if(c.test(f.schemeIdUri)){var x=Object(s.isFiniteNumber)(f.presentationTime)?f.presentationTime/f.timeScale:L+f.presentationTimeDelta/f.timeScale,S=f.payload;_.samples.push({data:S,len:S.byteLength,dts:x,pts:x,type:a.MetadataSchema.emsg})}})}return _},d.demuxSampleAes=function(E,L,_){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},d.destroy=function(){},h}();i.default=u},"./src/demux/mpegaudio.ts":function(n,i,r){r.r(i),r.d(i,"appendFrame",function(){return u}),r.d(i,"parseHeader",function(){return h}),r.d(i,"isHeaderPattern",function(){return d}),r.d(i,"isHeader",function(){return y}),r.d(i,"canParse",function(){return E}),r.d(i,"probe",function(){return L});var s=null,a=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],o=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],l=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],c=[0,1,1,4];function u(_,A,v,f,x){if(!(v+24>A.length)){var S=h(A,v);if(S&&v+S.frameLength<=A.length){var C=S.samplesPerFrame*9e4/S.sampleRate,p=f+x*C,g={unit:A.subarray(v,v+S.frameLength),pts:p,dts:p};return _.config=[],_.channelCount=S.channelCount,_.samplerate=S.sampleRate,_.samples.push(g),{sample:g,length:S.frameLength,missing:0}}}}function h(_,A){var v=_[A+1]>>3&3,f=_[A+1]>>1&3,x=_[A+2]>>4&15,S=_[A+2]>>2&3;if(v!==1&&x!==0&&x!==15&&S!==3){var C=_[A+2]>>1&1,p=_[A+3]>>6,g=v===3?3-f:f===3?3:4,m=a[g*14+x-1]*1e3,D=v===3?0:v===2?1:2,b=o[D*3+S],T=p===3?1:2,P=l[v][f],M=c[f],O=P*8*M,R=Math.floor(P*m/b+C)*M;if(s===null){var I=navigator.userAgent||"",w=I.match(/Chrome\/(\d+)/i);s=w?parseInt(w[1]):0}var k=!!s&&s<=87;return k&&f===2&&m>=224e3&&p===0&&(_[A+3]=_[A+3]|128),{sampleRate:b,channelCount:T,frameLength:R,samplesPerFrame:O}}}function d(_,A){return _[A]===255&&(_[A+1]&224)===224&&(_[A+1]&6)!==0}function y(_,A){return A+1<_.length&&d(_,A)}function E(_,A){var v=4;return d(_,A)&&v<=_.length-A}function L(_,A){if(A+1<_.length&&d(_,A)){var v=4,f=h(_,A),x=v;f!=null&&f.frameLength&&(x=f.frameLength);var S=A+x;return S===_.length||y(_,S)}return!1}},"./src/demux/sample-aes.ts":function(n,i,r){r.r(i);var s=r("./src/crypt/decrypter.ts"),a=r("./src/demux/tsdemuxer.ts"),o=function(){function l(u,h,d){this.keyData=void 0,this.decrypter=void 0,this.keyData=d,this.decrypter=new s.default(u,h,{removePKCS7Padding:!1})}var c=l.prototype;return c.decryptBuffer=function(h,d){this.decrypter.decrypt(h,this.keyData.key.buffer,this.keyData.iv.buffer,d)},c.decryptAacSample=function(h,d,y,E){var L=h[d].unit;if(!(L.length<=16)){var _=L.subarray(16,L.length-L.length%16),A=_.buffer.slice(_.byteOffset,_.byteOffset+_.length),v=this;this.decryptBuffer(A,function(f){var x=new Uint8Array(f);L.set(x,16),E||v.decryptAacSamples(h,d+1,y)})}},c.decryptAacSamples=function(h,d,y){for(;;d++){if(d>=h.length){y();return}if(!(h[d].unit.length<32)){var E=this.decrypter.isSync();if(this.decryptAacSample(h,d,y,E),!E)return}}},c.getAvcEncryptedData=function(h){for(var d=Math.floor((h.length-48)/160)*16+16,y=new Int8Array(d),E=0,L=32;L<h.length-16;L+=160,E+=16)y.set(h.subarray(L,L+16),E);return y},c.getAvcDecryptedUnit=function(h,d){for(var y=new Uint8Array(d),E=0,L=32;L<h.length-16;L+=160,E+=16)h.set(y.subarray(E,E+16),L);return h},c.decryptAvcSample=function(h,d,y,E,L,_){var A=Object(a.discardEPB)(L.data),v=this.getAvcEncryptedData(A),f=this;this.decryptBuffer(v.buffer,function(x){L.data=f.getAvcDecryptedUnit(A,x),_||f.decryptAvcSamples(h,d,y+1,E)})},c.decryptAvcSamples=function(h,d,y,E){if(h instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;d++,y=0){if(d>=h.length){E();return}for(var L=h[d].units;!(y>=L.length);y++){var _=L[y];if(!(_.data.length<=48||_.type!==1&&_.type!==5)){var A=this.decrypter.isSync();if(this.decryptAvcSample(h,d,y,E,_,A),!A)return}}}},l}();i.default=o},"./src/demux/transmuxer-interface.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return y});var s=r("./node_modules/webworkify-webpack/index.js"),a=r("./src/events.ts"),o=r("./src/demux/transmuxer.ts"),l=r("./src/utils/logger.ts"),c=r("./src/errors.ts"),u=r("./src/utils/mediasource-helper.ts"),h=r("./node_modules/eventemitter3/index.js"),d=Object(u.getMediaSource)()||{isTypeSupported:function(){return!1}},y=function(){function E(_,A,v,f){var x=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=_,this.id=A,this.onTransmuxComplete=v,this.onFlush=f;var S=_.config,C=function(b,T){T=T||{},T.frag=x.frag,T.id=x.id,_.trigger(b,T)};this.observer=new h.EventEmitter,this.observer.on(a.Events.FRAG_DECRYPTED,C),this.observer.on(a.Events.ERROR,C);var p={mp4:d.isTypeSupported("video/mp4"),mpeg:d.isTypeSupported("audio/mpeg"),mp3:d.isTypeSupported('audio/mp4; codecs="mp3"')},g=navigator.vendor;if(S.enableWorker&&typeof Worker<"u"){l.logger.log("demuxing in webworker");var m;try{m=this.worker=s("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),m.addEventListener("message",this.onwmsg),m.onerror=function(D){_.trigger(a.Events.ERROR,{type:c.ErrorTypes.OTHER_ERROR,details:c.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(D.message+"  ("+D.filename+":"+D.lineno+")")})},m.postMessage({cmd:"init",typeSupported:p,vendor:g,id:A,config:JSON.stringify(S)})}catch(D){l.logger.warn("Error in worker:",D),l.logger.error("Error while initializing DemuxerWorker, fallback to inline"),m&&self.URL.revokeObjectURL(m.objectURL),this.transmuxer=new o.default(this.observer,p,S,g,A),this.worker=null}}else this.transmuxer=new o.default(this.observer,p,S,g,A)}var L=E.prototype;return L.destroy=function(){var A=this.worker;if(A)A.removeEventListener("message",this.onwmsg),A.terminate(),this.worker=null,this.onwmsg=void 0;else{var v=this.transmuxer;v&&(v.destroy(),this.transmuxer=null)}var f=this.observer;f&&f.removeAllListeners(),this.frag=null,this.observer=null,this.hls=null},L.push=function(A,v,f,x,S,C,p,g,m,D){var b,T,P=this;m.transmuxing.start=self.performance.now();var M=this.transmuxer,O=this.worker,R=C?C.start:S.start,I=S.decryptdata,w=this.frag,k=!(w&&S.cc===w.cc),B=!(w&&m.level===w.level),F=w?m.sn-w.sn:-1,N=this.part?m.part-this.part.index:-1,K=F===0&&m.id>1&&m.id===(w==null?void 0:w.stats.chunkCount),H=!B&&(F===1||F===0&&(N===1||K&&N<=0)),U=self.performance.now();(B||F||S.stats.parsing.start===0)&&(S.stats.parsing.start=U),C&&(N||!H)&&(C.stats.parsing.start=U);var j=!(w&&((b=S.initSegment)===null||b===void 0?void 0:b.url)===((T=w.initSegment)===null||T===void 0?void 0:T.url)),$=new o.TransmuxState(k,H,g,B,R,j);if(!H||k||j){l.logger.log("[transmuxer-interface, "+S.type+"]: Starting new transmux session for sn: "+m.sn+" p: "+m.part+" level: "+m.level+" id: "+m.id+`
        discontinuity: `+k+`
        trackSwitch: `+B+`
        contiguous: `+H+`
        accurateTimeOffset: `+g+`
        timeOffset: `+R+`
        initSegmentChange: `+j);var X=new o.TransmuxConfig(f,x,v,p,D);this.configureTransmuxer(X)}if(this.frag=S,this.part=C,O)O.postMessage({cmd:"demux",data:A,decryptdata:I,chunkMeta:m,state:$},A instanceof ArrayBuffer?[A]:[]);else if(M){var Z=M.push(A,I,m,$);Object(o.isPromise)(Z)?Z.then(function(nt){P.handleTransmuxComplete(nt)}):this.handleTransmuxComplete(Z)}},L.flush=function(A){var v=this;A.transmuxing.start=self.performance.now();var f=this.transmuxer,x=this.worker;if(x)x.postMessage({cmd:"flush",chunkMeta:A});else if(f){var S=f.flush(A);Object(o.isPromise)(S)?S.then(function(C){v.handleFlushResult(C,A)}):this.handleFlushResult(S,A)}},L.handleFlushResult=function(A,v){var f=this;A.forEach(function(x){f.handleTransmuxComplete(x)}),this.onFlush(v)},L.onWorkerMessage=function(A){var v=A.data,f=this.hls;switch(v.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(v.data);break}case"flush":{this.onFlush(v.data);break}case"workerLog":l.logger[v.data.logType]&&l.logger[v.data.logType](v.data.message);break;default:{v.data=v.data||{},v.data.frag=this.frag,v.data.id=this.id,f.trigger(v.event,v.data);break}}},L.configureTransmuxer=function(A){var v=this.worker,f=this.transmuxer;v?v.postMessage({cmd:"configure",config:A}):f&&f.configure(A)},L.handleTransmuxComplete=function(A){A.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(A)},E}()},"./src/demux/transmuxer-worker.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return c});var s=r("./src/demux/transmuxer.ts"),a=r("./src/events.ts"),o=r("./src/utils/logger.ts"),l=r("./node_modules/eventemitter3/index.js");function c(E){var L=new l.EventEmitter,_=function(f,x){E.postMessage({event:f,data:x})};L.on(a.Events.FRAG_DECRYPTED,_),L.on(a.Events.ERROR,_);var A=function(){var f=function(C){var p=function(m){_("workerLog",{logType:C,message:m})};o.logger[C]=p};for(var x in o.logger)f(x)};E.addEventListener("message",function(v){var f=v.data;switch(f.cmd){case"init":{var x=JSON.parse(f.config);E.transmuxer=new s.default(L,f.typeSupported,x,f.vendor,f.id),Object(o.enableLogs)(x.debug),A(),_("init",null);break}case"configure":{E.transmuxer.configure(f.config);break}case"demux":{var S=E.transmuxer.push(f.data,f.decryptdata,f.chunkMeta,f.state);Object(s.isPromise)(S)?S.then(function(g){u(E,g)}):u(E,S);break}case"flush":{var C=f.chunkMeta,p=E.transmuxer.flush(C);Object(s.isPromise)(p)?p.then(function(g){d(E,g,C)}):d(E,p,C);break}}})}function u(E,L){if(y(L.remuxResult))return!1;var _=[],A=L.remuxResult,v=A.audio,f=A.video;return v&&h(_,v),f&&h(_,f),E.postMessage({event:"transmuxComplete",data:L},_),!0}function h(E,L){L.data1&&E.push(L.data1.buffer),L.data2&&E.push(L.data2.buffer)}function d(E,L,_){var A=L.reduce(function(v,f){return u(E,f)||v},!1);A||E.postMessage({event:"transmuxComplete",data:L[0]}),E.postMessage({event:"flush",data:_})}function y(E){return!E.audio&&!E.video&&!E.text&&!E.id3&&!E.initSegment}},"./src/demux/transmuxer.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return A}),r.d(i,"isPromise",function(){return x}),r.d(i,"TransmuxConfig",function(){return S}),r.d(i,"TransmuxState",function(){return C});var s=r("./src/events.ts"),a=r("./src/errors.ts"),o=r("./src/crypt/decrypter.ts"),l=r("./src/demux/aacdemuxer.ts"),c=r("./src/demux/mp4demuxer.ts"),u=r("./src/demux/tsdemuxer.ts"),h=r("./src/demux/mp3demuxer.ts"),d=r("./src/remux/mp4-remuxer.ts"),y=r("./src/remux/passthrough-remuxer.ts"),E=r("./src/utils/logger.ts"),L;try{L=self.performance.now.bind(self.performance)}catch{E.logger.debug("Unable to use Performance API on this environment"),L=self.Date.now}var _=[{demux:u.default,remux:d.default},{demux:c.default,remux:y.default},{demux:l.default,remux:d.default},{demux:h.default,remux:d.default}],A=function(){function p(m,D,b,T,P){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.observer=m,this.typeSupported=D,this.config=b,this.vendor=T,this.id=P}var g=p.prototype;return g.configure=function(D){this.transmuxConfig=D,this.decrypter&&this.decrypter.reset()},g.push=function(D,b,T,P){var M=this,O=T.transmuxing;O.executeStart=L();var R=new Uint8Array(D),I=this.config,w=this.currentTransmuxState,k=this.transmuxConfig;P&&(this.currentTransmuxState=P);var B=P||w,F=B.contiguous,N=B.discontinuity,K=B.trackSwitch,H=B.accurateTimeOffset,U=B.timeOffset,j=B.initSegmentChange,$=k.audioCodec,X=k.videoCodec,Z=k.defaultInitPts,nt=k.duration,at=k.initSegmentData;(N||K||j)&&this.resetInitSegment(at,$,X,nt),(N||j)&&this.resetInitialTimestamp(Z),F||this.resetContiguity();var it=v(R,b);if(it&&it.method==="AES-128"){var W=this.getDecrypter();if(I.enableSoftwareAES){var V=W.softwareDecrypt(R,it.key.buffer,it.iv.buffer);if(!V)return O.executeEnd=L(),f(T);R=new Uint8Array(V)}else return this.decryptionPromise=W.webCryptoDecrypt(R,it.key.buffer,it.iv.buffer).then(function(Q){var J=M.push(Q,null,T);return M.decryptionPromise=null,J}),this.decryptionPromise}this.needsProbing(R,N,K)&&this.configureTransmuxer(R,k);var z=this.transmux(R,it,U,H,T),Y=this.currentTransmuxState;return Y.contiguous=!0,Y.discontinuity=!1,Y.trackSwitch=!1,O.executeEnd=L(),z},g.flush=function(D){var b=this,T=D.transmuxing;T.executeStart=L();var P=this.decrypter,M=this.currentTransmuxState,O=this.decryptionPromise;if(O)return O.then(function(){return b.flush(D)});var R=[],I=M.timeOffset;if(P){var w=P.flush();w&&R.push(this.push(w,null,D))}var k=this.demuxer,B=this.remuxer;if(!k||!B)return this.observer.emit(s.Events.ERROR,s.Events.ERROR,{type:a.ErrorTypes.MEDIA_ERROR,details:a.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),T.executeEnd=L(),[f(D)];var F=k.flush(I);return x(F)?F.then(function(N){return b.flushRemux(R,N,D),R}):(this.flushRemux(R,F,D),R)},g.flushRemux=function(D,b,T){var P=b.audioTrack,M=b.videoTrack,O=b.id3Track,R=b.textTrack,I=this.currentTransmuxState,w=I.accurateTimeOffset,k=I.timeOffset;E.logger.log("[transmuxer.ts]: Flushed fragment "+T.sn+(T.part>-1?" p: "+T.part:"")+" of level "+T.level);var B=this.remuxer.remux(P,M,O,R,k,w,!0,this.id);D.push({remuxResult:B,chunkMeta:T}),T.transmuxing.executeEnd=L()},g.resetInitialTimestamp=function(D){var b=this.demuxer,T=this.remuxer;!b||!T||(b.resetTimeStamp(D),T.resetTimeStamp(D))},g.resetContiguity=function(){var D=this.demuxer,b=this.remuxer;!D||!b||(D.resetContiguity(),b.resetNextTimestamp())},g.resetInitSegment=function(D,b,T,P){var M=this.demuxer,O=this.remuxer;!M||!O||(M.resetInitSegment(D,b,T,P),O.resetInitSegment(D,b,T))},g.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},g.transmux=function(D,b,T,P,M){var O;return b&&b.method==="SAMPLE-AES"?O=this.transmuxSampleAes(D,b,T,P,M):O=this.transmuxUnencrypted(D,T,P,M),O},g.transmuxUnencrypted=function(D,b,T,P){var M=this.demuxer.demux(D,b,!1,!this.config.progressive),O=M.audioTrack,R=M.videoTrack,I=M.id3Track,w=M.textTrack,k=this.remuxer.remux(O,R,I,w,b,T,!1,this.id);return{remuxResult:k,chunkMeta:P}},g.transmuxSampleAes=function(D,b,T,P,M){var O=this;return this.demuxer.demuxSampleAes(D,b,T).then(function(R){var I=O.remuxer.remux(R.audioTrack,R.videoTrack,R.id3Track,R.textTrack,T,P,!1,O.id);return{remuxResult:I,chunkMeta:M}})},g.configureTransmuxer=function(D,b){for(var T=this.config,P=this.observer,M=this.typeSupported,O=this.vendor,R=b.audioCodec,I=b.defaultInitPts,w=b.duration,k=b.initSegmentData,B=b.videoCodec,F,N=0,K=_.length;N<K;N++)if(_[N].demux.probe(D)){F=_[N];break}F||(E.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),F={demux:c.default,remux:y.default});var H=this.demuxer,U=this.remuxer,j=F.remux,$=F.demux;(!U||!(U instanceof j))&&(this.remuxer=new j(P,T,M,O)),(!H||!(H instanceof $))&&(this.demuxer=new $(P,T,M),this.probe=$.probe),this.resetInitSegment(k,R,B,w),this.resetInitialTimestamp(I)},g.needsProbing=function(D,b,T){return!this.demuxer||!this.remuxer||b||T},g.getDecrypter=function(){var D=this.decrypter;return D||(D=this.decrypter=new o.default(this.observer,this.config)),D},p}();function v(p,g){var m=null;return p.byteLength>0&&g!=null&&g.key!=null&&g.iv!==null&&g.method!=null&&(m=g),m}var f=function(g){return{remuxResult:{},chunkMeta:g}};function x(p){return"then"in p&&p.then instanceof Function}var S=function(g,m,D,b,T){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=g,this.videoCodec=m,this.initSegmentData=D,this.duration=b,this.defaultInitPts=T},C=function(g,m,D,b,T,P){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.initSegmentChange=void 0,this.discontinuity=g,this.contiguous=m,this.accurateTimeOffset=D,this.trackSwitch=b,this.timeOffset=T,this.initSegmentChange=P}},"./src/demux/tsdemuxer.ts":function(n,i,r){r.r(i),r.d(i,"discardEPB",function(){return S});var s=r("./src/demux/adts.ts"),a=r("./src/demux/mpegaudio.ts"),o=r("./src/demux/exp-golomb.ts"),l=r("./src/demux/sample-aes.ts"),c=r("./src/events.ts"),u=r("./src/utils/mp4-tools.ts"),h=r("./src/utils/logger.ts"),d=r("./src/errors.ts"),y=r("./src/types/demuxer.ts");function E(){return E=Object.assign?Object.assign.bind():function(C){for(var p=1;p<arguments.length;p++){var g=arguments[p];for(var m in g)Object.prototype.hasOwnProperty.call(g,m)&&(C[m]=g[m])}return C},E.apply(this,arguments)}var L=function(){function C(g,m,D){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=g,this.config=m,this.typeSupported=D}C.probe=function(m){return m[0]===71&&m[188]===71},C.createTrack=function(m,D){return{container:m==="video"||m==="audio"?"video/mp2t":void 0,type:m,id:u.RemuxerTrackIdConfig[m],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:m==="audio"?D:void 0}};var p=C.prototype;return p.resetInitSegment=function(m,D,b,T){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=C.createTrack("video"),this._audioTrack=C.createTrack("audio",T),this._id3Track=C.createTrack("id3"),this._txtTrack=C.createTrack("text"),this._audioTrack.segmentCodec="aac",this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.audioCodec=D,this.videoCodec=b,this._duration=T},p.resetTimeStamp=function(){},p.resetContiguity=function(){var m=this._audioTrack,D=this._avcTrack,b=this._id3Track;m&&(m.pesData=null),D&&(D.pesData=null),b&&(b.pesData=null),this.aacOverFlow=null},p.demux=function(m,D,b,T){b===void 0&&(b=!1),T===void 0&&(T=!1),b||(this.sampleAes=null);var P,M=this._avcTrack,O=this._audioTrack,R=this._id3Track,I=this._txtTrack,w=M.pid,k=M.pesData,B=O.pid,F=R.pid,N=O.pesData,K=R.pesData,H=null,U=this.pmtParsed,j=this._pmtId,$=m.length;if(this.remainderData&&(m=Object(u.appendUint8Array)(this.remainderData,m),$=m.length,this.remainderData=null),$<188&&!T)return this.remainderData=m,{audioTrack:O,videoTrack:M,id3Track:R,textTrack:I};$-=$%188,$<m.byteLength&&!T&&(this.remainderData=new Uint8Array(m.buffer,$,m.buffer.byteLength-$));for(var X=0,Z=0;Z<$;Z+=188)if(m[Z]===71){var nt=!!(m[Z+1]&64),at=((m[Z+1]&31)<<8)+m[Z+2],it=(m[Z+3]&48)>>4,W=void 0;if(it>1){if(W=Z+5+m[Z+4],W===Z+188)continue}else W=Z+4;switch(at){case w:nt&&(k&&(P=f(k))&&this.parseAVCPES(M,I,P,!1),k={data:[],size:0}),k&&(k.data.push(m.subarray(W,Z+188)),k.size+=Z+188-W);break;case B:if(nt){if(N&&(P=f(N)))switch(O.segmentCodec){case"aac":this.parseAACPES(O,P);break;case"mp3":this.parseMPEGPES(O,P);break}N={data:[],size:0}}N&&(N.data.push(m.subarray(W,Z+188)),N.size+=Z+188-W);break;case F:nt&&(K&&(P=f(K))&&this.parseID3PES(R,P),K={data:[],size:0}),K&&(K.data.push(m.subarray(W,Z+188)),K.size+=Z+188-W);break;case 0:nt&&(W+=m[W]+1),j=this._pmtId=A(m,W);break;case j:{nt&&(W+=m[W]+1);var V=v(m,W,this.typeSupported,b);w=V.avc,w>0&&(M.pid=w),B=V.audio,B>0&&(O.pid=B,O.segmentCodec=V.segmentCodec),F=V.id3,F>0&&(R.pid=F),H!==null&&!U&&(h.logger.log("unknown PID '"+H+"' in TS found"),H=null),U=this.pmtParsed=!0;break}case 17:case 8191:break;default:H=at;break}}else X++;X>0&&this.observer.emit(c.Events.ERROR,c.Events.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"Found "+X+" TS packet/s that do not start with 0x47"}),M.pesData=k,O.pesData=N,R.pesData=K;var z={audioTrack:O,videoTrack:M,id3Track:R,textTrack:I};return T&&this.extractRemainingSamples(z),z},p.flush=function(){var m=this.remainderData;this.remainderData=null;var D;return m?D=this.demux(m,-1,!1,!0):D={videoTrack:this._avcTrack,audioTrack:this._audioTrack,id3Track:this._id3Track,textTrack:this._txtTrack},this.extractRemainingSamples(D),this.sampleAes?this.decrypt(D,this.sampleAes):D},p.extractRemainingSamples=function(m){var D=m.audioTrack,b=m.videoTrack,T=m.id3Track,P=m.textTrack,M=b.pesData,O=D.pesData,R=T.pesData,I;if(M&&(I=f(M))?(this.parseAVCPES(b,P,I,!0),b.pesData=null):b.pesData=M,O&&(I=f(O))){switch(D.segmentCodec){case"aac":this.parseAACPES(D,I);break;case"mp3":this.parseMPEGPES(D,I);break}D.pesData=null}else O!=null&&O.size&&h.logger.log("last AAC PES packet truncated,might overlap between fragments"),D.pesData=O;R&&(I=f(R))?(this.parseID3PES(T,I),T.pesData=null):T.pesData=R},p.demuxSampleAes=function(m,D,b){var T=this.demux(m,b,!0,!this.config.progressive),P=this.sampleAes=new l.default(this.observer,this.config,D);return this.decrypt(T,P)},p.decrypt=function(m,D){return new Promise(function(b){var T=m.audioTrack,P=m.videoTrack;T.samples&&T.segmentCodec==="aac"?D.decryptAacSamples(T.samples,0,function(){P.samples?D.decryptAvcSamples(P.samples,0,0,function(){b(m)}):b(m)}):P.samples&&D.decryptAvcSamples(P.samples,0,0,function(){b(m)})})},p.destroy=function(){this._duration=0},p.parseAVCPES=function(m,D,b,T){var P=this,M=this.parseAVCNALu(m,b.data),O=this.avcSample,R,I=!1;b.data=null,O&&M.length&&!m.audFound&&(x(O,m),O=this.avcSample=_(!1,b.pts,b.dts,"")),M.forEach(function(w){switch(w.type){case 1:{R=!0,O||(O=P.avcSample=_(!0,b.pts,b.dts,"")),O.frame=!0;var k=w.data;if(I&&k.length>4){var B=new o.default(k).readSliceType();(B===2||B===4||B===7||B===9)&&(O.key=!0)}break}case 5:R=!0,O||(O=P.avcSample=_(!0,b.pts,b.dts,"")),O.key=!0,O.frame=!0;break;case 6:{R=!0,Object(u.parseSEIMessageFromNALu)(S(w.data),b.pts,D.samples);break}case 7:if(R=!0,I=!0,!m.sps){var F=new o.default(w.data),N=F.readSPS();m.width=N.width,m.height=N.height,m.pixelRatio=N.pixelRatio,m.sps=[w.data],m.duration=P._duration;for(var K=w.data.subarray(1,4),H="avc1.",U=0;U<3;U++){var j=K[U].toString(16);j.length<2&&(j="0"+j),H+=j}m.codec=H}break;case 8:R=!0,m.pps||(m.pps=[w.data]);break;case 9:R=!1,m.audFound=!0,O&&x(O,m),O=P.avcSample=_(!1,b.pts,b.dts,"");break;case 12:R=!0;break;default:R=!1,O&&(O.debug+="unknown NAL "+w.type+" ");break}if(O&&R){var $=O.units;$.push(w)}}),T&&O&&(x(O,m),this.avcSample=null)},p.getLastNalUnit=function(m){var D,b=this.avcSample,T;if((!b||b.units.length===0)&&(b=m[m.length-1]),(D=b)!==null&&D!==void 0&&D.units){var P=b.units;T=P[P.length-1]}return T},p.parseAVCNALu=function(m,D){var b=D.byteLength,T=m.naluState||0,P=T,M=[],O=0,R,I,w,k=-1,B=0;for(T===-1&&(k=0,B=D[0]&31,T=0,O=1);O<b;){if(R=D[O++],!T){T=R?0:1;continue}if(T===1){T=R?0:2;continue}if(!R)T=3;else if(R===1){if(k>=0){var F={data:D.subarray(k,O-T-1),type:B};M.push(F)}else{var N=this.getLastNalUnit(m.samples);if(N&&(P&&O<=4-P&&N.state&&(N.data=N.data.subarray(0,N.data.byteLength-P)),I=O-T-1,I>0)){var K=new Uint8Array(N.data.byteLength+I);K.set(N.data,0),K.set(D.subarray(0,I),N.data.byteLength),N.data=K,N.state=0}}O<b?(w=D[O]&31,k=O,B=w,T=0):T=-1}else T=0}if(k>=0&&T>=0){var H={data:D.subarray(k,b),type:B,state:T};M.push(H)}if(M.length===0){var U=this.getLastNalUnit(m.samples);if(U){var j=new Uint8Array(U.data.byteLength+D.byteLength);j.set(U.data,0),j.set(D,U.data.byteLength),U.data=j}}return m.naluState=T,M},p.parseAACPES=function(m,D){var b=0,T=this.aacOverFlow,P=D.data;if(T){this.aacOverFlow=null;var M=T.missing,O=T.sample.unit.byteLength;if(M===-1){var R=new Uint8Array(O+P.byteLength);R.set(T.sample.unit,0),R.set(P,O),P=R}else{var I=O-M;T.sample.unit.set(P.subarray(0,M),I),m.samples.push(T.sample),b=T.missing}}var w,k;for(w=b,k=P.length;w<k-1&&!s.isHeader(P,w);w++);if(w!==b){var B,F;if(w<k-1?(B="AAC PES did not start with ADTS header,offset:"+w,F=!1):(B="no ADTS header found in AAC PES",F=!0),h.logger.warn("parsing error:"+B),this.observer.emit(c.Events.ERROR,c.Events.ERROR,{type:d.ErrorTypes.MEDIA_ERROR,details:d.ErrorDetails.FRAG_PARSING_ERROR,fatal:F,reason:B}),F)return}s.initTrackConfig(m,this.observer,P,w,this.audioCodec);var N;if(D.pts!==void 0)N=D.pts;else if(T){var K=s.getFrameDuration(m.samplerate);N=T.sample.pts+K}else{h.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var H=0,U;w<k;)if(U=s.appendFrame(m,P,w,N,H),w+=U.length,U.missing){this.aacOverFlow=U;break}else for(H++;w<k-1&&!s.isHeader(P,w);w++);},p.parseMPEGPES=function(m,D){var b=D.data,T=b.length,P=0,M=0,O=D.pts;if(O===void 0){h.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;M<T;)if(a.isHeader(b,M)){var R=a.appendFrame(m,b,M,O,P);if(R)M+=R.length,P++;else break}else M++},p.parseID3PES=function(m,D){if(D.pts===void 0){h.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}var b=E({},D,{type:this._avcTrack?y.MetadataSchema.emsg:y.MetadataSchema.audioId3});m.samples.push(b)},C}();function _(C,p,g,m){return{key:C,frame:!1,pts:p,dts:g,units:[],debug:m,length:0}}function A(C,p){return(C[p+10]&31)<<8|C[p+11]}function v(C,p,g,m){var D={audio:-1,avc:-1,id3:-1,segmentCodec:"aac"},b=(C[p+1]&15)<<8|C[p+2],T=p+3+b-4,P=(C[p+10]&15)<<8|C[p+11];for(p+=12+P;p<T;){var M=(C[p+1]&31)<<8|C[p+2];switch(C[p]){case 207:if(!m){h.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:D.audio===-1&&(D.audio=M);break;case 21:D.id3===-1&&(D.id3=M);break;case 219:if(!m){h.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:D.avc===-1&&(D.avc=M);break;case 3:case 4:g.mpeg!==!0&&g.mp3!==!0?h.logger.log("MPEG audio found, not supported in this browser"):D.audio===-1&&(D.audio=M,D.segmentCodec="mp3");break;case 36:h.logger.warn("Unsupported HEVC stream type found");break}p+=((C[p+3]&15)<<8|C[p+4])+5}return D}function f(C){var p=0,g,m,D,b,T,P=C.data;if(!C||C.size===0)return null;for(;P[0].length<19&&P.length>1;){var M=new Uint8Array(P[0].length+P[1].length);M.set(P[0]),M.set(P[1],P[0].length),P[0]=M,P.splice(1,1)}g=P[0];var O=(g[0]<<16)+(g[1]<<8)+g[2];if(O===1){if(m=(g[4]<<8)+g[5],m&&m>C.size-6)return null;var R=g[7];R&192&&(b=(g[9]&14)*536870912+(g[10]&255)*4194304+(g[11]&254)*16384+(g[12]&255)*128+(g[13]&254)/2,R&64?(T=(g[14]&14)*536870912+(g[15]&255)*4194304+(g[16]&254)*16384+(g[17]&255)*128+(g[18]&254)/2,b-T>60*9e4&&(h.logger.warn(Math.round((b-T)/9e4)+"s delta between PTS and DTS, align them"),b=T)):T=b),D=g[8];var I=D+9;if(C.size<=I)return null;C.size-=I;for(var w=new Uint8Array(C.size),k=0,B=P.length;k<B;k++){g=P[k];var F=g.byteLength;if(I)if(I>F){I-=F;continue}else g=g.subarray(I),F-=I,I=0;w.set(g,p),p+=F}return m&&(m-=D+3),{data:w,pts:b,dts:T,len:m}}return null}function x(C,p){if(C.units.length&&C.frame){if(C.pts===void 0){var g=p.samples,m=g.length;if(m){var D=g[m-1];C.pts=D.pts,C.dts=D.dts}else{p.dropped++;return}}p.samples.push(C)}C.debug.length&&h.logger.log(C.pts+"/"+C.dts+":"+C.debug)}function S(C){for(var p=C.byteLength,g=[],m=1;m<p-2;)C[m]===0&&C[m+1]===0&&C[m+2]===3?(g.push(m+2),m+=2):m++;if(g.length===0)return C;var D=p-g.length,b=new Uint8Array(D),T=0;for(m=0;m<D;T++,m++)T===g[0]&&(T++,g.shift()),b[m]=C[T];return b}i.default=L},"./src/errors.ts":function(n,i,r){r.r(i),r.d(i,"ErrorTypes",function(){return s}),r.d(i,"ErrorDetails",function(){return a});var s;(function(o){o.NETWORK_ERROR="networkError",o.MEDIA_ERROR="mediaError",o.KEY_SYSTEM_ERROR="keySystemError",o.MUX_ERROR="muxError",o.OTHER_ERROR="otherError"})(s||(s={}));var a;(function(o){o.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",o.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",o.KEY_SYSTEM_NO_SESSION="keySystemNoSession",o.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",o.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",o.MANIFEST_LOAD_ERROR="manifestLoadError",o.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",o.MANIFEST_PARSING_ERROR="manifestParsingError",o.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",o.LEVEL_EMPTY_ERROR="levelEmptyError",o.LEVEL_LOAD_ERROR="levelLoadError",o.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",o.LEVEL_SWITCH_ERROR="levelSwitchError",o.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",o.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",o.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",o.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",o.FRAG_LOAD_ERROR="fragLoadError",o.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",o.FRAG_DECRYPT_ERROR="fragDecryptError",o.FRAG_PARSING_ERROR="fragParsingError",o.REMUX_ALLOC_ERROR="remuxAllocError",o.KEY_LOAD_ERROR="keyLoadError",o.KEY_LOAD_TIMEOUT="keyLoadTimeOut",o.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",o.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",o.BUFFER_APPEND_ERROR="bufferAppendError",o.BUFFER_APPENDING_ERROR="bufferAppendingError",o.BUFFER_STALLED_ERROR="bufferStalledError",o.BUFFER_FULL_ERROR="bufferFullError",o.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",o.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",o.INTERNAL_EXCEPTION="internalException",o.INTERNAL_ABORTED="aborted",o.UNKNOWN="unknown"})(a||(a={}))},"./src/events.ts":function(n,i,r){r.r(i),r.d(i,"Events",function(){return s});var s;(function(a){a.MEDIA_ATTACHING="hlsMediaAttaching",a.MEDIA_ATTACHED="hlsMediaAttached",a.MEDIA_DETACHING="hlsMediaDetaching",a.MEDIA_DETACHED="hlsMediaDetached",a.BUFFER_RESET="hlsBufferReset",a.BUFFER_CODECS="hlsBufferCodecs",a.BUFFER_CREATED="hlsBufferCreated",a.BUFFER_APPENDING="hlsBufferAppending",a.BUFFER_APPENDED="hlsBufferAppended",a.BUFFER_EOS="hlsBufferEos",a.BUFFER_FLUSHING="hlsBufferFlushing",a.BUFFER_FLUSHED="hlsBufferFlushed",a.MANIFEST_LOADING="hlsManifestLoading",a.MANIFEST_LOADED="hlsManifestLoaded",a.MANIFEST_PARSED="hlsManifestParsed",a.LEVEL_SWITCHING="hlsLevelSwitching",a.LEVEL_SWITCHED="hlsLevelSwitched",a.LEVEL_LOADING="hlsLevelLoading",a.LEVEL_LOADED="hlsLevelLoaded",a.LEVEL_UPDATED="hlsLevelUpdated",a.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",a.LEVELS_UPDATED="hlsLevelsUpdated",a.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",a.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",a.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",a.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",a.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",a.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",a.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",a.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",a.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",a.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",a.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",a.CUES_PARSED="hlsCuesParsed",a.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",a.INIT_PTS_FOUND="hlsInitPtsFound",a.FRAG_LOADING="hlsFragLoading",a.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",a.FRAG_LOADED="hlsFragLoaded",a.FRAG_DECRYPTED="hlsFragDecrypted",a.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",a.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",a.FRAG_PARSING_METADATA="hlsFragParsingMetadata",a.FRAG_PARSED="hlsFragParsed",a.FRAG_BUFFERED="hlsFragBuffered",a.FRAG_CHANGED="hlsFragChanged",a.FPS_DROP="hlsFpsDrop",a.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",a.ERROR="hlsError",a.DESTROYING="hlsDestroying",a.KEY_LOADING="hlsKeyLoading",a.KEY_LOADED="hlsKeyLoaded",a.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",a.BACK_BUFFER_REACHED="hlsBackBufferReached"})(s||(s={}))},"./src/hls.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return S});var s=r("./node_modules/url-toolkit/src/url-toolkit.js"),a=r("./src/loader/playlist-loader.ts"),o=r("./src/loader/key-loader.ts"),l=r("./src/controller/id3-track-controller.ts"),c=r("./src/controller/latency-controller.ts"),u=r("./src/controller/level-controller.ts"),h=r("./src/controller/fragment-tracker.ts"),d=r("./src/controller/stream-controller.ts"),y=r("./src/is-supported.ts"),E=r("./src/utils/logger.ts"),L=r("./src/config.ts"),_=r("./node_modules/eventemitter3/index.js"),A=r("./src/events.ts"),v=r("./src/errors.ts");function f(C,p){for(var g=0;g<p.length;g++){var m=p[g];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(C,m.key,m)}}function x(C,p,g){return p&&f(C.prototype,p),g&&f(C,g),Object.defineProperty(C,"prototype",{writable:!1}),C}var S=function(){C.isSupported=function(){return Object(y.isSupported)()};function C(g){g===void 0&&(g={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new _.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this.cmcdController=void 0,this._media=null,this.url=null;var m=this.config=Object(L.mergeConfig)(C.DefaultConfig,g);this.userConfig=g,Object(E.enableLogs)(m.debug),this._autoLevelCapping=-1,m.progressive&&Object(L.enableStreamingMode)(m);var D=m.abrController,b=m.bufferController,T=m.capLevelController,P=m.fpsController,M=this.abrController=new D(this),O=this.bufferController=new b(this),R=this.capLevelController=new T(this),I=new P(this),w=new a.default(this),k=new o.default(this),B=new l.default(this),F=this.levelController=new u.default(this),N=new h.FragmentTracker(this),K=this.streamController=new d.default(this,N);R.setStreamController(K),I.setStreamController(K);var H=[w,k,F,K];this.networkControllers=H;var U=[M,O,R,I,B,N];this.audioTrackController=this.createController(m.audioTrackController,null,H),this.createController(m.audioStreamController,N,H),this.subtitleTrackController=this.createController(m.subtitleTrackController,null,H),this.createController(m.subtitleStreamController,N,H),this.createController(m.timelineController,null,U),this.emeController=this.createController(m.emeController,null,U),this.cmcdController=this.createController(m.cmcdController,null,U),this.latencyController=this.createController(c.default,null,U),this.coreComponents=U}var p=C.prototype;return p.createController=function(m,D,b){if(m){var T=D?new m(this,D):new m(this);return b&&b.push(T),T}return null},p.on=function(m,D,b){b===void 0&&(b=this),this._emitter.on(m,D,b)},p.once=function(m,D,b){b===void 0&&(b=this),this._emitter.once(m,D,b)},p.removeAllListeners=function(m){this._emitter.removeAllListeners(m)},p.off=function(m,D,b,T){b===void 0&&(b=this),this._emitter.off(m,D,b,T)},p.listeners=function(m){return this._emitter.listeners(m)},p.emit=function(m,D,b){return this._emitter.emit(m,D,b)},p.trigger=function(m,D){if(this.config.debug)return this.emit(m,m,D);try{return this.emit(m,m,D)}catch(b){E.logger.error("An internal error happened while handling event "+m+'. Error message: "'+b.message+'". Here is a stacktrace:',b),this.trigger(A.Events.ERROR,{type:v.ErrorTypes.OTHER_ERROR,details:v.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:m,error:b})}return!1},p.listenerCount=function(m){return this._emitter.listenerCount(m)},p.destroy=function(){E.logger.log("destroy"),this.trigger(A.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(m){return m.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(m){return m.destroy()}),this.coreComponents.length=0},p.attachMedia=function(m){E.logger.log("attachMedia"),this._media=m,this.trigger(A.Events.MEDIA_ATTACHING,{media:m})},p.detachMedia=function(){E.logger.log("detachMedia"),this.trigger(A.Events.MEDIA_DETACHING,void 0),this._media=null},p.loadSource=function(m){this.stopLoad();var D=this.media,b=this.url,T=this.url=s.buildAbsoluteURL(self.location.href,m,{alwaysNormalize:!0});E.logger.log("loadSource:"+T),D&&b&&b!==T&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(D)),this.trigger(A.Events.MANIFEST_LOADING,{url:m})},p.startLoad=function(m){m===void 0&&(m=-1),E.logger.log("startLoad("+m+")"),this.networkControllers.forEach(function(D){D.startLoad(m)})},p.stopLoad=function(){E.logger.log("stopLoad"),this.networkControllers.forEach(function(m){m.stopLoad()})},p.swapAudioCodec=function(){E.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},p.recoverMediaError=function(){E.logger.log("recoverMediaError");var m=this._media;this.detachMedia(),m&&this.attachMedia(m)},p.removeLevel=function(m,D){D===void 0&&(D=0),this.levelController.removeLevel(m,D)},x(C,[{key:"levels",get:function(){var m=this.levelController.levels;return m||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(m){E.logger.log("set currentLevel:"+m),this.loadLevel=m,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(m){E.logger.log("set nextLevel:"+m),this.levelController.manualLevel=m,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(m){E.logger.log("set loadLevel:"+m),this.levelController.manualLevel=m}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(m){this.levelController.nextLoadLevel=m}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(m){E.logger.log("set firstLevel:"+m),this.levelController.firstLevel=m}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(m){E.logger.log("set startLevel:"+m),m!==-1&&(m=Math.max(m,this.minAutoLevel)),this.levelController.startLevel=m}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(m){var D=!!m;D!==this.config.capLevelToPlayerSize&&(D?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=D)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(m){this._autoLevelCapping!==m&&(E.logger.log("set autoLevelCapping:"+m),this._autoLevelCapping=m)}},{key:"bandwidthEstimate",get:function(){var m=this.abrController.bwEstimator;return m?m.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var m=this.levels,D=this.config.minAutoBitrate;if(!m)return 0;for(var b=m.length,T=0;T<b;T++)if(m[T].maxBitrate>=D)return T;return 0}},{key:"maxAutoLevel",get:function(){var m=this.levels,D=this.autoLevelCapping,b;return D===-1&&m&&m.length?b=m.length-1:b=D,b}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(m){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,m)}},{key:"playingDate",get:function(){return this.streamController.currentProgramDateTime}},{key:"audioTracks",get:function(){var m=this.audioTrackController;return m?m.audioTracks:[]}},{key:"audioTrack",get:function(){var m=this.audioTrackController;return m?m.audioTrack:-1},set:function(m){var D=this.audioTrackController;D&&(D.audioTrack=m)}},{key:"subtitleTracks",get:function(){var m=this.subtitleTrackController;return m?m.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var m=this.subtitleTrackController;return m?m.subtitleTrack:-1},set:function(m){var D=this.subtitleTrackController;D&&(D.subtitleTrack=m)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var m=this.subtitleTrackController;return m?m.subtitleDisplay:!1},set:function(m){var D=this.subtitleTrackController;D&&(D.subtitleDisplay=m)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(m){this.config.lowLatencyMode=m}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.2.3"}},{key:"Events",get:function(){return A.Events}},{key:"ErrorTypes",get:function(){return v.ErrorTypes}},{key:"ErrorDetails",get:function(){return v.ErrorDetails}},{key:"DefaultConfig",get:function(){return C.defaultConfig?C.defaultConfig:L.hlsDefaultConfig},set:function(m){C.defaultConfig=m}}]),C}();S.defaultConfig=void 0},"./src/is-supported.ts":function(n,i,r){r.r(i),r.d(i,"isSupported",function(){return o}),r.d(i,"changeTypeSupported",function(){return l});var s=r("./src/utils/mediasource-helper.ts");function a(){return self.SourceBuffer||self.WebKitSourceBuffer}function o(){var c=Object(s.getMediaSource)();if(!c)return!1;var u=a(),h=c&&typeof c.isTypeSupported=="function"&&c.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),d=!u||u.prototype&&typeof u.prototype.appendBuffer=="function"&&typeof u.prototype.remove=="function";return!!h&&!!d}function l(){var c,u=a();return typeof(u==null||(c=u.prototype)===null||c===void 0?void 0:c.changeType)=="function"}},"./src/loader/date-range.ts":function(n,i,r){r.r(i),r.d(i,"DateRangeAttribute",function(){return h}),r.d(i,"DateRange",function(){return d});var s=r("./src/polyfills/number.ts"),a=r("./src/utils/attr-list.ts"),o=r("./src/utils/logger.ts");function l(){return l=Object.assign?Object.assign.bind():function(y){for(var E=1;E<arguments.length;E++){var L=arguments[E];for(var _ in L)Object.prototype.hasOwnProperty.call(L,_)&&(y[_]=L[_])}return y},l.apply(this,arguments)}function c(y,E){for(var L=0;L<E.length;L++){var _=E[L];_.enumerable=_.enumerable||!1,_.configurable=!0,"value"in _&&(_.writable=!0),Object.defineProperty(y,_.key,_)}}function u(y,E,L){return E&&c(y.prototype,E),L&&c(y,L),Object.defineProperty(y,"prototype",{writable:!1}),y}var h;(function(y){y.ID="ID",y.CLASS="CLASS",y.START_DATE="START-DATE",y.DURATION="DURATION",y.END_DATE="END-DATE",y.END_ON_NEXT="END-ON-NEXT",y.PLANNED_DURATION="PLANNED-DURATION",y.SCTE35_OUT="SCTE35-OUT",y.SCTE35_IN="SCTE35-IN"})(h||(h={}));var d=function(){function y(E,L){if(this.attr=void 0,this._startDate=void 0,this._endDate=void 0,this._badValueForSameId=void 0,L){var _=L.attr;for(var A in _)if(Object.prototype.hasOwnProperty.call(E,A)&&E[A]!==_[A]){o.logger.warn('DATERANGE tag attribute: "'+A+'" does not match for tags with ID: "'+E.ID+'"'),this._badValueForSameId=A;break}E=l(new a.AttrList({}),_,E)}if(this.attr=E,this._startDate=new Date(E[h.START_DATE]),h.END_DATE in this.attr){var v=new Date(this.attr[h.END_DATE]);Object(s.isFiniteNumber)(v.getTime())&&(this._endDate=v)}}return u(y,[{key:"id",get:function(){return this.attr.ID}},{key:"class",get:function(){return this.attr.CLASS}},{key:"startDate",get:function(){return this._startDate}},{key:"endDate",get:function(){if(this._endDate)return this._endDate;var L=this.duration;return L!==null?new Date(this._startDate.getTime()+L*1e3):null}},{key:"duration",get:function(){if(h.DURATION in this.attr){var L=this.attr.decimalFloatingPoint(h.DURATION);if(Object(s.isFiniteNumber)(L))return L}else if(this._endDate)return(this._endDate.getTime()-this._startDate.getTime())/1e3;return null}},{key:"plannedDuration",get:function(){return h.PLANNED_DURATION in this.attr?this.attr.decimalFloatingPoint(h.PLANNED_DURATION):null}},{key:"endOnNext",get:function(){return this.attr.bool(h.END_ON_NEXT)}},{key:"isValid",get:function(){return!!this.id&&!this._badValueForSameId&&Object(s.isFiniteNumber)(this.startDate.getTime())&&(this.duration===null||this.duration>=0)&&(!this.endOnNext||!!this.class)}}]),y}()},"./src/loader/fragment-loader.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return L}),r.d(i,"LoadError",function(){return A});var s=r("./src/polyfills/number.ts"),a=r("./src/errors.ts");function o(v,f){v.prototype=Object.create(f.prototype),v.prototype.constructor=v,d(v,f)}function l(v){var f=typeof Map=="function"?new Map:void 0;return l=function(S){if(S===null||!h(S))return S;if(typeof S!="function")throw new TypeError("Super expression must either be null or a function");if(typeof f<"u"){if(f.has(S))return f.get(S);f.set(S,C)}function C(){return c(S,arguments,y(this).constructor)}return C.prototype=Object.create(S.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),d(C,S)},l(v)}function c(v,f,x){return u()?c=Reflect.construct.bind():c=function(C,p,g){var m=[null];m.push.apply(m,p);var D=Function.bind.apply(C,m),b=new D;return g&&d(b,g.prototype),b},c.apply(null,arguments)}function u(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function h(v){return Function.toString.call(v).indexOf("[native code]")!==-1}function d(v,f){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(S,C){return S.__proto__=C,S},d(v,f)}function y(v){return y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(x){return x.__proto__||Object.getPrototypeOf(x)},y(v)}var E=Math.pow(2,17),L=function(){function v(x){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=x}var f=v.prototype;return f.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},f.abort=function(){this.loader&&this.loader.abort()},f.load=function(S,C){var p=this,g=S.url;if(!g)return Promise.reject(new A({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:S,networkDetails:null},"Fragment does not have a "+(g?"part list":"url")));this.abort();var m=this.config,D=m.fLoader,b=m.loader;return new Promise(function(T,P){p.loader&&p.loader.destroy();var M=p.loader=S.loader=D?new D(m):new b(m),O=_(S),R={timeout:m.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:m.fragLoadingMaxRetryTimeout,highWaterMark:S.sn==="initSegment"?1/0:E};S.stats=M.stats,M.load(O,R,{onSuccess:function(w,k,B,F){p.resetLoader(S,M),T({frag:S,part:null,payload:w.data,networkDetails:F})},onError:function(w,k,B){p.resetLoader(S,M),P(new A({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:S,response:w,networkDetails:B}))},onAbort:function(w,k,B){p.resetLoader(S,M),P(new A({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:S,networkDetails:B}))},onTimeout:function(w,k,B){p.resetLoader(S,M),P(new A({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:S,networkDetails:B}))},onProgress:function(w,k,B,F){C&&C({frag:S,part:null,payload:B,networkDetails:F})}})})},f.loadPart=function(S,C,p){var g=this;this.abort();var m=this.config,D=m.fLoader,b=m.loader;return new Promise(function(T,P){g.loader&&g.loader.destroy();var M=g.loader=S.loader=D?new D(m):new b(m),O=_(S,C),R={timeout:m.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:m.fragLoadingMaxRetryTimeout,highWaterMark:E};C.stats=M.stats,M.load(O,R,{onSuccess:function(w,k,B,F){g.resetLoader(S,M),g.updateStatsFromPart(S,C);var N={frag:S,part:C,payload:w.data,networkDetails:F};p(N),T(N)},onError:function(w,k,B){g.resetLoader(S,M),P(new A({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:S,part:C,response:w,networkDetails:B}))},onAbort:function(w,k,B){S.stats.aborted=C.stats.aborted,g.resetLoader(S,M),P(new A({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:S,part:C,networkDetails:B}))},onTimeout:function(w,k,B){g.resetLoader(S,M),P(new A({type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:S,part:C,networkDetails:B}))}})})},f.updateStatsFromPart=function(S,C){var p=S.stats,g=C.stats,m=g.total;if(p.loaded+=g.loaded,m){var D=Math.round(S.duration/C.duration),b=Math.min(Math.round(p.loaded/m),D),T=D-b,P=T*Math.round(p.loaded/b);p.total=p.loaded+P}else p.total=Math.max(p.loaded,p.total);var M=p.loading,O=g.loading;M.start?M.first+=O.first-O.start:(M.start=O.start,M.first=O.first),M.end=O.end},f.resetLoader=function(S,C){S.loader=null,this.loader===C&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),C.destroy()},v}();function _(v,f){f===void 0&&(f=null);var x=f||v,S={frag:v,part:f,responseType:"arraybuffer",url:x.url,headers:{},rangeStart:0,rangeEnd:0},C=x.byteRangeStartOffset,p=x.byteRangeEndOffset;return Object(s.isFiniteNumber)(C)&&Object(s.isFiniteNumber)(p)&&(S.rangeStart=C,S.rangeEnd=p),S}var A=function(v){o(f,v);function f(x){for(var S,C=arguments.length,p=new Array(C>1?C-1:0),g=1;g<C;g++)p[g-1]=arguments[g];return S=v.call.apply(v,[this].concat(p))||this,S.data=void 0,S.data=x,S}return f}(l(Error))},"./src/loader/fragment.ts":function(n,i,r){r.r(i),r.d(i,"ElementaryStreamTypes",function(){return E}),r.d(i,"BaseSegment",function(){return L}),r.d(i,"Fragment",function(){return _}),r.d(i,"Part",function(){return A});var s=r("./src/polyfills/number.ts"),a=r("./node_modules/url-toolkit/src/url-toolkit.js"),o=r("./src/utils/logger.ts"),l=r("./src/loader/level-key.ts"),c=r("./src/loader/load-stats.ts");function u(v,f){v.prototype=Object.create(f.prototype),v.prototype.constructor=v,h(v,f)}function h(v,f){return h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(S,C){return S.__proto__=C,S},h(v,f)}function d(v,f){for(var x=0;x<f.length;x++){var S=f[x];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(v,S.key,S)}}function y(v,f,x){return f&&d(v.prototype,f),x&&d(v,x),Object.defineProperty(v,"prototype",{writable:!1}),v}var E;(function(v){v.AUDIO="audio",v.VIDEO="video",v.AUDIOVIDEO="audiovideo"})(E||(E={}));var L=function(){function v(x){var S;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(S={},S[E.AUDIO]=null,S[E.VIDEO]=null,S[E.AUDIOVIDEO]=null,S),this.baseurl=x}var f=v.prototype;return f.setByteRange=function(S,C){var p=S.split("@",2),g=[];p.length===1?g[0]=C?C.byteRangeEndOffset:0:g[0]=parseInt(p[1]),g[1]=parseInt(p[0])+g[0],this._byteRange=g},y(v,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(a.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(S){this._url=S}}]),v}(),_=function(v){u(f,v);function f(S,C){var p;return p=v.call(this,C)||this,p._decryptdata=null,p.rawProgramDateTime=null,p.programDateTime=null,p.tagList=[],p.duration=0,p.sn=0,p.levelkey=void 0,p.type=void 0,p.loader=null,p.level=-1,p.cc=0,p.startPTS=void 0,p.endPTS=void 0,p.appendedPTS=void 0,p.startDTS=void 0,p.endDTS=void 0,p.start=0,p.deltaPTS=void 0,p.maxStartPTS=void 0,p.minEndPTS=void 0,p.stats=new c.LoadStats,p.urlId=0,p.data=void 0,p.bitrateTest=!1,p.title=null,p.initSegment=null,p.type=S,p}var x=f.prototype;return x.createInitializationVector=function(C){for(var p=new Uint8Array(16),g=12;g<16;g++)p[g]=C>>8*(15-g)&255;return p},x.setDecryptDataFromLevelKey=function(C,p){var g=C;return(C==null?void 0:C.method)==="AES-128"&&C.uri&&!C.iv&&(g=l.LevelKey.fromURI(C.uri),g.method=C.method,g.iv=this.createInitializationVector(p),g.keyFormat="identity"),g},x.setElementaryStreamInfo=function(C,p,g,m,D,b){b===void 0&&(b=!1);var T=this.elementaryStreams,P=T[C];if(!P){T[C]={startPTS:p,endPTS:g,startDTS:m,endDTS:D,partial:b};return}P.startPTS=Math.min(P.startPTS,p),P.endPTS=Math.max(P.endPTS,g),P.startDTS=Math.min(P.startDTS,m),P.endDTS=Math.max(P.endDTS,D)},x.clearElementaryStreamInfo=function(){var C=this.elementaryStreams;C[E.AUDIO]=null,C[E.VIDEO]=null,C[E.AUDIOVIDEO]=null},y(f,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var C=this.sn;typeof C!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&o.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),C=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,C)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(s.isFiniteNumber)(this.programDateTime))return null;var C=Object(s.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+C*1e3}},{key:"encrypted",get:function(){var C;return!!((C=this.decryptdata)!==null&&C!==void 0&&C.keyFormat&&this.decryptdata.uri)}}]),f}(L),A=function(v){u(f,v);function f(x,S,C,p,g){var m;m=v.call(this,C)||this,m.fragOffset=0,m.duration=0,m.gap=!1,m.independent=!1,m.relurl=void 0,m.fragment=void 0,m.index=void 0,m.stats=new c.LoadStats,m.duration=x.decimalFloatingPoint("DURATION"),m.gap=x.bool("GAP"),m.independent=x.bool("INDEPENDENT"),m.relurl=x.enumeratedString("URI"),m.fragment=S,m.index=p;var D=x.enumeratedString("BYTERANGE");return D&&m.setByteRange(D,g),g&&(m.fragOffset=g.fragOffset+g.duration),m}return y(f,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var S=this.elementaryStreams;return!!(S.audio||S.video||S.audiovideo)}}]),f}(L)},"./src/loader/key-loader.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return l});var s=r("./src/events.ts"),a=r("./src/errors.ts"),o=r("./src/utils/logger.ts"),l=function(){function c(h){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=h,this.registerListeners()}var u=c.prototype;return u.startLoad=function(d){},u.stopLoad=function(){this.destroyInternalLoaders()},u.registerListeners=function(){this.hls.on(s.Events.KEY_LOADING,this.onKeyLoading,this)},u.unregisterListeners=function(){this.hls.off(s.Events.KEY_LOADING,this.onKeyLoading)},u.destroyInternalLoaders=function(){for(var d in this.loaders){var y=this.loaders[d];y&&y.destroy()}this.loaders={}},u.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},u.onKeyLoading=function(d,y){var E=y.frag,L=E.type,_=this.loaders[L];if(!E.decryptdata){o.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var A=E.decryptdata.uri;if(A!==this.decrypturl||this.decryptkey===null){var v=this.hls.config;if(_&&(o.logger.warn("abort previous key loader for type:"+L),_.abort()),!A){o.logger.warn("key uri is falsy");return}var f=v.loader,x=E.loader=this.loaders[L]=new f(v);this.decrypturl=A,this.decryptkey=null;var S={url:A,frag:E,responseType:"arraybuffer"},C={timeout:v.fragLoadingTimeOut,maxRetry:0,retryDelay:v.fragLoadingRetryDelay,maxRetryDelay:v.fragLoadingMaxRetryTimeout,highWaterMark:0},p={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};x.load(S,C,p)}else this.decryptkey&&(E.decryptdata.key=this.decryptkey,this.hls.trigger(s.Events.KEY_LOADED,{frag:E}))},u.loadsuccess=function(d,y,E){var L=E.frag;if(!L.decryptdata){o.logger.error("after key load, decryptdata unset");return}this.decryptkey=L.decryptdata.key=new Uint8Array(d.data),L.loader=null,delete this.loaders[L.type],this.hls.trigger(s.Events.KEY_LOADED,{frag:L})},u.loaderror=function(d,y){var E=y.frag,L=E.loader;L&&L.abort(),delete this.loaders[E.type],this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:E,response:d})},u.loadtimeout=function(d,y){var E=y.frag,L=E.loader;L&&L.abort(),delete this.loaders[E.type],this.hls.trigger(s.Events.ERROR,{type:a.ErrorTypes.NETWORK_ERROR,details:a.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:E})},c}()},"./src/loader/level-details.ts":function(n,i,r){r.r(i),r.d(i,"LevelDetails",function(){return c});var s=r("./src/polyfills/number.ts");function a(u,h){for(var d=0;d<h.length;d++){var y=h[d];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(u,y.key,y)}}function o(u,h,d){return h&&a(u.prototype,h),d&&a(u,d),Object.defineProperty(u,"prototype",{writable:!1}),u}var l=10,c=function(){function u(d){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.dateRanges=void 0,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.dateRanges={},this.url=d}var h=u.prototype;return h.reloaded=function(y){if(!y){this.advanced=!0,this.updated=!0;return}var E=this.lastPartSn-y.lastPartSn,L=this.lastPartIndex-y.lastPartIndex;this.updated=this.endSN!==y.endSN||!!L||!!E,this.advanced=this.endSN>y.endSN||E>0||E===0&&L>0,this.updated||this.advanced?this.misses=Math.floor(y.misses*.6):this.misses=y.misses+1,this.availabilityDelay=y.availabilityDelay},o(u,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?Object(s.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||l}},{key:"drift",get:function(){var y=this.driftEndTime-this.driftStartTime;if(y>0){var E=this.driftEnd-this.driftStart;return E*1e3/y}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var y;return(y=this.partList)!==null&&y!==void 0&&y.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var y;return(y=this.fragments)!==null&&y!==void 0&&y.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var y;return(y=this.partList)!==null&&y!==void 0&&y.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var y;return(y=this.partList)!==null&&y!==void 0&&y.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),u}()},"./src/loader/level-key.ts":function(n,i,r){r.r(i),r.d(i,"LevelKey",function(){return l});var s=r("./node_modules/url-toolkit/src/url-toolkit.js");function a(c,u){for(var h=0;h<u.length;h++){var d=u[h];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(c,d.key,d)}}function o(c,u,h){return u&&a(c.prototype,u),h&&a(c,h),Object.defineProperty(c,"prototype",{writable:!1}),c}var l=function(){c.fromURL=function(h,d){return new c(h,d)},c.fromURI=function(h){return new c(h)};function c(u,h){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,h?this._uri=Object(s.buildAbsoluteURL)(u,h,{alwaysNormalize:!0}):this._uri=u}return o(c,[{key:"uri",get:function(){return this._uri}}]),c}()},"./src/loader/load-stats.ts":function(n,i,r){r.r(i),r.d(i,"LoadStats",function(){return s});var s=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return x});var s=r("./src/polyfills/number.ts"),a=r("./node_modules/url-toolkit/src/url-toolkit.js"),o=r("./src/loader/date-range.ts"),l=r("./src/loader/fragment.ts"),c=r("./src/loader/level-details.ts"),u=r("./src/loader/level-key.ts"),h=r("./src/utils/attr-list.ts"),d=r("./src/utils/logger.ts"),y=r("./src/utils/codecs.ts"),E=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,L=/#EXT-X-MEDIA:(.*)/g,_=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),A=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(DATERANGE|KEY|MAP|PART|PART-INF|PLAYLIST-TYPE|PRELOAD-HINT|RENDITION-REPORT|SERVER-CONTROL|SKIP|START):(.+)/.source,/#EXT-X-(BITRATE|DISCONTINUITY-SEQUENCE|MEDIA-SEQUENCE|TARGETDURATION|VERSION): *(\d+)/.source,/#EXT-X-(DISCONTINUITY|ENDLIST|GAP)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),v=/\.(mp4|m4s|m4v|m4a)$/i;function f(D){var b,T;return v.test((b=(T=a.parseURL(D))===null||T===void 0?void 0:T.path)!=null?b:"")}var x=function(){function D(){}return D.findGroup=function(T,P){for(var M=0;M<T.length;M++){var O=T[M];if(O.id===P)return O}},D.convertAVC1ToAVCOTI=function(T){var P=T.split(".");if(P.length>2){var M=P.shift()+".";return M+=parseInt(P.shift()).toString(16),M+=("000"+parseInt(P.shift()).toString(16)).slice(-4),M}return T},D.resolve=function(T,P){return a.buildAbsoluteURL(P,T,{alwaysNormalize:!0})},D.parseMasterPlaylist=function(T,P){var M=[],O={},R=!1;E.lastIndex=0;for(var I;(I=E.exec(T))!=null;)if(I[1]){var w=new h.AttrList(I[1]),k={attrs:w,bitrate:w.decimalInteger("AVERAGE-BANDWIDTH")||w.decimalInteger("BANDWIDTH"),name:w.NAME,url:D.resolve(I[2],P)},B=w.decimalResolution("RESOLUTION");B&&(k.width=B.width,k.height=B.height),S((w.CODECS||"").split(/[ ,]+/).filter(function(N){return N}),k),k.videoCodec&&k.videoCodec.indexOf("avc1")!==-1&&(k.videoCodec=D.convertAVC1ToAVCOTI(k.videoCodec)),M.push(k)}else if(I[3]){var F=new h.AttrList(I[3]);F["DATA-ID"]&&(R=!0,O[F["DATA-ID"]]=F)}return{levels:M,sessionData:R?O:null}},D.parseMasterPlaylistMedia=function(T,P,M,O){O===void 0&&(O=[]);var R,I=[],w=0;for(L.lastIndex=0;(R=L.exec(T))!==null;){var k=new h.AttrList(R[1]);if(k.TYPE===M){var B={attrs:k,bitrate:0,id:w++,groupId:k["GROUP-ID"],instreamId:k["INSTREAM-ID"],name:k.NAME||k.LANGUAGE||"",type:M,default:k.bool("DEFAULT"),autoselect:k.bool("AUTOSELECT"),forced:k.bool("FORCED"),lang:k.LANGUAGE,url:k.URI?D.resolve(k.URI,P):""};if(O.length){var F=D.findGroup(O,B.groupId)||O[0];C(B,F,"audioCodec"),C(B,F,"textCodec")}I.push(B)}}return I},D.parseLevelPlaylist=function(T,P,M,O,R){var I=new c.LevelDetails(P),w=I.fragments,k=null,B=0,F=0,N=0,K=0,H=null,U=new l.Fragment(O,P),j,$,X,Z=-1,nt=!1;for(_.lastIndex=0,I.m3u8=T;(j=_.exec(T))!==null;){nt&&(nt=!1,U=new l.Fragment(O,P),U.start=N,U.sn=B,U.cc=K,U.level=M,k&&(U.initSegment=k,U.rawProgramDateTime=k.rawProgramDateTime,k.rawProgramDateTime=null));var at=j[1];if(at){U.duration=parseFloat(at);var it=(" "+j[2]).slice(1);U.title=it||null,U.tagList.push(it?["INF",at,it]:["INF",at])}else if(j[3])Object(s.isFiniteNumber)(U.duration)&&(U.start=N,X&&(U.levelkey=X),U.sn=B,U.level=M,U.cc=K,U.urlId=R,w.push(U),U.relurl=(" "+j[3]).slice(1),g(U,H),H=U,N+=U.duration,B++,F=0,nt=!0);else if(j[4]){var W=(" "+j[4]).slice(1);H?U.setByteRange(W,H):U.setByteRange(W)}else if(j[5])U.rawProgramDateTime=(" "+j[5]).slice(1),U.tagList.push(["PROGRAM-DATE-TIME",U.rawProgramDateTime]),Z===-1&&(Z=w.length);else{if(j=j[0].match(A),!j){d.logger.warn("No matches on slow regex match for level playlist!");continue}for($=1;$<j.length&&!(typeof j[$]<"u");$++);var V=(" "+j[$]).slice(1),z=(" "+j[$+1]).slice(1),Y=j[$+2]?(" "+j[$+2]).slice(1):"";switch(V){case"PLAYLIST-TYPE":I.type=z.toUpperCase();break;case"MEDIA-SEQUENCE":B=I.startSN=parseInt(z);break;case"SKIP":{var Q=new h.AttrList(z),J=Q.decimalInteger("SKIPPED-SEGMENTS");if(Object(s.isFiniteNumber)(J)){I.skippedSegments=J;for(var rt=J;rt--;)w.unshift(null);B+=J}var tt=Q.enumeratedString("RECENTLY-REMOVED-DATERANGES");tt&&(I.recentlyRemovedDateranges=tt.split("	"));break}case"TARGETDURATION":I.targetduration=parseFloat(z);break;case"VERSION":I.version=parseInt(z);break;case"EXTM3U":break;case"ENDLIST":I.live=!1;break;case"#":(z||Y)&&U.tagList.push(Y?[z,Y]:[z]);break;case"DISCONTINUITY":K++,U.tagList.push(["DIS"]);break;case"GAP":U.tagList.push([V]);break;case"BITRATE":U.tagList.push([V,z]);break;case"DATERANGE":{var et=new h.AttrList(z),q=new o.DateRange(et,I.dateRanges[et.ID]);q.isValid||I.skippedSegments?I.dateRanges[q.id]=q:d.logger.warn('Ignoring invalid DATERANGE tag: "'+z+'"'),U.tagList.push(["EXT-X-DATERANGE",z]);break}case"DISCONTINUITY-SEQUENCE":K=parseInt(z);break;case"KEY":{var ut,lt=new h.AttrList(z),ft=lt.enumeratedString("METHOD"),dt=lt.URI,vt=lt.hexadecimalInteger("IV"),Et=lt.enumeratedString("KEYFORMATVERSIONS"),yt=lt.enumeratedString("KEYID"),Tt=(ut=lt.enumeratedString("KEYFORMAT"))!=null?ut:"identity",Wt=["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"];if(Wt.indexOf(Tt)>-1){d.logger.warn("Keyformat "+Tt+" is not supported from the manifest");continue}else if(Tt!=="identity")continue;ft&&(X=u.LevelKey.fromURL(P,dt),dt&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(ft)>=0&&(X.method=ft,X.keyFormat=Tt,yt&&(X.keyID=yt),Et&&(X.keyFormatVersions=Et),X.iv=vt));break}case"START":{var te=new h.AttrList(z),Ht=te.decimalFloatingPoint("TIME-OFFSET");Object(s.isFiniteNumber)(Ht)&&(I.startTimeOffset=Ht);break}case"MAP":{var jt=new h.AttrList(z);if(U.duration){var oe=new l.Fragment(O,P);m(oe,jt,M,X),k=oe,U.initSegment=k,k.rawProgramDateTime&&!U.rawProgramDateTime&&(U.rawProgramDateTime=k.rawProgramDateTime)}else m(U,jt,M,X),k=U,nt=!0;break}case"SERVER-CONTROL":{var St=new h.AttrList(z);I.canBlockReload=St.bool("CAN-BLOCK-RELOAD"),I.canSkipUntil=St.optionalFloat("CAN-SKIP-UNTIL",0),I.canSkipDateRanges=I.canSkipUntil>0&&St.bool("CAN-SKIP-DATERANGES"),I.partHoldBack=St.optionalFloat("PART-HOLD-BACK",0),I.holdBack=St.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var It=new h.AttrList(z);I.partTarget=It.decimalFloatingPoint("PART-TARGET");break}case"PART":{var ee=I.partList;ee||(ee=I.partList=[]);var Qe=F>0?ee[ee.length-1]:void 0,Rn=F++,ni=new l.Part(new h.AttrList(z),U,P,Rn,Qe);ee.push(ni),U.duration+=ni.duration;break}case"PRELOAD-HINT":{var Ne=new h.AttrList(z);I.preloadHint=Ne;break}case"RENDITION-REPORT":{var Ks=new h.AttrList(z);I.renditionReports=I.renditionReports||[],I.renditionReports.push(Ks);break}default:d.logger.warn("line parsed but not handled: "+j);break}}}H&&!H.relurl?(w.pop(),N-=H.duration,I.partList&&(I.fragmentHint=H)):I.partList&&(g(U,H),U.cc=K,I.fragmentHint=U);var In=w.length,Ze=w[0],ii=w[In-1];if(N+=I.skippedSegments*I.targetduration,N>0&&In&&ii){I.averagetargetduration=N/In;var wn=ii.sn;I.endSN=wn!=="initSegment"?wn:0,Ze&&(I.startCC=Ze.cc,Ze.initSegment||I.fragments.every(function(_r){return _r.relurl&&f(_r.relurl)})&&(d.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),U=new l.Fragment(O,P),U.relurl=ii.relurl,U.level=M,U.sn="initSegment",Ze.initSegment=U,I.needSidxRanges=!0))}else I.endSN=0,I.startCC=0;return I.fragmentHint&&(N+=I.fragmentHint.duration),I.totalduration=N,I.endCC=K,Z>0&&p(w,Z),I},D}();function S(D,b){["video","audio","text"].forEach(function(T){var P=D.filter(function(O){return Object(y.isCodecType)(O,T)});if(P.length){var M=P.filter(function(O){return O.lastIndexOf("avc1",0)===0||O.lastIndexOf("mp4a",0)===0});b[T+"Codec"]=M.length>0?M[0]:P[0],D=D.filter(function(O){return P.indexOf(O)===-1})}}),b.unknownCodecs=D}function C(D,b,T){var P=b[T];P&&(D[T]=P)}function p(D,b){for(var T=D[b],P=b;P--;){var M=D[P];if(!M)return;M.programDateTime=T.programDateTime-M.duration*1e3,T=M}}function g(D,b){D.rawProgramDateTime?D.programDateTime=Date.parse(D.rawProgramDateTime):b!=null&&b.programDateTime&&(D.programDateTime=b.endProgramDateTime),Object(s.isFiniteNumber)(D.programDateTime)||(D.programDateTime=null,D.rawProgramDateTime=null)}function m(D,b,T,P){D.relurl=b.URI,b.BYTERANGE&&D.setByteRange(b.BYTERANGE),D.level=T,D.sn="initSegment",P&&(D.levelkey=P),D.initSegment=null}},"./src/loader/playlist-loader.ts":function(n,i,r){r.r(i);var s=r("./src/polyfills/number.ts"),a=r("./src/events.ts"),o=r("./src/errors.ts"),l=r("./src/utils/logger.ts"),c=r("./src/utils/mp4-tools.ts"),u=r("./src/loader/m3u8-parser.ts"),h=r("./src/types/loader.ts"),d=r("./src/utils/attr-list.ts");function y(_){var A=_.type;switch(A){case h.PlaylistContextType.AUDIO_TRACK:return h.PlaylistLevelType.AUDIO;case h.PlaylistContextType.SUBTITLE_TRACK:return h.PlaylistLevelType.SUBTITLE;default:return h.PlaylistLevelType.MAIN}}function E(_,A){var v=_.url;return(v===void 0||v.indexOf("data:")===0)&&(v=A.url),v}var L=function(){function _(v){this.hls=void 0,this.loaders=Object.create(null),this.hls=v,this.registerListeners()}var A=_.prototype;return A.startLoad=function(f){},A.stopLoad=function(){this.destroyInternalLoaders()},A.registerListeners=function(){var f=this.hls;f.on(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.on(a.Events.LEVEL_LOADING,this.onLevelLoading,this),f.on(a.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),f.on(a.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},A.unregisterListeners=function(){var f=this.hls;f.off(a.Events.MANIFEST_LOADING,this.onManifestLoading,this),f.off(a.Events.LEVEL_LOADING,this.onLevelLoading,this),f.off(a.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),f.off(a.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},A.createInternalLoader=function(f){var x=this.hls.config,S=x.pLoader,C=x.loader,p=S||C,g=new p(x);return f.loader=g,this.loaders[f.type]=g,g},A.getInternalLoader=function(f){return this.loaders[f.type]},A.resetInternalLoader=function(f){this.loaders[f]&&delete this.loaders[f]},A.destroyInternalLoaders=function(){for(var f in this.loaders){var x=this.loaders[f];x&&x.destroy(),this.resetInternalLoader(f)}},A.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},A.onManifestLoading=function(f,x){var S=x.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:h.PlaylistContextType.MANIFEST,url:S,deliveryDirectives:null})},A.onLevelLoading=function(f,x){var S=x.id,C=x.level,p=x.url,g=x.deliveryDirectives;this.load({id:S,groupId:null,level:C,responseType:"text",type:h.PlaylistContextType.LEVEL,url:p,deliveryDirectives:g})},A.onAudioTrackLoading=function(f,x){var S=x.id,C=x.groupId,p=x.url,g=x.deliveryDirectives;this.load({id:S,groupId:C,level:null,responseType:"text",type:h.PlaylistContextType.AUDIO_TRACK,url:p,deliveryDirectives:g})},A.onSubtitleTrackLoading=function(f,x){var S=x.id,C=x.groupId,p=x.url,g=x.deliveryDirectives;this.load({id:S,groupId:C,level:null,responseType:"text",type:h.PlaylistContextType.SUBTITLE_TRACK,url:p,deliveryDirectives:g})},A.load=function(f){var x,S=this.hls.config,C=this.getInternalLoader(f);if(C){var p=C.context;if(p&&p.url===f.url){l.logger.trace("[playlist-loader]: playlist request ongoing");return}l.logger.log("[playlist-loader]: aborting previous loader for type: "+f.type),C.abort()}var g,m,D,b;switch(f.type){case h.PlaylistContextType.MANIFEST:g=S.manifestLoadingMaxRetry,m=S.manifestLoadingTimeOut,D=S.manifestLoadingRetryDelay,b=S.manifestLoadingMaxRetryTimeout;break;case h.PlaylistContextType.LEVEL:case h.PlaylistContextType.AUDIO_TRACK:case h.PlaylistContextType.SUBTITLE_TRACK:g=0,m=S.levelLoadingTimeOut;break;default:g=S.levelLoadingMaxRetry,m=S.levelLoadingTimeOut,D=S.levelLoadingRetryDelay,b=S.levelLoadingMaxRetryTimeout;break}if(C=this.createInternalLoader(f),(x=f.deliveryDirectives)!==null&&x!==void 0&&x.part){var T;if(f.type===h.PlaylistContextType.LEVEL&&f.level!==null?T=this.hls.levels[f.level].details:f.type===h.PlaylistContextType.AUDIO_TRACK&&f.id!==null?T=this.hls.audioTracks[f.id].details:f.type===h.PlaylistContextType.SUBTITLE_TRACK&&f.id!==null&&(T=this.hls.subtitleTracks[f.id].details),T){var P=T.partTarget,M=T.targetduration;P&&M&&(m=Math.min(Math.max(P*3,M*.8)*1e3,m))}}var O={timeout:m,maxRetry:g,retryDelay:D,maxRetryDelay:b,highWaterMark:0},R={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};C.load(f,O,R)},A.loadsuccess=function(f,x,S,C){if(C===void 0&&(C=null),S.isSidxRequest){this.handleSidxRequest(f,S),this.handlePlaylistLoaded(f,x,S,C);return}this.resetInternalLoader(S.type);var p=f.data;if(p.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(f,S,"no EXTM3U delimiter",C);return}x.parsing.start=performance.now(),p.indexOf("#EXTINF:")>0||p.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(f,x,S,C):this.handleMasterPlaylist(f,x,S,C)},A.loaderror=function(f,x,S){S===void 0&&(S=null),this.handleNetworkError(x,S,!1,f)},A.loadtimeout=function(f,x,S){S===void 0&&(S=null),this.handleNetworkError(x,S,!0)},A.handleMasterPlaylist=function(f,x,S,C){var p=this.hls,g=f.data,m=E(f,S),D=u.default.parseMasterPlaylist(g,m),b=D.levels,T=D.sessionData;if(!b.length){this.handleManifestParsingError(f,S,"no level found in manifest",C);return}var P=b.map(function(k){return{id:k.attrs.AUDIO,audioCodec:k.audioCodec}}),M=b.map(function(k){return{id:k.attrs.SUBTITLES,textCodec:k.textCodec}}),O=u.default.parseMasterPlaylistMedia(g,m,"AUDIO",P),R=u.default.parseMasterPlaylistMedia(g,m,"SUBTITLES",M),I=u.default.parseMasterPlaylistMedia(g,m,"CLOSED-CAPTIONS");if(O.length){var w=O.some(function(k){return!k.url});!w&&b[0].audioCodec&&!b[0].attrs.AUDIO&&(l.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),O.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new d.AttrList({}),bitrate:0,url:""}))}p.trigger(a.Events.MANIFEST_LOADED,{levels:b,audioTracks:O,subtitles:R,captions:I,url:m,stats:x,networkDetails:C,sessionData:T})},A.handleTrackOrLevelPlaylist=function(f,x,S,C){var p=this.hls,g=S.id,m=S.level,D=S.type,b=E(f,S),T=Object(s.isFiniteNumber)(g)?g:0,P=Object(s.isFiniteNumber)(m)?m:T,M=y(S),O=u.default.parseLevelPlaylist(f.data,b,P,M,T);if(!O.fragments.length){p.trigger(a.Events.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:b,reason:"no fragments found in level",level:typeof S.level=="number"?S.level:void 0});return}if(D===h.PlaylistContextType.MANIFEST){var R={attrs:new d.AttrList({}),bitrate:0,details:O,name:"",url:b};p.trigger(a.Events.MANIFEST_LOADED,{levels:[R],audioTracks:[],url:b,stats:x,networkDetails:C,sessionData:null})}if(x.parsing.end=performance.now(),O.needSidxRanges){var I,w=(I=O.fragments[0].initSegment)===null||I===void 0?void 0:I.url;this.load({url:w,isSidxRequest:!0,type:D,level:m,levelDetails:O,id:g,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null});return}S.levelDetails=O,this.handlePlaylistLoaded(f,x,S,C)},A.handleSidxRequest=function(f,x){var S=new Uint8Array(f.data),C=Object(c.findBox)(S,["sidx"])[0];if(!!C){var p=Object(c.parseSegmentIndex)(C);if(!!p){var g=p.references,m=x.levelDetails;g.forEach(function(D,b){var T=D.info,P=m.fragments[b];if(P.byteRange.length===0&&P.setByteRange(String(1+T.end-T.start)+"@"+String(T.start)),P.initSegment){var M=Object(c.findBox)(S,["moov"])[0],O=M?M.length:null;P.initSegment.setByteRange(String(O)+"@0")}})}}},A.handleManifestParsingError=function(f,x,S,C){this.hls.trigger(a.Events.ERROR,{type:o.ErrorTypes.NETWORK_ERROR,details:o.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:x.type===h.PlaylistContextType.MANIFEST,url:f.url,reason:S,response:f,context:x,networkDetails:C})},A.handleNetworkError=function(f,x,S,C){S===void 0&&(S=!1),l.logger.warn("[playlist-loader]: A network "+(S?"timeout":"error")+" occurred while loading "+f.type+" level: "+f.level+" id: "+f.id+' group-id: "'+f.groupId+'"');var p=o.ErrorDetails.UNKNOWN,g=!1,m=this.getInternalLoader(f);switch(f.type){case h.PlaylistContextType.MANIFEST:p=S?o.ErrorDetails.MANIFEST_LOAD_TIMEOUT:o.ErrorDetails.MANIFEST_LOAD_ERROR,g=!0;break;case h.PlaylistContextType.LEVEL:p=S?o.ErrorDetails.LEVEL_LOAD_TIMEOUT:o.ErrorDetails.LEVEL_LOAD_ERROR,g=!1;break;case h.PlaylistContextType.AUDIO_TRACK:p=S?o.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:o.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,g=!1;break;case h.PlaylistContextType.SUBTITLE_TRACK:p=S?o.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:o.ErrorDetails.SUBTITLE_LOAD_ERROR,g=!1;break}m&&this.resetInternalLoader(f.type);var D={type:o.ErrorTypes.NETWORK_ERROR,details:p,fatal:g,url:f.url,loader:m,context:f,networkDetails:x};C&&(D.response=C),this.hls.trigger(a.Events.ERROR,D)},A.handlePlaylistLoaded=function(f,x,S,C){var p=S.type,g=S.level,m=S.id,D=S.groupId,b=S.loader,T=S.levelDetails,P=S.deliveryDirectives;if(!(T!=null&&T.targetduration)){this.handleManifestParsingError(f,S,"invalid target duration",C);return}if(!!b)switch(T.live&&(b.getCacheAge&&(T.ageHeader=b.getCacheAge()||0),(!b.getCacheAge||isNaN(T.ageHeader))&&(T.ageHeader=0)),p){case h.PlaylistContextType.MANIFEST:case h.PlaylistContextType.LEVEL:this.hls.trigger(a.Events.LEVEL_LOADED,{details:T,level:g||0,id:m||0,stats:x,networkDetails:C,deliveryDirectives:P});break;case h.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(a.Events.AUDIO_TRACK_LOADED,{details:T,id:m||0,groupId:D||"",stats:x,networkDetails:C,deliveryDirectives:P});break;case h.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(a.Events.SUBTITLE_TRACK_LOADED,{details:T,id:m||0,groupId:D||"",stats:x,networkDetails:C,deliveryDirectives:P});break}},_}();i.default=L},"./src/polyfills/number.ts":function(n,i,r){r.r(i),r.d(i,"isFiniteNumber",function(){return s}),r.d(i,"MAX_SAFE_INTEGER",function(){return a});var s=Number.isFinite||function(o){return typeof o=="number"&&isFinite(o)},a=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(n,i,r){r.r(i);var s=function(){function a(){}return a.getSilentFrame=function(l,c){switch(l){case"mp4a.40.2":if(c===1)return new Uint8Array([0,200,0,128,35,128]);if(c===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(c===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(c===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(c===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(c===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(c===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(c===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(c===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},a}();i.default=s},"./src/remux/mp4-generator.ts":function(n,i,r){r.r(i);var s=Math.pow(2,32)-1,a=function(){function o(){}return o.init=function(){o.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var c;for(c in o.types)o.types.hasOwnProperty(c)&&(o.types[c]=[c.charCodeAt(0),c.charCodeAt(1),c.charCodeAt(2),c.charCodeAt(3)]);var u=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),h=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);o.HDLR_TYPES={video:u,audio:h};var d=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),y=new Uint8Array([0,0,0,0,0,0,0,0]);o.STTS=o.STSC=o.STCO=y,o.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),o.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),o.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),o.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var E=new Uint8Array([105,115,111,109]),L=new Uint8Array([97,118,99,49]),_=new Uint8Array([0,0,0,1]);o.FTYP=o.box(o.types.ftyp,E,_,E,L),o.DINF=o.box(o.types.dinf,o.box(o.types.dref,d))},o.box=function(c){for(var u=8,h=arguments.length,d=new Array(h>1?h-1:0),y=1;y<h;y++)d[y-1]=arguments[y];for(var E=d.length,L=E;E--;)u+=d[E].byteLength;var _=new Uint8Array(u);for(_[0]=u>>24&255,_[1]=u>>16&255,_[2]=u>>8&255,_[3]=u&255,_.set(c,4),E=0,u=8;E<L;E++)_.set(d[E],u),u+=d[E].byteLength;return _},o.hdlr=function(c){return o.box(o.types.hdlr,o.HDLR_TYPES[c])},o.mdat=function(c){return o.box(o.types.mdat,c)},o.mdhd=function(c,u){u*=c;var h=Math.floor(u/(s+1)),d=Math.floor(u%(s+1));return o.box(o.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,c>>24&255,c>>16&255,c>>8&255,c&255,h>>24,h>>16&255,h>>8&255,h&255,d>>24,d>>16&255,d>>8&255,d&255,85,196,0,0]))},o.mdia=function(c){return o.box(o.types.mdia,o.mdhd(c.timescale,c.duration),o.hdlr(c.type),o.minf(c))},o.mfhd=function(c){return o.box(o.types.mfhd,new Uint8Array([0,0,0,0,c>>24,c>>16&255,c>>8&255,c&255]))},o.minf=function(c){return c.type==="audio"?o.box(o.types.minf,o.box(o.types.smhd,o.SMHD),o.DINF,o.stbl(c)):o.box(o.types.minf,o.box(o.types.vmhd,o.VMHD),o.DINF,o.stbl(c))},o.moof=function(c,u,h){return o.box(o.types.moof,o.mfhd(c),o.traf(h,u))},o.moov=function(c){for(var u=c.length,h=[];u--;)h[u]=o.trak(c[u]);return o.box.apply(null,[o.types.moov,o.mvhd(c[0].timescale,c[0].duration)].concat(h).concat(o.mvex(c)))},o.mvex=function(c){for(var u=c.length,h=[];u--;)h[u]=o.trex(c[u]);return o.box.apply(null,[o.types.mvex].concat(h))},o.mvhd=function(c,u){u*=c;var h=Math.floor(u/(s+1)),d=Math.floor(u%(s+1)),y=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,c>>24&255,c>>16&255,c>>8&255,c&255,h>>24,h>>16&255,h>>8&255,h&255,d>>24,d>>16&255,d>>8&255,d&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return o.box(o.types.mvhd,y)},o.sdtp=function(c){var u=c.samples||[],h=new Uint8Array(4+u.length),d,y;for(d=0;d<u.length;d++)y=u[d].flags,h[d+4]=y.dependsOn<<4|y.isDependedOn<<2|y.hasRedundancy;return o.box(o.types.sdtp,h)},o.stbl=function(c){return o.box(o.types.stbl,o.stsd(c),o.box(o.types.stts,o.STTS),o.box(o.types.stsc,o.STSC),o.box(o.types.stsz,o.STSZ),o.box(o.types.stco,o.STCO))},o.avc1=function(c){var u=[],h=[],d,y,E;for(d=0;d<c.sps.length;d++)y=c.sps[d],E=y.byteLength,u.push(E>>>8&255),u.push(E&255),u=u.concat(Array.prototype.slice.call(y));for(d=0;d<c.pps.length;d++)y=c.pps[d],E=y.byteLength,h.push(E>>>8&255),h.push(E&255),h=h.concat(Array.prototype.slice.call(y));var L=o.box(o.types.avcC,new Uint8Array([1,u[3],u[4],u[5],255,224|c.sps.length].concat(u).concat([c.pps.length]).concat(h))),_=c.width,A=c.height,v=c.pixelRatio[0],f=c.pixelRatio[1];return o.box(o.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,_>>8&255,_&255,A>>8&255,A&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),L,o.box(o.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),o.box(o.types.pasp,new Uint8Array([v>>24,v>>16&255,v>>8&255,v&255,f>>24,f>>16&255,f>>8&255,f&255])))},o.esds=function(c){var u=c.config.length;return new Uint8Array([0,0,0,0,3,23+u,0,1,0,4,15+u,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([u]).concat(c.config).concat([6,1,2]))},o.mp4a=function(c){var u=c.samplerate;return o.box(o.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,c.channelCount,0,16,0,0,0,0,u>>8&255,u&255,0,0]),o.box(o.types.esds,o.esds(c)))},o.mp3=function(c){var u=c.samplerate;return o.box(o.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,c.channelCount,0,16,0,0,0,0,u>>8&255,u&255,0,0]))},o.stsd=function(c){return c.type==="audio"?c.segmentCodec==="mp3"&&c.codec==="mp3"?o.box(o.types.stsd,o.STSD,o.mp3(c)):o.box(o.types.stsd,o.STSD,o.mp4a(c)):o.box(o.types.stsd,o.STSD,o.avc1(c))},o.tkhd=function(c){var u=c.id,h=c.duration*c.timescale,d=c.width,y=c.height,E=Math.floor(h/(s+1)),L=Math.floor(h%(s+1));return o.box(o.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,u>>24&255,u>>16&255,u>>8&255,u&255,0,0,0,0,E>>24,E>>16&255,E>>8&255,E&255,L>>24,L>>16&255,L>>8&255,L&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,d>>8&255,d&255,0,0,y>>8&255,y&255,0,0]))},o.traf=function(c,u){var h=o.sdtp(c),d=c.id,y=Math.floor(u/(s+1)),E=Math.floor(u%(s+1));return o.box(o.types.traf,o.box(o.types.tfhd,new Uint8Array([0,0,0,0,d>>24,d>>16&255,d>>8&255,d&255])),o.box(o.types.tfdt,new Uint8Array([1,0,0,0,y>>24,y>>16&255,y>>8&255,y&255,E>>24,E>>16&255,E>>8&255,E&255])),o.trun(c,h.length+16+20+8+16+8+8),h)},o.trak=function(c){return c.duration=c.duration||4294967295,o.box(o.types.trak,o.tkhd(c),o.mdia(c))},o.trex=function(c){var u=c.id;return o.box(o.types.trex,new Uint8Array([0,0,0,0,u>>24,u>>16&255,u>>8&255,u&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},o.trun=function(c,u){var h=c.samples||[],d=h.length,y=12+16*d,E=new Uint8Array(y),L,_,A,v,f,x;for(u+=8+y,E.set([c.type==="video"?1:0,0,15,1,d>>>24&255,d>>>16&255,d>>>8&255,d&255,u>>>24&255,u>>>16&255,u>>>8&255,u&255],0),L=0;L<d;L++)_=h[L],A=_.duration,v=_.size,f=_.flags,x=_.cts,E.set([A>>>24&255,A>>>16&255,A>>>8&255,A&255,v>>>24&255,v>>>16&255,v>>>8&255,v&255,f.isLeading<<2|f.dependsOn,f.isDependedOn<<6|f.hasRedundancy<<4|f.paddingValue<<1|f.isNonSync,f.degradPrio&240<<8,f.degradPrio&15,x>>>24&255,x>>>16&255,x>>>8&255,x&255],12+16*L);return o.box(o.types.trun,E)},o.initSegment=function(c){o.types||o.init();var u=o.moov(c),h=new Uint8Array(o.FTYP.byteLength+u.byteLength);return h.set(o.FTYP),h.set(u,o.FTYP.byteLength),h},o}();a.types=void 0,a.HDLR_TYPES=void 0,a.STTS=void 0,a.STSC=void 0,a.STCO=void 0,a.STSZ=void 0,a.VMHD=void 0,a.SMHD=void 0,a.STSD=void 0,a.FTYP=void 0,a.DINF=void 0,i.default=a},"./src/remux/mp4-remuxer.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return f}),r.d(i,"normalizePts",function(){return x}),r.d(i,"flushTextTrackMetadataCueSamples",function(){return C}),r.d(i,"flushTextTrackUserdataCueSamples",function(){return p});var s=r("./src/polyfills/number.ts"),a=r("./src/remux/aac-helper.ts"),o=r("./src/remux/mp4-generator.ts"),l=r("./src/events.ts"),c=r("./src/errors.ts"),u=r("./src/utils/logger.ts"),h=r("./src/types/loader.ts"),d=r("./src/utils/timescale-conversion.ts");function y(){return y=Object.assign?Object.assign.bind():function(D){for(var b=1;b<arguments.length;b++){var T=arguments[b];for(var P in T)Object.prototype.hasOwnProperty.call(T,P)&&(D[P]=T[P])}return D},y.apply(this,arguments)}var E=10*1e3,L=1024,_=1152,A=null,v=null,f=function(){function D(T,P,M,O){if(this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.videoSampleDuration=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=T,this.config=P,this.typeSupported=M,this.ISGenerated=!1,A===null){var R=navigator.userAgent||"",I=R.match(/Chrome\/(\d+)/i);A=I?parseInt(I[1]):0}if(v===null){var w=navigator.userAgent.match(/Safari\/(\d+)/i);v=w?parseInt(w[1]):0}}var b=D.prototype;return b.destroy=function(){},b.resetTimeStamp=function(P){u.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=P},b.resetNextTimestamp=function(){u.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},b.resetInitSegment=function(){u.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},b.getVideoStartPts=function(P){var M=!1,O=P.reduce(function(R,I){var w=I.pts-R;return w<-4294967296?(M=!0,x(R,I.pts)):w>0?R:I.pts},P[0].pts);return M&&u.logger.debug("PTS rollover detected"),O},b.remux=function(P,M,O,R,I,w,k,B){var F,N,K,H,U,j,$=I,X=I,Z=P.pid>-1,nt=M.pid>-1,at=M.samples.length,it=P.samples.length>0,W=k&&at>0||at>1,V=(!Z||it)&&(!nt||W)||this.ISGenerated||k;if(V){this.ISGenerated||(K=this.generateIS(P,M,I));var z=this.isVideoContiguous,Y=-1,Q;if(W&&(Y=S(M.samples),!z&&this.config.forceKeyFrameOnDiscontinuity))if(j=!0,Y>0){u.logger.warn("[mp4-remuxer]: Dropped "+Y+" out of "+at+" video samples due to a missing keyframe");var J=this.getVideoStartPts(M.samples);M.samples=M.samples.slice(Y),M.dropped+=Y,X+=(M.samples[0].pts-J)/M.inputTimeScale,Q=X}else Y===-1&&(u.logger.warn("[mp4-remuxer]: No keyframe found out of "+at+" video samples"),j=!1);if(this.ISGenerated){if(it&&W){var rt=this.getVideoStartPts(M.samples),tt=x(P.samples[0].pts,rt)-rt,et=tt/M.inputTimeScale;$+=Math.max(0,et),X+=Math.max(0,-et)}if(it){if(P.samplerate||(u.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),K=this.generateIS(P,M,I)),N=this.remuxAudio(P,$,this.isAudioContiguous,w,nt||W||B===h.PlaylistLevelType.AUDIO?X:void 0),W){var q=N?N.endPTS-N.startPTS:0;M.inputTimeScale||(u.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),K=this.generateIS(P,M,I)),F=this.remuxVideo(M,X,z,q)}}else W&&(F=this.remuxVideo(M,X,z,0));F&&(F.firstKeyFrame=Y,F.independent=Y!==-1,F.firstKeyFramePTS=Q)}}return this.ISGenerated&&(O.samples.length&&(U=C(O,I,this._initPTS,this._initDTS)),R.samples.length&&(H=p(R,I,this._initPTS))),{audio:N,video:F,initSegment:K,independent:j,text:H,id3:U}},b.generateIS=function(P,M,O){var R=P.samples,I=M.samples,w=this.typeSupported,k={},B=!Object(s.isFiniteNumber)(this._initPTS),F="audio/mp4",N,K,H;if(B&&(N=K=1/0),P.config&&R.length){switch(P.timescale=P.samplerate,P.segmentCodec){case"mp3":w.mpeg?(F="audio/mpeg",P.codec=""):w.mp3&&(P.codec="mp3");break}k.audio={id:"audio",container:F,codec:P.codec,initSegment:P.segmentCodec==="mp3"&&w.mpeg?new Uint8Array(0):o.default.initSegment([P]),metadata:{channelCount:P.channelCount}},B&&(H=P.inputTimeScale,N=K=R[0].pts-Math.round(H*O))}if(M.sps&&M.pps&&I.length&&(M.timescale=M.inputTimeScale,k.video={id:"main",container:"video/mp4",codec:M.codec,initSegment:o.default.initSegment([M]),metadata:{width:M.width,height:M.height}},B)){H=M.inputTimeScale;var U=this.getVideoStartPts(I),j=Math.round(H*O);K=Math.min(K,x(I[0].dts,U)-j),N=Math.min(N,U-j)}if(Object.keys(k).length)return this.ISGenerated=!0,B&&(this._initPTS=N,this._initDTS=K),{tracks:k,initPTS:N,timescale:H}},b.remuxVideo=function(P,M,O,R){var I=P.inputTimeScale,w=P.samples,k=[],B=w.length,F=this._initPTS,N=this.nextAvcDts,K=8,H=this.videoSampleDuration,U,j,$=Number.POSITIVE_INFINITY,X=Number.NEGATIVE_INFINITY,Z=!1;if(!O||N===null){var nt=M*I,at=w[0].pts-x(w[0].dts,w[0].pts);N=nt-at}for(var it=0;it<B;it++){var W=w[it];W.pts=x(W.pts-F,N),W.dts=x(W.dts-F,N),W.dts<w[it>0?it-1:it].dts&&(Z=!0)}Z&&w.sort(function(Vs,Wo){var Wd=Vs.dts-Wo.dts,Kd=Vs.pts-Wo.pts;return Wd||Kd}),U=w[0].dts,j=w[w.length-1].dts;var V=j-U,z=V?Math.round(V/(B-1)):H||P.inputTimeScale/30;if(O){var Y=U-N,Q=Y>z,J=Y<-1;if(Q||J){Q?u.logger.warn("AVC: "+Object(d.toMsFromMpegTsClock)(Y,!0)+" ms ("+Y+"dts) hole between fragments detected, filling it"):u.logger.warn("AVC: "+Object(d.toMsFromMpegTsClock)(-Y,!0)+" ms ("+Y+"dts) overlapping between fragments detected"),U=N;var rt=w[0].pts-Y;w[0].dts=U,w[0].pts=rt,u.logger.log("Video: First PTS/DTS adjusted: "+Object(d.toMsFromMpegTsClock)(rt,!0)+"/"+Object(d.toMsFromMpegTsClock)(U,!0)+", delta: "+Object(d.toMsFromMpegTsClock)(Y,!0)+" ms")}}U=Math.max(0,U);for(var tt=0,et=0,q=0;q<B;q++){for(var ut=w[q],lt=ut.units,ft=lt.length,dt=0,vt=0;vt<ft;vt++)dt+=lt[vt].data.length;et+=dt,tt+=ft,ut.length=dt,ut.dts=Math.max(ut.dts,U),$=Math.min(ut.pts,$),X=Math.max(ut.pts,X)}j=w[B-1].dts;var Et=et+4*tt+8,yt;try{yt=new Uint8Array(Et)}catch{this.observer.emit(l.Events.ERROR,l.Events.ERROR,{type:c.ErrorTypes.MUX_ERROR,details:c.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Et,reason:"fail allocating video mdat "+Et});return}var Tt=new DataView(yt.buffer);Tt.setUint32(0,Et),yt.set(o.default.types.mdat,4);for(var Wt=!1,te=Number.POSITIVE_INFINITY,Ht=Number.POSITIVE_INFINITY,jt=Number.NEGATIVE_INFINITY,oe=Number.NEGATIVE_INFINITY,St=0;St<B;St++){for(var It=w[St],ee=It.units,Qe=0,Rn=0,ni=ee.length;Rn<ni;Rn++){var Ne=ee[Rn],Ks=Ne.data,In=Ne.data.byteLength;Tt.setUint32(K,In),K+=4,yt.set(Ks,K),K+=In,Qe+=4+In}var Ze=void 0;if(St<B-1)H=w[St+1].dts-It.dts,Ze=w[St+1].pts-It.pts;else{var ii=this.config,wn=St>0?It.dts-w[St-1].dts:z;if(Ze=St>0?It.pts-w[St-1].pts:z,ii.stretchShortVideoTrack&&this.nextAudioPts!==null){var _r=Math.floor(ii.maxBufferHole*I),Hs=(R?$+R*I:this.nextAudioPts)-It.pts;Hs>_r?(H=Hs-wn,H<0?H=wn:Wt=!0,u.logger.log("[mp4-remuxer]: It is approximately "+Hs/90+" ms to the next segment; using duration "+H/90+" ms for the last video frame.")):H=wn}else H=wn}var wd=Math.round(It.pts-It.dts);te=Math.min(te,H),jt=Math.max(jt,H),Ht=Math.min(Ht,Ze),oe=Math.max(oe,Ze),k.push(new g(It.key,H,Qe,wd))}if(k.length){if(A){if(A<70){var Bo=k[0].flags;Bo.dependsOn=2,Bo.isNonSync=0}}else if(v&&oe-Ht<jt-te&&z/jt<.025&&k[0].cts===0){u.logger.warn("Found irregular gaps in sample duration. Using PTS instead of DTS to determine MP4 sample duration.");for(var js=U,De=0,No=k.length;De<No;De++){var Uo=js+k[De].duration,kd=js+k[De].cts;if(De<No-1){var Fd=Uo+k[De+1].cts;k[De].duration=Fd-kd}else k[De].duration=De?k[De-1].duration:z;k[De].cts=0,js=Uo}}}console.assert(H!==null,"mp4SampleDuration must be computed"),H=Wt||!H?z:H,this.nextAvcDts=N=j+H,this.videoSampleDuration=H,this.isVideoContiguous=!0;var Bd=o.default.moof(P.sequenceNumber++,U,y({},P,{samples:k})),Nd="video",Ud={data1:Bd,data2:yt,startPTS:$/I,endPTS:(X+H)/I,startDTS:U/I,endDTS:N/I,type:Nd,hasAudio:!1,hasVideo:!0,nb:k.length,dropped:P.dropped};return P.samples=[],P.dropped=0,console.assert(yt.length,"MDAT length must not be zero"),Ud},b.remuxAudio=function(P,M,O,R,I){var w=P.inputTimeScale,k=P.samplerate?P.samplerate:w,B=w/k,F=P.segmentCodec==="aac"?L:_,N=F*B,K=this._initPTS,H=P.segmentCodec==="mp3"&&this.typeSupported.mpeg,U=[],j=I!==void 0,$=P.samples,X=H?0:8,Z=this.nextAudioPts||-1,nt=M*w;if(this.isAudioContiguous=O=O||$.length&&Z>0&&(R&&Math.abs(nt-Z)<9e3||Math.abs(x($[0].pts-K,nt)-Z)<20*N),$.forEach(function(Ne){Ne.pts=x(Ne.pts-K,nt)}),!O||Z<0){if($=$.filter(function(Ne){return Ne.pts>=0}),!$.length)return;I===0?Z=0:R&&!j?Z=Math.max(0,nt):Z=$[0].pts}if(P.segmentCodec==="aac")for(var at=this.config.maxAudioFramesDrift,it=0,W=Z;it<$.length;it++){var V=$[it],z=V.pts,Y=z-W,Q=Math.abs(1e3*Y/w);if(Y<=-at*N&&j)it===0&&(u.logger.warn("Audio frame @ "+(z/w).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*Y/w)+" ms."),this.nextAudioPts=Z=W=z);else if(Y>=at*N&&Q<E&&j){var J=Math.round(Y/N);W=z-J*N,W<0&&(J--,W+=N),it===0&&(this.nextAudioPts=Z=W),u.logger.warn("[mp4-remuxer]: Injecting "+J+" audio frame @ "+(W/w).toFixed(3)+"s due to "+Math.round(1e3*Y/w)+" ms gap.");for(var rt=0;rt<J;rt++){var tt=Math.max(W,0),et=a.default.getSilentFrame(P.manifestCodec||P.codec,P.channelCount);et||(u.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),et=V.unit.subarray()),$.splice(it,0,{unit:et,pts:tt}),W+=N,it++}}V.pts=W,W+=N}for(var q=null,ut=null,lt,ft=0,dt=$.length;dt--;)ft+=$[dt].unit.byteLength;for(var vt=0,Et=$.length;vt<Et;vt++){var yt=$[vt],Tt=yt.unit,Wt=yt.pts;if(ut!==null){var te=U[vt-1];te.duration=Math.round((Wt-ut)/B)}else if(O&&P.segmentCodec==="aac"&&(Wt=Z),q=Wt,ft>0){ft+=X;try{lt=new Uint8Array(ft)}catch{this.observer.emit(l.Events.ERROR,l.Events.ERROR,{type:c.ErrorTypes.MUX_ERROR,details:c.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:ft,reason:"fail allocating audio mdat "+ft});return}if(!H){var Ht=new DataView(lt.buffer);Ht.setUint32(0,ft),lt.set(o.default.types.mdat,4)}}else return;lt.set(Tt,X);var jt=Tt.byteLength;X+=jt,U.push(new g(!0,F,jt,0)),ut=Wt}var oe=U.length;if(!!oe){var St=U[U.length-1];this.nextAudioPts=Z=ut+B*St.duration;var It=H?new Uint8Array(0):o.default.moof(P.sequenceNumber++,q/B,y({},P,{samples:U}));P.samples=[];var ee=q/w,Qe=Z/w,Rn="audio",ni={data1:It,data2:lt,startPTS:ee,endPTS:Qe,startDTS:ee,endDTS:Qe,type:Rn,hasAudio:!0,hasVideo:!1,nb:oe};return this.isAudioContiguous=!0,console.assert(lt.length,"MDAT length must not be zero"),ni}},b.remuxEmptyAudio=function(P,M,O,R){var I=P.inputTimeScale,w=P.samplerate?P.samplerate:I,k=I/w,B=this.nextAudioPts,F=(B!==null?B:R.startDTS*I)+this._initDTS,N=R.endDTS*I+this._initDTS,K=k*L,H=Math.ceil((N-F)/K),U=a.default.getSilentFrame(P.manifestCodec||P.codec,P.channelCount);if(u.logger.warn("[mp4-remuxer]: remux empty Audio"),!U){u.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var j=[],$=0;$<H;$++){var X=F+$*K;j.push({unit:U,pts:X,dts:X})}return P.samples=j,this.remuxAudio(P,M,O,!1)},D}();function x(D,b){var T;if(b===null)return D;for(b<D?T=-8589934592:T=8589934592;Math.abs(D-b)>4294967296;)D+=T;return D}function S(D){for(var b=0;b<D.length;b++)if(D[b].key)return b;return-1}function C(D,b,T,P){var M=D.samples.length;if(!!M){for(var O=D.inputTimeScale,R=0;R<M;R++){var I=D.samples[R];I.pts=x(I.pts-T,b*O)/O,I.dts=x(I.dts-P,b*O)/O}var w=D.samples;return D.samples=[],{samples:w}}}function p(D,b,T){var P=D.samples.length;if(!!P){for(var M=D.inputTimeScale,O=0;O<P;O++){var R=D.samples[O];R.pts=x(R.pts-T,b*M)/M}D.samples.sort(function(w,k){return w.pts-k.pts});var I=D.samples;return D.samples=[],{samples:I}}}var g=function(b,T,P,M){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=T,this.size=P,this.cts=M,this.flags=new m(b)},m=function(b){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=b?2:1,this.isNonSync=b?0:1}},"./src/remux/passthrough-remuxer.ts":function(n,i,r){r.r(i);var s=r("./src/polyfills/number.ts"),a=r("./src/remux/mp4-remuxer.ts"),o=r("./src/utils/mp4-tools.ts"),l=r("./src/loader/fragment.ts"),c=r("./src/utils/logger.ts"),u=function(){function d(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndTime=null}var y=d.prototype;return y.destroy=function(){},y.resetTimeStamp=function(L){this.initPTS=L,this.lastEndTime=null},y.resetNextTimestamp=function(){this.lastEndTime=null},y.resetInitSegment=function(L,_,A){this.audioCodec=_,this.videoCodec=A,this.generateInitSegment(L),this.emitInitSegment=!0},y.generateInitSegment=function(L){var _=this.audioCodec,A=this.videoCodec;if(!L||!L.byteLength){this.initTracks=void 0,this.initData=void 0;return}var v=this.initData=Object(o.parseInitSegment)(L);_||(_=h(v.audio,l.ElementaryStreamTypes.AUDIO)),A||(A=h(v.video,l.ElementaryStreamTypes.VIDEO));var f={};v.audio&&v.video?f.audiovideo={container:"video/mp4",codec:_+","+A,initSegment:L,id:"main"}:v.audio?f.audio={container:"audio/mp4",codec:_,initSegment:L,id:"audio"}:v.video?f.video={container:"video/mp4",codec:A,initSegment:L,id:"main"}:c.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=f},y.remux=function(L,_,A,v,f){var x,S=this.initPTS,C=this.lastEndTime,p={audio:void 0,video:void 0,text:v,id3:A,initSegment:void 0};Object(s.isFiniteNumber)(C)||(C=this.lastEndTime=f||0);var g=_.samples;if(!g||!g.length)return p;var m={initPTS:void 0,timescale:1},D=this.initData;if((!D||!D.length)&&(this.generateInitSegment(g),D=this.initData),!D||!D.length)return c.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),p;this.emitInitSegment&&(m.tracks=this.initTracks,this.emitInitSegment=!1);var b=Object(o.getStartDTS)(D,g);Object(s.isFiniteNumber)(S)||(this.initPTS=m.initPTS=S=b-f);var T=Object(o.getDuration)(g,D),P=L?b-S:C,M=P+T;Object(o.offsetStartDTS)(D,g,S),T>0?this.lastEndTime=M:(c.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var O=!!D.audio,R=!!D.video,I="";O&&(I+="audio"),R&&(I+="video");var w={data1:g,startPTS:P,startDTS:P,endPTS:M,endDTS:M,type:I,hasAudio:O,hasVideo:R,nb:1,dropped:0};p.audio=w.type==="audio"?w:void 0,p.video=w.type!=="audio"?w:void 0,p.initSegment=m;var k=(x=this.initPTS)!=null?x:0;return p.id3=Object(a.flushTextTrackMetadataCueSamples)(A,f,k,k),v.samples.length&&(p.text=Object(a.flushTextTrackUserdataCueSamples)(v,f,k)),p},d}();function h(d,y){var E=d==null?void 0:d.codec;return E&&E.length>4?E:E==="hvc1"||E==="hev1"?"hvc1.1.c.L120.90":E==="av01"?"av01.0.04M.08":E==="avc1"||y===l.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}i.default=u},"./src/task-loop.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return s});var s=function(){function a(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var o=a.prototype;return o.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},o.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},o.onHandlerDestroyed=function(){},o.hasInterval=function(){return!!this._tickInterval},o.hasNextTick=function(){return!!this._tickTimer},o.setInterval=function(c){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,c),!0)},o.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},o.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},o.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},o.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},o.doTick=function(){},a}()},"./src/types/cmcd.ts":function(n,i,r){r.r(i),r.d(i,"CMCDVersion",function(){return s}),r.d(i,"CMCDObjectType",function(){return a}),r.d(i,"CMCDStreamingFormat",function(){return o}),r.d(i,"CMCDStreamType",function(){return l});var s=1,a;(function(c){c.MANIFEST="m",c.AUDIO="a",c.VIDEO="v",c.MUXED="av",c.INIT="i",c.CAPTION="c",c.TIMED_TEXT="tt",c.KEY="k",c.OTHER="o"})(a||(a={}));var o;(function(c){c.DASH="d",c.HLS="h",c.SMOOTH="s",c.OTHER="o"})(o||(o={}));var l;(function(c){c.VOD="v",c.LIVE="l"})(l||(l={}))},"./src/types/demuxer.ts":function(n,i,r){r.r(i),r.d(i,"MetadataSchema",function(){return s});var s;(function(a){a.audioId3="org.id3",a.dateRange="com.apple.quicktime.HLS",a.emsg="https://aomedia.org/emsg/ID3"})(s||(s={}))},"./src/types/level.ts":function(n,i,r){r.r(i),r.d(i,"HlsSkip",function(){return o}),r.d(i,"getSkipValue",function(){return l}),r.d(i,"HlsUrlParameters",function(){return c}),r.d(i,"Level",function(){return u});function s(h,d){for(var y=0;y<d.length;y++){var E=d[y];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(h,E.key,E)}}function a(h,d,y){return d&&s(h.prototype,d),y&&s(h,y),Object.defineProperty(h,"prototype",{writable:!1}),h}var o;(function(h){h.No="",h.Yes="YES",h.v2="v2"})(o||(o={}));function l(h,d){var y=h.canSkipUntil,E=h.canSkipDateRanges,L=h.endSN,_=d!==void 0?d-L:0;return y&&_<y?E?o.v2:o.Yes:o.No}var c=function(){function h(y,E,L){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=y,this.part=E,this.skip=L}var d=h.prototype;return d.addDirectives=function(E){var L=new self.URL(E);return this.msn!==void 0&&L.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&L.searchParams.set("_HLS_part",this.part.toString()),this.skip&&L.searchParams.set("_HLS_skip",this.skip),L.toString()},h}(),u=function(){function h(d){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[d.url],this.attrs=d.attrs,this.bitrate=d.bitrate,d.details&&(this.details=d.details),this.id=d.id||0,this.name=d.name,this.width=d.width||0,this.height=d.height||0,this.audioCodec=d.audioCodec,this.videoCodec=d.videoCodec,this.unknownCodecs=d.unknownCodecs,this.codecSet=[d.videoCodec,d.audioCodec].filter(function(y){return y}).join(",").replace(/\.[^.,]+/g,"")}return a(h,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(y){var E=y%this.url.length;this._urlId!==E&&(this.details=void 0,this._urlId=E)}}]),h}()},"./src/types/loader.ts":function(n,i,r){r.r(i),r.d(i,"PlaylistContextType",function(){return s}),r.d(i,"PlaylistLevelType",function(){return a});var s;(function(o){o.MANIFEST="manifest",o.LEVEL="level",o.AUDIO_TRACK="audioTrack",o.SUBTITLE_TRACK="subtitleTrack"})(s||(s={}));var a;(function(o){o.MAIN="main",o.AUDIO="audio",o.SUBTITLE="subtitle"})(a||(a={}))},"./src/types/transmuxer.ts":function(n,i,r){r.r(i),r.d(i,"ChunkMetadata",function(){return s});var s=function(l,c,u,h,d,y){h===void 0&&(h=0),d===void 0&&(d=-1),y===void 0&&(y=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=a(),this.buffering={audio:a(),video:a(),audiovideo:a()},this.level=l,this.sn=c,this.id=u,this.size=h,this.part=d,this.partial=y};function a(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":function(n,i,r){r.r(i),r.d(i,"AttrList",function(){return o});var s=/^(\d+)x(\d+)$/,a=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,o=function(){function l(u){typeof u=="string"&&(u=l.parseAttrList(u));for(var h in u)u.hasOwnProperty(h)&&(this[h]=u[h])}var c=l.prototype;return c.decimalInteger=function(h){var d=parseInt(this[h],10);return d>Number.MAX_SAFE_INTEGER?1/0:d},c.hexadecimalInteger=function(h){if(this[h]){var d=(this[h]||"0x").slice(2);d=(d.length&1?"0":"")+d;for(var y=new Uint8Array(d.length/2),E=0;E<d.length/2;E++)y[E]=parseInt(d.slice(E*2,E*2+2),16);return y}else return null},c.hexadecimalIntegerAsNumber=function(h){var d=parseInt(this[h],16);return d>Number.MAX_SAFE_INTEGER?1/0:d},c.decimalFloatingPoint=function(h){return parseFloat(this[h])},c.optionalFloat=function(h,d){var y=this[h];return y?parseFloat(y):d},c.enumeratedString=function(h){return this[h]},c.bool=function(h){return this[h]==="YES"},c.decimalResolution=function(h){var d=s.exec(this[h]);if(d!==null)return{width:parseInt(d[1],10),height:parseInt(d[2],10)}},l.parseAttrList=function(h){var d,y={},E='"';for(a.lastIndex=0;(d=a.exec(h))!==null;){var L=d[2];L.indexOf(E)===0&&L.lastIndexOf(E)===L.length-1&&(L=L.slice(1,-1)),y[d[1]]=L}return y},l}()},"./src/utils/binary-search.ts":function(n,i,r){r.r(i);var s={search:function(o,l){for(var c=0,u=o.length-1,h=null,d=null;c<=u;){h=(c+u)/2|0,d=o[h];var y=l(d);if(y>0)c=h+1;else if(y<0)u=h-1;else return d}return null}};i.default=s},"./src/utils/buffer-helper.ts":function(n,i,r){r.r(i),r.d(i,"BufferHelper",function(){return o});var s=r("./src/utils/logger.ts"),a={length:0,start:function(){return 0},end:function(){return 0}},o=function(){function l(){}return l.isBuffered=function(u,h){try{if(u){for(var d=l.getBuffered(u),y=0;y<d.length;y++)if(h>=d.start(y)&&h<=d.end(y))return!0}}catch{}return!1},l.bufferInfo=function(u,h,d){try{if(u){var y=l.getBuffered(u),E=[],L;for(L=0;L<y.length;L++)E.push({start:y.start(L),end:y.end(L)});return this.bufferedInfo(E,h,d)}}catch{}return{len:0,start:h,end:h,nextStart:void 0}},l.bufferedInfo=function(u,h,d){h=Math.max(0,h),u.sort(function(g,m){var D=g.start-m.start;return D||m.end-g.end});var y=[];if(d)for(var E=0;E<u.length;E++){var L=y.length;if(L){var _=y[L-1].end;u[E].start-_<d?u[E].end>_&&(y[L-1].end=u[E].end):y.push(u[E])}else y.push(u[E])}else y=u;for(var A=0,v,f=h,x=h,S=0;S<y.length;S++){var C=y[S].start,p=y[S].end;if(h+d>=C&&h<p)f=C,x=p,A=x-h;else if(h+d<C){v=C;break}}return{len:A,start:f||0,end:x||0,nextStart:v}},l.getBuffered=function(u){try{return u.buffered}catch(h){return s.logger.log("failed to get media.buffered",h),a}},l}()},"./src/utils/cea-608-parser.ts":function(n,i,r){r.r(i),r.d(i,"Row",function(){return x}),r.d(i,"CaptionScreen",function(){return S});var s=r("./src/utils/logger.ts"),a={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},o=function(T){var P=T;return a.hasOwnProperty(T)&&(P=a[T]),String.fromCharCode(P)},l=15,c=100,u={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},h={17:2,18:4,21:6,22:8,23:10,19:13,20:15},d={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},y={25:2,26:4,29:6,30:8,31:10,27:13,28:15},E=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],L;(function(b){b[b.ERROR=0]="ERROR",b[b.TEXT=1]="TEXT",b[b.WARNING=2]="WARNING",b[b.INFO=2]="INFO",b[b.DEBUG=3]="DEBUG",b[b.DATA=3]="DATA"})(L||(L={}));var _=function(){function b(){this.time=null,this.verboseLevel=L.ERROR}var T=b.prototype;return T.log=function(M,O){this.verboseLevel>=M&&s.logger.log(this.time+" ["+M+"] "+O)},b}(),A=function(T){for(var P=[],M=0;M<T.length;M++)P.push(T[M].toString(16));return P},v=function(){function b(P,M,O,R,I){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=P||"white",this.underline=M||!1,this.italics=O||!1,this.background=R||"black",this.flash=I||!1}var T=b.prototype;return T.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},T.setStyles=function(M){for(var O=["foreground","underline","italics","background","flash"],R=0;R<O.length;R++){var I=O[R];M.hasOwnProperty(I)&&(this[I]=M[I])}},T.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},T.equals=function(M){return this.foreground===M.foreground&&this.underline===M.underline&&this.italics===M.italics&&this.background===M.background&&this.flash===M.flash},T.copy=function(M){this.foreground=M.foreground,this.underline=M.underline,this.italics=M.italics,this.background=M.background,this.flash=M.flash},T.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},b}(),f=function(){function b(P,M,O,R,I,w){this.uchar=void 0,this.penState=void 0,this.uchar=P||" ",this.penState=new v(M,O,R,I,w)}var T=b.prototype;return T.reset=function(){this.uchar=" ",this.penState.reset()},T.setChar=function(M,O){this.uchar=M,this.penState.copy(O)},T.setPenState=function(M){this.penState.copy(M)},T.equals=function(M){return this.uchar===M.uchar&&this.penState.equals(M.penState)},T.copy=function(M){this.uchar=M.uchar,this.penState.copy(M.penState)},T.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},b}(),x=function(){function b(P){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var M=0;M<c;M++)this.chars.push(new f);this.logger=P,this.pos=0,this.currPenState=new v}var T=b.prototype;return T.equals=function(M){for(var O=!0,R=0;R<c;R++)if(!this.chars[R].equals(M.chars[R])){O=!1;break}return O},T.copy=function(M){for(var O=0;O<c;O++)this.chars[O].copy(M.chars[O])},T.isEmpty=function(){for(var M=!0,O=0;O<c;O++)if(!this.chars[O].isEmpty()){M=!1;break}return M},T.setCursor=function(M){this.pos!==M&&(this.pos=M),this.pos<0?(this.logger.log(L.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>c&&(this.logger.log(L.DEBUG,"Too large cursor position "+this.pos),this.pos=c)},T.moveCursor=function(M){var O=this.pos+M;if(M>1)for(var R=this.pos+1;R<O+1;R++)this.chars[R].setPenState(this.currPenState);this.setCursor(O)},T.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},T.insertChar=function(M){M>=144&&this.backSpace();var O=o(M);if(this.pos>=c){this.logger.log(L.ERROR,"Cannot insert "+M.toString(16)+" ("+O+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(O,this.currPenState),this.moveCursor(1)},T.clearFromPos=function(M){var O;for(O=M;O<c;O++)this.chars[O].reset()},T.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},T.clearToEndOfRow=function(){this.clearFromPos(this.pos)},T.getTextString=function(){for(var M=[],O=!0,R=0;R<c;R++){var I=this.chars[R].uchar;I!==" "&&(O=!1),M.push(I)}return O?"":M.join("")},T.setPenStyles=function(M){this.currPenState.setStyles(M);var O=this.chars[this.pos];O.setPenState(this.currPenState)},b}(),S=function(){function b(P){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var M=0;M<l;M++)this.rows.push(new x(P));this.logger=P,this.currRow=l-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var T=b.prototype;return T.reset=function(){for(var M=0;M<l;M++)this.rows[M].clear();this.currRow=l-1},T.equals=function(M){for(var O=!0,R=0;R<l;R++)if(!this.rows[R].equals(M.rows[R])){O=!1;break}return O},T.copy=function(M){for(var O=0;O<l;O++)this.rows[O].copy(M.rows[O])},T.isEmpty=function(){for(var M=!0,O=0;O<l;O++)if(!this.rows[O].isEmpty()){M=!1;break}return M},T.backSpace=function(){var M=this.rows[this.currRow];M.backSpace()},T.clearToEndOfRow=function(){var M=this.rows[this.currRow];M.clearToEndOfRow()},T.insertChar=function(M){var O=this.rows[this.currRow];O.insertChar(M)},T.setPen=function(M){var O=this.rows[this.currRow];O.setPenStyles(M)},T.moveCursor=function(M){var O=this.rows[this.currRow];O.moveCursor(M)},T.setCursor=function(M){this.logger.log(L.INFO,"setCursor: "+M);var O=this.rows[this.currRow];O.setCursor(M)},T.setPAC=function(M){this.logger.log(L.INFO,"pacData = "+JSON.stringify(M));var O=M.row-1;if(this.nrRollUpRows&&O<this.nrRollUpRows-1&&(O=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==O){for(var R=0;R<l;R++)this.rows[R].clear();var I=this.currRow+1-this.nrRollUpRows,w=this.lastOutputScreen;if(w){var k=w.rows[I].cueStartTime,B=this.logger.time;if(k&&B!==null&&k<B)for(var F=0;F<this.nrRollUpRows;F++)this.rows[O-this.nrRollUpRows+F+1].copy(w.rows[I+F])}}this.currRow=O;var N=this.rows[this.currRow];if(M.indent!==null){var K=M.indent,H=Math.max(K-1,0);N.setCursor(M.indent),M.color=N.chars[H].penState.foreground}var U={foreground:M.color,underline:M.underline,italics:M.italics,background:"black",flash:!1};this.setPen(U)},T.setBkgData=function(M){this.logger.log(L.INFO,"bkgData = "+JSON.stringify(M)),this.backSpace(),this.setPen(M),this.insertChar(32)},T.setRollUpRows=function(M){this.nrRollUpRows=M},T.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(L.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(L.TEXT,this.getDisplayText());var M=this.currRow+1-this.nrRollUpRows,O=this.rows.splice(M,1)[0];O.clear(),this.rows.splice(this.currRow,0,O),this.logger.log(L.INFO,"Rolling up")},T.getDisplayText=function(M){M=M||!1;for(var O=[],R="",I=-1,w=0;w<l;w++){var k=this.rows[w].getTextString();k&&(I=w+1,M?O.push("Row "+I+": '"+k+"'"):O.push(k.trim()))}return O.length>0&&(M?R="["+O.join(" | ")+"]":R=O.join(`
`)),R},T.getTextAndFormat=function(){return this.rows},b}(),C=function(){function b(P,M,O){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=P,this.outputFilter=M,this.mode=null,this.verbose=0,this.displayedMemory=new S(O),this.nonDisplayedMemory=new S(O),this.lastOutputScreen=new S(O),this.currRollUpRow=this.displayedMemory.rows[l-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=O}var T=b.prototype;return T.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[l-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},T.getHandler=function(){return this.outputFilter},T.setHandler=function(M){this.outputFilter=M},T.setPAC=function(M){this.writeScreen.setPAC(M)},T.setBkgData=function(M){this.writeScreen.setBkgData(M)},T.setMode=function(M){M!==this.mode&&(this.mode=M,this.logger.log(L.INFO,"MODE="+M),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=M)},T.insertChars=function(M){for(var O=0;O<M.length;O++)this.writeScreen.insertChar(M[O]);var R=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(L.INFO,R+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(L.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},T.ccRCL=function(){this.logger.log(L.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},T.ccBS=function(){this.logger.log(L.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},T.ccAOF=function(){},T.ccAON=function(){},T.ccDER=function(){this.logger.log(L.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},T.ccRU=function(M){this.logger.log(L.INFO,"RU("+M+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(M)},T.ccFON=function(){this.logger.log(L.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},T.ccRDC=function(){this.logger.log(L.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},T.ccTR=function(){this.logger.log(L.INFO,"TR"),this.setMode("MODE_TEXT")},T.ccRTD=function(){this.logger.log(L.INFO,"RTD"),this.setMode("MODE_TEXT")},T.ccEDM=function(){this.logger.log(L.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},T.ccCR=function(){this.logger.log(L.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},T.ccENM=function(){this.logger.log(L.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},T.ccEOC=function(){if(this.logger.log(L.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var M=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=M,this.writeScreen=this.nonDisplayedMemory,this.logger.log(L.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},T.ccTO=function(M){this.logger.log(L.INFO,"TO("+M+") - Tab Offset"),this.writeScreen.moveCursor(M)},T.ccMIDROW=function(M){var O={flash:!1};if(O.underline=M%2===1,O.italics=M>=46,O.italics)O.foreground="white";else{var R=Math.floor(M/2)-16,I=["white","green","blue","cyan","red","yellow","magenta"];O.foreground=I[R]}this.logger.log(L.INFO,"MIDROW: "+JSON.stringify(O)),this.writeScreen.setPen(O)},T.outputDataUpdate=function(M){M===void 0&&(M=!1);var O=this.logger.time;O!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=O:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,O,this.lastOutputScreen),M&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:O),this.lastOutputScreen.copy(this.displayedMemory))},T.cueSplitAtTime=function(M){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,M,this.displayedMemory),this.cueStartTime=M))},b}(),p=function(){function b(P,M,O){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var R=new _;this.channels=[null,new C(P,M,R),new C(P+1,O,R)],this.cmdHistory=D(),this.logger=R}var T=b.prototype;return T.getHandler=function(M){return this.channels[M].getHandler()},T.setHandler=function(M,O){this.channels[M].setHandler(O)},T.addData=function(M,O){var R,I,w,k=!1;this.logger.time=M;for(var B=0;B<O.length;B+=2)if(I=O[B]&127,w=O[B+1]&127,!(I===0&&w===0)){if(this.logger.log(L.DATA,"["+A([O[B],O[B+1]])+"] -> ("+A([I,w])+")"),R=this.parseCmd(I,w),R||(R=this.parseMidrow(I,w)),R||(R=this.parsePAC(I,w)),R||(R=this.parseBackgroundAttributes(I,w)),!R&&(k=this.parseChars(I,w),k)){var F=this.currentChannel;if(F&&F>0){var N=this.channels[F];N.insertChars(k)}else this.logger.log(L.WARNING,"No channel found yet. TEXT-MODE?")}!R&&!k&&this.logger.log(L.WARNING,"Couldn't parse cleaned data "+A([I,w])+" orig: "+A([O[B],O[B+1]]))}},T.parseCmd=function(M,O){var R=this.cmdHistory,I=(M===20||M===28||M===21||M===29)&&O>=32&&O<=47,w=(M===23||M===31)&&O>=33&&O<=35;if(!(I||w))return!1;if(m(M,O,R))return g(null,null,R),this.logger.log(L.DEBUG,"Repeated command ("+A([M,O])+") is dropped"),!0;var k=M===20||M===21||M===23?1:2,B=this.channels[k];return M===20||M===21||M===28||M===29?O===32?B.ccRCL():O===33?B.ccBS():O===34?B.ccAOF():O===35?B.ccAON():O===36?B.ccDER():O===37?B.ccRU(2):O===38?B.ccRU(3):O===39?B.ccRU(4):O===40?B.ccFON():O===41?B.ccRDC():O===42?B.ccTR():O===43?B.ccRTD():O===44?B.ccEDM():O===45?B.ccCR():O===46?B.ccENM():O===47&&B.ccEOC():B.ccTO(O-32),g(M,O,R),this.currentChannel=k,!0},T.parseMidrow=function(M,O){var R=0;if((M===17||M===25)&&O>=32&&O<=47){if(M===17?R=1:R=2,R!==this.currentChannel)return this.logger.log(L.ERROR,"Mismatch channel in midrow parsing"),!1;var I=this.channels[R];return I?(I.ccMIDROW(O),this.logger.log(L.DEBUG,"MIDROW ("+A([M,O])+")"),!0):!1}return!1},T.parsePAC=function(M,O){var R,I=this.cmdHistory,w=(M>=17&&M<=23||M>=25&&M<=31)&&O>=64&&O<=127,k=(M===16||M===24)&&O>=64&&O<=95;if(!(w||k))return!1;if(m(M,O,I))return g(null,null,I),!0;var B=M<=23?1:2;O>=64&&O<=95?R=B===1?u[M]:d[M]:R=B===1?h[M]:y[M];var F=this.channels[B];return F?(F.setPAC(this.interpretPAC(R,O)),g(M,O,I),this.currentChannel=B,!0):!1},T.interpretPAC=function(M,O){var R,I={color:null,italics:!1,indent:null,underline:!1,row:M};return O>95?R=O-96:R=O-64,I.underline=(R&1)===1,R<=13?I.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(R/2)]:R<=15?(I.italics=!0,I.color="white"):I.indent=Math.floor((R-16)/2)*4,I},T.parseChars=function(M,O){var R,I=null,w=null;if(M>=25?(R=2,w=M-8):(R=1,w=M),w>=17&&w<=19){var k;w===17?k=O+80:w===18?k=O+112:k=O+144,this.logger.log(L.INFO,"Special char '"+o(k)+"' in channel "+R),I=[k]}else M>=32&&M<=127&&(I=O===0?[M]:[M,O]);if(I){var B=A(I);this.logger.log(L.DEBUG,"Char codes =  "+B.join(",")),g(M,O,this.cmdHistory)}return I},T.parseBackgroundAttributes=function(M,O){var R=(M===16||M===24)&&O>=32&&O<=47,I=(M===23||M===31)&&O>=45&&O<=47;if(!(R||I))return!1;var w,k={};M===16||M===24?(w=Math.floor((O-32)/2),k.background=E[w],O%2===1&&(k.background=k.background+"_semi")):O===45?k.background="transparent":(k.foreground="black",O===47&&(k.underline=!0));var B=M<=23?1:2,F=this.channels[B];return F.setBkgData(k),g(M,O,this.cmdHistory),!0},T.reset=function(){for(var M=0;M<Object.keys(this.channels).length;M++){var O=this.channels[M];O&&O.reset()}this.cmdHistory=D()},T.cueSplitAtTime=function(M){for(var O=0;O<this.channels.length;O++){var R=this.channels[O];R&&R.cueSplitAtTime(M)}},b}();function g(b,T,P){P.a=b,P.b=T}function m(b,T,P){return P.a===b&&P.b===T}function D(){return{a:null,b:null}}i.default=p},"./src/utils/codecs.ts":function(n,i,r){r.r(i),r.d(i,"isCodecType",function(){return a}),r.d(i,"isCodecSupportedInMp4",function(){return o});var s={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function a(l,c){var u=s[c];return!!u&&u[l.slice(0,4)]===!0}function o(l,c){return MediaSource.isTypeSupported((c||"video")+'/mp4;codecs="'+l+'"')}},"./src/utils/cues.ts":function(n,i,r){r.r(i);var s=r("./src/utils/vttparser.ts"),a=r("./src/utils/webvtt-parser.ts"),o=r("./src/utils/texttrack-utils.ts"),l=/\s/,c={newCue:function(h,d,y,E){for(var L=[],_,A,v,f,x,S=self.VTTCue||self.TextTrackCue,C=0;C<E.rows.length;C++)if(_=E.rows[C],v=!0,f=0,x="",!_.isEmpty()){for(var p=0;p<_.chars.length;p++)l.test(_.chars[p].uchar)&&v?f++:(x+=_.chars[p].uchar,v=!1);_.cueStartTime=d,d===y&&(y+=1e-4),f>=16?f--:f++;var g=Object(s.fixLineBreaks)(x.trim()),m=Object(a.generateCueId)(d,y,g);(!h||!h.cues||!h.cues.getCueById(m))&&(A=new S(d,y,g),A.id=m,A.line=C+1,A.align="left",A.position=10+Math.min(80,Math.floor(f*8/32)*10),L.push(A))}return h&&L.length&&(L.sort(function(D,b){return D.line==="auto"||b.line==="auto"?0:D.line>8&&b.line>8?b.line-D.line:D.line-b.line}),L.forEach(function(D){return Object(o.addCueToTrack)(h,D)})),L}};i.default=c},"./src/utils/discontinuities.ts":function(n,i,r){r.r(i),r.d(i,"findFirstFragWithCC",function(){return l}),r.d(i,"shouldAlignOnDiscontinuities",function(){return c}),r.d(i,"findDiscontinuousReferenceFrag",function(){return u}),r.d(i,"adjustSlidingStart",function(){return d}),r.d(i,"alignStream",function(){return y}),r.d(i,"alignPDT",function(){return L}),r.d(i,"alignFragmentByPDTDelta",function(){return _}),r.d(i,"alignMediaPlaylistByPDT",function(){return A});var s=r("./src/polyfills/number.ts"),a=r("./src/utils/logger.ts"),o=r("./src/controller/level-helper.ts");function l(v,f){for(var x=null,S=0,C=v.length;S<C;S++){var p=v[S];if(p&&p.cc===f){x=p;break}}return x}function c(v,f,x){return!!(f.details&&(x.endCC>x.startCC||v&&v.cc<x.startCC))}function u(v,f){var x=v.fragments,S=f.fragments;if(!S.length||!x.length){a.logger.log("No fragments to align");return}var C=l(x,S[0].cc);if(!C||C&&!C.startPTS){a.logger.log("No frag in previous level to align on");return}return C}function h(v,f){if(v){var x=v.start+f;v.start=v.startPTS=x,v.endPTS=x+v.duration}}function d(v,f){for(var x=f.fragments,S=0,C=x.length;S<C;S++)h(x[S],v);f.fragmentHint&&h(f.fragmentHint,v),f.alignedSliding=!0}function y(v,f,x){!f||(E(v,x,f),!x.alignedSliding&&f.details&&L(x,f.details),!x.alignedSliding&&f.details&&!x.skippedSegments&&Object(o.adjustSliding)(f.details,x))}function E(v,f,x){if(c(v,x,f)){var S=u(x.details,f);S&&Object(s.isFiniteNumber)(S.start)&&(a.logger.log("Adjusting PTS using last level due to CC increase within current level "+f.url),d(S.start,f))}}function L(v,f){if(!(!f.fragments.length||!v.hasProgramDateTime||!f.hasProgramDateTime)){var x=f.fragments[0].programDateTime,S=v.fragments[0].programDateTime,C=(S-x)/1e3+f.fragments[0].start;C&&Object(s.isFiniteNumber)(C)&&(a.logger.log("Adjusting PTS using programDateTime delta "+(S-x)+"ms, sliding:"+C.toFixed(3)+" "+v.url+" "),d(C,v))}}function _(v,f){var x=v.programDateTime;if(!!x){var S=(x-f)/1e3;v.start=v.startPTS=S,v.endPTS=S+v.duration}}function A(v,f){if(!(!f.fragments.length||!v.hasProgramDateTime||!f.hasProgramDateTime)){var x=f.fragments[0].programDateTime,S=f.fragments[0].start,C=x-S*1e3;v.fragments.forEach(function(p){_(p,C)}),v.fragmentHint&&_(v.fragmentHint,C),v.alignedSliding=!0}}},"./src/utils/ewma-bandwidth-estimator.ts":function(n,i,r){r.r(i);var s=r("./src/utils/ewma.ts"),a=function(){function o(c,u,h){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=h,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new s.default(c),this.fast_=new s.default(u)}var l=o.prototype;return l.update=function(u,h){var d=this.slow_,y=this.fast_;this.slow_.halfLife!==u&&(this.slow_=new s.default(u,d.getEstimate(),d.getTotalWeight())),this.fast_.halfLife!==h&&(this.fast_=new s.default(h,y.getEstimate(),y.getTotalWeight()))},l.sample=function(u,h){u=Math.max(u,this.minDelayMs_);var d=8*h,y=u/1e3,E=d/y;this.fast_.sample(y,E),this.slow_.sample(y,E)},l.canEstimate=function(){var u=this.fast_;return u&&u.getTotalWeight()>=this.minWeight_},l.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},l.destroy=function(){},o}();i.default=a},"./src/utils/ewma.ts":function(n,i,r){r.r(i);var s=function(){function a(l,c,u){c===void 0&&(c=0),u===void 0&&(u=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=l,this.alpha_=l?Math.exp(Math.log(.5)/l):0,this.estimate_=c,this.totalWeight_=u}var o=a.prototype;return o.sample=function(c,u){var h=Math.pow(this.alpha_,c);this.estimate_=u*(1-h)+h*this.estimate_,this.totalWeight_+=c},o.getTotalWeight=function(){return this.totalWeight_},o.getEstimate=function(){if(this.alpha_){var c=1-Math.pow(this.alpha_,this.totalWeight_);if(c)return this.estimate_/c}return this.estimate_},a}();i.default=s},"./src/utils/fetch-loader.ts":function(n,i,r){r.r(i),r.d(i,"fetchSupported",function(){return _});var s=r("./src/polyfills/number.ts"),a=r("./src/loader/load-stats.ts"),o=r("./src/demux/chunk-cache.ts");function l(S,C){S.prototype=Object.create(C.prototype),S.prototype.constructor=S,y(S,C)}function c(S){var C=typeof Map=="function"?new Map:void 0;return c=function(g){if(g===null||!d(g))return g;if(typeof g!="function")throw new TypeError("Super expression must either be null or a function");if(typeof C<"u"){if(C.has(g))return C.get(g);C.set(g,m)}function m(){return u(g,arguments,E(this).constructor)}return m.prototype=Object.create(g.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),y(m,g)},c(S)}function u(S,C,p){return h()?u=Reflect.construct.bind():u=function(m,D,b){var T=[null];T.push.apply(T,D);var P=Function.bind.apply(m,T),M=new P;return b&&y(M,b.prototype),M},u.apply(null,arguments)}function h(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function d(S){return Function.toString.call(S).indexOf("[native code]")!==-1}function y(S,C){return y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(g,m){return g.__proto__=m,g},y(S,C)}function E(S){return E=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(p){return p.__proto__||Object.getPrototypeOf(p)},E(S)}function L(){return L=Object.assign?Object.assign.bind():function(S){for(var C=1;C<arguments.length;C++){var p=arguments[C];for(var g in p)Object.prototype.hasOwnProperty.call(p,g)&&(S[g]=p[g])}return S},L.apply(this,arguments)}function _(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch{}return!1}var A=function(){function S(p){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=p.fetchSetup||f,this.controller=new self.AbortController,this.stats=new a.LoadStats}var C=S.prototype;return C.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},C.abortInternal=function(){var g=this.response;(!g||!g.ok)&&(this.stats.aborted=!0,this.controller.abort())},C.abort=function(){var g;this.abortInternal(),(g=this.callbacks)!==null&&g!==void 0&&g.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},C.load=function(g,m,D){var b=this,T=this.stats;if(T.loading.start)throw new Error("Loader can only be used once.");T.loading.start=self.performance.now();var P=v(g,this.controller.signal),M=D.onProgress,O=g.responseType==="arraybuffer",R=O?"byteLength":"length";this.context=g,this.config=m,this.callbacks=D,this.request=this.fetchSetup(g,P),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){b.abortInternal(),D.onTimeout(T,g,b.response)},m.timeout),self.fetch(this.request).then(function(I){if(b.response=b.loader=I,!I.ok){var w=I.status,k=I.statusText;throw new x(k||"fetch, bad network response",w,I)}return T.loading.first=Math.max(self.performance.now(),T.loading.start),T.total=parseInt(I.headers.get("Content-Length")||"0"),M&&Object(s.isFiniteNumber)(m.highWaterMark)?b.loadProgressively(I,T,g,m.highWaterMark,M):O?I.arrayBuffer():I.text()}).then(function(I){var w=b.response;self.clearTimeout(b.requestTimeout),T.loading.end=Math.max(self.performance.now(),T.loading.first),T.loaded=T.total=I[R];var k={url:w.url,data:I};M&&!Object(s.isFiniteNumber)(m.highWaterMark)&&M(T,g,I,w),D.onSuccess(k,T,g,w)}).catch(function(I){if(self.clearTimeout(b.requestTimeout),!T.aborted){var w=I&&I.code||0,k=I?I.message:null;D.onError({code:w,text:k},g,I?I.details:null)}})},C.getCacheAge=function(){var g=null;if(this.response){var m=this.response.headers.get("age");g=m?parseFloat(m):null}return g},C.loadProgressively=function(g,m,D,b,T){b===void 0&&(b=0);var P=new o.default,M=g.body.getReader(),O=function R(){return M.read().then(function(I){if(I.done)return P.dataLength&&T(m,D,P.flush(),g),Promise.resolve(new ArrayBuffer(0));var w=I.value,k=w.length;return m.loaded+=k,k<b||P.dataLength?(P.push(w),P.dataLength>=b&&T(m,D,P.flush(),g)):T(m,D,w,g),R()}).catch(function(){return Promise.reject()})};return O()},S}();function v(S,C){var p={method:"GET",mode:"cors",credentials:"same-origin",signal:C,headers:new self.Headers(L({},S.headers))};return S.rangeEnd&&p.headers.set("Range","bytes="+S.rangeStart+"-"+String(S.rangeEnd-1)),p}function f(S,C){return new self.Request(S.url,C)}var x=function(S){l(C,S);function C(p,g,m){var D;return D=S.call(this,p)||this,D.code=void 0,D.details=void 0,D.code=g,D.details=m,D}return C}(c(Error));i.default=A},"./src/utils/imsc1-ttml-parser.ts":function(n,i,r){r.r(i),r.d(i,"IMSC1_CODEC",function(){return d}),r.d(i,"parseIMSC1",function(){return _});var s=r("./src/utils/mp4-tools.ts"),a=r("./src/utils/vttparser.ts"),o=r("./src/utils/vttcue.ts"),l=r("./src/demux/id3.ts"),c=r("./src/utils/timescale-conversion.ts"),u=r("./src/utils/webvtt-parser.ts");function h(){return h=Object.assign?Object.assign.bind():function(b){for(var T=1;T<arguments.length;T++){var P=arguments[T];for(var M in P)Object.prototype.hasOwnProperty.call(P,M)&&(b[M]=P[M])}return b},h.apply(this,arguments)}var d="stpp.ttml.im1t",y=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,E=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,L={left:"start",center:"center",right:"end",start:"start",end:"end"};function _(b,T,P,M,O){var R=Object(s.findBox)(new Uint8Array(b),["mdat"]);if(R.length===0){O(new Error("Could not parse IMSC1 mdat"));return}var I=R.map(function(k){return Object(l.utf8ArrayToStr)(k)}),w=Object(c.toTimescaleFromScale)(T,1,P);try{I.forEach(function(k){return M(A(k,w))})}catch(k){O(k)}}function A(b,T){var P=new DOMParser,M=P.parseFromString(b,"text/xml"),O=M.getElementsByTagName("tt")[0];if(!O)throw new Error("Invalid ttml");var R={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},I=Object.keys(R).reduce(function(N,K){return N[K]=O.getAttribute("ttp:"+K)||R[K],N},{}),w=O.getAttribute("xml:space")!=="preserve",k=f(v(O,"styling","style")),B=f(v(O,"layout","region")),F=v(O,"body","[begin]");return[].map.call(F,function(N){var K=x(N,w);if(!K||!N.hasAttribute("begin"))return null;var H=g(N.getAttribute("begin"),I),U=g(N.getAttribute("dur"),I),j=g(N.getAttribute("end"),I);if(H===null)throw p(N);if(j===null){if(U===null)throw p(N);j=H+U}var $=new o.default(H-T,j-T,K);$.id=Object(u.generateCueId)($.startTime,$.endTime,$.text);var X=B[N.getAttribute("region")],Z=k[N.getAttribute("style")];$.position=10,$.size=80;var nt=S(X,Z,k),at=nt.textAlign;if(at){var it=L[at];it&&($.lineAlign=it),$.align=at}return h($,nt),$}).filter(function(N){return N!==null})}function v(b,T,P){var M=b.getElementsByTagName(T)[0];return M?[].slice.call(M.querySelectorAll(P)):[]}function f(b){return b.reduce(function(T,P){var M=P.getAttribute("xml:id");return M&&(T[M]=P),T},{})}function x(b,T){return[].slice.call(b.childNodes).reduce(function(P,M,O){var R;return M.nodeName==="br"&&O?P+`
`:(R=M.childNodes)!==null&&R!==void 0&&R.length?x(M,T):T?P+M.textContent.trim().replace(/\s+/g," "):P+M.textContent},"")}function S(b,T,P){var M="http://www.w3.org/ns/ttml#styling",O=null,R=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"],I=b!=null&&b.hasAttribute("style")?b.getAttribute("style"):null;return I&&P.hasOwnProperty(I)&&(O=P[I]),R.reduce(function(w,k){var B=C(T,M,k)||C(b,M,k)||C(O,M,k);return B&&(w[k]=B),w},{})}function C(b,T,P){return b&&b.hasAttributeNS(T,P)?b.getAttributeNS(T,P):null}function p(b){return new Error("Could not parse ttml timestamp "+b)}function g(b,T){if(!b)return null;var P=Object(a.parseTimeStamp)(b);return P===null&&(y.test(b)?P=m(b,T):E.test(b)&&(P=D(b,T))),P}function m(b,T){var P=y.exec(b),M=(P[4]|0)+(P[5]|0)/T.subFrameRate;return(P[1]|0)*3600+(P[2]|0)*60+(P[3]|0)+M/T.frameRate}function D(b,T){var P=E.exec(b),M=Number(P[1]),O=P[2];switch(O){case"h":return M*3600;case"m":return M*60;case"ms":return M*1e3;case"f":return M/T.frameRate;case"t":return M/T.tickRate}return M}},"./src/utils/logger.ts":function(n,i,r){r.r(i),r.d(i,"enableLogs",function(){return u}),r.d(i,"logger",function(){return h});var s=function(){},a={trace:s,debug:s,log:s,warn:s,info:s,error:s},o=a;function l(d){var y=self.console[d];return y?y.bind(self.console,"["+d+"] >"):s}function c(d){for(var y=arguments.length,E=new Array(y>1?y-1:0),L=1;L<y;L++)E[L-1]=arguments[L];E.forEach(function(_){o[_]=d[_]?d[_].bind(d):l(_)})}function u(d){if(self.console&&d===!0||typeof d=="object"){c(d,"debug","log","info","warn","error");try{o.log()}catch{o=a}}else o=a}var h=o},"./src/utils/mediakeys-helper.ts":function(n,i,r){r.r(i),r.d(i,"KeySystems",function(){return s}),r.d(i,"requestMediaKeySystemAccess",function(){return a});var s;(function(o){o.WIDEVINE="com.widevine.alpha",o.PLAYREADY="com.microsoft.playready"})(s||(s={}));var a=function(){return typeof self<"u"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}()},"./src/utils/mediasource-helper.ts":function(n,i,r){r.r(i),r.d(i,"getMediaSource",function(){return s});function s(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":function(n,i,r){r.r(i),r.d(i,"RemuxerTrackIdConfig",function(){return u}),r.d(i,"bin2str",function(){return h}),r.d(i,"readUint16",function(){return d}),r.d(i,"readUint32",function(){return y}),r.d(i,"readSint32",function(){return E}),r.d(i,"writeUint32",function(){return L}),r.d(i,"findBox",function(){return _}),r.d(i,"parseSegmentIndex",function(){return A}),r.d(i,"parseInitSegment",function(){return v}),r.d(i,"getStartDTS",function(){return f}),r.d(i,"getDuration",function(){return x}),r.d(i,"computeRawDurationFromSamples",function(){return S}),r.d(i,"offsetStartDTS",function(){return C}),r.d(i,"segmentValidRange",function(){return p}),r.d(i,"appendUint8Array",function(){return g}),r.d(i,"parseSamples",function(){return m}),r.d(i,"parseSEIMessageFromNALu",function(){return T}),r.d(i,"parseEmsg",function(){return M});var s=r("./src/utils/typed-array.ts"),a=r("./src/loader/fragment.ts"),o=r("./src/demux/id3.ts"),l=Math.pow(2,32)-1,c=[].push,u={video:1,audio:2,id3:3,text:4};function h(O){return String.fromCharCode.apply(null,O)}function d(O,R){var I=O[R]<<8|O[R+1];return I<0?65536+I:I}function y(O,R){var I=E(O,R);return I<0?4294967296+I:I}function E(O,R){return O[R]<<24|O[R+1]<<16|O[R+2]<<8|O[R+3]}function L(O,R,I){O[R]=I>>24,O[R+1]=I>>16&255,O[R+2]=I>>8&255,O[R+3]=I&255}function _(O,R){var I=[];if(!R.length)return I;for(var w=O.byteLength,k=0;k<w;){var B=y(O,k),F=h(O.subarray(k+4,k+8)),N=B>1?k+B:w;if(F===R[0])if(R.length===1)I.push(O.subarray(k+8,N));else{var K=_(O.subarray(k+8,N),R.slice(1));K.length&&c.apply(I,K)}k=N}return I}function A(O){var R=[],I=O[0],w=8,k=y(O,w);w+=4;var B=0,F=0;I===0?w+=8:w+=16,w+=2;var N=O.length+F,K=d(O,w);w+=2;for(var H=0;H<K;H++){var U=w,j=y(O,U);U+=4;var $=j&2147483647,X=(j&2147483648)>>>31;if(X===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var Z=y(O,U);U+=4,R.push({referenceSize:$,subsegmentDuration:Z,info:{duration:Z/k,start:N,end:N+$-1}}),N+=$,U+=4,w=U}return{earliestPresentationTime:B,timescale:k,version:I,referencesCount:K,references:R}}function v(O){for(var R=[],I=_(O,["moov","trak"]),w=0;w<I.length;w++){var k=I[w],B=_(k,["tkhd"])[0];if(B){var F=B[0],N=F===0?12:20,K=y(B,N),H=_(k,["mdia","mdhd"])[0];if(H){F=H[0],N=F===0?12:20;var U=y(H,N),j=_(k,["mdia","hdlr"])[0];if(j){var $=h(j.subarray(8,12)),X={soun:a.ElementaryStreamTypes.AUDIO,vide:a.ElementaryStreamTypes.VIDEO}[$];if(X){var Z=_(k,["mdia","minf","stbl","stsd"])[0],nt=void 0;Z&&(nt=h(Z.subarray(12,16))),R[K]={timescale:U,type:X},R[X]={timescale:U,id:K,codec:nt}}}}}}var at=_(O,["moov","mvex","trex"]);return at.forEach(function(it){var W=y(it,4),V=R[W];V&&(V.default={duration:y(it,12),flags:y(it,20)})}),R}function f(O,R){return _(R,["moof","traf"]).reduce(function(I,w){var k=_(w,["tfdt"])[0],B=k[0],F=_(w,["tfhd"]).reduce(function(N,K){var H=y(K,4),U=O[H];if(U){var j=y(k,4);B===1&&(j*=Math.pow(2,32),j+=y(k,8));var $=U.timescale||9e4,X=j/$;if(isFinite(X)&&(N===null||X<N))return X}return N},null);return F!==null&&isFinite(F)&&(I===null||F<I)?F:I},null)||0}function x(O,R){for(var I=0,w=0,k=0,B=_(O,["moof","traf"]),F=0;F<B.length;F++){var N=B[F],K=_(N,["tfhd"])[0],H=y(K,4),U=R[H];if(!!U){var j=U.default,$=y(K,0)|(j==null?void 0:j.flags),X=j==null?void 0:j.duration;$&8&&($&2?X=y(K,12):X=y(K,8));for(var Z=U.timescale||9e4,nt=_(N,["trun"]),at=0;at<nt.length;at++){if(I=S(nt[at]),!I&&X){var it=y(nt[at],4);I=X*it}U.type===a.ElementaryStreamTypes.VIDEO?w+=I/Z:U.type===a.ElementaryStreamTypes.AUDIO&&(k+=I/Z)}}}if(w===0&&k===0){for(var W=0,V=_(O,["sidx"]),z=0;z<V.length;z++){var Y=A(V[z]);Y!=null&&Y.references&&(W+=Y.references.reduce(function(Q,J){return Q+J.info.duration||0},0))}return W}return w||k}function S(O){var R=y(O,0),I=8;R&1&&(I+=4),R&4&&(I+=4);for(var w=0,k=y(O,4),B=0;B<k;B++){if(R&256){var F=y(O,I);w+=F,I+=4}R&512&&(I+=4),R&1024&&(I+=4),R&2048&&(I+=4)}return w}function C(O,R,I){_(R,["moof","traf"]).forEach(function(w){_(w,["tfhd"]).forEach(function(k){var B=y(k,4),F=O[B];if(!!F){var N=F.timescale||9e4;_(w,["tfdt"]).forEach(function(K){var H=K[0],U=y(K,4);if(H===0)U-=I*N,U=Math.max(U,0),L(K,4,U);else{U*=Math.pow(2,32),U+=y(K,8),U-=I*N,U=Math.max(U,0);var j=Math.floor(U/(l+1)),$=Math.floor(U%(l+1));L(K,4,j),L(K,8,$)}})}})})}function p(O){var R={valid:null,remainder:null},I=_(O,["moof"]);if(I){if(I.length<2)return R.remainder=O,R}else return R;var w=I[I.length-1];return R.valid=Object(s.sliceUint8)(O,0,w.byteOffset-8),R.remainder=Object(s.sliceUint8)(O,w.byteOffset-8),R}function g(O,R){var I=new Uint8Array(O.length+R.length);return I.set(O),I.set(R,O.length),I}function m(O,R){var I=[],w=R.samples,k=R.timescale,B=R.id,F=!1,N=_(w,["moof"]);return N.map(function(K){var H=K.byteOffset-8,U=_(K,["traf"]);U.map(function(j){var $=_(j,["tfdt"]).map(function(X){var Z=X[0],nt=y(X,4);return Z===1&&(nt*=Math.pow(2,32),nt+=y(X,8)),nt/k})[0];return $!==void 0&&(O=$),_(j,["tfhd"]).map(function(X){var Z=y(X,4),nt=y(X,0)&16777215,at=(nt&1)!==0,it=(nt&2)!==0,W=(nt&8)!==0,V=0,z=(nt&16)!==0,Y=0,Q=(nt&32)!==0,J=8;Z===B&&(at&&(J+=8),it&&(J+=4),W&&(V=y(X,J),J+=4),z&&(Y=y(X,J),J+=4),Q&&(J+=4),R.type==="video"&&(F=D(R.codec)),_(j,["trun"]).map(function(rt){var tt=rt[0],et=y(rt,0)&16777215,q=(et&1)!==0,ut=0,lt=(et&4)!==0,ft=(et&256)!==0,dt=0,vt=(et&512)!==0,Et=0,yt=(et&1024)!==0,Tt=(et&2048)!==0,Wt=0,te=y(rt,4),Ht=8;q&&(ut=y(rt,Ht),Ht+=4),lt&&(Ht+=4);for(var jt=ut+H,oe=0;oe<te;oe++){if(ft?(dt=y(rt,Ht),Ht+=4):dt=V,vt?(Et=y(rt,Ht),Ht+=4):Et=Y,yt&&(Ht+=4),Tt&&(tt===0?Wt=y(rt,Ht):Wt=E(rt,Ht),Ht+=4),R.type===a.ElementaryStreamTypes.VIDEO)for(var St=0;St<Et;){var It=y(w,jt);jt+=4;var ee=w[jt]&31;if(b(F,ee)){var Qe=w.subarray(jt,jt+It);T(Qe,O+Wt/k,I)}jt+=It,St+=It+4}O+=dt/k}}))})})}),I}function D(O){if(!O)return!1;var R=O.indexOf("."),I=R<0?O:O.substring(0,R);return I==="hvc1"||I==="hev1"||I==="dvh1"||I==="dvhe"}function b(O,R){return O?R===39||R===40:R===6}function T(O,R,I){var w=P(O),k=0;k++;for(var B=0,F=0,N=!1,K=0;k<w.length;){B=0;do{if(k>=w.length)break;K=w[k++],B+=K}while(K===255);F=0;do{if(k>=w.length)break;K=w[k++],F+=K}while(K===255);var H=w.length-k;if(!N&&B===4&&k<w.length){N=!0;var U=w[k++];if(U===181){var j=d(w,k);if(k+=2,j===49){var $=y(w,k);if(k+=4,$===1195456820){var X=w[k++];if(X===3){var Z=w[k++],nt=31&Z,at=64&Z,it=at?2+nt*3:0,W=new Uint8Array(it);if(at){W[0]=Z;for(var V=1;V<it;V++)W[V]=w[k++]}I.push({type:X,payloadType:B,pts:R,bytes:W})}}}}}else if(B===5&&F<H){if(N=!0,F>16){for(var z=[],Y=0;Y<16;Y++){var Q=w[k++].toString(16);z.push(Q.length==1?"0"+Q:Q),(Y===3||Y===5||Y===7||Y===9)&&z.push("-")}for(var J=F-16,rt=new Uint8Array(J),tt=0;tt<J;tt++)rt[tt]=w[k++];I.push({payloadType:B,pts:R,uuid:z.join(""),userData:Object(o.utf8ArrayToStr)(rt),userDataBytes:rt})}}else if(F<H)k+=F;else if(F>H)break}}function P(O){for(var R=O.byteLength,I=[],w=1;w<R-2;)O[w]===0&&O[w+1]===0&&O[w+2]===3?(I.push(w+2),w+=2):w++;if(I.length===0)return O;var k=R-I.length,B=new Uint8Array(k),F=0;for(w=0;w<k;F++,w++)F===I[0]&&(F++,I.shift()),B[w]=O[F];return B}function M(O){var R=O[0],I="",w="",k=0,B=0,F=0,N=0,K=0,H=0;if(R===0){for(;h(O.subarray(H,H+1))!=="\0";)I+=h(O.subarray(H,H+1)),H+=1;for(I+=h(O.subarray(H,H+1)),H+=1;h(O.subarray(H,H+1))!=="\0";)w+=h(O.subarray(H,H+1)),H+=1;w+=h(O.subarray(H,H+1)),H+=1,k=y(O,12),B=y(O,16),N=y(O,20),K=y(O,24),H=28}else if(R===1){H+=4,k=y(O,H),H+=4;var U=y(O,H);H+=4;var j=y(O,H);for(H+=4,F=Math.pow(2,32)*U+j,Number.isSafeInteger(F)||(F=Number.MAX_SAFE_INTEGER,console.warn("Presentation time exceeds safe integer limit and wrapped to max safe integer in parsing emsg box")),N=y(O,H),H+=4,K=y(O,H),H+=4;h(O.subarray(H,H+1))!=="\0";)I+=h(O.subarray(H,H+1)),H+=1;for(I+=h(O.subarray(H,H+1)),H+=1;h(O.subarray(H,H+1))!=="\0";)w+=h(O.subarray(H,H+1)),H+=1;w+=h(O.subarray(H,H+1)),H+=1}var $=O.subarray(H,O.byteLength);return{schemeIdUri:I,value:w,timeScale:k,presentationTime:F,presentationTimeDelta:B,eventDuration:N,id:K,payload:$}}},"./src/utils/output-filter.ts":function(n,i,r){r.r(i),r.d(i,"default",function(){return s});var s=function(){function a(l,c){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=l,this.trackName=c}var o=a.prototype;return o.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},o.newCue=function(c,u,h){(this.startTime===null||this.startTime>c)&&(this.startTime=c),this.endTime=u,this.screen=h,this.timelineController.createCaptionsTrack(this.trackName)},o.reset=function(){this.cueRanges=[],this.startTime=null},a}()},"./src/utils/texttrack-utils.ts":function(n,i,r){r.r(i),r.d(i,"sendAddTrackEvent",function(){return a}),r.d(i,"addCueToTrack",function(){return o}),r.d(i,"clearCurrentCues",function(){return l}),r.d(i,"removeCuesInRange",function(){return c}),r.d(i,"getCuesInRange",function(){return h});var s=r("./src/utils/logger.ts");function a(d,y){var E;try{E=new Event("addtrack")}catch{E=document.createEvent("Event"),E.initEvent("addtrack",!1,!1)}E.track=d,y.dispatchEvent(E)}function o(d,y){var E=d.mode;if(E==="disabled"&&(d.mode="hidden"),d.cues&&!d.cues.getCueById(y.id))try{if(d.addCue(y),!d.cues.getCueById(y.id))throw new Error("addCue is failed for: "+y)}catch(_){s.logger.debug("[texttrack-utils]: "+_);var L=new self.TextTrackCue(y.startTime,y.endTime,y.text);L.id=y.id,d.addCue(L)}E==="disabled"&&(d.mode=E)}function l(d){var y=d.mode;if(y==="disabled"&&(d.mode="hidden"),d.cues)for(var E=d.cues.length;E--;)d.removeCue(d.cues[E]);y==="disabled"&&(d.mode=y)}function c(d,y,E,L){var _=d.mode;if(_==="disabled"&&(d.mode="hidden"),d.cues&&d.cues.length>0)for(var A=h(d.cues,y,E),v=0;v<A.length;v++)(!L||L(A[v]))&&d.removeCue(A[v]);_==="disabled"&&(d.mode=_)}function u(d,y){if(y<d[0].startTime)return 0;var E=d.length-1;if(y>d[E].endTime)return-1;for(var L=0,_=E;L<=_;){var A=Math.floor((_+L)/2);if(y<d[A].startTime)_=A-1;else if(y>d[A].startTime&&L<E)L=A+1;else return A}return d[L].startTime-y<y-d[_].startTime?L:_}function h(d,y,E){var L=[],_=u(d,y);if(_>-1)for(var A=_,v=d.length;A<v;A++){var f=d[A];if(f.startTime>=y&&f.endTime<=E)L.push(f);else if(f.startTime>E)return L}return L}},"./src/utils/time-ranges.ts":function(n,i,r){r.r(i);var s={toString:function(o){for(var l="",c=o.length,u=0;u<c;u++)l+="["+o.start(u).toFixed(3)+","+o.end(u).toFixed(3)+"]";return l}};i.default=s},"./src/utils/timescale-conversion.ts":function(n,i,r){r.r(i),r.d(i,"toTimescaleFromBase",function(){return a}),r.d(i,"toTimescaleFromScale",function(){return o}),r.d(i,"toMsFromMpegTsClock",function(){return l}),r.d(i,"toMpegTsClockFromTimescale",function(){return c});var s=9e4;function a(u,h,d,y){d===void 0&&(d=1),y===void 0&&(y=!1);var E=u*h*d;return y?Math.round(E):E}function o(u,h,d,y){return d===void 0&&(d=1),y===void 0&&(y=!1),a(u,h,1/d,y)}function l(u,h){return h===void 0&&(h=!1),a(u,1e3,1/s,h)}function c(u,h){return h===void 0&&(h=1),a(u,s,1/h)}},"./src/utils/typed-array.ts":function(n,i,r){r.r(i),r.d(i,"sliceUint8",function(){return s});function s(a,o,l){return Uint8Array.prototype.slice?a.slice(o,l):new Uint8Array(Array.prototype.slice.call(a,o,l))}},"./src/utils/vttcue.ts":function(n,i,r){r.r(i),i.default=function(){if(typeof self<"u"&&self.VTTCue)return self.VTTCue;var s=["","lr","rl"],a=["start","middle","end","left","right"];function o(d,y){if(typeof y!="string"||!Array.isArray(d))return!1;var E=y.toLowerCase();return~d.indexOf(E)?E:!1}function l(d){return o(s,d)}function c(d){return o(a,d)}function u(d){for(var y=arguments.length,E=new Array(y>1?y-1:0),L=1;L<y;L++)E[L-1]=arguments[L];for(var _=1;_<arguments.length;_++){var A=arguments[_];for(var v in A)d[v]=A[v]}return d}function h(d,y,E){var L=this,_={enumerable:!0};L.hasBeenReset=!1;var A="",v=!1,f=d,x=y,S=E,C=null,p="",g=!0,m="auto",D="start",b=50,T="middle",P=50,M="middle";Object.defineProperty(L,"id",u({},_,{get:function(){return A},set:function(R){A=""+R}})),Object.defineProperty(L,"pauseOnExit",u({},_,{get:function(){return v},set:function(R){v=!!R}})),Object.defineProperty(L,"startTime",u({},_,{get:function(){return f},set:function(R){if(typeof R!="number")throw new TypeError("Start time must be set to a number.");f=R,this.hasBeenReset=!0}})),Object.defineProperty(L,"endTime",u({},_,{get:function(){return x},set:function(R){if(typeof R!="number")throw new TypeError("End time must be set to a number.");x=R,this.hasBeenReset=!0}})),Object.defineProperty(L,"text",u({},_,{get:function(){return S},set:function(R){S=""+R,this.hasBeenReset=!0}})),Object.defineProperty(L,"region",u({},_,{get:function(){return C},set:function(R){C=R,this.hasBeenReset=!0}})),Object.defineProperty(L,"vertical",u({},_,{get:function(){return p},set:function(R){var I=l(R);if(I===!1)throw new SyntaxError("An invalid or illegal string was specified.");p=I,this.hasBeenReset=!0}})),Object.defineProperty(L,"snapToLines",u({},_,{get:function(){return g},set:function(R){g=!!R,this.hasBeenReset=!0}})),Object.defineProperty(L,"line",u({},_,{get:function(){return m},set:function(R){if(typeof R!="number"&&R!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");m=R,this.hasBeenReset=!0}})),Object.defineProperty(L,"lineAlign",u({},_,{get:function(){return D},set:function(R){var I=c(R);if(!I)throw new SyntaxError("An invalid or illegal string was specified.");D=I,this.hasBeenReset=!0}})),Object.defineProperty(L,"position",u({},_,{get:function(){return b},set:function(R){if(R<0||R>100)throw new Error("Position must be between 0 and 100.");b=R,this.hasBeenReset=!0}})),Object.defineProperty(L,"positionAlign",u({},_,{get:function(){return T},set:function(R){var I=c(R);if(!I)throw new SyntaxError("An invalid or illegal string was specified.");T=I,this.hasBeenReset=!0}})),Object.defineProperty(L,"size",u({},_,{get:function(){return P},set:function(R){if(R<0||R>100)throw new Error("Size must be between 0 and 100.");P=R,this.hasBeenReset=!0}})),Object.defineProperty(L,"align",u({},_,{get:function(){return M},set:function(R){var I=c(R);if(!I)throw new SyntaxError("An invalid or illegal string was specified.");M=I,this.hasBeenReset=!0}})),L.displayState=void 0}return h.prototype.getCueAsHTML=function(){var d=self.WebVTT;return d.convertCueToDOMTree(self,this.text)},h}()},"./src/utils/vttparser.ts":function(n,i,r){r.r(i),r.d(i,"parseTimeStamp",function(){return o}),r.d(i,"fixLineBreaks",function(){return y}),r.d(i,"VTTParser",function(){return E});var s=r("./src/utils/vttcue.ts"),a=function(){function L(){}var _=L.prototype;return _.decode=function(v,f){if(!v)return"";if(typeof v!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(v))},L}();function o(L){function _(v,f,x,S){return(v|0)*3600+(f|0)*60+(x|0)+parseFloat(S||0)}var A=L.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return A?parseFloat(A[2])>59?_(A[2],A[3],0,A[4]):_(A[1],A[2],A[3],A[4]):null}var l=function(){function L(){this.values=Object.create(null)}var _=L.prototype;return _.set=function(v,f){!this.get(v)&&f!==""&&(this.values[v]=f)},_.get=function(v,f,x){return x?this.has(v)?this.values[v]:f[x]:this.has(v)?this.values[v]:f},_.has=function(v){return v in this.values},_.alt=function(v,f,x){for(var S=0;S<x.length;++S)if(f===x[S]){this.set(v,f);break}},_.integer=function(v,f){/^-?\d+$/.test(f)&&this.set(v,parseInt(f,10))},_.percent=function(v,f){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(f)){var x=parseFloat(f);if(x>=0&&x<=100)return this.set(v,x),!0}return!1},L}();function c(L,_,A,v){var f=v?L.split(v):[L];for(var x in f)if(typeof f[x]=="string"){var S=f[x].split(A);if(S.length===2){var C=S[0],p=S[1];_(C,p)}}}var u=new s.default(0,0,""),h=u.align==="middle"?"middle":"center";function d(L,_,A){var v=L;function f(){var C=o(L);if(C===null)throw new Error("Malformed timestamp: "+v);return L=L.replace(/^[^\sa-zA-Z-]+/,""),C}function x(C,p){var g=new l;c(C,function(b,T){var P;switch(b){case"region":for(var M=A.length-1;M>=0;M--)if(A[M].id===T){g.set(b,A[M].region);break}break;case"vertical":g.alt(b,T,["rl","lr"]);break;case"line":P=T.split(","),g.integer(b,P[0]),g.percent(b,P[0])&&g.set("snapToLines",!1),g.alt(b,P[0],["auto"]),P.length===2&&g.alt("lineAlign",P[1],["start",h,"end"]);break;case"position":P=T.split(","),g.percent(b,P[0]),P.length===2&&g.alt("positionAlign",P[1],["start",h,"end","line-left","line-right","auto"]);break;case"size":g.percent(b,T);break;case"align":g.alt(b,T,["start",h,"end","left","right"]);break}},/:/,/\s/),p.region=g.get("region",null),p.vertical=g.get("vertical","");var m=g.get("line","auto");m==="auto"&&u.line===-1&&(m=-1),p.line=m,p.lineAlign=g.get("lineAlign","start"),p.snapToLines=g.get("snapToLines",!0),p.size=g.get("size",100),p.align=g.get("align",h);var D=g.get("position","auto");D==="auto"&&u.position===50&&(D=p.align==="start"||p.align==="left"?0:p.align==="end"||p.align==="right"?100:50),p.position=D}function S(){L=L.replace(/^\s+/,"")}if(S(),_.startTime=f(),S(),L.slice(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+v);L=L.slice(3),S(),_.endTime=f(),S(),x(L,_)}function y(L){return L.replace(/<br(?: \/)?>/gi,`
`)}var E=function(){function L(){this.state="INITIAL",this.buffer="",this.decoder=new a,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var _=L.prototype;return _.parse=function(v){var f=this;v&&(f.buffer+=f.decoder.decode(v,{stream:!0}));function x(){var D=f.buffer,b=0;for(D=y(D);b<D.length&&D[b]!=="\r"&&D[b]!==`
`;)++b;var T=D.slice(0,b);return D[b]==="\r"&&++b,D[b]===`
`&&++b,f.buffer=D.slice(b),T}function S(D){c(D,function(b,T){},/:/)}try{var C="";if(f.state==="INITIAL"){if(!/\r\n|\n/.test(f.buffer))return this;C=x();var p=C.match(/^()?WEBVTT([ \t].*)?$/);if(!p||!p[0])throw new Error("Malformed WebVTT signature.");f.state="HEADER"}for(var g=!1;f.buffer;){if(!/\r\n|\n/.test(f.buffer))return this;switch(g?g=!1:C=x(),f.state){case"HEADER":/:/.test(C)?S(C):C||(f.state="ID");continue;case"NOTE":C||(f.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(C)){f.state="NOTE";break}if(!C)continue;if(f.cue=new s.default(0,0,""),f.state="CUE",C.indexOf("-->")===-1){f.cue.id=C;continue}case"CUE":if(!f.cue){f.state="BADCUE";continue}try{d(C,f.cue,f.regionList)}catch{f.cue=null,f.state="BADCUE";continue}f.state="CUETEXT";continue;case"CUETEXT":{var m=C.indexOf("-->")!==-1;if(!C||m&&(g=!0)){f.oncue&&f.cue&&f.oncue(f.cue),f.cue=null,f.state="ID";continue}if(f.cue===null)continue;f.cue.text&&(f.cue.text+=`
`),f.cue.text+=C}continue;case"BADCUE":C||(f.state="ID")}}}catch{f.state==="CUETEXT"&&f.cue&&f.oncue&&f.oncue(f.cue),f.cue=null,f.state=f.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},_.flush=function(){var v=this;try{if((v.cue||v.state==="HEADER")&&(v.buffer+=`

`,v.parse()),v.state==="INITIAL"||v.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(f){v.onparsingerror&&v.onparsingerror(f)}return v.onflush&&v.onflush(),this},L}()},"./src/utils/webvtt-parser.ts":function(n,i,r){r.r(i),r.d(i,"generateCueId",function(){return E}),r.d(i,"parseWebVTT",function(){return _});var s=r("./src/polyfills/number.ts"),a=r("./src/utils/vttparser.ts"),o=r("./src/demux/id3.ts"),l=r("./src/utils/timescale-conversion.ts"),c=r("./src/remux/mp4-remuxer.ts"),u=/\r\n|\n\r|\n|\r/g,h=function(v,f,x){return x===void 0&&(x=0),v.slice(x,x+f.length)===f},d=function(v){var f=parseInt(v.slice(-3)),x=parseInt(v.slice(-6,-4)),S=parseInt(v.slice(-9,-7)),C=v.length>9?parseInt(v.substring(0,v.indexOf(":"))):0;if(!Object(s.isFiniteNumber)(f)||!Object(s.isFiniteNumber)(x)||!Object(s.isFiniteNumber)(S)||!Object(s.isFiniteNumber)(C))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+v);return f+=1e3*x,f+=60*1e3*S,f+=60*60*1e3*C,f},y=function(v){for(var f=5381,x=v.length;x;)f=f*33^v.charCodeAt(--x);return(f>>>0).toString()};function E(A,v,f){return y(A.toString())+y(v.toString())+y(f)}var L=function(v,f,x){var S=v[f],C=v[S.prevCC];if(!C||!C.new&&S.new){v.ccOffset=v.presentationOffset=S.start,S.new=!1;return}for(;(p=C)!==null&&p!==void 0&&p.new;){var p;v.ccOffset+=S.start-C.start,S.new=!1,S=C,C=v[S.prevCC]}v.presentationOffset=x};function _(A,v,f,x,S,C,p,g){var m=new a.VTTParser,D=Object(o.utf8ArrayToStr)(new Uint8Array(A)).trim().replace(u,`
`).split(`
`),b=[],T=Object(l.toMpegTsClockFromTimescale)(v,f),P="00:00.000",M=0,O=0,R,I=!0;m.oncue=function(w){var k=x[S],B=x.ccOffset,F=(M-T)/9e4;k!=null&&k.new&&(O!==void 0?B=x.ccOffset=k.start:L(x,S,F)),F&&(B=F-x.presentationOffset);var N=w.endTime-w.startTime,K=Object(c.normalizePts)((w.startTime+B-O)*9e4,C*9e4)/9e4;w.startTime=Math.max(K,0),w.endTime=Math.max(K+N,0);var H=w.text.trim();w.text=decodeURIComponent(encodeURIComponent(H)),w.id||(w.id=E(w.startTime,w.endTime,H)),w.endTime>0&&b.push(w)},m.onparsingerror=function(w){R=w},m.onflush=function(){if(R){g(R);return}p(b)},D.forEach(function(w){if(I)if(h(w,"X-TIMESTAMP-MAP=")){I=!1,w.slice(16).split(",").forEach(function(k){h(k,"LOCAL:")?P=k.slice(6):h(k,"MPEGTS:")&&(M=parseInt(k.slice(7)))});try{O=d(P)/1e3}catch(k){R=k}return}else w===""&&(I=!1);m.parse(w+`
`)}),m.flush()}},"./src/utils/xhr-loader.ts":function(n,i,r){r.r(i);var s=r("./src/utils/logger.ts"),a=r("./src/loader/load-stats.ts"),o=/^age:\s*[\d.]+\s*$/m,l=function(){function c(h){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=h?h.xhrSetup:null,this.stats=new a.LoadStats,this.retryDelay=0}var u=c.prototype;return u.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},u.abortInternal=function(){var d=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),d&&(d.onreadystatechange=null,d.onprogress=null,d.readyState!==4&&(this.stats.aborted=!0,d.abort()))},u.abort=function(){var d;this.abortInternal(),(d=this.callbacks)!==null&&d!==void 0&&d.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},u.load=function(d,y,E){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=d,this.config=y,this.callbacks=E,this.retryDelay=y.retryDelay,this.loadInternal()},u.loadInternal=function(){var d=this.config,y=this.context;if(!!d){var E=this.loader=new self.XMLHttpRequest,L=this.stats;L.loading.first=0,L.loaded=0;var _=this.xhrSetup;try{if(_)try{_(E,y.url)}catch{E.open("GET",y.url,!0),_(E,y.url)}E.readyState||E.open("GET",y.url,!0);var A=this.context.headers;if(A)for(var v in A)E.setRequestHeader(v,A[v])}catch(f){this.callbacks.onError({code:E.status,text:f.message},y,E);return}y.rangeEnd&&E.setRequestHeader("Range","bytes="+y.rangeStart+"-"+(y.rangeEnd-1)),E.onreadystatechange=this.readystatechange.bind(this),E.onprogress=this.loadprogress.bind(this),E.responseType=y.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),d.timeout),E.send()}},u.readystatechange=function(){var d=this.context,y=this.loader,E=this.stats;if(!(!d||!y)){var L=y.readyState,_=this.config;if(!E.aborted&&L>=2)if(self.clearTimeout(this.requestTimeout),E.loading.first===0&&(E.loading.first=Math.max(self.performance.now(),E.loading.start)),L===4){y.onreadystatechange=null,y.onprogress=null;var A=y.status;if(A>=200&&A<300){E.loading.end=Math.max(self.performance.now(),E.loading.first);var v,f;if(d.responseType==="arraybuffer"?(v=y.response,f=v.byteLength):(v=y.responseText,f=v.length),E.loaded=E.total=f,!this.callbacks)return;var x=this.callbacks.onProgress;if(x&&x(E,d,v,y),!this.callbacks)return;var S={url:y.responseURL,data:v};this.callbacks.onSuccess(S,E,d,y)}else E.retry>=_.maxRetry||A>=400&&A<499?(s.logger.error(A+" while loading "+d.url),this.callbacks.onError({code:A,text:y.statusText},d,y)):(s.logger.warn(A+" while loading "+d.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,_.maxRetryDelay),E.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),_.timeout)}},u.loadtimeout=function(){s.logger.warn("timeout while loading "+this.context.url);var d=this.callbacks;d&&(this.abortInternal(),d.onTimeout(this.stats,this.context,this.loader))},u.loadprogress=function(d){var y=this.stats;y.loaded=d.loaded,d.lengthComputable&&(y.total=d.total)},u.getCacheAge=function(){var d=null;if(this.loader&&o.test(this.loader.getAllResponseHeaders())){var y=this.loader.getResponseHeader("age");d=y?parseFloat(y):null}return d},c}();i.default=l}}).default})})(Lf);const Or=_m(Lf.exports),$i="https://api.bazzled.com",Sm="https://api.ttv.lol",Ca=e=>$i+"/corsproxy/"+encodeURIComponent(e),Xt=e=>({headers:{"client-id":"kimne78kx3ncx6brgo4mv6wki5h1ko"},body:JSON.stringify(e),method:"POST"}),Lm="https://badges.twitch.tv/v1/badges/global/display?language=en",de="https://gql.twitch.tv/gql",Df=e=>({operationName:"BrowsePage_Popular",variables:{imageWidth:50,limit:30,platformType:"all",options:{sort:"VIEWER_COUNT",freeformTags:null,tags:[],recommendationsContext:{platform:"web"},requestID:"JIRA-VXP-2397"},sortTypeIsRecency:!1,freeformTagsEnabled:!0,...e&&{cursor:e}},extensions:{persistedQuery:{version:1,sha256Hash:"267d2d2a64e0a0d6206c039ea9948d14a9b300a927d52b2efc52d2486ff0ec65"}}}),Af=e=>({operationName:"SearchTray_SearchSuggestions",variables:{requestID:"3da37623-8425-4a8a-bbcc-130552a009bc",queryFragment:e,withOfflineChannelContent:!0},extensions:{persistedQuery:{version:1,sha256Hash:"b71566f2c593dd906493b0ab2012e5626c7f277d3e435504d4454de2ff15788a"}}}),Cf=(e,t)=>({operationName:"FilterableVideoTower_Videos",variables:{limit:30,channelOwnerLogin:e,broadcastType:"ARCHIVE",videoSort:"TIME",...t&&{cursor:t}},extensions:{persistedQuery:{version:1,sha256Hash:"a937f1d22e269e39a03b509f65a7490f9fc247d7f83d6ac1421523e3b68042cb"}}}),Kl=(e,t,n)=>({operationName:"VideoCommentsByOffsetOrCursor",variables:{videoID:e,...t&&{contentOffsetSeconds:t},...n&&{cursor:n}},extensions:{persistedQuery:{version:1,sha256Hash:"b70a3591ff0f4e0313d126c6a1502d79a1c02baebb288227c582044aa76adf6a"}}}),Of=e=>({operationName:"ChannelShell",variables:{login:e},extensions:{persistedQuery:{version:1,sha256Hash:"580ab410bcd0c1ad194224957ae2241e5d252b2c5173d8e0cce9d32d5bb14efe"}}}),Mf=e=>({operationName:"NielsenContentMetadata",variables:{isCollectionContent:!1,isLiveContent:!0,isVODContent:!1,collectionID:"",login:e,vodID:""},extensions:{persistedQuery:{version:1,sha256Hash:"2dbf505ee929438369e68e72319d1106bb3c142e295332fac157c90638968586"}}}),Dm=e=>({operationName:"NielsenContentMetadata",variables:{isCollectionContent:!1,isLiveContent:!1,isVODContent:!0,collectionID:"",login:"",vodID:e},extensions:{persistedQuery:{version:1,sha256Hash:"2dbf505ee929438369e68e72319d1106bb3c142e295332fac157c90638968586"}}}),Am=(e,t)=>({operationName:"VideoMetadata",variables:{channelLogin:t,videoID:e},extensions:{persistedQuery:{version:1,sha256Hash:"49b5b8f268cdeb259d75b58dcb0c1a748e3b575003448a2333dc5cdafd49adad"}}}),Cm=e=>({operationName:"DirectoryPage_Game",variables:{imageWidth:50,name:e,options:{sort:"VIEWER_COUNT",recommendationsContext:{platform:"web"},requestID:"JIRA-VXP-2397",freeformTags:null,tags:[]},sortTypeIsRecency:!1,limit:30},extensions:{persistedQuery:{version:1,sha256Hash:"df4bb6cc45055237bfaf3ead608bbafb79815c7100b6ee126719fac3762ddf8b"}}}),Om=()=>({operationName:"BrowsePage_AllDirectories",variables:{limit:30,options:{recommendationsContext:{platform:"web"},requestID:"JIRA-VXP-2397",sort:"VIEWER_COUNT",tags:[]}},extensions:{persistedQuery:{version:1,sha256Hash:"78957de9388098820e222c88ec14e85aaf6cf844adf44c8319c545c75fd63203"}}}),Mm=(e,t)=>({operationName:"ViewerCard",variables:{channelLogin:e,hasChannelID:!0,giftRecipientLogin:t,isViewerBadgeCollectionEnabled:!0,withStandardGifting:!0},extensions:{persistedQuery:{version:1,sha256Hash:"20e51233313878f971daa32dfc039b2e2183822e62c13f47c48448d5d5e4f5e9"}}}),Hl=(e,t=null)=>({operationName:"ClipsCards__User",variables:{login:e,limit:20,criteria:{filter:"ALL_TIME"},...t&&{cursor:t}},extensions:{persistedQuery:{version:1,sha256Hash:"b73ad2bfaecfd30a9e6c28fada15bd97032c83ec77a0440766a56fe0bd632777"}}}),Pm=e=>({operationName:"ClipsDownloadButton",variables:{slug:e},extensions:{persistedQuery:{version:1,sha256Hash:"6e465bb8446e2391644cf079851c0cb1b96928435a240f07ed4b240f0acc6f1b"}}}),jl={showChat:!0,showMessages:!0,showBadges:!0,showEmotes:!0,showUsernames:!0,showTimestamps:!0,smoothChatFlow:!1,fontSize:13,fontType:"inherit",chatBackground:"#18181a",chatText:"#efeff1",chatSpeed:100};const Ut=(e,t)=>{const n=e.__vccOpts||e;for(const[i,r]of t)n[i]=r;return n},Rm={key:0,class:"chat-width-holder"},Im={class:"chats-positioner"},wm={class:"flex-time"},km={key:0,class:"chat-timestamp"},Fm=["innerHTML"],Bm={key:0},Nm=["innerHTML"],Um={__name:"ChatBox",props:["channel","channelId","settings"],setup(e,{expose:t}){const n=e,i=100,r=ot(null),s=ot({}),a=ot({}),o=ot([]),l=ot(!1);ve(()=>{console.log("mounting chatbox"),window.addEventListener("resize",c),c(),A(),v()}),Di(()=>{document.body.style.overflow="initial",window.removeEventListener("resize",c)});const c=()=>{(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)<=720?document.body.style.overflow="clip":document.body.style.overflow="initial"},u=D=>{const b=D.data;!b||!b.includes("@badge-info")||b.split("@badge-info").forEach(T=>h("@badge-info"+T))},h=D=>{if(l.value||D=="@badge-info"||n.settings.chatSpeed<100&&Math.random()*100>n.settings.chatSpeed)return;const b=D.match(/display-name=[^;]*;/),T=b&&b[0].substring(13,b[0].length-1),P=D.match(/color=[^;]*;/),M=P&&P[0].substring(6,P[0].length-1);let O=D.split(`PRIVMSG #${n.channel} :`)[1];O||(O=D.split(`USERNOTICE #${n.channel} :`)[1]),!O&&D.match(/system-msg=[^;]*;/)&&(O=String.raw`${D.match(/system-msg=[^;]*;/)[0].substring(11,D.match(/system-msg=[^;]*;/)[0].length-1)}`.replaceAll("\\s"," ")),O||console.log("ERR: no message",D);const R=d(D,O.replace(/(?:\\[rn]|[\r\n]+)+/g,"")),I=E(D);o.value.unshift({user:T,message:R,color:M,badges:I,key:Math.floor(Math.random()*10**9)}),o.value.length>i&&(o.value.length=i)},d=(D,b)=>{if(!n.settings.showEmotes||!b)return b;const T=D.match(/;emotes=[^;]*;/),P=T?T[0].substring(8,T[0].length-1):"",M=[];for(const k of P.split("/")){if(!k.includes(":"))break;const B=k.split(":")[0],F=k.split(":")[1];for(const N of F.split(","))M.push({start:N.split("-")[0],end:N.split("-")[1],emoteId:B})}M.sort((k,B)=>k.start-B.start);let O="",R=0;for(let k=0;k<b.length;k++)M[R]&&M[R].start==k?(O+=`<span class="badge-holder"><img src="https://static-cdn.jtvnw.net/emoticons/v2/${M[R].emoteId}/default/dark/1.0" class="emoticon" /><span class="badge-tooltip tooltip-raise">${b.substring(parseInt(M[R].start),parseInt(M[R].end)+1)} </span></span>`,k=M[R].end,R++):O+=b[k];const I=O.replace(/<\/?[^>]+(>|$)/g,"");if(!I)return O;const w=[];for(const k of I.split(" "))a.value[k]&&!w.includes(k)&&(O=O.replaceAll(k,y(k,a.value[k])),w.push(k));return O},y=(D,b)=>`<span class="badge-holder"><img src="${b}" class="emoticon" /><span class="badge-tooltip tooltip-raise">${D} </span></span>`,E=D=>{var M;let b="";const T=D.match(/badges=[^;]*;/);if(!T||T[0].length<=8)return b;const P=T[0].substring(7,T[0].length-1);for(const O of P.split(",")){const R=O.split("/")[0],I=O.split("/")[1],w=(M=s.value[R])==null?void 0:M.versions[I];if(!w)continue;b=`<span class="badge-holder"><img src="${w.image_url_1x||w.image_url_2x}" class="badge" /><span class="badge-tooltip">${w.title}</span></span>`+b}return b},L=D=>{if(l.value||n.settings.chatSpeed<100&&Math.random()*100>n.settings.chatSpeed)return;let b="";console.log(),D.badges.forEach(O=>b+=`<span class="badge-holder"><img src="${s.value[O.setID].versions[O.version].image_url_1x}" class="badge" /><span class="badge-tooltip">${O.setID}</span></span>`);let T=_(D.fragments);const P=T.replace(/<\/?[^>]+(>|$)/g,""),M=[];for(const O of P.split(" "))a.value[O]&&!M.includes(O)&&(T=T.replaceAll(O,y(O,a.value[O])),M.push(O));o.value.unshift({user:D.user,message:T,color:D.color,badges:b,timestamp:f(D.offset),key:Math.floor(Math.random()*10**9)}),o.value.length>i&&(o.value.length=i)},_=D=>{let b="";for(let T of D)T.emote?b+=y(T.text,`https://static-cdn.jtvnw.net/emoticons/v2/${T.emote.emoteID}/default/dark/1.0"`):b+=T.text;return b},A=async()=>{const D=await fetch(Lm).then(b=>b.json());s.value=D.badge_sets},v=(D=0)=>{if(console.log(n.channelId,"get third party emotes"),D!=5){if(!n.channelId)return setTimeout(()=>v(D+1),500);fetch(`https://api.7tv.app/v2/users/${n.channel}/emotes`).then(b=>b.json()).then(b=>{b.error||b.forEach(T=>{a.value[T.name]=T.urls[0][1]})}).catch(b=>console.log(b)),fetch(`https://api.frankerfacez.com/v1/room/id/${n.channelId}`).then(b=>b.json()).then(b=>{var T,P;if(!b.error){const M=(T=b.room)==null?void 0:T.set;(P=b.sets[M])==null||P.emoticons.forEach(O=>{a.value[O.name]=O.urls[1]})}}),fetch(`https://api.betterttv.net/3/cached/users/twitch/${n.channelId}`).then(b=>b.json()).then(b=>{!b.error&&b.message!="user not found"&&(b.channelEmotes.forEach(T=>{a.value[T.code]=`https://cdn.betterttv.net/emote/${T.id}/1x`}),b.sharedEmotes.forEach(T=>{a.value[T.code]=`https://cdn.betterttv.net/emote/${T.id}/1x`}))})}},f=D=>{let b=Math.floor(D/3600);D=D%3600;let T=Math.floor(D/60);D=D%60;let P=D;return P<10&&(P="0"+P),T<10&&b!=0&&(T="0"+T),b==0?`${T}:${P}`:`${b}:${T}:${P}`},x=D=>{if(!D)return 0;let b=0;for(let T=0,P=D.length;T<P;T++){let M=D.charCodeAt(T);b=(b<<5)-b+M,b|=0}return b},S=["#ff0000","#319a24","#ff4500","#f7ff00","#8b58ff","#9acd32","#1e90ff"],C=D=>S[Math.abs(x(D))%S.length],p=()=>{l.value=r.value.scrollTop<-20},g=()=>{r.value.scrollTop=0};return t({handleNewMessage:u,handleNewVodMessage:L,clearAllChat:()=>{o.value.length=0}}),(D,b)=>e.settings.showChat?(st(),ct("div",Rm,[G("div",Im,[G("div",{ref_key:"chatContainer",ref:r,class:"chats-container",style:Ge(`background-color: ${e.settings.chatBackground}; color: ${e.settings.chatText}; font-family: ${e.settings.fontType};`),onScroll:p},[pt(ff,{name:e.settings.smoothChatFlow?"chatbox":""},{default:Sn(()=>[(st(!0),ct(Rt,null,Ie(o.value,T=>(st(),ct("div",{class:"chat-each",key:T.key,style:Ge(`font-size: ${e.settings.fontSize}px;`)},[G("div",wm,[e.settings.showTimestamps&&T.timestamp?(st(),ct("span",km,mt(T.timestamp),1)):Ot("",!0),G("span",null,[G("span",{style:Ge(`color: ${T.color||C(T.user)}; font-weight: 600`)},[e.settings.showBadges?(st(),ct("span",{key:0,innerHTML:T.badges},null,8,Fm)):Ot("",!0),Se(mt(e.settings.showUsernames?T.user:""),1)],4),e.settings.showUsernames?(st(),ct("span",Bm,": ")):Ot("",!0),e.settings.showMessages?(st(),ct("span",{key:1,innerHTML:T.message},null,8,Nm)):Ot("",!0)])])],4))),128))]),_:1},8,["name"])],36),l.value?(st(),ct("div",{key:0,class:"resume-chat",onClick:g}," Resume Auto Scroll ")):Ot("",!0)])])):Ot("",!0)}},Wm=Ut(Um,[["__scopeId","data-v-f78b915d"]]);const Km={},Hm=e=>(cn("data-v-b7bfb10d"),e=e(),un(),e),jm={type:"color-fill-current",width:"18px",height:"18px",version:"1.1",viewBox:"0 0 20 20",x:"0px",y:"0px",class:"fill-purple"},Vm=Hm(()=>G("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M10 2l6 2 2 6-2 6-6 2-6-2-2-6 2-6 6-2zM8.889 13.636l5.43-5.429-1.415-1.414-4.015 4.015-2.015-2.015-1.414 1.414 3.429 3.43z"},null,-1)),$m=[Vm];function Gm(e,t){return st(),ct("svg",jm,$m)}const uo=Ut(Km,[["render",Gm],["__scopeId","data-v-b7bfb10d"]]);const zm={},Ym=e=>(cn("data-v-1bda0ed2"),e=e(),un(),e),Xm={type:"color-text-accessible-red",width:"20px",height:"20px",version:"1.1",viewBox:"0 0 20 20",x:"0px",y:"0px",class:"red"},Qm=Ym(()=>G("g",null,[G("path",{"fill-rule":"evenodd",d:"M5 7a5 5 0 116.192 4.857A2 2 0 0013 13h1a3 3 0 013 3v2h-2v-2a1 1 0 00-1-1h-1a3.99 3.99 0 01-3-1.354A3.99 3.99 0 017 15H6a1 1 0 00-1 1v2H3v-2a3 3 0 013-3h1a2 2 0 001.808-1.143A5.002 5.002 0 015 7zm5 3a3 3 0 110-6 3 3 0 010 6z","clip-rule":"evenodd"})],-1)),Zm=[Qm];function Jm(e,t){return st(),ct("svg",Xm,Zm)}const qm=Ut(zm,[["render",Jm],["__scopeId","data-v-1bda0ed2"]]),Ce=e=>{if(e<1e3)return e;if(e<1e5){const t=Math.floor(e/1e3),n=Math.round(e%1e3/100);return n==10?t+1+"K":n==0?t+"K":t+"."+n+"K"}if(e<1e6)return Math.round(e/1e3)+"K";{const t=Math.floor(e/1e6),n=Math.round(e%1e6/1e5);return n==10?t+1+"M":n==0?t+"M":t+"."+n+"M"}},fo=e=>{let t=Math.floor(e/3600);e=e%3600;let n=Math.floor(e/60);return e=e%60,n<10&&(n="0"+n),e<10&&(e="0"+e),t?`${t}:${n}:${e}`:`${n}:${e}`},Pi=e=>{let t=Math.floor(e/3600);e=e%3600;let n=Math.floor(e/60);return t<10&&(t="0"+t),n<10&&(n="0"+n),`${t}:${n}`},ho=e=>{const t=(new Date-new Date(e))/1e3,n=Math.round(t/3600);if(n<24)return n==1?"1 hour ago":`${n} hours ago`;const i=Math.round(n/24);if(i<30)return i==1?"Yesterday":`${i} days ago`;const r=Math.round(i/30);if(r<12)return r==1?"Last month":`${r} months ago`;const s=Math.round(r/12);return s==1?"Last year":`${s} years ago`},tp={},ep={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",fill:"currentColor"},np=G("path",{d:"M15 4a1 1 0 1 0 0 2V4zm0 11v-1a1 1 0 0 0-1 1h1zm0 4l-.707.707A1 1 0 0 0 16 19h-1zm-4-4l.707-.707A1 1 0 0 0 11 14v1zm-4.707-1.293a1 1 0 0 0-1.414 1.414l1.414-1.414zm-.707.707l-.707-.707.707.707zM9 11v-1a1 1 0 0 0-.707.293L9 11zm-4 0h1a1 1 0 0 0-1-1v1zm0 4H4a1 1 0 0 0 1.707.707L5 15zm10-9h2V4h-2v2zm2 0a1 1 0 0 1 1 1h2a3 3 0 0 0-3-3v2zm1 1v6h2V7h-2zm0 6a1 1 0 0 1-1 1v2a3 3 0 0 0 3-3h-2zm-1 1h-2v2h2v-2zm-3 1v4h2v-4h-2zm1.707 3.293l-4-4-1.414 1.414 4 4 1.414-1.414zM11 14H7v2h4v-2zm-4 0c-.276 0-.525-.111-.707-.293l-1.414 1.414C5.42 15.663 6.172 16 7 16v-2zm-.707 1.121l3.414-3.414-1.414-1.414-3.414 3.414 1.414 1.414zM9 12h4v-2H9v2zm4 0a3 3 0 0 0 3-3h-2a1 1 0 0 1-1 1v2zm3-3V3h-2v6h2zm0-6a3 3 0 0 0-3-3v2a1 1 0 0 1 1 1h2zm-3-3H3v2h10V0zM3 0a3 3 0 0 0-3 3h2a1 1 0 0 1 1-1V0zM0 3v6h2V3H0zm0 6a3 3 0 0 0 3 3v-2a1 1 0 0 1-1-1H0zm3 3h2v-2H3v2zm1-1v4h2v-4H4zm1.707 4.707l.586-.586-1.414-1.414-.586.586 1.414 1.414z"},null,-1),ip=[np];function rp(e,t){return st(),ct("svg",ep,ip)}const Pf=Ut(tp,[["render",rp]]),sp={},ap={xmlns:"http://www.w3.org/2000/svg",width:"20",height:"17",fill:"currentColor"},op=G("path",{d:"M11 2.253a1 1 0 1 0-2 0h2zm-2 13a1 1 0 1 0 2 0H9zm.447-12.167a1 1 0 1 0 1.107-1.666L9.447 3.086zM1 2.253L.447 1.42A1 1 0 0 0 0 2.253h1zm0 13H0a1 1 0 0 0 1.553.833L1 15.253zm8.447.833a1 1 0 1 0 1.107-1.666l-1.107 1.666zm0-14.666a1 1 0 1 0 1.107 1.666L9.447 1.42zM19 2.253h1a1 1 0 0 0-.447-.833L19 2.253zm0 13l-.553.833A1 1 0 0 0 20 15.253h-1zm-9.553-.833a1 1 0 1 0 1.107 1.666L9.447 14.42zM9 2.253v13h2v-13H9zm1.553-.833C9.203.523 7.42 0 5.5 0v2c1.572 0 2.961.431 3.947 1.086l1.107-1.666zM5.5 0C3.58 0 1.797.523.447 1.42l1.107 1.666C2.539 2.431 3.928 2 5.5 2V0zM0 2.253v13h2v-13H0zm1.553 13.833C2.539 15.431 3.928 15 5.5 15v-2c-1.92 0-3.703.523-5.053 1.42l1.107 1.666zM5.5 15c1.572 0 2.961.431 3.947 1.086l1.107-1.666C9.203 13.523 7.42 13 5.5 13v2zm5.053-11.914C11.539 2.431 12.928 2 14.5 2V0c-1.92 0-3.703.523-5.053 1.42l1.107 1.666zM14.5 2c1.573 0 2.961.431 3.947 1.086l1.107-1.666C18.203.523 16.421 0 14.5 0v2zm3.5.253v13h2v-13h-2zm1.553 12.167C18.203 13.523 16.421 13 14.5 13v2c1.573 0 2.961.431 3.947 1.086l1.107-1.666zM14.5 13c-1.92 0-3.703.523-5.053 1.42l1.107 1.666C11.539 15.431 12.928 15 14.5 15v-2z"},null,-1),lp=[op];function cp(e,t){return st(),ct("svg",ap,lp)}const up=Ut(sp,[["render",cp]]);const fp={},go=e=>(cn("data-v-ac322f5f"),e=e(),un(),e),dp={id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 122.88 66.49"},hp=go(()=>G("defs",null,null,-1)),gp=go(()=>G("title",null,"leaderboard",-1)),vp=go(()=>G("path",{class:"cls-1",d:"M2.27,18.3H34.05a2.27,2.27,0,0,1,2.27,2.27V64.22a2.27,2.27,0,0,1-2.27,2.27H2.27A2.27,2.27,0,0,1,0,64.22V20.57A2.27,2.27,0,0,1,2.27,18.3ZM68.4,9.44V31H61V17.39l-4.52,1.8-2-5.3,7.66-4.45ZM26,49.45H11V43.81l2.84-2.75c.62-.57,1.21-1.13,1.77-1.7L17,38a7.69,7.69,0,0,0,1-1.24,3.52,3.52,0,0,0,.54-1,2.82,2.82,0,0,0,.09-.71,1.08,1.08,0,0,0-.5-1.08,4.54,4.54,0,0,0-1.73-.23,24,24,0,0,0-4.32.36l-.69.13L11,28.58a21.3,21.3,0,0,1,7.12-1.21A9.13,9.13,0,0,1,24,29.06a5.64,5.64,0,0,1,2.12,4.68,9.36,9.36,0,0,1-1,4.7A11.9,11.9,0,0,1,21.45,42l-2.19,1.54H26v5.9ZM103.1,37.19q4.82,0,7,1.37t2.18,4.85a6.81,6.81,0,0,1-.44,2.75,4.59,4.59,0,0,1-1.56,1.74A6.49,6.49,0,0,1,112,49.78a5.44,5.44,0,0,1,.52,2.64q0,4.09-2.13,5.65t-6.58,1.55A28.12,28.12,0,0,1,98,59l-1.08-.23L97.07,53q3.77.33,5.37.33a8,8,0,0,0,2.13-.18.76.76,0,0,0,.53-.79.91.91,0,0,0-.37-.83,2.48,2.48,0,0,0-1.37-.33H98.74v-5.8h4.32c1.18,0,1.77-.33,1.77-1s-.75-1-2.26-1c-1,0-2.53.08-4.52.23l-.85.07L97,38.14a26.29,26.29,0,0,1,6.06-1ZM45.55,0H77.33A2.27,2.27,0,0,1,79.6,2.27v62a2.27,2.27,0,0,1-2.27,2.27H45.55a2.27,2.27,0,0,1-2.27-2.27V2.27A2.27,2.27,0,0,1,45.55,0ZM88.83,30.35h31.78a2.28,2.28,0,0,1,2.27,2.27v31.6a2.27,2.27,0,0,1-2.27,2.27H88.83a2.27,2.27,0,0,1-2.27-2.27V32.62a2.27,2.27,0,0,1,2.27-2.27Z"},null,-1)),mp=[hp,gp,vp];function pp(e,t){return st(),ct("svg",dp,mp)}const vo=Ut(fp,[["render",pp],["__scopeId","data-v-ac322f5f"]]);const yp={class:"live-info-full"},Ep={class:"info-left"},xp={class:"pfp-holder"},bp=["src"],Tp={class:"long-info-holder"},_p={class:"stream-title"},Sp={class:"info-right"},Lp={class:"stream-uptime"},Dp={class:"icons-holder"},Ap={__name:"LiveInfo",props:{channel:String},emits:["settingsClick","leaderboardClick","setId"],setup(e,{emit:t}){const n=e,i=me(),r=ot(""),s=ot(null),a=ot(""),o=ot(""),l=ot(""),c=ot(0),u=ot("");ve(()=>{h()});const h=async()=>{var A,v,f,x,S,C,p,g,m,D,b,T,P,M,O,R,I,w;const E=[Of(n.channel),Mf(n.channel)],L=Xt(E),_=await fetch(de,L).then(k=>k.json());r.value=(f=(v=(A=_[1].data)==null?void 0:A.user)==null?void 0:v.broadcastSettings)==null?void 0:f.title,s.value=(C=(S=(x=_[1].data)==null?void 0:x.user)==null?void 0:S.stream)==null?void 0:C.createdAt,a.value=(D=(m=(g=(p=_[1].data)==null?void 0:p.user)==null?void 0:g.stream)==null?void 0:m.game)==null?void 0:D.displayName,o.value=(T=(b=_[0].data)==null?void 0:b.userOrError)==null?void 0:T.profileImageURL,l.value=(M=(P=_[0].data)==null?void 0:P.userOrError)==null?void 0:M.displayName,c.value=(R=(O=_[0].data)==null?void 0:O.userOrError)==null?void 0:R.stream.viewersCount,t("setId",(w=(I=_[0].data)==null?void 0:I.userOrError)==null?void 0:w.id),setInterval(d,1e3)},d=()=>{if(!s.value)return;const E=new Date-new Date(s.value);u.value=fo(Math.round(E/1e3))},y=()=>{i.push(`/twitch/${n.channel}`)};return(E,L)=>(st(),ct("div",yp,[G("div",Ep,[G("div",xp,[G("img",{class:"pfp",src:o.value,onClick:y},null,8,bp)]),G("div",Tp,[G("div",{class:"channel-name",onClick:y},[Se(mt(l.value),1),pt(uo,{class:"icon-check"})]),G("div",_p,mt(r.value),1),G("div",{class:"stream-game",onClick:L[0]||(L[0]=_=>ht(i).push(`/twitch/directory-search-${a.value}`))},mt(a.value),1)])]),G("div",Sp,[G("div",{class:"view-count",onClick:L[1]||(L[1]=_=>ht(i).push("/"))},[pt(qm),Se(mt(c.value.toLocaleString()),1)]),G("div",Lp,mt(u.value),1),G("div",Dp,[pt(Pf,{class:"analyze-button",onClick:L[2]||(L[2]=_=>E.$emit("settingsClick"))}),pt(vo,{class:"analyze-button",onClick:L[3]||(L[3]=_=>E.$emit("leaderboardClick")),style:{width:"36px"}}),pt(up,{class:"analyze-button",onClick:L[4]||(L[4]=_=>ht(i).push(`/twitch/${n.channel}/analyzeLive`))})])])]))}},Cp=Ut(Ap,[["__scopeId","data-v-3af62853"]]);const Op={class:"live-info-full"},Mp={class:"info-left"},Pp={class:"pfp-holder"},Rp=["src"],Ip={class:"long-info-holder"},wp={class:"vod-title"},kp={class:"info-right"},Fp={class:"view-count"},Bp={class:"vod-uptime"},Np={class:"icons-holder"},Up={__name:"VodInfo",props:{vodId:String},emits:["settingsClick","leaderboardClick","setId"],setup(e,{emit:t}){const n=e,i=me(),r=ot(""),s=ot(""),a=ot(null),o=ot(0),l=ot(""),c=ot(""),u=ot(!1),h=ot("");ve(()=>{d()});const d=async()=>{var x,S,C,p,g,m,D,b,T,P,M,O,R,I,w,k,B,F,N,K,H;const E=Dm(n.vodId),L=Xt(E),_=await fetch(de,L).then(U=>U.json()),A=(C=(S=(x=_==null?void 0:_.data)==null?void 0:x.video)==null?void 0:S.owner)==null?void 0:C.login,v=Xt(Am(n.vodId,A)),f=await fetch(de,v).then(U=>U.json());console.log(f),r.value=(m=(g=(p=f==null?void 0:f.data)==null?void 0:p.video)==null?void 0:g.game)==null?void 0:m.name,s.value=(b=(D=f==null?void 0:f.data)==null?void 0:D.video)==null?void 0:b.title,a.value=(P=(T=f==null?void 0:f.data)==null?void 0:T.video)==null?void 0:P.createdAt,o.value=(O=(M=f==null?void 0:f.data)==null?void 0:M.video)==null?void 0:O.viewCount,c.value=(w=(I=(R=f==null?void 0:f.data)==null?void 0:R.video)==null?void 0:I.owner)==null?void 0:w.displayName,l.value=(B=(k=f==null?void 0:f.data)==null?void 0:k.user)==null?void 0:B.profileImageURL,u.value=(N=(F=f==null?void 0:f.data)==null?void 0:F.user)==null?void 0:N.isPartner,h.value=A,t("setId",(H=(K=f==null?void 0:f.data)==null?void 0:K.user)==null?void 0:H.id)},y=()=>{i.push(`/twitch/${h.value}`)};return(E,L)=>(st(),ct("div",Op,[G("div",Mp,[G("div",Pp,[G("img",{class:"pfp",src:l.value,onClick:y},null,8,Rp)]),G("div",Ip,[G("div",{class:"channel-name",onClick:y},[Se(mt(c.value),1),u.value?(st(),zt(uo,{key:0,class:"icon-check"})):Ot("",!0)]),G("div",wp,mt(s.value),1),G("div",{class:"vod-game",onClick:L[0]||(L[0]=_=>ht(i).push(`/twitch/directory-search-${r.value}`))},mt(r.value),1)])]),G("div",kp,[G("div",Fp,mt(o.value.toLocaleString())+"\xA0views",1),G("div",Bp,mt(ht(ho)(a.value)),1),G("div",Np,[pt(Pf,{class:"analyze-button",onClick:L[1]||(L[1]=_=>E.$emit("settingsClick"))}),pt(vo,{class:"analyze-button",onClick:L[2]||(L[2]=_=>E.$emit("leaderboardClick")),style:{width:"36px"}})])])]))}},Wp=Ut(Up,[["__scopeId","data-v-d7cd546e"]]),Kp={},Hp={type:"color-fill-current",width:"20px",height:"20px",version:"1.1",viewBox:"0 0 20 20",x:"0px",y:"0px"},jp=G("g",null,[G("path",{"fill-rule":"evenodd",d:"M13.192 14.606a7 7 0 111.414-1.414l3.101 3.1-1.414 1.415-3.1-3.1zM14 9A5 5 0 114 9a5 5 0 0110 0z","clip-rule":"evenodd"})],-1),Vp=[jp];function $p(e,t){return st(),ct("svg",Hp,Vp)}const Vl=Ut(Kp,[["render",$p]]);const Gp=e=>(cn("data-v-e9f14ec0"),e=e(),un(),e),zp=Gp(()=>G("div",{class:"search-spaceholder"},null,-1)),Yp={class:"search-container"},Xp={key:0,class:"suggestions-container"},Qp=["onClick"],Zp={class:"channel-row"},Jp=["src"],qp=["src"],t0={class:"channel-info"},e0={class:"suggestion-text"},n0={key:0,class:"channel-verified"},i0={key:3,class:"channel-is-live"},r0={key:0},s0={__name:"SearchBox",props:{getQuerySuggestions:Function},emits:["queryClick"],setup(e,{emit:t}){const n=e,i=me(),r=ot(""),s=ot([]),a=ot(null),o=ot(null),l=ot(!1);ve(()=>{a.value.addEventListener("focusin",()=>l.value=!0),a.value.addEventListener("focusout",()=>l.value=!1)});const c=async()=>{r.value?s.value=await n.getQuerySuggestions(r.value):s.value=[]},u=h=>{!h.content&&h.text&&(h=h.text),t("queryClick",h),l.value=!1,o.value.blur()};return(h,d)=>(st(),ct(Rt,null,[zp,G("div",{class:"home-button",onClick:d[0]||(d[0]=y=>ht(i).push("/"))},"Home"),G("div",Yp,[G("div",{class:"search-box-container",tabindex:"-1",ref_key:"inputDiv",ref:a},[ce(G("input",{type:"text",class:"query-input","onUpdate:modelValue":d[1]||(d[1]=y=>r.value=y),autocapitalize:"none",autocomplete:"off",autocorrect:"off",spellcheck:"false",placeholder:"Search",maxlength:"150",onInput:c,onKeypress:d[2]||(d[2]=gv(()=>u(r.value),["enter"])),ref_key:"inputElement",ref:o},null,544),[[li,r.value]]),pt(hi,{name:"container"},{default:Sn(()=>[r.value&&l.value?(st(),ct("div",Xp,[(st(!0),ct(Rt,null,Ie(s.value,y=>{var E,L,_,A;return st(),ct("div",{class:"suggestion-each",key:y,onMousedown:d[3]||(d[3]=dv(()=>{},["prevent"])),onClick:()=>u(y)},[G("div",Zp,[(E=y.content)!=null&&E.profileImageURL?(st(),ct("img",{key:0,class:"profile-image",src:y.content.profileImageURL},null,8,Jp)):(L=y.content)!=null&&L.boxArtURL?(st(),ct("img",{key:1,class:"profile-image-box",src:y.content.boxArtURL},null,8,qp)):(st(),zt(Vl,{key:2,class:"search-icon"})),G("div",t0,[G("span",e0,mt(y.text),1),(_=y.content)!=null&&_.isVerified?(st(),ct("span",n0,[pt(uo)])):Ot("",!0)]),(A=y.content)!=null&&A.isLive?(st(),ct("div",i0,"LIVE")):Ot("",!0)])],40,Qp)}),128)),s.value.length?Ot("",!0):(st(),ct("div",r0," No results "))])):Ot("",!0)]),_:1})],512),G("div",{class:"search-button",onClick:d[4]||(d[4]=()=>u(r.value))},[pt(Vl,{class:"search-icon"})])])],64))}},mo=Ut(s0,[["__scopeId","data-v-e9f14ec0"]]),Rf={__name:"TwitchSearchBox",setup(e){const t=me(),n=async r=>{const s=Xt(Af(r));return(await fetch(de,s).then(l=>l.json())).data.searchSuggestions.edges.map(l=>l.node).filter(l=>l.content)},i=r=>{var c,u,h;console.log(r);const s=(c=r==null?void 0:r.content)==null?void 0:c.login,a=(u=r==null?void 0:r.content)==null?void 0:u.isLive,o=(h=r==null?void 0:r.content)==null?void 0:h.boxArtURL,l=r==null?void 0:r.text;s&&a?t.push(`/hls/twitch/${s}`):s&&!a?t.push(`/twitch/${s}`):o&&l?t.push(`/twitch/directory-search-${l}`):console.log("normal query search, wip")};return(r,s)=>(st(),zt(mo,{"get-query-suggestions":n,onQueryClick:i}))}};const qt=e=>(cn("data-v-65f524c8"),e=e(),un(),e),a0={class:"modal"},o0=qt(()=>G("div",{class:"section"}," Chat ",-1)),l0={class:"row"},c0=qt(()=>G("span",{class:"label"},"Show Chat",-1)),u0={class:"row"},f0=qt(()=>G("span",{class:"label"},"Show Messages",-1)),d0={class:"row"},h0=qt(()=>G("span",{class:"label"},"Show Badges",-1)),g0={class:"row"},v0=qt(()=>G("span",{class:"label"},"Show Emotes",-1)),m0={class:"row"},p0=qt(()=>G("span",{class:"label"},"Show Usernames",-1)),y0={class:"row"},E0=qt(()=>G("span",{class:"label"},"Show Timestamps (vod only)",-1)),x0={class:"row"},b0=qt(()=>G("span",{class:"label"},"Smooth Chat Flow",-1)),T0={class:"row"},_0=qt(()=>G("span",{class:"label"},"Font Size",-1)),S0={class:"row"},L0=qt(()=>G("span",{class:"label"},"Font Type",-1)),D0=qt(()=>G("option",{value:"inherit"},"normal",-1)),A0=qt(()=>G("option",{value:"monospace"},"monospace",-1)),C0=qt(()=>G("option",{value:"cursive"},"cursive",-1)),O0=[D0,A0,C0],M0={class:"row"},P0=qt(()=>G("span",{class:"label"},"Background Color",-1)),R0={class:"row"},I0=qt(()=>G("span",{class:"label"},"Text Color",-1)),w0={class:"row"},k0=qt(()=>G("span",{class:"label"},"Speed",-1)),F0=qt(()=>G("span",{class:"info"},"1% - 100%",-1)),B0={__name:"StreamSettingsPage",props:["settings"],emits:["settingsUpdated","resetSettings"],setup(e,{emit:t}){const n=e,i=()=>t("settingsUpdated"),r=()=>t("resetSettings");return(s,a)=>(st(),ct("div",null,[G("div",a0,[o0,G("div",l0,[c0,ce(G("input",{class:"input",type:"checkbox","onUpdate:modelValue":a[0]||(a[0]=o=>n.settings.showChat=o)},null,512),[[Nn,n.settings.showChat]])]),G("div",u0,[f0,ce(G("input",{class:"input",type:"checkbox","onUpdate:modelValue":a[1]||(a[1]=o=>n.settings.showMessages=o)},null,512),[[Nn,n.settings.showMessages]])]),G("div",d0,[h0,ce(G("input",{class:"input",type:"checkbox","onUpdate:modelValue":a[2]||(a[2]=o=>n.settings.showBadges=o)},null,512),[[Nn,n.settings.showBadges]])]),G("div",g0,[v0,ce(G("input",{class:"input",type:"checkbox","onUpdate:modelValue":a[3]||(a[3]=o=>n.settings.showEmotes=o)},null,512),[[Nn,n.settings.showEmotes]])]),G("div",m0,[p0,ce(G("input",{class:"input",type:"checkbox","onUpdate:modelValue":a[4]||(a[4]=o=>n.settings.showUsernames=o)},null,512),[[Nn,n.settings.showUsernames]])]),G("div",y0,[E0,ce(G("input",{class:"input",type:"checkbox","onUpdate:modelValue":a[5]||(a[5]=o=>n.settings.showTimestamps=o)},null,512),[[Nn,n.settings.showTimestamps]])]),G("div",x0,[b0,ce(G("input",{class:"input",type:"checkbox","onUpdate:modelValue":a[6]||(a[6]=o=>n.settings.smoothChatFlow=o)},null,512),[[Nn,n.settings.smoothChatFlow]])]),G("div",T0,[_0,ce(G("input",{class:"input",type:"number",min:"2",max:"30","onUpdate:modelValue":a[7]||(a[7]=o=>n.settings.fontSize=o)},null,512),[[li,n.settings.fontSize]])]),G("div",S0,[L0,ce(G("select",{class:"input","onUpdate:modelValue":a[8]||(a[8]=o=>n.settings.fontType=o)},O0,512),[[df,n.settings.fontType]])]),G("div",M0,[P0,ce(G("input",{class:"input",type:"color","onUpdate:modelValue":a[9]||(a[9]=o=>n.settings.chatBackground=o)},null,512),[[li,n.settings.chatBackground]])]),G("div",R0,[I0,ce(G("input",{class:"input",type:"color","onUpdate:modelValue":a[10]||(a[10]=o=>n.settings.chatText=o)},null,512),[[li,n.settings.chatText]])]),G("div",w0,[k0,ce(G("input",{class:"input",type:"number",min:"1",max:"100","onUpdate:modelValue":a[11]||(a[11]=o=>n.settings.chatSpeed=o)},null,512),[[li,n.settings.chatSpeed]])]),F0,G("div",{class:"row center"},[G("button",{class:"button",onClick:r},"Reset")])]),G("div",{class:"modal-outer",onClick:i})]))}},N0=Ut(B0,[["__scopeId","data-v-65f524c8"]]);const po=e=>(cn("data-v-71b0904a"),e=e(),un(),e),U0={class:"modal"},W0={class:"section row"},K0=qu('<option value="3" data-v-71b0904a>Last 3 days</option><option value="7" data-v-71b0904a>Last week</option><option value="14" data-v-71b0904a>Last 2 weeks</option><option value="30" data-v-71b0904a>Last month</option><option value="180" data-v-71b0904a>Last 6 months</option><option value="365" data-v-71b0904a>Last year</option>',6),H0=[K0],j0={class:"row"},V0=po(()=>G("span",{class:"label"}," Average View Count ",-1)),$0={class:"row"},G0=po(()=>G("span",{class:"label"}," Peak View Count ",-1)),z0={class:"row"},Y0=po(()=>G("span",{class:"label"}," Hours Streamed ",-1)),X0={__name:"LeaderboardModal",props:["channel"],emits:["closePage"],setup(e){const t=e,n=ot({}),i=ot(!0),r=ot(14);return Re(r,()=>{i.value=!0,fetch($i+`/twitchChannelViewsData/${t.channel}/${r.value}`).then(s=>s.json()).then(s=>{console.log(s),i.value=!1,n.value=s})},{immediate:!0}),(s,a)=>(st(),ct(Rt,null,[G("div",U0,[G("div",W0,[Se(mt(t.channel),1),ce(G("select",{class:"days-active","onUpdate:modelValue":a[0]||(a[0]=o=>r.value=o)},H0,512),[[df,r.value]])]),G("div",j0,[V0,pt(hi,{name:"slide-fade",mode:"out-in"},{default:Sn(()=>[(st(),ct("span",{class:"answer",key:n.value.avgViews},mt(n.value.avgViews)+" "+mt(n.value.avgViewsRank&&`(${n.value.avgViewsRank})`),1))]),_:1})]),G("div",$0,[G0,pt(hi,{name:"slide-fade",mode:"out-in"},{default:Sn(()=>[(st(),ct("span",{class:"answer",key:n.value.peakViews},mt(n.value.peakViews)+" "+mt(n.value.peakViewsRank&&`(${n.value.peakViewsRank})`),1))]),_:1})]),G("div",z0,[Y0,pt(hi,{name:"slide-fade",mode:"out-in"},{default:Sn(()=>[(st(),ct("span",{class:"answer",key:n.value.hoursStreamed},mt(n.value.hoursStreamed),1))]),_:1})])]),G("div",{class:"modal-outer",onClick:a[1]||(a[1]=o=>s.$emit("closePage"))})],64))}},If=Ut(X0,[["__scopeId","data-v-71b0904a"]]);const Q0={id:"page-container"},Z0={class:"video-and-chat-container"},J0={class:"video-section"},q0={__name:"HlsView",setup(e){const t=pr(),n=ot(""),i=ot(0),r=ot(!1),s=ot(!1),a=ot([]),o=ot(null),l=ot(null),c=ot(null),u=ot(null),h=ot(Object.assign({},jl)),d=ot("");ve(()=>{t.params.twitchChannelName?(n.value=`https://twitch.tv/${t.params.twitchChannelName}`,y()):t.params.ytWatchId?(n.value=`https://youtube.com/watch?v=${t.params.ytWatchId}`,y()):t.params.twitchVodId&&(n.value=`https://twitch.tv/videos/${t.params.twitchVodId}`,y()),c.value.ontimeupdate=_,c.value.onseeked=A,document.addEventListener("keydown",v);const S=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(C,p,g,m,D){!p.includes($i)&&!p.includes(Sm)?S.call(this,C,$i+"/corsproxy/"+p,g,m,D):S.call(this,C,p,g,m,D)}}),Di(()=>{document.removeEventListener("keydown",v),l.value&&l.value.destroy(),o.value&&o.value.close()}),Re(()=>t.params,()=>{t.params.twitchChannelName?(n.value=`https://api.ttv.lol/playlist/${t.params.twitchChannelName}.m3u8%3Fallow_source%3Dtrue`,y("_bypass_")):t.params.ytWatchId?(n.value=`https://youtube.com/watch?v=${t.params.ytWatchId}`,y()):t.params.twitchVodId&&(n.value=`https://twitch.tv/videos/${t.params.twitchVodId}`,y())},{deep:!0});const y=async S=>{n.value||(n.value="https://www.twitch.tv/videos/1590984204");let C=S==="_bypass_"?n.value:await fetch(`${$i}/twitch/getVodSource/${encodeURIComponent(n.value)}`).then(g=>g.text());const p=new Or({xhrSetup:g=>{g.setRequestHeader("x-donate-to","https://ttv.lol/donate")}});l.value=p,Or.isSupported()?(p.loadSource(C),p.attachMedia(c.value),p.on(Or.Events.ERROR,async(g,m)=>{console.log("Hls error"),console.log(g,m)}),p.on(Or.Events.MANIFEST_PARSED,()=>{c.value.play().catch(g=>{!c.value||(c.value.muted=!0,c.value.play())}),i.value=1})):c.value.canPlayType("application/vnd.apple.mpegurl")?(console.log("direct play"),c.value.src=C,c.value.addEventListener("canplay",()=>{c.value.play(),i.value=1})):console.log("device unable to play stream"),t.params.twitchChannelName?E(t.params.twitchChannelName):t.params.twitchVodId&&L()},E=S=>{o.value&&(o.value.close(),u.value.clearAllChat());const C="wss://irc-ws.chat.twitch.tv/",p=new WebSocket(C);o.value=p;const g=Math.floor(Math.random()*99999);p.onopen=()=>{p.send("CAP REQ :twitch.tv/tags twitch.tv/commands"),p.send("PASS SCHMOOPIIE"),p.send(`NICK justinfan${g}`),p.send(`USER justinfan${g} 8 * :justinfan${g}`),p.send(`JOIN #${S}`)},p.onmessage=u.value.handleNewMessage},L=async()=>{var m,D,b;const S=t.params.twitchVodId;if(!S)return;const C=Math.floor(c.value.currentTime),p=Xt(Kl(S,C,null)),g=await fetch(de,p).then(T=>T.json());console.log("joining vod twitch chat: ",g),a.value=(b=(D=(m=g==null?void 0:g.data)==null?void 0:m.video)==null?void 0:D.comments)==null?void 0:b.edges},_=S=>{var p,g;if(!t.params.twitchVodId)return;const C=a.value[a.value.length-1];if(((p=C==null?void 0:C.node)==null?void 0:p.contentOffsetSeconds)<c.value.currentTime+5){const m=t.params.twitchVodId,D=Xt(Kl(m,null,C.cursor));fetch(de,D).then(b=>b.json()).then(b=>{var T,P,M;return a.value.push(...(M=(P=(T=b==null?void 0:b.data)==null?void 0:T.video)==null?void 0:P.comments)==null?void 0:M.edges)})}for(let m=0;m<a.value.length;m++){const D=a.value[m];if(((g=D==null?void 0:D.node)==null?void 0:g.contentOffsetSeconds)<c.value.currentTime)u.value.handleNewVodMessage({user:D.node.commenter.displayName,fragments:D.node.message.fragments,badges:D.node.message.userBadges,color:D.node.message.userColor,offset:D.node.contentOffsetSeconds}),a.value.shift();else break}},A=S=>{!t.params.twitchVodId||L()},v=S=>{var p;if(((p=S.target)==null?void 0:p.className)=="query-input")return;const C=S.key;C=="j"?c.value.currentTime-=10:C=="l"?c.value.currentTime+=10:C=="k"&&(c.value.paused?c.value.play():c.value.pause())},f=S=>{r.value=!1},x=()=>{h.value=Object.assign({},jl)};return(S,C)=>(st(),ct("div",Q0,[ht(t).params.twitchChannelName||ht(t).params.twitchVodId?(st(),zt(Rf,{key:0})):Ot("",!0),G("div",Z0,[G("div",J0,[G("video",{ref_key:"video",ref:c,class:"video-player",controls:"",autoplay:"","webkit-playsinline":"",playsinline:"",type:"application/x-mpegURL"},null,512),ht(t).params.twitchChannelName?(st(),zt(Cp,{channel:ht(t).params.twitchChannelName,key:ht(t).params.twitchChannelName,onSettingsClick:C[0]||(C[0]=p=>r.value=!0),onLeaderboardClick:C[1]||(C[1]=p=>s.value=!0),onSetId:C[2]||(C[2]=p=>d.value=p)},null,8,["channel"])):ht(t).params.twitchVodId?(st(),zt(Wp,{vodId:ht(t).params.twitchVodId,key:ht(t).params.twitchVodId,onSettingsClick:C[3]||(C[3]=p=>r.value=!0),onLeaderboardClick:C[4]||(C[4]=p=>s.value=!0),onSetId:C[5]||(C[5]=p=>d.value=p)},null,8,["vodId"])):Ot("",!0)]),pt(Wm,{ref_key:"chatbox",ref:u,channel:ht(t).params.twitchChannelName,channelId:d.value,settings:h.value},null,8,["channel","channelId","settings"]),r.value?(st(),zt(N0,{key:0,settings:h.value,onSettingsUpdated:f,onResetSettings:x},null,8,["settings"])):s.value?(st(),zt(If,{key:1,channel:ht(t).params.twitchChannelName,onClosePage:C[6]||(C[6]=p=>s.value=!1)},null,8,["channel"])):Ot("",!0)])]))}},ty=Ut(q0,[["__scopeId","data-v-e4916fa1"]]);const ey=["onClick"],ny={class:"view-count"},iy={class:"mobile-bar-info"},ry={class:"rotation-wrapper-outer"},sy={class:"rotation-wrapper-inner"},ay=["height"],oy={class:"bar-tooltip"},ly={class:"tooltip-displayname"},cy=["src"],uy={__name:"LeaderboardChart",props:{liveChannelsList:Array,numShown:Number},setup(e){const t=e,n=me(),i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=Math.min(500,i-70),s=ot(null),a=ot([]),o=ot([]),l=async(u=0)=>{if(!(!a.value.length||u==20)){if(!o.value.length)return setTimeout(()=>l(u+1),250);for(const h of o.value.reverse()){const d=h.getAttribute("height");h.style.height=`${d}px`,await new Promise(y=>setTimeout(y,75))}}};Re(()=>t.liveChannelsList,()=>{console.log(t.liveChannelsList,t.numShown),t.liveChannelsList.length&&(s.value=t.liveChannelsList[0].node.viewersCount,a.value=t.liveChannelsList.slice(0,t.numShown).map(u=>({viewersCount:u.node.viewersCount,title:u.node.title,profileImage:u.node.broadcaster.profileImageURL,channelLogin:u.node.broadcaster.login,displayName:u.node.broadcaster.displayName,length:u.node.viewersCount/s.value*r})),l())},{immediate:!0});const c=u=>{console.log(u);for(let h=0;h<o.value.length;h++){const d=o.value[h].getBoundingClientRect();if(console.log(d,a.value[h].channelLogin),u.y>d.y&&u.y<d.y+d.height&&u.x>d.x&&u.x<d.x+d.width)return n.push(`/hls/twitch/${a.value[a.value.length-h-1].channelLogin}`)}};return(u,h)=>(st(),ct("div",{class:"channels-container",onClick:c},[(st(!0),ct(Rt,null,Ie(a.value,d=>(st(),ct("div",{class:"channel-each",onClick:y=>ht(n).push(`/hls/twitch/${d.channelLogin}`)},[G("div",ny,[Se(mt(ht(Ce)(d.viewersCount))+"\xA0 ",1),G("span",iy,mt(d.displayName),1)]),G("div",ry,[G("div",sy,[G("div",{class:"bar-each",ref_for:!0,ref_key:"barElements",ref:o,height:d.length},[G("div",oy,[G("div",ly,mt(d.displayName),1),Se(" "+mt(d.title),1)])],8,ay)])]),G("img",{class:"profile-image",src:d.profileImage},null,8,cy)],8,ey))),256))]))}},fy=Ut(uy,[["__scopeId","data-v-b8e15dd1"]]);const dy=["onClick"],hy={class:"view-count"},gy={class:"mobile-bar-info"},vy={class:"rotation-wrapper-outer"},my={class:"rotation-wrapper-inner"},py=["height"],yy={class:"bar-tooltip"},Ey={class:"tooltip-displayname"},xy=["src"],by={__name:"DirectoryLeaderboardChart",props:{curDirectoryList:Array,numShown:Number},setup(e){const t=e,n=me(),i=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,r=Math.min(500,i-70),s=ot(null),a=ot([]),o=ot([]),l=async(u=0)=>{if(!(!a.value.length||u==20)){if(!o.value.length)return setTimeout(()=>l(u+1),250);for(const h of o.value.reverse()){const d=h.getAttribute("height");h.style.height=`${d}px`,await new Promise(y=>setTimeout(y,75))}}};Re(()=>t.curDirectoryList,()=>{console.log(t.curDirectoryList),t.curDirectoryList.length&&(s.value=t.curDirectoryList[0].node.viewersCount,a.value=t.curDirectoryList.slice(0,t.numShown).map(u=>({viewersCount:u.node.viewersCount,title:u.node.name,directoryImage:u.node.avatarURL,length:u.node.viewersCount/s.value*r})),l())},{immediate:!0});const c=u=>{console.log(u);for(let h=0;h<o.value.length;h++){const d=o.value[h].getBoundingClientRect();if(console.log(d,a.value[h].title),u.y>d.y&&u.y<d.y+d.height&&u.x>d.x&&u.x<d.x+d.width)return n.push(`twitch/directory-search-${a.value[a.value.length-h-1].title}`)}};return(u,h)=>(st(),ct("div",{class:"channels-container",onClick:c},[(st(!0),ct(Rt,null,Ie(a.value,d=>(st(),ct("div",{class:"channel-each",onClick:y=>ht(n).push(`/twitch/directory-search-${d.title}`)},[G("div",hy,[Se(mt(ht(Ce)(d.viewersCount))+"\xA0 ",1),G("span",gy,mt(d.title),1)]),G("div",vy,[G("div",my,[G("div",{class:"bar-each",ref_for:!0,ref_key:"barElements",ref:o,height:d.length},[G("div",yy,[G("div",Ey,mt(d.title),1)])],8,py)])]),G("img",{class:"profile-image",src:d.directoryImage},null,8,xy)],8,dy))),256))]))}},Ty=Ut(by,[["__scopeId","data-v-55941406"]]);const _y={class:"home-view"},Sy={class:"route-buttons"},Ly={class:"route-buttons all-bottom"},Dy=Se("contact"),Ay={__name:"HomeView",setup(e){const t="https://gql.twitch.tv/gql",n=me(),i=ot([]),r=ot([]),s=ot(!0),a=ot(10);return ve(async()=>{var h,d;const o=Xt(Df()),l=await fetch(t,o).then(y=>y.json());i.value=l.data.streams.edges,console.log(i.value);const c=Xt(Om()),u=await fetch(t,c).then(y=>y.json());r.value=(d=(h=u==null?void 0:u.data)==null?void 0:h.directoriesWithTags)==null?void 0:d.edges,console.log(u)}),(o,l)=>{const c=ig("RouterLink");return st(),ct(Rt,null,[pt(Rf),G("div",_y,[G("div",Sy,[G("button",{onClick:l[0]||(l[0]=u=>s.value=!0),class:"change-leaderboard-type",style:Ge(s.value&&"color: #a970ff;")}," Channels ",4),G("button",{onClick:l[1]||(l[1]=u=>s.value=!1),class:"change-leaderboard-type",style:Ge(!s.value&&"color: #a970ff;")}," Categories ",4)]),s.value?(st(),zt(fy,{key:0,liveChannelsList:i.value,numShown:a.value},null,8,["liveChannelsList","numShown"])):(st(),zt(Ty,{key:1,curDirectoryList:r.value,numShown:a.value},null,8,["curDirectoryList","numShown"])),G("div",Ly,[G("button",{onClick:l[2]||(l[2]=u=>ht(n).push("/twitch")),class:"twitch-route"}," All Channels ")]),pt(c,{to:"/contact",class:"contact"},{default:Sn(()=>[Dy]),_:1})])],64)}}},wf="/assets/live-stream-thumbnail.09efb82b.png";const Cy=e=>(cn("data-v-68d2a889"),e=e(),un(),e),Oy={class:"live-channel-each"},My={class:"thumbnail-holder"},Py=["src"],Ry=["src"],Iy={key:2,class:"live-message-holder"},wy=Cy(()=>G("div",{class:"live-message"}," LIVE ",-1)),ky=[wy],Fy={class:"viewer-count-holder"},By={class:"viewer-count"},Ny={key:3,class:"vod-length"},Uy={key:4,class:"vod-upload"},Wy={class:"channel-lower-info"},Ky=["src"],Hy={class:"channel-info-container"},jy={__name:"StreamCard",props:{thumbnail:String,title:String,viewCount:String,channelLogo:String,channelName:String,route:String,byRoute:{type:String,default:""},live:{type:Boolean,default:!0},vodLength:{type:String,default:""},vodUploadTimeAgo:{type:String,default:""}},setup(e){const t=e,n=me();return(i,r)=>(st(),ct("div",Oy,[G("div",My,[t.thumbnail!=="https://vod-secure.twitch.tv/_404/404_processing_320x180.png"?(st(),ct("img",{key:0,class:"channel-thumbnail",src:t.thumbnail,onClick:r[0]||(r[0]=s=>ht(n).push(t.route))},null,8,Py)):(st(),ct("img",{key:1,class:"channel-thumbnail",src:ht(wf),onClick:r[1]||(r[1]=s=>ht(n).push(t.route))},null,8,Ry)),t.live?(st(),ct("div",Iy,ky)):Ot("",!0),G("div",Fy,[G("div",By,mt(t.viewCount||"0 watching"),1)]),t.vodLength?(st(),ct("div",Ny,mt(t.vodLength),1)):Ot("",!0),t.vodUploadTimeAgo?(st(),ct("div",Uy,mt(t.vodUploadTimeAgo),1)):Ot("",!0)]),G("div",Wy,[G("img",{class:"channel-logo",src:t.channelLogo,onClick:r[2]||(r[2]=s=>ht(n).push(t.route))},null,8,Ky),G("div",Hy,[G("div",{class:"channel-title",onClick:r[3]||(r[3]=s=>ht(n).push(t.route))},mt(t.title),1),G("div",{class:"channel-by",onClick:r[4]||(r[4]=s=>ht(n).push(t.byRoute||t.route))},mt(t.channelName),1)])])]))}},Yr=Ut(jy,[["__scopeId","data-v-68d2a889"]]);const Vy={},$y={class:"placeholder-empty-card"};function Gy(e,t){return st(),ct("div",$y)}const kf=Ut(Vy,[["render",Gy],["__scopeId","data-v-9eca3e80"]]);const zy={},Yy={class:"container"},Xy=qu('<div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div><div class="block" data-v-b86efe59></div>',16),Qy=[Xy];function Zy(e,t){return st(),ct("div",Yy,Qy)}const yo=Ut(zy,[["render",Zy],["__scopeId","data-v-b86efe59"]]),Jy={},qy={width:"100%",height:"100%",version:"1.1",viewBox:"0 0 20 20",x:"0px",y:"0px",class:"cancel-icon"},tE=G("g",null,[G("path",{d:"M8.5 10L4 5.5 5.5 4 10 8.5 14.5 4 16 5.5 11.5 10l4.5 4.5-1.5 1.5-4.5-4.5L5.5 16 4 14.5 8.5 10z"})],-1),eE=[tE];function nE(e,t){return st(),ct("svg",qy,eE)}const iE=Ut(Jy,[["render",nE]]);const rE={class:"search-space"},sE={key:0,class:"card-message"},aE={key:1,class:"channel-options-row"},oE={class:"live-channels-container"},lE={key:3,class:"card-message"},cE={__name:"TwitchView",setup(e){const t=me(),n=pr(),i=ot([]),r=ot(""),s=ot(!0),a=ot(!1),o=ot(null),l=ot(!1),c=ot(!1);ve(()=>{window.addEventListener("scroll",E)}),Di(()=>{window.removeEventListener("scroll",E)});const u=async(L=null)=>{if(a.value)return;s.value=!0;let _=null;L&&L.startsWith("directory-search-")?_=Xt(Cm(L.split("directory-search-")[1])):L?_=Xt(Cf(L,r.value)):_=Xt(Df(r.value));const A=await fetch(de,_).then(v=>v.json());console.log(A),L&&L.startsWith("directory-search-")?i.value.push(...A.data.game.streams.edges):L?i.value.push(...A.data.user.videos.edges):i.value.push(...A.data.streams.edges),i.value.length?r.value=i.value[i.value.length-1].cursor:a.value=!0,r.value==null&&(a.value=!0),console.log(i.value),s.value=!1},h=async L=>{const _=Xt(Af(L)),v=(await fetch(de,_).then(f=>f.json())).data.searchSuggestions.edges.map(f=>f.node);return console.log(v),v.filter(f=>f.content)},d=async L=>{var f,x,S,C,p,g,m,D,b,T;if(console.log(L),!L)return;const _=[Of(L),Mf(L)],A=Xt(_),v=await fetch(de,A).then(P=>P.json());!((x=(f=v[0].data)==null?void 0:f.userOrError)!=null&&x.stream)||(o.value={viewers:(p=(C=(S=v[0].data)==null?void 0:S.userOrError)==null?void 0:C.stream)==null?void 0:p.viewersCount,title:(D=(m=(g=v[1].data)==null?void 0:g.user)==null?void 0:m.broadcastSettings)==null?void 0:D.title,pfp:(T=(b=v[0].data)==null?void 0:b.userOrError)==null?void 0:T.profileImageURL,login:L})};Re(()=>{var L;return(L=n.params)==null?void 0:L.twitchChannelName},async(L,_)=>{var A;console.log("channel: ",L,(A=n.params)==null?void 0:A.twitchChannelName),i.value=[],r.value="",a.value=!1,o.value=null,l.value=!n.params.twitchChannelName||n.params.twitchChannelName.startsWith("directory-search-"),u(L),d(L)},{immediate:!0});const y=L=>{var x,S,C;console.log(L);const _=(x=L==null?void 0:L.content)==null?void 0:x.login,A=(S=L==null?void 0:L.content)==null?void 0:S.isLive,v=(C=L==null?void 0:L.content)==null?void 0:C.boxArtURL,f=L==null?void 0:L.text;_&&A?t.push(`/hls/twitch/${_}`):_&&!A?t.push(`/twitch/${_}`):v&&f?t.push(`/twitch/directory-search-${f}`):console.log("normal query search, wip")},E=()=>{var v;const L=document.height||document.body.offsetHeight,_=window.scrollY+(window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight);L-_<500&&!s.value&&u((v=n.params)==null?void 0:v.twitchChannelName)};return(L,_)=>{var A;return st(),ct(Rt,null,[G("div",rE,[pt(mo,{"get-query-suggestions":h,onQueryClick:y})]),s.value?(st(),ct("div",sE,[pt(yo)])):l.value?(A=ht(n).params)!=null&&A.twitchChannelName?(st(),ct("div",{key:2,class:"category-display",onClick:_[3]||(_[3]=v=>ht(t).push("/twitch"))},[Se(" Category: "+mt(ht(n).params.twitchChannelName.split("directory-search-")[1])+" ",1),pt(iE,{class:"icon-cancel"})])):Ot("",!0):(st(),ct("div",aE,[pt(vo,{onClick:_[0]||(_[0]=v=>c.value=!0),class:"analyze-icon"}),G("div",{class:"analyze-option",onClick:_[1]||(_[1]=v=>ht(t).push(`/twitch/${ht(n).params.twitchChannelName}/analyze`))}," Analyze Vods "),G("div",{class:"analyze-option",onClick:_[2]||(_[2]=v=>ht(t).push(`/twitch/${ht(n).params.twitchChannelName}/clips`))}," Top Clips ")])),G("div",oE,[l.value?(st(!0),ct(Rt,{key:0},Ie(i.value,v=>{var f,x;return st(),zt(Yr,{key:v.cursor,thumbnail:v.node.previewImageURL,title:v.node.title,"view-count":ht(Ce)(v.node.viewersCount)+" watching","channel-logo":(f=v.node.broadcaster)==null?void 0:f.profileImageURL,"channel-name":(x=v.node.broadcaster)==null?void 0:x.displayName,route:`/hls/twitch/${v.node.broadcaster.login}`,"by-route":`/twitch/${v.node.broadcaster.login}`},null,8,["thumbnail","title","view-count","channel-logo","channel-name","route","by-route"])}),128)):o.value?(st(),zt(Yr,{key:o.value.login,thumbnail:ht(wf),title:o.value.title,"view-count":ht(Ce)(o.value.viewers)+" watching","channel-logo":o.value.pfp,"channel-name":o.value.login,route:`/hls/twitch/${o.value.login}`,"by-route":`/hls/twitch/${o.value.login}`},null,8,["thumbnail","title","view-count","channel-logo","channel-name","route","by-route"])):Ot("",!0),l.value?Ot("",!0):(st(!0),ct(Rt,{key:2},Ie(i.value,v=>{var f,x;return st(),zt(Yr,{key:v.node.id,thumbnail:v.node.previewThumbnailURL,title:v.node.title,"view-count":ht(Ce)(v.node.viewCount)+" views","channel-logo":(f=v.node.owner)==null?void 0:f.profileImageURL,"channel-name":(x=v.node.owner)==null?void 0:x.displayName,route:`/hls/twitchvod/${v.node.id}`,live:!1,"vod-length":ht(fo)(v.node.lengthSeconds),"vod-upload-time-ago":ht(ho)(v.node.publishedAt)},null,8,["thumbnail","title","view-count","channel-logo","channel-name","route","vod-length","vod-upload-time-ago"])}),128)),(st(),ct(Rt,null,Ie(5,v=>pt(kf,{key:v})),64))]),a.value?(st(),ct("div",lE," No more results found ")):Ot("",!0),c.value?(st(),zt(If,{key:4,channel:ht(n).params.twitchChannelName,onClosePage:_[4]||(_[4]=v=>c.value=!1)},null,8,["channel"])):Ot("",!0)],64)}}},uE=e=>({headers:{"Content-Type":"application/json"},body:JSON.stringify(e),method:"POST"}),fE="https://www.youtube.com/youtubei/v1/search?key=AIzaSyAO_FJ2SlqU8Q4STEHLGCilw_Y9_11qcW8&prettyPrint=false",dE=e=>`https://suggestqueries-clients6.youtube.com/complete/search?client=youtube&q=${e}`,hE=e=>({context:{client:{hl:"en",gl:"US",clientName:"ANDROID",clientVersion:"16.02"}},query:e,params:"CAMSAkAB"});const gE={class:"live-channels-container"},vE={key:0,class:"no-results"},mE={__name:"YoutubeLiveView",setup(e){me();const t=ot([]),n=async a=>{console.log(a);const o=uE(hE(a)),l=await fetch(Ca(fE),o).then(u=>u.json()),c=[];for(const u of l.contents.sectionListRenderer.contents)for(const h of u.itemSectionRenderer.contents)h.compactVideoRenderer&&c.push(h.compactVideoRenderer);t.value=c,console.log(t.value)};ve(n);const i=async a=>{const o=Ca(dE(a)),l=await fetch(o).then(u=>u.text()),c=JSON.parse(l.split("window.google.ac.h(")[1].slice(0,-1))[1].map(u=>({text:u[0]}));return console.log(c),c},r=a=>a[1]||a[0],s=a=>a?a.map(o=>o.text).join(""):"";return(a,o)=>(st(),ct(Rt,null,[pt(mo,{"get-query-suggestions":i,onQueryClick:n}),G("div",gE,[(st(!0),ct(Rt,null,Ie(t.value,l=>{var c,u;return st(),zt(Yr,{key:l.videoId,thumbnail:(c=r(l.thumbnail.thumbnails))==null?void 0:c.url,title:s(l.title.runs),"view-count":s((u=l.shortViewCountText)==null?void 0:u.runs)||"0 watching","channel-logo":l.channelThumbnail.thumbnails[0].url,"channel-name":s(l.longBylineText.runs),route:`/hls/yt/${l.videoId}`},null,8,["thumbnail","title","view-count","channel-logo","channel-name","route"])}),128)),(st(),ct(Rt,null,Ie(5,l=>pt(kf,{key:l})),64)),t.value.length?Ot("",!0):(st(),ct("div",vE," No results "))])],64))}},pE=Ut(mE,[["__scopeId","data-v-135ed4c7"]]);/*!
 * Chart.js v3.9.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */function qe(){}const yE=function(){let e=0;return function(){return e++}}();function At(e){return e===null||typeof e>"u"}function Nt(e){if(Array.isArray&&Array.isArray(e))return!0;const t=Object.prototype.toString.call(e);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function _t(e){return e!==null&&Object.prototype.toString.call(e)==="[object Object]"}const $t=e=>(typeof e=="number"||e instanceof Number)&&isFinite(+e);function Ee(e,t){return $t(e)?e:t}function xt(e,t){return typeof e>"u"?t:e}const EE=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100:e/t,Ff=(e,t)=>typeof e=="string"&&e.endsWith("%")?parseFloat(e)/100*t:+e;function Bt(e,t,n){if(e&&typeof e.call=="function")return e.apply(n,t)}function Pt(e,t,n,i){let r,s,a;if(Nt(e))if(s=e.length,i)for(r=s-1;r>=0;r--)t.call(n,e[r],r);else for(r=0;r<s;r++)t.call(n,e[r],r);else if(_t(e))for(a=Object.keys(e),s=a.length,r=0;r<s;r++)t.call(n,e[a[r]],a[r])}function is(e,t){let n,i,r,s;if(!e||!t||e.length!==t.length)return!1;for(n=0,i=e.length;n<i;++n)if(r=e[n],s=t[n],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function rs(e){if(Nt(e))return e.map(rs);if(_t(e)){const t=Object.create(null),n=Object.keys(e),i=n.length;let r=0;for(;r<i;++r)t[n[r]]=rs(e[n[r]]);return t}return e}function Bf(e){return["__proto__","prototype","constructor"].indexOf(e)===-1}function xE(e,t,n,i){if(!Bf(e))return;const r=t[e],s=n[e];_t(r)&&_t(s)?cr(r,s,i):t[e]=rs(s)}function cr(e,t,n){const i=Nt(t)?t:[t],r=i.length;if(!_t(e))return e;n=n||{};const s=n.merger||xE;for(let a=0;a<r;++a){if(t=i[a],!_t(t))continue;const o=Object.keys(t);for(let l=0,c=o.length;l<c;++l)s(o[l],e,t,n)}return e}function Gi(e,t){return cr(e,t,{merger:bE})}function bE(e,t,n){if(!Bf(e))return;const i=t[e],r=n[e];_t(i)&&_t(r)?Gi(i,r):Object.prototype.hasOwnProperty.call(t,e)||(t[e]=rs(r))}const $l={"":e=>e,x:e=>e.x,y:e=>e.y};function Cn(e,t){return($l[t]||($l[t]=TE(t)))(e)}function TE(e){const t=_E(e);return n=>{for(const i of t){if(i==="")break;n=n&&n[i]}return n}}function _E(e){const t=e.split("."),n=[];let i="";for(const r of t)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(n.push(i),i="");return n}function Eo(e){return e.charAt(0).toUpperCase()+e.slice(1)}const Le=e=>typeof e<"u",On=e=>typeof e=="function",Gl=(e,t)=>{if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0};function SE(e){return e.type==="mouseup"||e.type==="click"||e.type==="contextmenu"}const Kt=Math.PI,wt=2*Kt,LE=wt+Kt,ss=Number.POSITIVE_INFINITY,DE=Kt/180,Vt=Kt/2,Ri=Kt/4,zl=Kt*2/3,be=Math.log10,Ye=Math.sign;function Yl(e){const t=Math.round(e);e=zi(e,t,e/1e3)?t:e;const n=Math.pow(10,Math.floor(be(e))),i=e/n;return(i<=1?1:i<=2?2:i<=5?5:10)*n}function AE(e){const t=[],n=Math.sqrt(e);let i;for(i=1;i<n;i++)e%i===0&&(t.push(i),t.push(e/i));return n===(n|0)&&t.push(n),t.sort((r,s)=>r-s).pop(),t}function xi(e){return!isNaN(parseFloat(e))&&isFinite(e)}function zi(e,t,n){return Math.abs(e-t)<n}function CE(e,t){const n=Math.round(e);return n-t<=e&&n+t>=e}function Nf(e,t,n){let i,r,s;for(i=0,r=e.length;i<r;i++)s=e[i][n],isNaN(s)||(t.min=Math.min(t.min,s),t.max=Math.max(t.max,s))}function Me(e){return e*(Kt/180)}function xo(e){return e*(180/Kt)}function Xl(e){if(!$t(e))return;let t=1,n=0;for(;Math.round(e*t)/t!==e;)t*=10,n++;return n}function Uf(e,t){const n=t.x-e.x,i=t.y-e.y,r=Math.sqrt(n*n+i*i);let s=Math.atan2(i,n);return s<-.5*Kt&&(s+=wt),{angle:s,distance:r}}function Oa(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function OE(e,t){return(e-t+LE)%wt-Kt}function he(e){return(e%wt+wt)%wt}function ur(e,t,n,i){const r=he(e),s=he(t),a=he(n),o=he(s-r),l=he(a-r),c=he(r-s),u=he(r-a);return r===s||r===a||i&&s===a||o>l&&c<u}function Qt(e,t,n){return Math.max(t,Math.min(n,e))}function ME(e){return Qt(e,-32768,32767)}function an(e,t,n,i=1e-6){return e>=Math.min(t,n)-i&&e<=Math.max(t,n)+i}function bo(e,t,n){n=n||(a=>e[a]<t);let i=e.length-1,r=0,s;for(;i-r>1;)s=r+i>>1,n(s)?r=s:i=s;return{lo:r,hi:i}}const on=(e,t,n,i)=>bo(e,n,i?r=>e[r][t]<=n:r=>e[r][t]<n),PE=(e,t,n)=>bo(e,n,i=>e[i][t]>=n);function RE(e,t,n){let i=0,r=e.length;for(;i<r&&e[i]<t;)i++;for(;r>i&&e[r-1]>n;)r--;return i>0||r<e.length?e.slice(i,r):e}const Wf=["push","pop","shift","splice","unshift"];function IE(e,t){if(e._chartjs){e._chartjs.listeners.push(t);return}Object.defineProperty(e,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),Wf.forEach(n=>{const i="_onData"+Eo(n),r=e[n];Object.defineProperty(e,n,{configurable:!0,enumerable:!1,value(...s){const a=r.apply(this,s);return e._chartjs.listeners.forEach(o=>{typeof o[i]=="function"&&o[i](...s)}),a}})})}function Ql(e,t){const n=e._chartjs;if(!n)return;const i=n.listeners,r=i.indexOf(t);r!==-1&&i.splice(r,1),!(i.length>0)&&(Wf.forEach(s=>{delete e[s]}),delete e._chartjs)}function Kf(e){const t=new Set;let n,i;for(n=0,i=e.length;n<i;++n)t.add(e[n]);return t.size===i?e:Array.from(t)}const Hf=function(){return typeof window>"u"?function(e){return e()}:window.requestAnimationFrame}();function jf(e,t,n){const i=n||(a=>Array.prototype.slice.call(a));let r=!1,s=[];return function(...a){s=i(a),r||(r=!0,Hf.call(window,()=>{r=!1,e.apply(t,s)}))}}function wE(e,t){let n;return function(...i){return t?(clearTimeout(n),n=setTimeout(e,t,i)):e.apply(this,i),t}}const To=e=>e==="start"?"left":e==="end"?"right":"center",ne=(e,t,n)=>e==="start"?t:e==="end"?n:(t+n)/2,kE=(e,t,n,i)=>e===(i?"left":"right")?n:e==="center"?(t+n)/2:t;function Vf(e,t,n){const i=t.length;let r=0,s=i;if(e._sorted){const{iScale:a,_parsed:o}=e,l=a.axis,{min:c,max:u,minDefined:h,maxDefined:d}=a.getUserBounds();h&&(r=Qt(Math.min(on(o,a.axis,c).lo,n?i:on(t,l,a.getPixelForValue(c)).lo),0,i-1)),d?s=Qt(Math.max(on(o,a.axis,u,!0).hi+1,n?0:on(t,l,a.getPixelForValue(u),!0).hi+1),r,i)-r:s=i-r}return{start:r,count:s}}function $f(e){const{xScale:t,yScale:n,_scaleRanges:i}=e,r={xmin:t.min,xmax:t.max,ymin:n.min,ymax:n.max};if(!i)return e._scaleRanges=r,!0;const s=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==n.min||i.ymax!==n.max;return Object.assign(i,r),s}const Mr=e=>e===0||e===1,Zl=(e,t,n)=>-(Math.pow(2,10*(e-=1))*Math.sin((e-t)*wt/n)),Jl=(e,t,n)=>Math.pow(2,-10*e)*Math.sin((e-t)*wt/n)+1,Yi={linear:e=>e,easeInQuad:e=>e*e,easeOutQuad:e=>-e*(e-2),easeInOutQuad:e=>(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1),easeInCubic:e=>e*e*e,easeOutCubic:e=>(e-=1)*e*e+1,easeInOutCubic:e=>(e/=.5)<1?.5*e*e*e:.5*((e-=2)*e*e+2),easeInQuart:e=>e*e*e*e,easeOutQuart:e=>-((e-=1)*e*e*e-1),easeInOutQuart:e=>(e/=.5)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2),easeInQuint:e=>e*e*e*e*e,easeOutQuint:e=>(e-=1)*e*e*e*e+1,easeInOutQuint:e=>(e/=.5)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2),easeInSine:e=>-Math.cos(e*Vt)+1,easeOutSine:e=>Math.sin(e*Vt),easeInOutSine:e=>-.5*(Math.cos(Kt*e)-1),easeInExpo:e=>e===0?0:Math.pow(2,10*(e-1)),easeOutExpo:e=>e===1?1:-Math.pow(2,-10*e)+1,easeInOutExpo:e=>Mr(e)?e:e<.5?.5*Math.pow(2,10*(e*2-1)):.5*(-Math.pow(2,-10*(e*2-1))+2),easeInCirc:e=>e>=1?e:-(Math.sqrt(1-e*e)-1),easeOutCirc:e=>Math.sqrt(1-(e-=1)*e),easeInOutCirc:e=>(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1),easeInElastic:e=>Mr(e)?e:Zl(e,.075,.3),easeOutElastic:e=>Mr(e)?e:Jl(e,.075,.3),easeInOutElastic(e){return Mr(e)?e:e<.5?.5*Zl(e*2,.1125,.45):.5+.5*Jl(e*2-1,.1125,.45)},easeInBack(e){return e*e*((1.70158+1)*e-1.70158)},easeOutBack(e){return(e-=1)*e*((1.70158+1)*e+1.70158)+1},easeInOutBack(e){let t=1.70158;return(e/=.5)<1?.5*(e*e*(((t*=1.525)+1)*e-t)):.5*((e-=2)*e*(((t*=1.525)+1)*e+t)+2)},easeInBounce:e=>1-Yi.easeOutBounce(1-e),easeOutBounce(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},easeInOutBounce:e=>e<.5?Yi.easeInBounce(e*2)*.5:Yi.easeOutBounce(e*2-1)*.5+.5};/*!
 * @kurkle/color v0.2.1
 * https://github.com/kurkle/color#readme
 * (c) 2022 Jukka Kurkela
 * Released under the MIT License
 */function yr(e){return e+.5|0}const xn=(e,t,n)=>Math.max(Math.min(e,n),t);function Ui(e){return xn(yr(e*2.55),0,255)}function Ln(e){return xn(yr(e*255),0,255)}function sn(e){return xn(yr(e/2.55)/100,0,1)}function ql(e){return xn(yr(e*100),0,100)}const ye={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Ma=[..."0123456789ABCDEF"],FE=e=>Ma[e&15],BE=e=>Ma[(e&240)>>4]+Ma[e&15],Pr=e=>(e&240)>>4===(e&15),NE=e=>Pr(e.r)&&Pr(e.g)&&Pr(e.b)&&Pr(e.a);function UE(e){var t=e.length,n;return e[0]==="#"&&(t===4||t===5?n={r:255&ye[e[1]]*17,g:255&ye[e[2]]*17,b:255&ye[e[3]]*17,a:t===5?ye[e[4]]*17:255}:(t===7||t===9)&&(n={r:ye[e[1]]<<4|ye[e[2]],g:ye[e[3]]<<4|ye[e[4]],b:ye[e[5]]<<4|ye[e[6]],a:t===9?ye[e[7]]<<4|ye[e[8]]:255})),n}const WE=(e,t)=>e<255?t(e):"";function KE(e){var t=NE(e)?FE:BE;return e?"#"+t(e.r)+t(e.g)+t(e.b)+WE(e.a,t):void 0}const HE=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Gf(e,t,n){const i=t*Math.min(n,1-n),r=(s,a=(s+e/30)%12)=>n-i*Math.max(Math.min(a-3,9-a,1),-1);return[r(0),r(8),r(4)]}function jE(e,t,n){const i=(r,s=(r+e/60)%6)=>n-n*t*Math.max(Math.min(s,4-s,1),0);return[i(5),i(3),i(1)]}function VE(e,t,n){const i=Gf(e,1,.5);let r;for(t+n>1&&(r=1/(t+n),t*=r,n*=r),r=0;r<3;r++)i[r]*=1-t-n,i[r]+=t;return i}function $E(e,t,n,i,r){return e===r?(t-n)/i+(t<n?6:0):t===r?(n-e)/i+2:(e-t)/i+4}function _o(e){const n=e.r/255,i=e.g/255,r=e.b/255,s=Math.max(n,i,r),a=Math.min(n,i,r),o=(s+a)/2;let l,c,u;return s!==a&&(u=s-a,c=o>.5?u/(2-s-a):u/(s+a),l=$E(n,i,r,u,s),l=l*60+.5),[l|0,c||0,o]}function So(e,t,n,i){return(Array.isArray(t)?e(t[0],t[1],t[2]):e(t,n,i)).map(Ln)}function Lo(e,t,n){return So(Gf,e,t,n)}function GE(e,t,n){return So(VE,e,t,n)}function zE(e,t,n){return So(jE,e,t,n)}function zf(e){return(e%360+360)%360}function YE(e){const t=HE.exec(e);let n=255,i;if(!t)return;t[5]!==i&&(n=t[6]?Ui(+t[5]):Ln(+t[5]));const r=zf(+t[2]),s=+t[3]/100,a=+t[4]/100;return t[1]==="hwb"?i=GE(r,s,a):t[1]==="hsv"?i=zE(r,s,a):i=Lo(r,s,a),{r:i[0],g:i[1],b:i[2],a:n}}function XE(e,t){var n=_o(e);n[0]=zf(n[0]+t),n=Lo(n),e.r=n[0],e.g=n[1],e.b=n[2]}function QE(e){if(!e)return;const t=_o(e),n=t[0],i=ql(t[1]),r=ql(t[2]);return e.a<255?`hsla(${n}, ${i}%, ${r}%, ${sn(e.a)})`:`hsl(${n}, ${i}%, ${r}%)`}const tc={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},ec={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function ZE(){const e={},t=Object.keys(ec),n=Object.keys(tc);let i,r,s,a,o;for(i=0;i<t.length;i++){for(a=o=t[i],r=0;r<n.length;r++)s=n[r],o=o.replace(s,tc[s]);s=parseInt(ec[a],16),e[o]=[s>>16&255,s>>8&255,s&255]}return e}let Rr;function JE(e){Rr||(Rr=ZE(),Rr.transparent=[0,0,0,0]);const t=Rr[e.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}const qE=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function tx(e){const t=qE.exec(e);let n=255,i,r,s;if(!!t){if(t[7]!==i){const a=+t[7];n=t[8]?Ui(a):xn(a*255,0,255)}return i=+t[1],r=+t[3],s=+t[5],i=255&(t[2]?Ui(i):xn(i,0,255)),r=255&(t[4]?Ui(r):xn(r,0,255)),s=255&(t[6]?Ui(s):xn(s,0,255)),{r:i,g:r,b:s,a:n}}}function ex(e){return e&&(e.a<255?`rgba(${e.r}, ${e.g}, ${e.b}, ${sn(e.a)})`:`rgb(${e.r}, ${e.g}, ${e.b})`)}const qs=e=>e<=.0031308?e*12.92:Math.pow(e,1/2.4)*1.055-.055,si=e=>e<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4);function nx(e,t,n){const i=si(sn(e.r)),r=si(sn(e.g)),s=si(sn(e.b));return{r:Ln(qs(i+n*(si(sn(t.r))-i))),g:Ln(qs(r+n*(si(sn(t.g))-r))),b:Ln(qs(s+n*(si(sn(t.b))-s))),a:e.a+n*(t.a-e.a)}}function Ir(e,t,n){if(e){let i=_o(e);i[t]=Math.max(0,Math.min(i[t]+i[t]*n,t===0?360:1)),i=Lo(i),e.r=i[0],e.g=i[1],e.b=i[2]}}function Yf(e,t){return e&&Object.assign(t||{},e)}function nc(e){var t={r:0,g:0,b:0,a:255};return Array.isArray(e)?e.length>=3&&(t={r:e[0],g:e[1],b:e[2],a:255},e.length>3&&(t.a=Ln(e[3]))):(t=Yf(e,{r:0,g:0,b:0,a:1}),t.a=Ln(t.a)),t}function ix(e){return e.charAt(0)==="r"?tx(e):YE(e)}class as{constructor(t){if(t instanceof as)return t;const n=typeof t;let i;n==="object"?i=nc(t):n==="string"&&(i=UE(t)||JE(t)||ix(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=Yf(this._rgb);return t&&(t.a=sn(t.a)),t}set rgb(t){this._rgb=nc(t)}rgbString(){return this._valid?ex(this._rgb):void 0}hexString(){return this._valid?KE(this._rgb):void 0}hslString(){return this._valid?QE(this._rgb):void 0}mix(t,n){if(t){const i=this.rgb,r=t.rgb;let s;const a=n===s?.5:n,o=2*a-1,l=i.a-r.a,c=((o*l===-1?o:(o+l)/(1+o*l))+1)/2;s=1-c,i.r=255&c*i.r+s*r.r+.5,i.g=255&c*i.g+s*r.g+.5,i.b=255&c*i.b+s*r.b+.5,i.a=a*i.a+(1-a)*r.a,this.rgb=i}return this}interpolate(t,n){return t&&(this._rgb=nx(this._rgb,t._rgb,n)),this}clone(){return new as(this.rgb)}alpha(t){return this._rgb.a=Ln(t),this}clearer(t){const n=this._rgb;return n.a*=1-t,this}greyscale(){const t=this._rgb,n=yr(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=n,this}opaquer(t){const n=this._rgb;return n.a*=1+t,this}negate(){const t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return Ir(this._rgb,2,t),this}darken(t){return Ir(this._rgb,2,-t),this}saturate(t){return Ir(this._rgb,1,t),this}desaturate(t){return Ir(this._rgb,1,-t),this}rotate(t){return XE(this._rgb,t),this}}function Xf(e){return new as(e)}function Qf(e){if(e&&typeof e=="object"){const t=e.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function ic(e){return Qf(e)?e:Xf(e)}function ta(e){return Qf(e)?e:Xf(e).saturate(.5).darken(.1).hexString()}const Jn=Object.create(null),Pa=Object.create(null);function Xi(e,t){if(!t)return e;const n=t.split(".");for(let i=0,r=n.length;i<r;++i){const s=n[i];e=e[s]||(e[s]=Object.create(null))}return e}function ea(e,t,n){return typeof t=="string"?cr(Xi(e,t),n):cr(Xi(e,""),t)}class rx{constructor(t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,i)=>ta(i.backgroundColor),this.hoverBorderColor=(n,i)=>ta(i.borderColor),this.hoverColor=(n,i)=>ta(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t)}set(t,n){return ea(this,t,n)}get(t){return Xi(this,t)}describe(t,n){return ea(Pa,t,n)}override(t,n){return ea(Jn,t,n)}route(t,n,i,r){const s=Xi(this,t),a=Xi(this,i),o="_"+n;Object.defineProperties(s,{[o]:{value:s[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[o],c=a[r];return _t(l)?Object.assign({},c,l):xt(l,c)},set(l){this[o]=l}}})}}var Lt=new rx({_scriptable:e=>!e.startsWith("on"),_indexable:e=>e!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}});function sx(e){return!e||At(e.size)||At(e.family)?null:(e.style?e.style+" ":"")+(e.weight?e.weight+" ":"")+e.size+"px "+e.family}function os(e,t,n,i,r){let s=t[r];return s||(s=t[r]=e.measureText(r).width,n.push(r)),s>i&&(i=s),i}function ax(e,t,n,i){i=i||{};let r=i.data=i.data||{},s=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(r=i.data={},s=i.garbageCollect=[],i.font=t),e.save(),e.font=t;let a=0;const o=n.length;let l,c,u,h,d;for(l=0;l<o;l++)if(h=n[l],h!=null&&Nt(h)!==!0)a=os(e,r,s,a,h);else if(Nt(h))for(c=0,u=h.length;c<u;c++)d=h[c],d!=null&&!Nt(d)&&(a=os(e,r,s,a,d));e.restore();const y=s.length/2;if(y>n.length){for(l=0;l<y;l++)delete r[s[l]];s.splice(0,y)}return a}function Un(e,t,n){const i=e.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((t-r)*i)/i+r}function rc(e,t){t=t||e.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,e.width,e.height),t.restore()}function Ra(e,t,n,i){Zf(e,t,n,i,null)}function Zf(e,t,n,i,r){let s,a,o,l,c,u;const h=t.pointStyle,d=t.rotation,y=t.radius;let E=(d||0)*DE;if(h&&typeof h=="object"&&(s=h.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){e.save(),e.translate(n,i),e.rotate(E),e.drawImage(h,-h.width/2,-h.height/2,h.width,h.height),e.restore();return}if(!(isNaN(y)||y<=0)){switch(e.beginPath(),h){default:r?e.ellipse(n,i,r/2,y,0,0,wt):e.arc(n,i,y,0,wt),e.closePath();break;case"triangle":e.moveTo(n+Math.sin(E)*y,i-Math.cos(E)*y),E+=zl,e.lineTo(n+Math.sin(E)*y,i-Math.cos(E)*y),E+=zl,e.lineTo(n+Math.sin(E)*y,i-Math.cos(E)*y),e.closePath();break;case"rectRounded":c=y*.516,l=y-c,a=Math.cos(E+Ri)*l,o=Math.sin(E+Ri)*l,e.arc(n-a,i-o,c,E-Kt,E-Vt),e.arc(n+o,i-a,c,E-Vt,E),e.arc(n+a,i+o,c,E,E+Vt),e.arc(n-o,i+a,c,E+Vt,E+Kt),e.closePath();break;case"rect":if(!d){l=Math.SQRT1_2*y,u=r?r/2:l,e.rect(n-u,i-l,2*u,2*l);break}E+=Ri;case"rectRot":a=Math.cos(E)*y,o=Math.sin(E)*y,e.moveTo(n-a,i-o),e.lineTo(n+o,i-a),e.lineTo(n+a,i+o),e.lineTo(n-o,i+a),e.closePath();break;case"crossRot":E+=Ri;case"cross":a=Math.cos(E)*y,o=Math.sin(E)*y,e.moveTo(n-a,i-o),e.lineTo(n+a,i+o),e.moveTo(n+o,i-a),e.lineTo(n-o,i+a);break;case"star":a=Math.cos(E)*y,o=Math.sin(E)*y,e.moveTo(n-a,i-o),e.lineTo(n+a,i+o),e.moveTo(n+o,i-a),e.lineTo(n-o,i+a),E+=Ri,a=Math.cos(E)*y,o=Math.sin(E)*y,e.moveTo(n-a,i-o),e.lineTo(n+a,i+o),e.moveTo(n+o,i-a),e.lineTo(n-o,i+a);break;case"line":a=r?r/2:Math.cos(E)*y,o=Math.sin(E)*y,e.moveTo(n-a,i-o),e.lineTo(n+a,i+o);break;case"dash":e.moveTo(n,i),e.lineTo(n+Math.cos(E)*y,i+Math.sin(E)*y);break}e.fill(),t.borderWidth>0&&e.stroke()}}function fr(e,t,n){return n=n||.5,!t||e&&e.x>t.left-n&&e.x<t.right+n&&e.y>t.top-n&&e.y<t.bottom+n}function Ds(e,t){e.save(),e.beginPath(),e.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),e.clip()}function As(e){e.restore()}function ox(e,t,n,i,r){if(!t)return e.lineTo(n.x,n.y);if(r==="middle"){const s=(t.x+n.x)/2;e.lineTo(s,t.y),e.lineTo(s,n.y)}else r==="after"!=!!i?e.lineTo(t.x,n.y):e.lineTo(n.x,t.y);e.lineTo(n.x,n.y)}function lx(e,t,n,i){if(!t)return e.lineTo(n.x,n.y);e.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?n.cp2x:n.cp1x,i?n.cp2y:n.cp1y,n.x,n.y)}function qn(e,t,n,i,r,s={}){const a=Nt(t)?t:[t],o=s.strokeWidth>0&&s.strokeColor!=="";let l,c;for(e.save(),e.font=r.string,cx(e,s),l=0;l<a.length;++l)c=a[l],o&&(s.strokeColor&&(e.strokeStyle=s.strokeColor),At(s.strokeWidth)||(e.lineWidth=s.strokeWidth),e.strokeText(c,n,i,s.maxWidth)),e.fillText(c,n,i,s.maxWidth),ux(e,n,i,c,s),i+=r.lineHeight;e.restore()}function cx(e,t){t.translation&&e.translate(t.translation[0],t.translation[1]),At(t.rotation)||e.rotate(t.rotation),t.color&&(e.fillStyle=t.color),t.textAlign&&(e.textAlign=t.textAlign),t.textBaseline&&(e.textBaseline=t.textBaseline)}function ux(e,t,n,i,r){if(r.strikethrough||r.underline){const s=e.measureText(i),a=t-s.actualBoundingBoxLeft,o=t+s.actualBoundingBoxRight,l=n-s.actualBoundingBoxAscent,c=n+s.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;e.strokeStyle=e.fillStyle,e.beginPath(),e.lineWidth=r.decorationWidth||2,e.moveTo(a,u),e.lineTo(o,u),e.stroke()}}function dr(e,t){const{x:n,y:i,w:r,h:s,radius:a}=t;e.arc(n+a.topLeft,i+a.topLeft,a.topLeft,-Vt,Kt,!0),e.lineTo(n,i+s-a.bottomLeft),e.arc(n+a.bottomLeft,i+s-a.bottomLeft,a.bottomLeft,Kt,Vt,!0),e.lineTo(n+r-a.bottomRight,i+s),e.arc(n+r-a.bottomRight,i+s-a.bottomRight,a.bottomRight,Vt,0,!0),e.lineTo(n+r,i+a.topRight),e.arc(n+r-a.topRight,i+a.topRight,a.topRight,0,-Vt,!0),e.lineTo(n+a.topLeft,i)}const fx=new RegExp(/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/),dx=new RegExp(/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/);function hx(e,t){const n=(""+e).match(fx);if(!n||n[1]==="normal")return t*1.2;switch(e=+n[2],n[3]){case"px":return e;case"%":e/=100;break}return t*e}const gx=e=>+e||0;function Do(e,t){const n={},i=_t(t),r=i?Object.keys(t):t,s=_t(e)?i?a=>xt(e[a],e[t[a]]):a=>e[a]:()=>e;for(const a of r)n[a]=gx(s(a));return n}function Jf(e){return Do(e,{top:"y",right:"x",bottom:"y",left:"x"})}function Qn(e){return Do(e,["topLeft","topRight","bottomLeft","bottomRight"])}function ae(e){const t=Jf(e);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function Gt(e,t){e=e||{},t=t||Lt.font;let n=xt(e.size,t.size);typeof n=="string"&&(n=parseInt(n,10));let i=xt(e.style,t.style);i&&!(""+i).match(dx)&&(console.warn('Invalid font style specified: "'+i+'"'),i="");const r={family:xt(e.family,t.family),lineHeight:hx(xt(e.lineHeight,t.lineHeight),n),size:n,style:i,weight:xt(e.weight,t.weight),string:""};return r.string=sx(r),r}function Wi(e,t,n,i){let r=!0,s,a,o;for(s=0,a=e.length;s<a;++s)if(o=e[s],o!==void 0&&(t!==void 0&&typeof o=="function"&&(o=o(t),r=!1),n!==void 0&&Nt(o)&&(o=o[n%o.length],r=!1),o!==void 0))return i&&!r&&(i.cacheable=!1),o}function vx(e,t,n){const{min:i,max:r}=e,s=Ff(t,(r-i)/2),a=(o,l)=>n&&o===0?0:o+l;return{min:a(i,-Math.abs(s)),max:a(r,s)}}function Mn(e,t){return Object.assign(Object.create(e),t)}function Ao(e,t=[""],n=e,i,r=()=>e[0]){Le(i)||(i=nd("_fallback",e));const s={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:e,_rootScopes:n,_fallback:i,_getTarget:r,override:a=>Ao([a,...e],t,n,i)};return new Proxy(s,{deleteProperty(a,o){return delete a[o],delete a._keys,delete e[0][o],!0},get(a,o){return td(a,o,()=>_x(o,t,e,a))},getOwnPropertyDescriptor(a,o){return Reflect.getOwnPropertyDescriptor(a._scopes[0],o)},getPrototypeOf(){return Reflect.getPrototypeOf(e[0])},has(a,o){return ac(a).includes(o)},ownKeys(a){return ac(a)},set(a,o,l){const c=a._storage||(a._storage=r());return a[o]=c[o]=l,delete a._keys,!0}})}function bi(e,t,n,i){const r={_cacheable:!1,_proxy:e,_context:t,_subProxy:n,_stack:new Set,_descriptors:qf(e,i),setContext:s=>bi(e,s,n,i),override:s=>bi(e.override(s),t,n,i)};return new Proxy(r,{deleteProperty(s,a){return delete s[a],delete e[a],!0},get(s,a,o){return td(s,a,()=>px(s,a,o))},getOwnPropertyDescriptor(s,a){return s._descriptors.allKeys?Reflect.has(e,a)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(e,a)},getPrototypeOf(){return Reflect.getPrototypeOf(e)},has(s,a){return Reflect.has(e,a)},ownKeys(){return Reflect.ownKeys(e)},set(s,a,o){return e[a]=o,delete s[a],!0}})}function qf(e,t={scriptable:!0,indexable:!0}){const{_scriptable:n=t.scriptable,_indexable:i=t.indexable,_allKeys:r=t.allKeys}=e;return{allKeys:r,scriptable:n,indexable:i,isScriptable:On(n)?n:()=>n,isIndexable:On(i)?i:()=>i}}const mx=(e,t)=>e?e+Eo(t):t,Co=(e,t)=>_t(t)&&e!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function td(e,t,n){if(Object.prototype.hasOwnProperty.call(e,t))return e[t];const i=n();return e[t]=i,i}function px(e,t,n){const{_proxy:i,_context:r,_subProxy:s,_descriptors:a}=e;let o=i[t];return On(o)&&a.isScriptable(t)&&(o=yx(t,o,e,n)),Nt(o)&&o.length&&(o=Ex(t,o,e,a.isIndexable)),Co(t,o)&&(o=bi(o,r,s&&s[t],a)),o}function yx(e,t,n,i){const{_proxy:r,_context:s,_subProxy:a,_stack:o}=n;if(o.has(e))throw new Error("Recursion detected: "+Array.from(o).join("->")+"->"+e);return o.add(e),t=t(s,a||i),o.delete(e),Co(e,t)&&(t=Oo(r._scopes,r,e,t)),t}function Ex(e,t,n,i){const{_proxy:r,_context:s,_subProxy:a,_descriptors:o}=n;if(Le(s.index)&&i(e))t=t[s.index%t.length];else if(_t(t[0])){const l=t,c=r._scopes.filter(u=>u!==l);t=[];for(const u of l){const h=Oo(c,r,e,u);t.push(bi(h,s,a&&a[e],o))}}return t}function ed(e,t,n){return On(e)?e(t,n):e}const xx=(e,t)=>e===!0?t:typeof e=="string"?Cn(t,e):void 0;function bx(e,t,n,i,r){for(const s of t){const a=xx(n,s);if(a){e.add(a);const o=ed(a._fallback,n,r);if(Le(o)&&o!==n&&o!==i)return o}else if(a===!1&&Le(i)&&n!==i)return null}return!1}function Oo(e,t,n,i){const r=t._rootScopes,s=ed(t._fallback,n,i),a=[...e,...r],o=new Set;o.add(i);let l=sc(o,a,n,s||n,i);return l===null||Le(s)&&s!==n&&(l=sc(o,a,s,l,i),l===null)?!1:Ao(Array.from(o),[""],r,s,()=>Tx(t,n,i))}function sc(e,t,n,i,r){for(;n;)n=bx(e,t,n,i,r);return n}function Tx(e,t,n){const i=e._getTarget();t in i||(i[t]={});const r=i[t];return Nt(r)&&_t(n)?n:r}function _x(e,t,n,i){let r;for(const s of t)if(r=nd(mx(s,e),n),Le(r))return Co(e,r)?Oo(n,i,e,r):r}function nd(e,t){for(const n of t){if(!n)continue;const i=n[e];if(Le(i))return i}}function ac(e){let t=e._keys;return t||(t=e._keys=Sx(e._scopes)),t}function Sx(e){const t=new Set;for(const n of e)for(const i of Object.keys(n).filter(r=>!r.startsWith("_")))t.add(i);return Array.from(t)}function id(e,t,n,i){const{iScale:r}=e,{key:s="r"}=this._parsing,a=new Array(i);let o,l,c,u;for(o=0,l=i;o<l;++o)c=o+n,u=t[c],a[o]={r:r.parse(Cn(u,s),c)};return a}const Lx=Number.EPSILON||1e-14,Ti=(e,t)=>t<e.length&&!e[t].skip&&e[t],rd=e=>e==="x"?"y":"x";function Dx(e,t,n,i){const r=e.skip?t:e,s=t,a=n.skip?t:n,o=Oa(s,r),l=Oa(a,s);let c=o/(o+l),u=l/(o+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const h=i*c,d=i*u;return{previous:{x:s.x-h*(a.x-r.x),y:s.y-h*(a.y-r.y)},next:{x:s.x+d*(a.x-r.x),y:s.y+d*(a.y-r.y)}}}function Ax(e,t,n){const i=e.length;let r,s,a,o,l,c=Ti(e,0);for(let u=0;u<i-1;++u)if(l=c,c=Ti(e,u+1),!(!l||!c)){if(zi(t[u],0,Lx)){n[u]=n[u+1]=0;continue}r=n[u]/t[u],s=n[u+1]/t[u],o=Math.pow(r,2)+Math.pow(s,2),!(o<=9)&&(a=3/Math.sqrt(o),n[u]=r*a*t[u],n[u+1]=s*a*t[u])}}function Cx(e,t,n="x"){const i=rd(n),r=e.length;let s,a,o,l=Ti(e,0);for(let c=0;c<r;++c){if(a=o,o=l,l=Ti(e,c+1),!o)continue;const u=o[n],h=o[i];a&&(s=(u-a[n])/3,o[`cp1${n}`]=u-s,o[`cp1${i}`]=h-s*t[c]),l&&(s=(l[n]-u)/3,o[`cp2${n}`]=u+s,o[`cp2${i}`]=h+s*t[c])}}function Ox(e,t="x"){const n=rd(t),i=e.length,r=Array(i).fill(0),s=Array(i);let a,o,l,c=Ti(e,0);for(a=0;a<i;++a)if(o=l,l=c,c=Ti(e,a+1),!!l){if(c){const u=c[t]-l[t];r[a]=u!==0?(c[n]-l[n])/u:0}s[a]=o?c?Ye(r[a-1])!==Ye(r[a])?0:(r[a-1]+r[a])/2:r[a-1]:r[a]}Ax(e,r,s),Cx(e,s,t)}function wr(e,t,n){return Math.max(Math.min(e,n),t)}function Mx(e,t){let n,i,r,s,a,o=fr(e[0],t);for(n=0,i=e.length;n<i;++n)a=s,s=o,o=n<i-1&&fr(e[n+1],t),s&&(r=e[n],a&&(r.cp1x=wr(r.cp1x,t.left,t.right),r.cp1y=wr(r.cp1y,t.top,t.bottom)),o&&(r.cp2x=wr(r.cp2x,t.left,t.right),r.cp2y=wr(r.cp2y,t.top,t.bottom)))}function Px(e,t,n,i,r){let s,a,o,l;if(t.spanGaps&&(e=e.filter(c=>!c.skip)),t.cubicInterpolationMode==="monotone")Ox(e,r);else{let c=i?e[e.length-1]:e[0];for(s=0,a=e.length;s<a;++s)o=e[s],l=Dx(c,o,e[Math.min(s+1,a-(i?0:1))%a],t.tension),o.cp1x=l.previous.x,o.cp1y=l.previous.y,o.cp2x=l.next.x,o.cp2y=l.next.y,c=o}t.capBezierPoints&&Mx(e,n)}function sd(){return typeof window<"u"&&typeof document<"u"}function Mo(e){let t=e.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function ls(e,t,n){let i;return typeof e=="string"?(i=parseInt(e,10),e.indexOf("%")!==-1&&(i=i/100*t.parentNode[n])):i=e,i}const Cs=e=>window.getComputedStyle(e,null);function Rx(e,t){return Cs(e).getPropertyValue(t)}const Ix=["top","right","bottom","left"];function Zn(e,t,n){const i={};n=n?"-"+n:"";for(let r=0;r<4;r++){const s=Ix[r];i[s]=parseFloat(e[t+"-"+s+n])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}const wx=(e,t,n)=>(e>0||t>0)&&(!n||!n.shadowRoot);function kx(e,t){const n=e.touches,i=n&&n.length?n[0]:e,{offsetX:r,offsetY:s}=i;let a=!1,o,l;if(wx(r,s,e.target))o=r,l=s;else{const c=t.getBoundingClientRect();o=i.clientX-c.left,l=i.clientY-c.top,a=!0}return{x:o,y:l,box:a}}function Hn(e,t){if("native"in e)return e;const{canvas:n,currentDevicePixelRatio:i}=t,r=Cs(n),s=r.boxSizing==="border-box",a=Zn(r,"padding"),o=Zn(r,"border","width"),{x:l,y:c,box:u}=kx(e,n),h=a.left+(u&&o.left),d=a.top+(u&&o.top);let{width:y,height:E}=t;return s&&(y-=a.width+o.width,E-=a.height+o.height),{x:Math.round((l-h)/y*n.width/i),y:Math.round((c-d)/E*n.height/i)}}function Fx(e,t,n){let i,r;if(t===void 0||n===void 0){const s=Mo(e);if(!s)t=e.clientWidth,n=e.clientHeight;else{const a=s.getBoundingClientRect(),o=Cs(s),l=Zn(o,"border","width"),c=Zn(o,"padding");t=a.width-c.width-l.width,n=a.height-c.height-l.height,i=ls(o.maxWidth,s,"clientWidth"),r=ls(o.maxHeight,s,"clientHeight")}}return{width:t,height:n,maxWidth:i||ss,maxHeight:r||ss}}const na=e=>Math.round(e*10)/10;function Bx(e,t,n,i){const r=Cs(e),s=Zn(r,"margin"),a=ls(r.maxWidth,e,"clientWidth")||ss,o=ls(r.maxHeight,e,"clientHeight")||ss,l=Fx(e,t,n);let{width:c,height:u}=l;if(r.boxSizing==="content-box"){const h=Zn(r,"border","width"),d=Zn(r,"padding");c-=d.width+h.width,u-=d.height+h.height}return c=Math.max(0,c-s.width),u=Math.max(0,i?Math.floor(c/i):u-s.height),c=na(Math.min(c,a,l.maxWidth)),u=na(Math.min(u,o,l.maxHeight)),c&&!u&&(u=na(c/2)),{width:c,height:u}}function oc(e,t,n){const i=t||1,r=Math.floor(e.height*i),s=Math.floor(e.width*i);e.height=r/i,e.width=s/i;const a=e.canvas;return a.style&&(n||!a.style.height&&!a.style.width)&&(a.style.height=`${e.height}px`,a.style.width=`${e.width}px`),e.currentDevicePixelRatio!==i||a.height!==r||a.width!==s?(e.currentDevicePixelRatio=i,a.height=r,a.width=s,e.ctx.setTransform(i,0,0,i,0,0),!0):!1}const Nx=function(){let e=!1;try{const t={get passive(){return e=!0,!1}};window.addEventListener("test",null,t),window.removeEventListener("test",null,t)}catch{}return e}();function lc(e,t){const n=Rx(e,t),i=n&&n.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function jn(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:e.y+n*(t.y-e.y)}}function Ux(e,t,n,i){return{x:e.x+n*(t.x-e.x),y:i==="middle"?n<.5?e.y:t.y:i==="after"?n<1?e.y:t.y:n>0?t.y:e.y}}function Wx(e,t,n,i){const r={x:e.cp2x,y:e.cp2y},s={x:t.cp1x,y:t.cp1y},a=jn(e,r,n),o=jn(r,s,n),l=jn(s,t,n),c=jn(a,o,n),u=jn(o,l,n);return jn(c,u,n)}const cc=new Map;function Kx(e,t){t=t||{};const n=e+JSON.stringify(t);let i=cc.get(n);return i||(i=new Intl.NumberFormat(e,t),cc.set(n,i)),i}function Er(e,t,n){return Kx(t,n).format(e)}const Hx=function(e,t){return{x(n){return e+e+t-n},setWidth(n){t=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,i){return n-i},leftForLtr(n,i){return n-i}}},jx=function(){return{x(e){return e},setWidth(e){},textAlign(e){return e},xPlus(e,t){return e+t},leftForLtr(e,t){return e}}};function gi(e,t,n){return e?Hx(t,n):jx()}function ad(e,t){let n,i;(t==="ltr"||t==="rtl")&&(n=e.canvas.style,i=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",t,"important"),e.prevTextDirection=i)}function od(e,t){t!==void 0&&(delete e.prevTextDirection,e.canvas.style.setProperty("direction",t[0],t[1]))}function ld(e){return e==="angle"?{between:ur,compare:OE,normalize:he}:{between:an,compare:(t,n)=>t-n,normalize:t=>t}}function uc({start:e,end:t,count:n,loop:i,style:r}){return{start:e%n,end:t%n,loop:i&&(t-e+1)%n===0,style:r}}function Vx(e,t,n){const{property:i,start:r,end:s}=n,{between:a,normalize:o}=ld(i),l=t.length;let{start:c,end:u,loop:h}=e,d,y;if(h){for(c+=l,u+=l,d=0,y=l;d<y&&a(o(t[c%l][i]),r,s);++d)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:h,style:e.style}}function cd(e,t,n){if(!n)return[e];const{property:i,start:r,end:s}=n,a=t.length,{compare:o,between:l,normalize:c}=ld(i),{start:u,end:h,loop:d,style:y}=Vx(e,t,n),E=[];let L=!1,_=null,A,v,f;const x=()=>l(r,f,A)&&o(r,f)!==0,S=()=>o(s,A)===0||l(s,f,A),C=()=>L||x(),p=()=>!L||S();for(let g=u,m=u;g<=h;++g)v=t[g%a],!v.skip&&(A=c(v[i]),A!==f&&(L=l(A,r,s),_===null&&C()&&(_=o(A,r)===0?g:m),_!==null&&p()&&(E.push(uc({start:_,end:g,loop:d,count:a,style:y})),_=null),m=g,f=A));return _!==null&&E.push(uc({start:_,end:h,loop:d,count:a,style:y})),E}function ud(e,t){const n=[],i=e.segments;for(let r=0;r<i.length;r++){const s=cd(i[r],e.points,t);s.length&&n.push(...s)}return n}function $x(e,t,n,i){let r=0,s=t-1;if(n&&!i)for(;r<t&&!e[r].skip;)r++;for(;r<t&&e[r].skip;)r++;for(r%=t,n&&(s+=r);s>r&&e[s%t].skip;)s--;return s%=t,{start:r,end:s}}function Gx(e,t,n,i){const r=e.length,s=[];let a=t,o=e[t],l;for(l=t+1;l<=n;++l){const c=e[l%r];c.skip||c.stop?o.skip||(i=!1,s.push({start:t%r,end:(l-1)%r,loop:i}),t=a=c.stop?l:null):(a=l,o.skip&&(t=l)),o=c}return a!==null&&s.push({start:t%r,end:a%r,loop:i}),s}function zx(e,t){const n=e.points,i=e.options.spanGaps,r=n.length;if(!r)return[];const s=!!e._loop,{start:a,end:o}=$x(n,r,s,i);if(i===!0)return fc(e,[{start:a,end:o,loop:s}],n,t);const l=o<a?o+r:o,c=!!e._fullLoop&&a===0&&o===r-1;return fc(e,Gx(n,a,l,c),n,t)}function fc(e,t,n,i){return!i||!i.setContext||!n?t:Yx(e,t,n,i)}function Yx(e,t,n,i){const r=e._chart.getContext(),s=dc(e.options),{_datasetIndex:a,options:{spanGaps:o}}=e,l=n.length,c=[];let u=s,h=t[0].start,d=h;function y(E,L,_,A){const v=o?-1:1;if(E!==L){for(E+=l;n[E%l].skip;)E-=v;for(;n[L%l].skip;)L+=v;E%l!==L%l&&(c.push({start:E%l,end:L%l,loop:_,style:A}),u=A,h=L%l)}}for(const E of t){h=o?h:E.start;let L=n[h%l],_;for(d=h+1;d<=E.end;d++){const A=n[d%l];_=dc(i.setContext(Mn(r,{type:"segment",p0:L,p1:A,p0DataIndex:(d-1)%l,p1DataIndex:d%l,datasetIndex:a}))),Xx(_,u)&&y(h,d-1,E.loop,u),L=A,u=_}h<d-1&&y(h,d-1,E.loop,u)}return c}function dc(e){return{backgroundColor:e.backgroundColor,borderCapStyle:e.borderCapStyle,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderJoinStyle:e.borderJoinStyle,borderWidth:e.borderWidth,borderColor:e.borderColor}}function Xx(e,t){return t&&JSON.stringify(e)!==JSON.stringify(t)}/*!
 * Chart.js v3.9.1
 * https://www.chartjs.org
 * (c) 2022 Chart.js Contributors
 * Released under the MIT License
 */class Qx{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,n,i,r){const s=n.listeners[r],a=n.duration;s.forEach(o=>o({chart:t,initial:n.initial,numSteps:a,currentStep:Math.min(i-n.start,a)}))}_refresh(){this._request||(this._running=!0,this._request=Hf.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let n=0;this._charts.forEach((i,r)=>{if(!i.running||!i.items.length)return;const s=i.items;let a=s.length-1,o=!1,l;for(;a>=0;--a)l=s[a],l._active?(l._total>i.duration&&(i.duration=l._total),l.tick(t),o=!0):(s[a]=s[s.length-1],s.pop());o&&(r.draw(),this._notify(r,i,t,"progress")),s.length||(i.running=!1,this._notify(r,i,t,"complete"),i.initial=!1),n+=s.length}),this._lastDate=t,n===0&&(this._running=!1)}_getAnims(t){const n=this._charts;let i=n.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(t,i)),i}listen(t,n,i){this._getAnims(t).listeners[n].push(i)}add(t,n){!n||!n.length||this._getAnims(t).items.push(...n)}has(t){return this._getAnims(t).items.length>0}start(t){const n=this._charts.get(t);!n||(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((i,r)=>Math.max(i,r._duration),0),this._refresh())}running(t){if(!this._running)return!1;const n=this._charts.get(t);return!(!n||!n.running||!n.items.length)}stop(t){const n=this._charts.get(t);if(!n||!n.items.length)return;const i=n.items;let r=i.length-1;for(;r>=0;--r)i[r].cancel();n.items=[],this._notify(t,n,Date.now(),"complete")}remove(t){return this._charts.delete(t)}}var en=new Qx;const hc="transparent",Zx={boolean(e,t,n){return n>.5?t:e},color(e,t,n){const i=ic(e||hc),r=i.valid&&ic(t||hc);return r&&r.valid?r.mix(i,n).hexString():t},number(e,t,n){return e+(t-e)*n}};class Jx{constructor(t,n,i,r){const s=n[i];r=Wi([t.to,r,s,t.from]);const a=Wi([t.from,s,r]);this._active=!0,this._fn=t.fn||Zx[t.type||typeof a],this._easing=Yi[t.easing]||Yi.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=n,this._prop=i,this._from=a,this._to=r,this._promises=void 0}active(){return this._active}update(t,n,i){if(this._active){this._notify(!1);const r=this._target[this._prop],s=i-this._start,a=this._duration-s;this._start=i,this._duration=Math.floor(Math.max(a,t.duration)),this._total+=s,this._loop=!!t.loop,this._to=Wi([t.to,n,r,t.from]),this._from=Wi([t.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){const n=t-this._start,i=this._duration,r=this._prop,s=this._from,a=this._loop,o=this._to;let l;if(this._active=s!==o&&(a||n<i),!this._active){this._target[r]=o,this._notify(!0);return}if(n<0){this._target[r]=s;return}l=n/i%2,l=a&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(s,o,l)}wait(){const t=this._promises||(this._promises=[]);return new Promise((n,i)=>{t.push({res:n,rej:i})})}_notify(t){const n=t?"res":"rej",i=this._promises||[];for(let r=0;r<i.length;r++)i[r][n]()}}const qx=["x","y","borderWidth","radius","tension"],tb=["color","borderColor","backgroundColor"];Lt.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0});const eb=Object.keys(Lt.animation);Lt.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"});Lt.set("animations",{colors:{type:"color",properties:tb},numbers:{type:"number",properties:qx}});Lt.describe("animations",{_fallback:"animation"});Lt.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}});class fd{constructor(t,n){this._chart=t,this._properties=new Map,this.configure(n)}configure(t){if(!_t(t))return;const n=this._properties;Object.getOwnPropertyNames(t).forEach(i=>{const r=t[i];if(!_t(r))return;const s={};for(const a of eb)s[a]=r[a];(Nt(r.properties)&&r.properties||[i]).forEach(a=>{(a===i||!n.has(a))&&n.set(a,s)})})}_animateOptions(t,n){const i=n.options,r=ib(t,i);if(!r)return[];const s=this._createAnimations(r,i);return i.$shared&&nb(t.options.$animations,i).then(()=>{t.options=i},()=>{}),s}_createAnimations(t,n){const i=this._properties,r=[],s=t.$animations||(t.$animations={}),a=Object.keys(n),o=Date.now();let l;for(l=a.length-1;l>=0;--l){const c=a[l];if(c.charAt(0)==="$")continue;if(c==="options"){r.push(...this._animateOptions(t,n));continue}const u=n[c];let h=s[c];const d=i.get(c);if(h)if(d&&h.active()){h.update(d,u,o);continue}else h.cancel();if(!d||!d.duration){t[c]=u;continue}s[c]=h=new Jx(d,t,c,u),r.push(h)}return r}update(t,n){if(this._properties.size===0){Object.assign(t,n);return}const i=this._createAnimations(t,n);if(i.length)return en.add(this._chart,i),!0}}function nb(e,t){const n=[],i=Object.keys(t);for(let r=0;r<i.length;r++){const s=e[i[r]];s&&s.active()&&n.push(s.wait())}return Promise.all(n)}function ib(e,t){if(!t)return;let n=e.options;if(!n){e.options=t;return}return n.$shared&&(e.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function gc(e,t){const n=e&&e.options||{},i=n.reverse,r=n.min===void 0?t:0,s=n.max===void 0?t:0;return{start:i?s:r,end:i?r:s}}function rb(e,t,n){if(n===!1)return!1;const i=gc(e,n),r=gc(t,n);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}function sb(e){let t,n,i,r;return _t(e)?(t=e.top,n=e.right,i=e.bottom,r=e.left):t=n=i=r=e,{top:t,right:n,bottom:i,left:r,disabled:e===!1}}function dd(e,t){const n=[],i=e._getSortedDatasetMetas(t);let r,s;for(r=0,s=i.length;r<s;++r)n.push(i[r].index);return n}function vc(e,t,n,i={}){const r=e.keys,s=i.mode==="single";let a,o,l,c;if(t!==null){for(a=0,o=r.length;a<o;++a){if(l=+r[a],l===n){if(i.all)continue;break}c=e.values[l],$t(c)&&(s||t===0||Ye(t)===Ye(c))&&(t+=c)}return t}}function ab(e){const t=Object.keys(e),n=new Array(t.length);let i,r,s;for(i=0,r=t.length;i<r;++i)s=t[i],n[i]={x:s,y:e[s]};return n}function mc(e,t){const n=e&&e.options.stacked;return n||n===void 0&&t.stack!==void 0}function ob(e,t,n){return`${e.id}.${t.id}.${n.stack||n.type}`}function lb(e){const{min:t,max:n,minDefined:i,maxDefined:r}=e.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function cb(e,t,n){const i=e[t]||(e[t]={});return i[n]||(i[n]={})}function pc(e,t,n,i){for(const r of t.getMatchingVisibleMetas(i).reverse()){const s=e[r.index];if(n&&s>0||!n&&s<0)return r.index}return null}function yc(e,t){const{chart:n,_cachedMeta:i}=e,r=n._stacks||(n._stacks={}),{iScale:s,vScale:a,index:o}=i,l=s.axis,c=a.axis,u=ob(s,a,i),h=t.length;let d;for(let y=0;y<h;++y){const E=t[y],{[l]:L,[c]:_}=E,A=E._stacks||(E._stacks={});d=A[c]=cb(r,u,L),d[o]=_,d._top=pc(d,a,!0,i.type),d._bottom=pc(d,a,!1,i.type)}}function ia(e,t){const n=e.scales;return Object.keys(n).filter(i=>n[i].axis===t).shift()}function ub(e,t){return Mn(e,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function fb(e,t,n){return Mn(e,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:n,index:t,mode:"default",type:"data"})}function Ii(e,t){const n=e.controller.index,i=e.vScale&&e.vScale.axis;if(!!i){t=t||e._parsed;for(const r of t){const s=r._stacks;if(!s||s[i]===void 0||s[i][n]===void 0)return;delete s[i][n]}}}const ra=e=>e==="reset"||e==="none",Ec=(e,t)=>t?e:Object.assign({},e),db=(e,t,n)=>e&&!t.hidden&&t._stacked&&{keys:dd(n,!0),values:null};class Fe{constructor(t,n){this.chart=t,this._ctx=t.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.initialize()}initialize(){const t=this._cachedMeta;this.configure(),this.linkScales(),t._stacked=mc(t.vScale,t),this.addElements()}updateIndex(t){this.index!==t&&Ii(this._cachedMeta),this.index=t}linkScales(){const t=this.chart,n=this._cachedMeta,i=this.getDataset(),r=(h,d,y,E)=>h==="x"?d:h==="r"?E:y,s=n.xAxisID=xt(i.xAxisID,ia(t,"x")),a=n.yAxisID=xt(i.yAxisID,ia(t,"y")),o=n.rAxisID=xt(i.rAxisID,ia(t,"r")),l=n.indexAxis,c=n.iAxisID=r(l,s,a,o),u=n.vAxisID=r(l,a,s,o);n.xScale=this.getScaleForId(s),n.yScale=this.getScaleForId(a),n.rScale=this.getScaleForId(o),n.iScale=this.getScaleForId(c),n.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(t){return this.chart.scales[t]}_getOtherScale(t){const n=this._cachedMeta;return t===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const t=this._cachedMeta;this._data&&Ql(this._data,this),t._stacked&&Ii(t)}_dataCheck(){const t=this.getDataset(),n=t.data||(t.data=[]),i=this._data;if(_t(n))this._data=ab(n);else if(i!==n){if(i){Ql(i,this);const r=this._cachedMeta;Ii(r),r._parsed=[]}n&&Object.isExtensible(n)&&IE(n,this),this._syncList=[],this._data=n}}addElements(){const t=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(t.dataset=new this.datasetElementType)}buildOrUpdateElements(t){const n=this._cachedMeta,i=this.getDataset();let r=!1;this._dataCheck();const s=n._stacked;n._stacked=mc(n.vScale,n),n.stack!==i.stack&&(r=!0,Ii(n),n.stack=i.stack),this._resyncElements(t),(r||s!==n._stacked)&&yc(this,n._parsed)}configure(){const t=this.chart.config,n=t.datasetScopeKeys(this._type),i=t.getOptionScopes(this.getDataset(),n,!0);this.options=t.createResolver(i,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(t,n){const{_cachedMeta:i,_data:r}=this,{iScale:s,_stacked:a}=i,o=s.axis;let l=t===0&&n===r.length?!0:i._sorted,c=t>0&&i._parsed[t-1],u,h,d;if(this._parsing===!1)i._parsed=r,i._sorted=!0,d=r;else{Nt(r[t])?d=this.parseArrayData(i,r,t,n):_t(r[t])?d=this.parseObjectData(i,r,t,n):d=this.parsePrimitiveData(i,r,t,n);const y=()=>h[o]===null||c&&h[o]<c[o];for(u=0;u<n;++u)i._parsed[u+t]=h=d[u],l&&(y()&&(l=!1),c=h);i._sorted=l}a&&yc(this,d)}parsePrimitiveData(t,n,i,r){const{iScale:s,vScale:a}=t,o=s.axis,l=a.axis,c=s.getLabels(),u=s===a,h=new Array(r);let d,y,E;for(d=0,y=r;d<y;++d)E=d+i,h[d]={[o]:u||s.parse(c[E],E),[l]:a.parse(n[E],E)};return h}parseArrayData(t,n,i,r){const{xScale:s,yScale:a}=t,o=new Array(r);let l,c,u,h;for(l=0,c=r;l<c;++l)u=l+i,h=n[u],o[l]={x:s.parse(h[0],u),y:a.parse(h[1],u)};return o}parseObjectData(t,n,i,r){const{xScale:s,yScale:a}=t,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,c=new Array(r);let u,h,d,y;for(u=0,h=r;u<h;++u)d=u+i,y=n[d],c[u]={x:s.parse(Cn(y,o),d),y:a.parse(Cn(y,l),d)};return c}getParsed(t){return this._cachedMeta._parsed[t]}getDataElement(t){return this._cachedMeta.data[t]}applyStack(t,n,i){const r=this.chart,s=this._cachedMeta,a=n[t.axis],o={keys:dd(r,!0),values:n._stacks[t.axis]};return vc(o,a,s.index,{mode:i})}updateRangeFromParsed(t,n,i,r){const s=i[n.axis];let a=s===null?NaN:s;const o=r&&i._stacks[n.axis];r&&o&&(r.values=o,a=vc(r,s,this._cachedMeta.index)),t.min=Math.min(t.min,a),t.max=Math.max(t.max,a)}getMinMax(t,n){const i=this._cachedMeta,r=i._parsed,s=i._sorted&&t===i.iScale,a=r.length,o=this._getOtherScale(t),l=db(n,i,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:h}=lb(o);let d,y;function E(){y=r[d];const L=y[o.axis];return!$t(y[t.axis])||u>L||h<L}for(d=0;d<a&&!(!E()&&(this.updateRangeFromParsed(c,t,y,l),s));++d);if(s){for(d=a-1;d>=0;--d)if(!E()){this.updateRangeFromParsed(c,t,y,l);break}}return c}getAllParsedValues(t){const n=this._cachedMeta._parsed,i=[];let r,s,a;for(r=0,s=n.length;r<s;++r)a=n[r][t.axis],$t(a)&&i.push(a);return i}getMaxOverflow(){return!1}getLabelAndValue(t){const n=this._cachedMeta,i=n.iScale,r=n.vScale,s=this.getParsed(t);return{label:i?""+i.getLabelForValue(s[i.axis]):"",value:r?""+r.getLabelForValue(s[r.axis]):""}}_update(t){const n=this._cachedMeta;this.update(t||"default"),n._clip=sb(xt(this.options.clip,rb(n.xScale,n.yScale,this.getMaxOverflow())))}update(t){}draw(){const t=this._ctx,n=this.chart,i=this._cachedMeta,r=i.data||[],s=n.chartArea,a=[],o=this._drawStart||0,l=this._drawCount||r.length-o,c=this.options.drawActiveElementsOnTop;let u;for(i.dataset&&i.dataset.draw(t,s,o,l),u=o;u<o+l;++u){const h=r[u];h.hidden||(h.active&&c?a.push(h):h.draw(t,s))}for(u=0;u<a.length;++u)a[u].draw(t,s)}getStyle(t,n){const i=n?"active":"default";return t===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(i):this.resolveDataElementOptions(t||0,i)}getContext(t,n,i){const r=this.getDataset();let s;if(t>=0&&t<this._cachedMeta.data.length){const a=this._cachedMeta.data[t];s=a.$context||(a.$context=fb(this.getContext(),t,a)),s.parsed=this.getParsed(t),s.raw=r.data[t],s.index=s.dataIndex=t}else s=this.$context||(this.$context=ub(this.chart.getContext(),this.index)),s.dataset=r,s.index=s.datasetIndex=this.index;return s.active=!!n,s.mode=i,s}resolveDatasetElementOptions(t){return this._resolveElementOptions(this.datasetElementType.id,t)}resolveDataElementOptions(t,n){return this._resolveElementOptions(this.dataElementType.id,n,t)}_resolveElementOptions(t,n="default",i){const r=n==="active",s=this._cachedDataOpts,a=t+"-"+n,o=s[a],l=this.enableOptionSharing&&Le(i);if(o)return Ec(o,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,t),h=r?[`${t}Hover`,"hover",t,""]:[t,""],d=c.getOptionScopes(this.getDataset(),u),y=Object.keys(Lt.elements[t]),E=()=>this.getContext(i,r),L=c.resolveNamedOptions(d,y,E,h);return L.$shared&&(L.$shared=l,s[a]=Object.freeze(Ec(L,l))),L}_resolveAnimations(t,n,i){const r=this.chart,s=this._cachedDataOpts,a=`animation-${n}`,o=s[a];if(o)return o;let l;if(r.options.animation!==!1){const u=this.chart.config,h=u.datasetAnimationScopeKeys(this._type,n),d=u.getOptionScopes(this.getDataset(),h);l=u.createResolver(d,this.getContext(t,i,n))}const c=new fd(r,l&&l.animations);return l&&l._cacheable&&(s[a]=Object.freeze(c)),c}getSharedOptions(t){if(!!t.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},t))}includeOptions(t,n){return!n||ra(t)||this.chart._animationsDisabled}_getSharedOptions(t,n){const i=this.resolveDataElementOptions(t,n),r=this._sharedOptions,s=this.getSharedOptions(i),a=this.includeOptions(n,s)||s!==r;return this.updateSharedOptions(s,n,i),{sharedOptions:s,includeOptions:a}}updateElement(t,n,i,r){ra(r)?Object.assign(t,i):this._resolveAnimations(n,r).update(t,i)}updateSharedOptions(t,n,i){t&&!ra(n)&&this._resolveAnimations(void 0,n).update(t,i)}_setStyle(t,n,i,r){t.active=r;const s=this.getStyle(n,r);this._resolveAnimations(n,i,r).update(t,{options:!r&&this.getSharedOptions(s)||s})}removeHoverStyle(t,n,i){this._setStyle(t,i,"active",!1)}setHoverStyle(t,n,i){this._setStyle(t,i,"active",!0)}_removeDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!1)}_setDatasetHoverStyle(){const t=this._cachedMeta.dataset;t&&this._setStyle(t,void 0,"active",!0)}_resyncElements(t){const n=this._data,i=this._cachedMeta.data;for(const[o,l,c]of this._syncList)this[o](l,c);this._syncList=[];const r=i.length,s=n.length,a=Math.min(s,r);a&&this.parse(0,a),s>r?this._insertElements(r,s-r,t):s<r&&this._removeElements(s,r-s)}_insertElements(t,n,i=!0){const r=this._cachedMeta,s=r.data,a=t+n;let o;const l=c=>{for(c.length+=n,o=c.length-1;o>=a;o--)c[o]=c[o-n]};for(l(s),o=t;o<a;++o)s[o]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(t,n),i&&this.updateElements(s,t,n,"reset")}updateElements(t,n,i,r){}_removeElements(t,n){const i=this._cachedMeta;if(this._parsing){const r=i._parsed.splice(t,n);i._stacked&&Ii(i,r)}i.data.splice(t,n)}_sync(t){if(this._parsing)this._syncList.push(t);else{const[n,i,r]=t;this[n](i,r)}this.chart._dataChanges.push([this.index,...t])}_onDataPush(){const t=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-t,t])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(t,n){n&&this._sync(["_removeElements",t,n]);const i=arguments.length-2;i&&this._sync(["_insertElements",t,i])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Fe.defaults={};Fe.prototype.datasetElementType=null;Fe.prototype.dataElementType=null;function hb(e,t){if(!e._cache.$bar){const n=e.getMatchingVisibleMetas(t);let i=[];for(let r=0,s=n.length;r<s;r++)i=i.concat(n[r].controller.getAllParsedValues(e));e._cache.$bar=Kf(i.sort((r,s)=>r-s))}return e._cache.$bar}function gb(e){const t=e.iScale,n=hb(t,e.type);let i=t._length,r,s,a,o;const l=()=>{a===32767||a===-32768||(Le(o)&&(i=Math.min(i,Math.abs(a-o)||i)),o=a)};for(r=0,s=n.length;r<s;++r)a=t.getPixelForValue(n[r]),l();for(o=void 0,r=0,s=t.ticks.length;r<s;++r)a=t.getPixelForTick(r),l();return i}function vb(e,t,n,i){const r=n.barThickness;let s,a;return At(r)?(s=t.min*n.categoryPercentage,a=n.barPercentage):(s=r*i,a=1),{chunk:s/i,ratio:a,start:t.pixels[e]-s/2}}function mb(e,t,n,i){const r=t.pixels,s=r[e];let a=e>0?r[e-1]:null,o=e<r.length-1?r[e+1]:null;const l=n.categoryPercentage;a===null&&(a=s-(o===null?t.end-t.start:o-s)),o===null&&(o=s+s-a);const c=s-(s-Math.min(a,o))/2*l;return{chunk:Math.abs(o-a)/2*l/i,ratio:n.barPercentage,start:c}}function pb(e,t,n,i){const r=n.parse(e[0],i),s=n.parse(e[1],i),a=Math.min(r,s),o=Math.max(r,s);let l=a,c=o;Math.abs(a)>Math.abs(o)&&(l=o,c=a),t[n.axis]=c,t._custom={barStart:l,barEnd:c,start:r,end:s,min:a,max:o}}function hd(e,t,n,i){return Nt(e)?pb(e,t,n,i):t[n.axis]=n.parse(e,i),t}function xc(e,t,n,i){const r=e.iScale,s=e.vScale,a=r.getLabels(),o=r===s,l=[];let c,u,h,d;for(c=n,u=n+i;c<u;++c)d=t[c],h={},h[r.axis]=o||r.parse(a[c],c),l.push(hd(d,h,s,c));return l}function sa(e){return e&&e.barStart!==void 0&&e.barEnd!==void 0}function yb(e,t,n){return e!==0?Ye(e):(t.isHorizontal()?1:-1)*(t.min>=n?1:-1)}function Eb(e){let t,n,i,r,s;return e.horizontal?(t=e.base>e.x,n="left",i="right"):(t=e.base<e.y,n="bottom",i="top"),t?(r="end",s="start"):(r="start",s="end"),{start:n,end:i,reverse:t,top:r,bottom:s}}function xb(e,t,n,i){let r=t.borderSkipped;const s={};if(!r){e.borderSkipped=s;return}if(r===!0){e.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:a,end:o,reverse:l,top:c,bottom:u}=Eb(e);r==="middle"&&n&&(e.enableBorderRadius=!0,(n._top||0)===i?r=c:(n._bottom||0)===i?r=u:(s[bc(u,a,o,l)]=!0,r=c)),s[bc(r,a,o,l)]=!0,e.borderSkipped=s}function bc(e,t,n,i){return i?(e=bb(e,t,n),e=Tc(e,n,t)):e=Tc(e,t,n),e}function bb(e,t,n){return e===t?n:e===n?t:e}function Tc(e,t,n){return e==="start"?t:e==="end"?n:e}function Tb(e,{inflateAmount:t},n){e.inflateAmount=t==="auto"?n===1?.33:0:t}class Os extends Fe{parsePrimitiveData(t,n,i,r){return xc(t,n,i,r)}parseArrayData(t,n,i,r){return xc(t,n,i,r)}parseObjectData(t,n,i,r){const{iScale:s,vScale:a}=t,{xAxisKey:o="x",yAxisKey:l="y"}=this._parsing,c=s.axis==="x"?o:l,u=a.axis==="x"?o:l,h=[];let d,y,E,L;for(d=i,y=i+r;d<y;++d)L=n[d],E={},E[s.axis]=s.parse(Cn(L,c),d),h.push(hd(Cn(L,u),E,a,d));return h}updateRangeFromParsed(t,n,i,r){super.updateRangeFromParsed(t,n,i,r);const s=i._custom;s&&n===this._cachedMeta.vScale&&(t.min=Math.min(t.min,s.min),t.max=Math.max(t.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(t){const n=this._cachedMeta,{iScale:i,vScale:r}=n,s=this.getParsed(t),a=s._custom,o=sa(a)?"["+a.start+", "+a.end+"]":""+r.getLabelForValue(s[r.axis]);return{label:""+i.getLabelForValue(s[i.axis]),value:o}}initialize(){this.enableOptionSharing=!0,super.initialize();const t=this._cachedMeta;t.stack=this.getDataset().stack}update(t){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,t)}updateElements(t,n,i,r){const s=r==="reset",{index:a,_cachedMeta:{vScale:o}}=this,l=o.getBasePixel(),c=o.isHorizontal(),u=this._getRuler(),{sharedOptions:h,includeOptions:d}=this._getSharedOptions(n,r);for(let y=n;y<n+i;y++){const E=this.getParsed(y),L=s||At(E[o.axis])?{base:l,head:l}:this._calculateBarValuePixels(y),_=this._calculateBarIndexPixels(y,u),A=(E._stacks||{})[o.axis],v={horizontal:c,base:L.base,enableBorderRadius:!A||sa(E._custom)||a===A._top||a===A._bottom,x:c?L.head:_.center,y:c?_.center:L.head,height:c?_.size:Math.abs(L.size),width:c?Math.abs(L.size):_.size};d&&(v.options=h||this.resolveDataElementOptions(y,t[y].active?"active":r));const f=v.options||t[y].options;xb(v,f,A,a),Tb(v,f,u.ratio),this.updateElement(t[y],y,v,r)}}_getStacks(t,n){const{iScale:i}=this._cachedMeta,r=i.getMatchingVisibleMetas(this._type).filter(l=>l.controller.options.grouped),s=i.options.stacked,a=[],o=l=>{const c=l.controller.getParsed(n),u=c&&c[l.vScale.axis];if(At(u)||isNaN(u))return!0};for(const l of r)if(!(n!==void 0&&o(l))&&((s===!1||a.indexOf(l.stack)===-1||s===void 0&&l.stack===void 0)&&a.push(l.stack),l.index===t))break;return a.length||a.push(void 0),a}_getStackCount(t){return this._getStacks(void 0,t).length}_getStackIndex(t,n,i){const r=this._getStacks(t,i),s=n!==void 0?r.indexOf(n):-1;return s===-1?r.length-1:s}_getRuler(){const t=this.options,n=this._cachedMeta,i=n.iScale,r=[];let s,a;for(s=0,a=n.data.length;s<a;++s)r.push(i.getPixelForValue(this.getParsed(s)[i.axis],s));const o=t.barThickness;return{min:o||gb(n),pixels:r,start:i._startPixel,end:i._endPixel,stackCount:this._getStackCount(),scale:i,grouped:t.grouped,ratio:o?1:t.categoryPercentage*t.barPercentage}}_calculateBarValuePixels(t){const{_cachedMeta:{vScale:n,_stacked:i},options:{base:r,minBarLength:s}}=this,a=r||0,o=this.getParsed(t),l=o._custom,c=sa(l);let u=o[n.axis],h=0,d=i?this.applyStack(n,o,i):u,y,E;d!==u&&(h=d-u,d=u),c&&(u=l.barStart,d=l.barEnd-l.barStart,u!==0&&Ye(u)!==Ye(l.barEnd)&&(h=0),h+=u);const L=!At(r)&&!c?r:h;let _=n.getPixelForValue(L);if(this.chart.getDataVisibility(t)?y=n.getPixelForValue(h+d):y=_,E=y-_,Math.abs(E)<s){E=yb(E,n,a)*s,u===a&&(_-=E/2);const A=n.getPixelForDecimal(0),v=n.getPixelForDecimal(1),f=Math.min(A,v),x=Math.max(A,v);_=Math.max(Math.min(_,x),f),y=_+E}if(_===n.getPixelForValue(a)){const A=Ye(E)*n.getLineWidthForValue(a)/2;_+=A,E-=A}return{size:E,base:_,head:y,center:y+E/2}}_calculateBarIndexPixels(t,n){const i=n.scale,r=this.options,s=r.skipNull,a=xt(r.maxBarThickness,1/0);let o,l;if(n.grouped){const c=s?this._getStackCount(t):n.stackCount,u=r.barThickness==="flex"?mb(t,n,r,c):vb(t,n,r,c),h=this._getStackIndex(this.index,this._cachedMeta.stack,s?t:void 0);o=u.start+u.chunk*h+u.chunk/2,l=Math.min(a,u.chunk*u.ratio)}else o=i.getPixelForValue(this.getParsed(t)[i.axis],t),l=Math.min(a,n.min*n.ratio);return{base:o-l/2,head:o+l/2,center:o,size:l}}draw(){const t=this._cachedMeta,n=t.vScale,i=t.data,r=i.length;let s=0;for(;s<r;++s)this.getParsed(s)[n.axis]!==null&&i[s].draw(this._ctx)}}Os.id="bar";Os.defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};Os.overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};class Ms extends Fe{initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(t,n,i,r){const s=super.parsePrimitiveData(t,n,i,r);for(let a=0;a<s.length;a++)s[a]._custom=this.resolveDataElementOptions(a+i).radius;return s}parseArrayData(t,n,i,r){const s=super.parseArrayData(t,n,i,r);for(let a=0;a<s.length;a++){const o=n[i+a];s[a]._custom=xt(o[2],this.resolveDataElementOptions(a+i).radius)}return s}parseObjectData(t,n,i,r){const s=super.parseObjectData(t,n,i,r);for(let a=0;a<s.length;a++){const o=n[i+a];s[a]._custom=xt(o&&o.r&&+o.r,this.resolveDataElementOptions(a+i).radius)}return s}getMaxOverflow(){const t=this._cachedMeta.data;let n=0;for(let i=t.length-1;i>=0;--i)n=Math.max(n,t[i].size(this.resolveDataElementOptions(i))/2);return n>0&&n}getLabelAndValue(t){const n=this._cachedMeta,{xScale:i,yScale:r}=n,s=this.getParsed(t),a=i.getLabelForValue(s.x),o=r.getLabelForValue(s.y),l=s._custom;return{label:n.label,value:"("+a+", "+o+(l?", "+l:"")+")"}}update(t){const n=this._cachedMeta.data;this.updateElements(n,0,n.length,t)}updateElements(t,n,i,r){const s=r==="reset",{iScale:a,vScale:o}=this._cachedMeta,{sharedOptions:l,includeOptions:c}=this._getSharedOptions(n,r),u=a.axis,h=o.axis;for(let d=n;d<n+i;d++){const y=t[d],E=!s&&this.getParsed(d),L={},_=L[u]=s?a.getPixelForDecimal(.5):a.getPixelForValue(E[u]),A=L[h]=s?o.getBasePixel():o.getPixelForValue(E[h]);L.skip=isNaN(_)||isNaN(A),c&&(L.options=l||this.resolveDataElementOptions(d,y.active?"active":r),s&&(L.options.radius=0)),this.updateElement(y,d,L,r)}}resolveDataElementOptions(t,n){const i=this.getParsed(t);let r=super.resolveDataElementOptions(t,n);r.$shared&&(r=Object.assign({},r,{$shared:!1}));const s=r.radius;return n!=="active"&&(r.radius=0),r.radius+=xt(i&&i._custom,s),r}}Ms.id="bubble";Ms.defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};Ms.overrides={scales:{x:{type:"linear"},y:{type:"linear"}},plugins:{tooltip:{callbacks:{title(){return""}}}}};function _b(e,t,n){let i=1,r=1,s=0,a=0;if(t<wt){const o=e,l=o+t,c=Math.cos(o),u=Math.sin(o),h=Math.cos(l),d=Math.sin(l),y=(f,x,S)=>ur(f,o,l,!0)?1:Math.max(x,x*n,S,S*n),E=(f,x,S)=>ur(f,o,l,!0)?-1:Math.min(x,x*n,S,S*n),L=y(0,c,h),_=y(Vt,u,d),A=E(Kt,c,h),v=E(Kt+Vt,u,d);i=(L-A)/2,r=(_-v)/2,s=-(L+A)/2,a=-(_+v)/2}return{ratioX:i,ratioY:r,offsetX:s,offsetY:a}}class Ai extends Fe{constructor(t,n){super(t,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(t,n){const i=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=i;else{let s=l=>+i[l];if(_t(i[t])){const{key:l="value"}=this._parsing;s=c=>+Cn(i[c],l)}let a,o;for(a=t,o=t+n;a<o;++a)r._parsed[a]=s(a)}}_getRotation(){return Me(this.options.rotation-90)}_getCircumference(){return Me(this.options.circumference)}_getRotationExtents(){let t=wt,n=-wt;for(let i=0;i<this.chart.data.datasets.length;++i)if(this.chart.isDatasetVisible(i)){const r=this.chart.getDatasetMeta(i).controller,s=r._getRotation(),a=r._getCircumference();t=Math.min(t,s),n=Math.max(n,s+a)}return{rotation:t,circumference:n-t}}update(t){const n=this.chart,{chartArea:i}=n,r=this._cachedMeta,s=r.data,a=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,o=Math.max((Math.min(i.width,i.height)-a)/2,0),l=Math.min(EE(this.options.cutout,o),1),c=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:d,ratioY:y,offsetX:E,offsetY:L}=_b(h,u,l),_=(i.width-a)/d,A=(i.height-a)/y,v=Math.max(Math.min(_,A)/2,0),f=Ff(this.options.radius,v),x=Math.max(f*l,0),S=(f-x)/this._getVisibleDatasetWeightTotal();this.offsetX=E*f,this.offsetY=L*f,r.total=this.calculateTotal(),this.outerRadius=f-S*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-S*c,0),this.updateElements(s,0,s.length,t)}_circumference(t,n){const i=this.options,r=this._cachedMeta,s=this._getCircumference();return n&&i.animation.animateRotate||!this.chart.getDataVisibility(t)||r._parsed[t]===null||r.data[t].hidden?0:this.calculateCircumference(r._parsed[t]*s/wt)}updateElements(t,n,i,r){const s=r==="reset",a=this.chart,o=a.chartArea,c=a.options.animation,u=(o.left+o.right)/2,h=(o.top+o.bottom)/2,d=s&&c.animateScale,y=d?0:this.innerRadius,E=d?0:this.outerRadius,{sharedOptions:L,includeOptions:_}=this._getSharedOptions(n,r);let A=this._getRotation(),v;for(v=0;v<n;++v)A+=this._circumference(v,s);for(v=n;v<n+i;++v){const f=this._circumference(v,s),x=t[v],S={x:u+this.offsetX,y:h+this.offsetY,startAngle:A,endAngle:A+f,circumference:f,outerRadius:E,innerRadius:y};_&&(S.options=L||this.resolveDataElementOptions(v,x.active?"active":r)),A+=f,this.updateElement(x,v,S,r)}}calculateTotal(){const t=this._cachedMeta,n=t.data;let i=0,r;for(r=0;r<n.length;r++){const s=t._parsed[r];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(r)&&!n[r].hidden&&(i+=Math.abs(s))}return i}calculateCircumference(t){const n=this._cachedMeta.total;return n>0&&!isNaN(t)?wt*(Math.abs(t)/n):0}getLabelAndValue(t){const n=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=Er(n._parsed[t],i.options.locale);return{label:r[t]||"",value:s}}getMaxBorderWidth(t){let n=0;const i=this.chart;let r,s,a,o,l;if(!t){for(r=0,s=i.data.datasets.length;r<s;++r)if(i.isDatasetVisible(r)){a=i.getDatasetMeta(r),t=a.data,o=a.controller;break}}if(!t)return 0;for(r=0,s=t.length;r<s;++r)l=o.resolveDataElementOptions(r),l.borderAlign!=="inner"&&(n=Math.max(n,l.borderWidth||0,l.hoverBorderWidth||0));return n}getMaxOffset(t){let n=0;for(let i=0,r=t.length;i<r;++i){const s=this.resolveDataElementOptions(i);n=Math.max(n,s.offset||0,s.hoverOffset||0)}return n}_getRingWeightOffset(t){let n=0;for(let i=0;i<t;++i)this.chart.isDatasetVisible(i)&&(n+=this._getRingWeight(i));return n}_getRingWeight(t){return Math.max(xt(this.chart.data.datasets[t].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Ai.id="doughnut";Ai.defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};Ai.descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"};Ai.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n}}=e.legend.options;return t.labels.map((i,r)=>{const a=e.getDatasetMeta(0).controller.getStyle(r);return{text:i,fillStyle:a.backgroundColor,strokeStyle:a.borderColor,lineWidth:a.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(r),index:r}})}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}},tooltip:{callbacks:{title(){return""},label(e){let t=e.label;const n=": "+e.formattedValue;return Nt(t)?(t=t.slice(),t[0]+=n):t+=n,t}}}}};class Ps extends Fe{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(t){const n=this._cachedMeta,{dataset:i,data:r=[],_dataset:s}=n,a=this.chart._animationsDisabled;let{start:o,count:l}=Vf(n,r,a);this._drawStart=o,this._drawCount=l,$f(n)&&(o=0,l=r.length),i._chart=this.chart,i._datasetIndex=this.index,i._decimated=!!s._decimated,i.points=r;const c=this.resolveDatasetElementOptions(t);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(i,void 0,{animated:!a,options:c},t),this.updateElements(r,o,l,t)}updateElements(t,n,i,r){const s=r==="reset",{iScale:a,vScale:o,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:h}=this._getSharedOptions(n,r),d=a.axis,y=o.axis,{spanGaps:E,segment:L}=this.options,_=xi(E)?E:Number.POSITIVE_INFINITY,A=this.chart._animationsDisabled||s||r==="none";let v=n>0&&this.getParsed(n-1);for(let f=n;f<n+i;++f){const x=t[f],S=this.getParsed(f),C=A?x:{},p=At(S[y]),g=C[d]=a.getPixelForValue(S[d],f),m=C[y]=s||p?o.getBasePixel():o.getPixelForValue(l?this.applyStack(o,S,l):S[y],f);C.skip=isNaN(g)||isNaN(m)||p,C.stop=f>0&&Math.abs(S[d]-v[d])>_,L&&(C.parsed=S,C.raw=c.data[f]),h&&(C.options=u||this.resolveDataElementOptions(f,x.active?"active":r)),A||this.updateElement(x,f,C,r),v=S}}getMaxOverflow(){const t=this._cachedMeta,n=t.dataset,i=n.options&&n.options.borderWidth||0,r=t.data||[];if(!r.length)return i;const s=r[0].size(this.resolveDataElementOptions(0)),a=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(i,s,a)/2}draw(){const t=this._cachedMeta;t.dataset.updateControlPoints(this.chart.chartArea,t.iScale.axis),super.draw()}}Ps.id="line";Ps.defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};Ps.overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};class Rs extends Fe{constructor(t,n){super(t,n),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(t){const n=this._cachedMeta,i=this.chart,r=i.data.labels||[],s=Er(n._parsed[t].r,i.options.locale);return{label:r[t]||"",value:s}}parseObjectData(t,n,i,r){return id.bind(this)(t,n,i,r)}update(t){const n=this._cachedMeta.data;this._updateRadius(),this.updateElements(n,0,n.length,t)}getMinMax(){const t=this._cachedMeta,n={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return t.data.forEach((i,r)=>{const s=this.getParsed(r).r;!isNaN(s)&&this.chart.getDataVisibility(r)&&(s<n.min&&(n.min=s),s>n.max&&(n.max=s))}),n}_updateRadius(){const t=this.chart,n=t.chartArea,i=t.options,r=Math.min(n.right-n.left,n.bottom-n.top),s=Math.max(r/2,0),a=Math.max(i.cutoutPercentage?s/100*i.cutoutPercentage:1,0),o=(s-a)/t.getVisibleDatasetCount();this.outerRadius=s-o*this.index,this.innerRadius=this.outerRadius-o}updateElements(t,n,i,r){const s=r==="reset",a=this.chart,l=a.options.animation,c=this._cachedMeta.rScale,u=c.xCenter,h=c.yCenter,d=c.getIndexAngle(0)-.5*Kt;let y=d,E;const L=360/this.countVisibleElements();for(E=0;E<n;++E)y+=this._computeAngle(E,r,L);for(E=n;E<n+i;E++){const _=t[E];let A=y,v=y+this._computeAngle(E,r,L),f=a.getDataVisibility(E)?c.getDistanceFromCenterForValue(this.getParsed(E).r):0;y=v,s&&(l.animateScale&&(f=0),l.animateRotate&&(A=v=d));const x={x:u,y:h,innerRadius:0,outerRadius:f,startAngle:A,endAngle:v,options:this.resolveDataElementOptions(E,_.active?"active":r)};this.updateElement(_,E,x,r)}}countVisibleElements(){const t=this._cachedMeta;let n=0;return t.data.forEach((i,r)=>{!isNaN(this.getParsed(r).r)&&this.chart.getDataVisibility(r)&&n++}),n}_computeAngle(t,n,i){return this.chart.getDataVisibility(t)?Me(this.resolveDataElementOptions(t,n).angle||i):0}}Rs.id="polarArea";Rs.defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};Rs.overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:n}}=e.legend.options;return t.labels.map((i,r)=>{const a=e.getDatasetMeta(0).controller.getStyle(r);return{text:i,fillStyle:a.backgroundColor,strokeStyle:a.borderColor,lineWidth:a.borderWidth,pointStyle:n,hidden:!e.getDataVisibility(r),index:r}})}return[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}},tooltip:{callbacks:{title(){return""},label(e){return e.chart.data.labels[e.dataIndex]+": "+e.formattedValue}}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};class Po extends Ai{}Po.id="pie";Po.defaults={cutout:0,rotation:0,circumference:360,radius:"100%"};class Is extends Fe{getLabelAndValue(t){const n=this._cachedMeta.vScale,i=this.getParsed(t);return{label:n.getLabels()[t],value:""+n.getLabelForValue(i[n.axis])}}parseObjectData(t,n,i,r){return id.bind(this)(t,n,i,r)}update(t){const n=this._cachedMeta,i=n.dataset,r=n.data||[],s=n.iScale.getLabels();if(i.points=r,t!=="resize"){const a=this.resolveDatasetElementOptions(t);this.options.showLine||(a.borderWidth=0);const o={_loop:!0,_fullLoop:s.length===r.length,options:a};this.updateElement(i,void 0,o,t)}this.updateElements(r,0,r.length,t)}updateElements(t,n,i,r){const s=this._cachedMeta.rScale,a=r==="reset";for(let o=n;o<n+i;o++){const l=t[o],c=this.resolveDataElementOptions(o,l.active?"active":r),u=s.getPointPositionForValue(o,this.getParsed(o).r),h=a?s.xCenter:u.x,d=a?s.yCenter:u.y,y={x:h,y:d,angle:u.angle,skip:isNaN(h)||isNaN(d),options:c};this.updateElement(l,o,y,r)}}}Is.id="radar";Is.defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};Is.overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};class Be{constructor(){this.x=void 0,this.y=void 0,this.active=!1,this.options=void 0,this.$animations=void 0}tooltipPosition(t){const{x:n,y:i}=this.getProps(["x","y"],t);return{x:n,y:i}}hasValue(){return xi(this.x)&&xi(this.y)}getProps(t,n){const i=this.$animations;if(!n||!i)return this;const r={};return t.forEach(s=>{r[s]=i[s]&&i[s].active()?i[s]._to:this[s]}),r}}Be.defaults={};Be.defaultRoutes=void 0;const gd={values(e){return Nt(e)?e:""+e},numeric(e,t,n){if(e===0)return"0";const i=this.chart.options.locale;let r,s=e;if(n.length>1){const c=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(c<1e-4||c>1e15)&&(r="scientific"),s=Sb(e,n)}const a=be(Math.abs(s)),o=Math.max(Math.min(-1*Math.floor(a),20),0),l={notation:r,minimumFractionDigits:o,maximumFractionDigits:o};return Object.assign(l,this.options.ticks.format),Er(e,i,l)},logarithmic(e,t,n){if(e===0)return"0";const i=e/Math.pow(10,Math.floor(be(e)));return i===1||i===2||i===5?gd.numeric.call(this,e,t,n):""}};function Sb(e,t){let n=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(n)>=1&&e!==Math.floor(e)&&(n=e-Math.floor(e)),n}var ws={formatters:gd};Lt.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",grace:0,grid:{display:!0,lineWidth:1,drawBorder:!0,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1,borderDash:[],borderDashOffset:0,borderWidth:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:ws.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}});Lt.route("scale.ticks","color","","color");Lt.route("scale.grid","color","","borderColor");Lt.route("scale.grid","borderColor","","borderColor");Lt.route("scale.title","color","","color");Lt.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"});Lt.describe("scales",{_fallback:"scale"});Lt.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"});function Lb(e,t){const n=e.options.ticks,i=n.maxTicksLimit||Db(e),r=n.major.enabled?Cb(t):[],s=r.length,a=r[0],o=r[s-1],l=[];if(s>i)return Ob(t,l,r,s/i),l;const c=Ab(r,t,i);if(s>0){let u,h;const d=s>1?Math.round((o-a)/(s-1)):null;for(kr(t,l,c,At(d)?0:a-d,a),u=0,h=s-1;u<h;u++)kr(t,l,c,r[u],r[u+1]);return kr(t,l,c,o,At(d)?t.length:o+d),l}return kr(t,l,c),l}function Db(e){const t=e.options.offset,n=e._tickSize(),i=e._length/n+(t?0:1),r=e._maxLength/n;return Math.floor(Math.min(i,r))}function Ab(e,t,n){const i=Mb(e),r=t.length/n;if(!i)return Math.max(r,1);const s=AE(i);for(let a=0,o=s.length-1;a<o;a++){const l=s[a];if(l>r)return l}return Math.max(r,1)}function Cb(e){const t=[];let n,i;for(n=0,i=e.length;n<i;n++)e[n].major&&t.push(n);return t}function Ob(e,t,n,i){let r=0,s=n[0],a;for(i=Math.ceil(i),a=0;a<e.length;a++)a===s&&(t.push(e[a]),r++,s=n[r*i])}function kr(e,t,n,i,r){const s=xt(i,0),a=Math.min(xt(r,e.length),e.length);let o=0,l,c,u;for(n=Math.ceil(n),r&&(l=r-i,n=l/Math.floor(l/n)),u=s;u<0;)o++,u=Math.round(s+o*n);for(c=Math.max(s,0);c<a;c++)c===u&&(t.push(e[c]),o++,u=Math.round(s+o*n))}function Mb(e){const t=e.length;let n,i;if(t<2)return!1;for(i=e[0],n=1;n<t;++n)if(e[n]-e[n-1]!==i)return!1;return i}const Pb=e=>e==="left"?"right":e==="right"?"left":e,_c=(e,t,n)=>t==="top"||t==="left"?e[t]+n:e[t]-n;function Sc(e,t){const n=[],i=e.length/t,r=e.length;let s=0;for(;s<r;s+=i)n.push(e[Math.floor(s)]);return n}function Rb(e,t,n){const i=e.ticks.length,r=Math.min(t,i-1),s=e._startPixel,a=e._endPixel,o=1e-6;let l=e.getPixelForTick(r),c;if(!(n&&(i===1?c=Math.max(l-s,a-l):t===0?c=(e.getPixelForTick(1)-l)/2:c=(l-e.getPixelForTick(r-1))/2,l+=r<t?c:-c,l<s-o||l>a+o)))return l}function Ib(e,t){Pt(e,n=>{const i=n.gc,r=i.length/2;let s;if(r>t){for(s=0;s<r;++s)delete n.data[i[s]];i.splice(0,r)}})}function wi(e){return e.drawTicks?e.tickLength:0}function Lc(e,t){if(!e.display)return 0;const n=Gt(e.font,t),i=ae(e.padding);return(Nt(e.text)?e.text.length:1)*n.lineHeight+i.height}function wb(e,t){return Mn(e,{scale:t,type:"scale"})}function kb(e,t,n){return Mn(e,{tick:n,index:t,type:"tick"})}function Fb(e,t,n){let i=To(e);return(n&&t!=="right"||!n&&t==="right")&&(i=Pb(i)),i}function Bb(e,t,n,i){const{top:r,left:s,bottom:a,right:o,chart:l}=e,{chartArea:c,scales:u}=l;let h=0,d,y,E;const L=a-r,_=o-s;if(e.isHorizontal()){if(y=ne(i,s,o),_t(n)){const A=Object.keys(n)[0],v=n[A];E=u[A].getPixelForValue(v)+L-t}else n==="center"?E=(c.bottom+c.top)/2+L-t:E=_c(e,n,t);d=o-s}else{if(_t(n)){const A=Object.keys(n)[0],v=n[A];y=u[A].getPixelForValue(v)-_+t}else n==="center"?y=(c.left+c.right)/2-_+t:y=_c(e,n,t);E=ne(i,a,r),h=n==="left"?-Vt:Vt}return{titleX:y,titleY:E,maxWidth:d,rotation:h}}class ei extends Be{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,n){return t}getUserBounds(){let{_userMin:t,_userMax:n,_suggestedMin:i,_suggestedMax:r}=this;return t=Ee(t,Number.POSITIVE_INFINITY),n=Ee(n,Number.NEGATIVE_INFINITY),i=Ee(i,Number.POSITIVE_INFINITY),r=Ee(r,Number.NEGATIVE_INFINITY),{min:Ee(t,i),max:Ee(n,r),minDefined:$t(t),maxDefined:$t(n)}}getMinMax(t){let{min:n,max:i,minDefined:r,maxDefined:s}=this.getUserBounds(),a;if(r&&s)return{min:n,max:i};const o=this.getMatchingVisibleMetas();for(let l=0,c=o.length;l<c;++l)a=o[l].controller.getMinMax(this,t),r||(n=Math.min(n,a.min)),s||(i=Math.max(i,a.max));return n=s&&n>i?i:n,i=r&&n>i?n:i,{min:Ee(n,Ee(i,n)),max:Ee(i,Ee(n,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Bt(this.options.beforeUpdate,[this])}update(t,n,i){const{beginAtZero:r,grace:s,ticks:a}=this.options,o=a.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=n,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=vx(this,s,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=o<this.ticks.length;this._convertTicksToLabels(l?Sc(this.ticks,o):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),a.display&&(a.autoSkip||a.source==="auto")&&(this.ticks=Lb(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,n,i;this.isHorizontal()?(n=this.left,i=this.right):(n=this.top,i=this.bottom,t=!t),this._startPixel=n,this._endPixel=i,this._reversePixels=t,this._length=i-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Bt(this.options.afterUpdate,[this])}beforeSetDimensions(){Bt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Bt(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),Bt(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Bt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){const n=this.options.ticks;let i,r,s;for(i=0,r=t.length;i<r;i++)s=t[i],s.label=Bt(n.callback,[s.value,i,t],this)}afterTickToLabelConversion(){Bt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Bt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const t=this.options,n=t.ticks,i=this.ticks.length,r=n.minRotation||0,s=n.maxRotation;let a=r,o,l,c;if(!this._isVisible()||!n.display||r>=s||i<=1||!this.isHorizontal()){this.labelRotation=r;return}const u=this._getLabelSizes(),h=u.widest.width,d=u.highest.height,y=Qt(this.chart.width-h,0,this.maxWidth);o=t.offset?this.maxWidth/i:y/(i-1),h+6>o&&(o=y/(i-(t.offset?.5:1)),l=this.maxHeight-wi(t.grid)-n.padding-Lc(t.title,this.chart.options.font),c=Math.sqrt(h*h+d*d),a=xo(Math.min(Math.asin(Qt((u.highest.height+6)/o,-1,1)),Math.asin(Qt(l/c,-1,1))-Math.asin(Qt(d/c,-1,1)))),a=Math.max(r,Math.min(s,a))),this.labelRotation=a}afterCalculateLabelRotation(){Bt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Bt(this.options.beforeFit,[this])}fit(){const t={width:0,height:0},{chart:n,options:{ticks:i,title:r,grid:s}}=this,a=this._isVisible(),o=this.isHorizontal();if(a){const l=Lc(r,n.options.font);if(o?(t.width=this.maxWidth,t.height=wi(s)+l):(t.height=this.maxHeight,t.width=wi(s)+l),i.display&&this.ticks.length){const{first:c,last:u,widest:h,highest:d}=this._getLabelSizes(),y=i.padding*2,E=Me(this.labelRotation),L=Math.cos(E),_=Math.sin(E);if(o){const A=i.mirror?0:_*h.width+L*d.height;t.height=Math.min(this.maxHeight,t.height+A+y)}else{const A=i.mirror?0:L*h.width+_*d.height;t.width=Math.min(this.maxWidth,t.width+A+y)}this._calculatePadding(c,u,_,L)}}this._handleMargins(),o?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,n,i,r){const{ticks:{align:s,padding:a},position:o}=this.options,l=this.labelRotation!==0,c=o!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let d=0,y=0;l?c?(d=r*t.width,y=i*n.height):(d=i*t.height,y=r*n.width):s==="start"?y=n.width:s==="end"?d=t.width:s!=="inner"&&(d=t.width/2,y=n.width/2),this.paddingLeft=Math.max((d-u+a)*this.width/(this.width-u),0),this.paddingRight=Math.max((y-h+a)*this.width/(this.width-h),0)}else{let u=n.height/2,h=t.height/2;s==="start"?(u=0,h=t.height):s==="end"&&(u=n.height,h=0),this.paddingTop=u+a,this.paddingBottom=h+a}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Bt(this.options.afterFit,[this])}isHorizontal(){const{axis:t,position:n}=this.options;return n==="top"||n==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let n,i;for(n=0,i=t.length;n<i;n++)At(t[n].label)&&(t.splice(n,1),i--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){const n=this.options.ticks.sampleSize;let i=this.ticks;n<i.length&&(i=Sc(i,n)),this._labelSizes=t=this._computeLabelSizes(i,i.length)}return t}_computeLabelSizes(t,n){const{ctx:i,_longestTextCache:r}=this,s=[],a=[];let o=0,l=0,c,u,h,d,y,E,L,_,A,v,f;for(c=0;c<n;++c){if(d=t[c].label,y=this._resolveTickFontOptions(c),i.font=E=y.string,L=r[E]=r[E]||{data:{},gc:[]},_=y.lineHeight,A=v=0,!At(d)&&!Nt(d))A=os(i,L.data,L.gc,A,d),v=_;else if(Nt(d))for(u=0,h=d.length;u<h;++u)f=d[u],!At(f)&&!Nt(f)&&(A=os(i,L.data,L.gc,A,f),v+=_);s.push(A),a.push(v),o=Math.max(A,o),l=Math.max(v,l)}Ib(r,n);const x=s.indexOf(o),S=a.indexOf(l),C=p=>({width:s[p]||0,height:a[p]||0});return{first:C(0),last:C(n-1),widest:C(x),highest:C(S),widths:s,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,n){return NaN}getValueForPixel(t){}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);const n=this._startPixel+t*this._length;return ME(this._alignToPixels?Un(this.chart,n,0):n)}getDecimalForPixel(t){const n=(t-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:t,max:n}=this;return t<0&&n<0?n:t>0&&n>0?t:0}getContext(t){const n=this.ticks||[];if(t>=0&&t<n.length){const i=n[t];return i.$context||(i.$context=kb(this.getContext(),t,i))}return this.$context||(this.$context=wb(this.chart.getContext(),this))}_tickSize(){const t=this.options.ticks,n=Me(this.labelRotation),i=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),s=this._getLabelSizes(),a=t.autoSkipPadding||0,o=s?s.widest.width+a:0,l=s?s.highest.height+a:0;return this.isHorizontal()?l*i>o*r?o/i:l/r:l*r<o*i?l/i:o/r}_isVisible(){const t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){const n=this.axis,i=this.chart,r=this.options,{grid:s,position:a}=r,o=s.offset,l=this.isHorizontal(),u=this.ticks.length+(o?1:0),h=wi(s),d=[],y=s.setContext(this.getContext()),E=y.drawBorder?y.borderWidth:0,L=E/2,_=function(O){return Un(i,O,E)};let A,v,f,x,S,C,p,g,m,D,b,T;if(a==="top")A=_(this.bottom),C=this.bottom-h,g=A-L,D=_(t.top)+L,T=t.bottom;else if(a==="bottom")A=_(this.top),D=t.top,T=_(t.bottom)-L,C=A+L,g=this.top+h;else if(a==="left")A=_(this.right),S=this.right-h,p=A-L,m=_(t.left)+L,b=t.right;else if(a==="right")A=_(this.left),m=t.left,b=_(t.right)-L,S=A+L,p=this.left+h;else if(n==="x"){if(a==="center")A=_((t.top+t.bottom)/2+.5);else if(_t(a)){const O=Object.keys(a)[0],R=a[O];A=_(this.chart.scales[O].getPixelForValue(R))}D=t.top,T=t.bottom,C=A+L,g=C+h}else if(n==="y"){if(a==="center")A=_((t.left+t.right)/2);else if(_t(a)){const O=Object.keys(a)[0],R=a[O];A=_(this.chart.scales[O].getPixelForValue(R))}S=A-L,p=S-h,m=t.left,b=t.right}const P=xt(r.ticks.maxTicksLimit,u),M=Math.max(1,Math.ceil(u/P));for(v=0;v<u;v+=M){const O=s.setContext(this.getContext(v)),R=O.lineWidth,I=O.color,w=O.borderDash||[],k=O.borderDashOffset,B=O.tickWidth,F=O.tickColor,N=O.tickBorderDash||[],K=O.tickBorderDashOffset;f=Rb(this,v,o),f!==void 0&&(x=Un(i,f,R),l?S=p=m=b=x:C=g=D=T=x,d.push({tx1:S,ty1:C,tx2:p,ty2:g,x1:m,y1:D,x2:b,y2:T,width:R,color:I,borderDash:w,borderDashOffset:k,tickWidth:B,tickColor:F,tickBorderDash:N,tickBorderDashOffset:K}))}return this._ticksLength=u,this._borderValue=A,d}_computeLabelItems(t){const n=this.axis,i=this.options,{position:r,ticks:s}=i,a=this.isHorizontal(),o=this.ticks,{align:l,crossAlign:c,padding:u,mirror:h}=s,d=wi(i.grid),y=d+u,E=h?-u:y,L=-Me(this.labelRotation),_=[];let A,v,f,x,S,C,p,g,m,D,b,T,P="middle";if(r==="top")C=this.bottom-E,p=this._getXAxisLabelAlignment();else if(r==="bottom")C=this.top+E,p=this._getXAxisLabelAlignment();else if(r==="left"){const O=this._getYAxisLabelAlignment(d);p=O.textAlign,S=O.x}else if(r==="right"){const O=this._getYAxisLabelAlignment(d);p=O.textAlign,S=O.x}else if(n==="x"){if(r==="center")C=(t.top+t.bottom)/2+y;else if(_t(r)){const O=Object.keys(r)[0],R=r[O];C=this.chart.scales[O].getPixelForValue(R)+y}p=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")S=(t.left+t.right)/2-y;else if(_t(r)){const O=Object.keys(r)[0],R=r[O];S=this.chart.scales[O].getPixelForValue(R)}p=this._getYAxisLabelAlignment(d).textAlign}n==="y"&&(l==="start"?P="top":l==="end"&&(P="bottom"));const M=this._getLabelSizes();for(A=0,v=o.length;A<v;++A){f=o[A],x=f.label;const O=s.setContext(this.getContext(A));g=this.getPixelForTick(A)+s.labelOffset,m=this._resolveTickFontOptions(A),D=m.lineHeight,b=Nt(x)?x.length:1;const R=b/2,I=O.color,w=O.textStrokeColor,k=O.textStrokeWidth;let B=p;a?(S=g,p==="inner"&&(A===v-1?B=this.options.reverse?"left":"right":A===0?B=this.options.reverse?"right":"left":B="center"),r==="top"?c==="near"||L!==0?T=-b*D+D/2:c==="center"?T=-M.highest.height/2-R*D+D:T=-M.highest.height+D/2:c==="near"||L!==0?T=D/2:c==="center"?T=M.highest.height/2-R*D:T=M.highest.height-b*D,h&&(T*=-1)):(C=g,T=(1-b)*D/2);let F;if(O.showLabelBackdrop){const N=ae(O.backdropPadding),K=M.heights[A],H=M.widths[A];let U=C+T-N.top,j=S-N.left;switch(P){case"middle":U-=K/2;break;case"bottom":U-=K;break}switch(p){case"center":j-=H/2;break;case"right":j-=H;break}F={left:j,top:U,width:H+N.width,height:K+N.height,color:O.backdropColor}}_.push({rotation:L,label:x,font:m,color:I,strokeColor:w,strokeWidth:k,textOffset:T,textAlign:B,textBaseline:P,translation:[S,C],backdrop:F})}return _}_getXAxisLabelAlignment(){const{position:t,ticks:n}=this.options;if(-Me(this.labelRotation))return t==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(t){const{position:n,ticks:{crossAlign:i,mirror:r,padding:s}}=this.options,a=this._getLabelSizes(),o=t+s,l=a.widest.width;let c,u;return n==="left"?r?(u=this.right+s,i==="near"?c="left":i==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-o,i==="near"?c="right":i==="center"?(c="center",u-=l/2):(c="left",u=this.left)):n==="right"?r?(u=this.left+s,i==="near"?c="right":i==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+o,i==="near"?c="left":i==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const t=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){const{ctx:t,options:{backgroundColor:n},left:i,top:r,width:s,height:a}=this;n&&(t.save(),t.fillStyle=n,t.fillRect(i,r,s,a),t.restore())}getLineWidthForValue(t){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(s=>s.value===t);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(t){const n=this.options.grid,i=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t));let s,a;const o=(l,c,u)=>{!u.width||!u.color||(i.save(),i.lineWidth=u.width,i.strokeStyle=u.color,i.setLineDash(u.borderDash||[]),i.lineDashOffset=u.borderDashOffset,i.beginPath(),i.moveTo(l.x,l.y),i.lineTo(c.x,c.y),i.stroke(),i.restore())};if(n.display)for(s=0,a=r.length;s<a;++s){const l=r[s];n.drawOnChartArea&&o({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&o({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:t,ctx:n,options:{grid:i}}=this,r=i.setContext(this.getContext()),s=i.drawBorder?r.borderWidth:0;if(!s)return;const a=i.setContext(this.getContext(0)).lineWidth,o=this._borderValue;let l,c,u,h;this.isHorizontal()?(l=Un(t,this.left,s)-s/2,c=Un(t,this.right,a)+a/2,u=h=o):(u=Un(t,this.top,s)-s/2,h=Un(t,this.bottom,a)+a/2,l=c=o),n.save(),n.lineWidth=r.borderWidth,n.strokeStyle=r.borderColor,n.beginPath(),n.moveTo(l,u),n.lineTo(c,h),n.stroke(),n.restore()}drawLabels(t){if(!this.options.ticks.display)return;const i=this.ctx,r=this._computeLabelArea();r&&Ds(i,r);const s=this._labelItems||(this._labelItems=this._computeLabelItems(t));let a,o;for(a=0,o=s.length;a<o;++a){const l=s[a],c=l.font,u=l.label;l.backdrop&&(i.fillStyle=l.backdrop.color,i.fillRect(l.backdrop.left,l.backdrop.top,l.backdrop.width,l.backdrop.height));let h=l.textOffset;qn(i,u,0,h,c,l)}r&&As(i)}drawTitle(){const{ctx:t,options:{position:n,title:i,reverse:r}}=this;if(!i.display)return;const s=Gt(i.font),a=ae(i.padding),o=i.align;let l=s.lineHeight/2;n==="bottom"||n==="center"||_t(n)?(l+=a.bottom,Nt(i.text)&&(l+=s.lineHeight*(i.text.length-1))):l+=a.top;const{titleX:c,titleY:u,maxWidth:h,rotation:d}=Bb(this,l,n,o);qn(t,i.text,0,0,s,{color:i.color,maxWidth:h,rotation:d,textAlign:Fb(o,n,r),textBaseline:"middle",translation:[c,u]})}draw(t){!this._isVisible()||(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){const t=this.options,n=t.ticks&&t.ticks.z||0,i=xt(t.grid&&t.grid.z,-1);return!this._isVisible()||this.draw!==ei.prototype.draw?[{z:n,draw:r=>{this.draw(r)}}]:[{z:i,draw:r=>{this.drawBackground(),this.drawGrid(r),this.drawTitle()}},{z:i+1,draw:()=>{this.drawBorder()}},{z:n,draw:r=>{this.drawLabels(r)}}]}getMatchingVisibleMetas(t){const n=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",r=[];let s,a;for(s=0,a=n.length;s<a;++s){const o=n[s];o[i]===this.id&&(!t||o.type===t)&&r.push(o)}return r}_resolveTickFontOptions(t){const n=this.options.ticks.setContext(this.getContext(t));return Gt(n.font)}_maxDigits(){const t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}}class Fr{constructor(t,n,i){this.type=t,this.scope=n,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){const n=Object.getPrototypeOf(t);let i;Wb(n)&&(i=this.register(n));const r=this.items,s=t.id,a=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+t);return s in r||(r[s]=t,Nb(t,a,i),this.override&&Lt.override(t.id,t.overrides)),a}get(t){return this.items[t]}unregister(t){const n=this.items,i=t.id,r=this.scope;i in n&&delete n[i],r&&i in Lt[r]&&(delete Lt[r][i],this.override&&delete Jn[i])}}function Nb(e,t,n){const i=cr(Object.create(null),[n?Lt.get(n):{},Lt.get(t),e.defaults]);Lt.set(t,i),e.defaultRoutes&&Ub(t,e.defaultRoutes),e.descriptors&&Lt.describe(t,e.descriptors)}function Ub(e,t){Object.keys(t).forEach(n=>{const i=n.split("."),r=i.pop(),s=[e].concat(i).join("."),a=t[n].split("."),o=a.pop(),l=a.join(".");Lt.route(s,r,l,o)})}function Wb(e){return"id"in e&&"defaults"in e}class Kb{constructor(){this.controllers=new Fr(Fe,"datasets",!0),this.elements=new Fr(Be,"elements"),this.plugins=new Fr(Object,"plugins"),this.scales=new Fr(ei,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,n,i){[...n].forEach(r=>{const s=i||this._getRegistryForType(r);i||s.isForType(r)||s===this.plugins&&r.id?this._exec(t,s,r):Pt(r,a=>{const o=i||this._getRegistryForType(a);this._exec(t,o,a)})})}_exec(t,n,i){const r=Eo(t);Bt(i["before"+r],[],i),n[t](i),Bt(i["after"+r],[],i)}_getRegistryForType(t){for(let n=0;n<this._typedRegistries.length;n++){const i=this._typedRegistries[n];if(i.isForType(t))return i}return this.plugins}_get(t,n,i){const r=n.get(t);if(r===void 0)throw new Error('"'+t+'" is not a registered '+i+".");return r}}var $e=new Kb;class ks extends Fe{update(t){const n=this._cachedMeta,{data:i=[]}=n,r=this.chart._animationsDisabled;let{start:s,count:a}=Vf(n,i,r);if(this._drawStart=s,this._drawCount=a,$f(n)&&(s=0,a=i.length),this.options.showLine){const{dataset:o,_dataset:l}=n;o._chart=this.chart,o._datasetIndex=this.index,o._decimated=!!l._decimated,o.points=i;const c=this.resolveDatasetElementOptions(t);c.segment=this.options.segment,this.updateElement(o,void 0,{animated:!r,options:c},t)}this.updateElements(i,s,a,t)}addElements(){const{showLine:t}=this.options;!this.datasetElementType&&t&&(this.datasetElementType=$e.getElement("line")),super.addElements()}updateElements(t,n,i,r){const s=r==="reset",{iScale:a,vScale:o,_stacked:l,_dataset:c}=this._cachedMeta,u=this.resolveDataElementOptions(n,r),h=this.getSharedOptions(u),d=this.includeOptions(r,h),y=a.axis,E=o.axis,{spanGaps:L,segment:_}=this.options,A=xi(L)?L:Number.POSITIVE_INFINITY,v=this.chart._animationsDisabled||s||r==="none";let f=n>0&&this.getParsed(n-1);for(let x=n;x<n+i;++x){const S=t[x],C=this.getParsed(x),p=v?S:{},g=At(C[E]),m=p[y]=a.getPixelForValue(C[y],x),D=p[E]=s||g?o.getBasePixel():o.getPixelForValue(l?this.applyStack(o,C,l):C[E],x);p.skip=isNaN(m)||isNaN(D)||g,p.stop=x>0&&Math.abs(C[y]-f[y])>A,_&&(p.parsed=C,p.raw=c.data[x]),d&&(p.options=h||this.resolveDataElementOptions(x,S.active?"active":r)),v||this.updateElement(S,x,p,r),f=C}this.updateSharedOptions(h,r,u)}getMaxOverflow(){const t=this._cachedMeta,n=t.data||[];if(!this.options.showLine){let o=0;for(let l=n.length-1;l>=0;--l)o=Math.max(o,n[l].size(this.resolveDataElementOptions(l))/2);return o>0&&o}const i=t.dataset,r=i.options&&i.options.borderWidth||0;if(!n.length)return r;const s=n[0].size(this.resolveDataElementOptions(0)),a=n[n.length-1].size(this.resolveDataElementOptions(n.length-1));return Math.max(r,s,a)/2}}ks.id="scatter";ks.defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};ks.overrides={interaction:{mode:"point"},plugins:{tooltip:{callbacks:{title(){return""},label(e){return"("+e.label+", "+e.formattedValue+")"}}}},scales:{x:{type:"linear"},y:{type:"linear"}}};var Hb=Object.freeze({__proto__:null,BarController:Os,BubbleController:Ms,DoughnutController:Ai,LineController:Ps,PolarAreaController:Rs,PieController:Po,RadarController:Is,ScatterController:ks});function Wn(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class Ia{constructor(t){this.options=t||{}}init(t){}formats(){return Wn()}parse(t,n){return Wn()}format(t,n){return Wn()}add(t,n,i){return Wn()}diff(t,n,i){return Wn()}startOf(t,n,i){return Wn()}endOf(t,n){return Wn()}}Ia.override=function(e){Object.assign(Ia.prototype,e)};var jb={_date:Ia};function Vb(e,t,n,i){const{controller:r,data:s,_sorted:a}=e,o=r._cachedMeta.iScale;if(o&&t===o.axis&&t!=="r"&&a&&s.length){const l=o._reversePixels?PE:on;if(i){if(r._sharedOptions){const c=s[0],u=typeof c.getRange=="function"&&c.getRange(t);if(u){const h=l(s,t,n-u),d=l(s,t,n+u);return{lo:h.lo,hi:d.hi}}}}else return l(s,t,n)}return{lo:0,hi:s.length-1}}function xr(e,t,n,i,r){const s=e.getSortedVisibleDatasetMetas(),a=n[t];for(let o=0,l=s.length;o<l;++o){const{index:c,data:u}=s[o],{lo:h,hi:d}=Vb(s[o],t,a,r);for(let y=h;y<=d;++y){const E=u[y];E.skip||i(E,c,y)}}}function $b(e){const t=e.indexOf("x")!==-1,n=e.indexOf("y")!==-1;return function(i,r){const s=t?Math.abs(i.x-r.x):0,a=n?Math.abs(i.y-r.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(a,2))}}function aa(e,t,n,i,r){const s=[];return!r&&!e.isPointInArea(t)||xr(e,n,t,function(o,l,c){!r&&!fr(o,e.chartArea,0)||o.inRange(t.x,t.y,i)&&s.push({element:o,datasetIndex:l,index:c})},!0),s}function Gb(e,t,n,i){let r=[];function s(a,o,l){const{startAngle:c,endAngle:u}=a.getProps(["startAngle","endAngle"],i),{angle:h}=Uf(a,{x:t.x,y:t.y});ur(h,c,u)&&r.push({element:a,datasetIndex:o,index:l})}return xr(e,n,t,s),r}function zb(e,t,n,i,r,s){let a=[];const o=$b(n);let l=Number.POSITIVE_INFINITY;function c(u,h,d){const y=u.inRange(t.x,t.y,r);if(i&&!y)return;const E=u.getCenterPoint(r);if(!(!!s||e.isPointInArea(E))&&!y)return;const _=o(t,E);_<l?(a=[{element:u,datasetIndex:h,index:d}],l=_):_===l&&a.push({element:u,datasetIndex:h,index:d})}return xr(e,n,t,c),a}function oa(e,t,n,i,r,s){return!s&&!e.isPointInArea(t)?[]:n==="r"&&!i?Gb(e,t,n,r):zb(e,t,n,i,r,s)}function Dc(e,t,n,i,r){const s=[],a=n==="x"?"inXRange":"inYRange";let o=!1;return xr(e,n,t,(l,c,u)=>{l[a](t[n],r)&&(s.push({element:l,datasetIndex:c,index:u}),o=o||l.inRange(t.x,t.y,r))}),i&&!o?[]:s}var Yb={evaluateInteractionItems:xr,modes:{index(e,t,n,i){const r=Hn(t,e),s=n.axis||"x",a=n.includeInvisible||!1,o=n.intersect?aa(e,r,s,i,a):oa(e,r,s,!1,i,a),l=[];return o.length?(e.getSortedVisibleDatasetMetas().forEach(c=>{const u=o[0].index,h=c.data[u];h&&!h.skip&&l.push({element:h,datasetIndex:c.index,index:u})}),l):[]},dataset(e,t,n,i){const r=Hn(t,e),s=n.axis||"xy",a=n.includeInvisible||!1;let o=n.intersect?aa(e,r,s,i,a):oa(e,r,s,!1,i,a);if(o.length>0){const l=o[0].datasetIndex,c=e.getDatasetMeta(l).data;o=[];for(let u=0;u<c.length;++u)o.push({element:c[u],datasetIndex:l,index:u})}return o},point(e,t,n,i){const r=Hn(t,e),s=n.axis||"xy",a=n.includeInvisible||!1;return aa(e,r,s,i,a)},nearest(e,t,n,i){const r=Hn(t,e),s=n.axis||"xy",a=n.includeInvisible||!1;return oa(e,r,s,n.intersect,i,a)},x(e,t,n,i){const r=Hn(t,e);return Dc(e,r,"x",n.intersect,i)},y(e,t,n,i){const r=Hn(t,e);return Dc(e,r,"y",n.intersect,i)}}};const vd=["left","top","right","bottom"];function ki(e,t){return e.filter(n=>n.pos===t)}function Ac(e,t){return e.filter(n=>vd.indexOf(n.pos)===-1&&n.box.axis===t)}function Fi(e,t){return e.sort((n,i)=>{const r=t?i:n,s=t?n:i;return r.weight===s.weight?r.index-s.index:r.weight-s.weight})}function Xb(e){const t=[];let n,i,r,s,a,o;for(n=0,i=(e||[]).length;n<i;++n)r=e[n],{position:s,options:{stack:a,stackWeight:o=1}}=r,t.push({index:n,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:a&&s+a,stackWeight:o});return t}function Qb(e){const t={};for(const n of e){const{stack:i,pos:r,stackWeight:s}=n;if(!i||!vd.includes(r))continue;const a=t[i]||(t[i]={count:0,placed:0,weight:0,size:0});a.count++,a.weight+=s}return t}function Zb(e,t){const n=Qb(e),{vBoxMaxWidth:i,hBoxMaxHeight:r}=t;let s,a,o;for(s=0,a=e.length;s<a;++s){o=e[s];const{fullSize:l}=o.box,c=n[o.stack],u=c&&o.stackWeight/c.weight;o.horizontal?(o.width=u?u*i:l&&t.availableWidth,o.height=r):(o.width=i,o.height=u?u*r:l&&t.availableHeight)}return n}function Jb(e){const t=Xb(e),n=Fi(t.filter(c=>c.box.fullSize),!0),i=Fi(ki(t,"left"),!0),r=Fi(ki(t,"right")),s=Fi(ki(t,"top"),!0),a=Fi(ki(t,"bottom")),o=Ac(t,"x"),l=Ac(t,"y");return{fullSize:n,leftAndTop:i.concat(s),rightAndBottom:r.concat(l).concat(a).concat(o),chartArea:ki(t,"chartArea"),vertical:i.concat(r).concat(l),horizontal:s.concat(a).concat(o)}}function Cc(e,t,n,i){return Math.max(e[n],t[n])+Math.max(e[i],t[i])}function md(e,t){e.top=Math.max(e.top,t.top),e.left=Math.max(e.left,t.left),e.bottom=Math.max(e.bottom,t.bottom),e.right=Math.max(e.right,t.right)}function qb(e,t,n,i){const{pos:r,box:s}=n,a=e.maxPadding;if(!_t(r)){n.size&&(e[r]-=n.size);const h=i[n.stack]||{size:0,count:1};h.size=Math.max(h.size,n.horizontal?s.height:s.width),n.size=h.size/h.count,e[r]+=n.size}s.getPadding&&md(a,s.getPadding());const o=Math.max(0,t.outerWidth-Cc(a,e,"left","right")),l=Math.max(0,t.outerHeight-Cc(a,e,"top","bottom")),c=o!==e.w,u=l!==e.h;return e.w=o,e.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}function tT(e){const t=e.maxPadding;function n(i){const r=Math.max(t[i]-e[i],0);return e[i]+=r,r}e.y+=n("top"),e.x+=n("left"),n("right"),n("bottom")}function eT(e,t){const n=t.maxPadding;function i(r){const s={left:0,top:0,right:0,bottom:0};return r.forEach(a=>{s[a]=Math.max(t[a],n[a])}),s}return i(e?["left","right"]:["top","bottom"])}function Ki(e,t,n,i){const r=[];let s,a,o,l,c,u;for(s=0,a=e.length,c=0;s<a;++s){o=e[s],l=o.box,l.update(o.width||t.w,o.height||t.h,eT(o.horizontal,t));const{same:h,other:d}=qb(t,n,o,i);c|=h&&r.length,u=u||d,l.fullSize||r.push(o)}return c&&Ki(r,t,n,i)||u}function Br(e,t,n,i,r){e.top=n,e.left=t,e.right=t+i,e.bottom=n+r,e.width=i,e.height=r}function Oc(e,t,n,i){const r=n.padding;let{x:s,y:a}=t;for(const o of e){const l=o.box,c=i[o.stack]||{count:1,placed:0,weight:1},u=o.stackWeight/c.weight||1;if(o.horizontal){const h=t.w*u,d=c.size||l.height;Le(c.start)&&(a=c.start),l.fullSize?Br(l,r.left,a,n.outerWidth-r.right-r.left,d):Br(l,t.left+c.placed,a,h,d),c.start=a,c.placed+=h,a=l.bottom}else{const h=t.h*u,d=c.size||l.width;Le(c.start)&&(s=c.start),l.fullSize?Br(l,s,r.top,d,n.outerHeight-r.bottom-r.top):Br(l,s,t.top+c.placed,d,h),c.start=s,c.placed+=h,s=l.right}}t.x=s,t.y=a}Lt.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}});var se={addBox(e,t){e.boxes||(e.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(n){t.draw(n)}}]},e.boxes.push(t)},removeBox(e,t){const n=e.boxes?e.boxes.indexOf(t):-1;n!==-1&&e.boxes.splice(n,1)},configure(e,t,n){t.fullSize=n.fullSize,t.position=n.position,t.weight=n.weight},update(e,t,n,i){if(!e)return;const r=ae(e.options.layout.padding),s=Math.max(t-r.width,0),a=Math.max(n-r.height,0),o=Jb(e.boxes),l=o.vertical,c=o.horizontal;Pt(e.boxes,L=>{typeof L.beforeLayout=="function"&&L.beforeLayout()});const u=l.reduce((L,_)=>_.box.options&&_.box.options.display===!1?L:L+1,0)||1,h=Object.freeze({outerWidth:t,outerHeight:n,padding:r,availableWidth:s,availableHeight:a,vBoxMaxWidth:s/2/u,hBoxMaxHeight:a/2}),d=Object.assign({},r);md(d,ae(i));const y=Object.assign({maxPadding:d,w:s,h:a,x:r.left,y:r.top},r),E=Zb(l.concat(c),h);Ki(o.fullSize,y,h,E),Ki(l,y,h,E),Ki(c,y,h,E)&&Ki(l,y,h,E),tT(y),Oc(o.leftAndTop,y,h,E),y.x+=y.w,y.y+=y.h,Oc(o.rightAndBottom,y,h,E),e.chartArea={left:y.left,top:y.top,right:y.left+y.w,bottom:y.top+y.h,height:y.h,width:y.w},Pt(o.chartArea,L=>{const _=L.box;Object.assign(_,e.chartArea),_.update(y.w,y.h,{left:0,top:0,right:0,bottom:0})})}};class pd{acquireContext(t,n){}releaseContext(t){return!1}addEventListener(t,n,i){}removeEventListener(t,n,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,n,i,r){return n=Math.max(0,n||t.width),i=i||t.height,{width:n,height:Math.max(0,r?Math.floor(n/r):i)}}isAttached(t){return!0}updateConfig(t){}}class nT extends pd{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}}const Xr="$chartjs",iT={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},Mc=e=>e===null||e==="";function rT(e,t){const n=e.style,i=e.getAttribute("height"),r=e.getAttribute("width");if(e[Xr]={initial:{height:i,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",Mc(r)){const s=lc(e,"width");s!==void 0&&(e.width=s)}if(Mc(i))if(e.style.height==="")e.height=e.width/(t||2);else{const s=lc(e,"height");s!==void 0&&(e.height=s)}return e}const yd=Nx?{passive:!0}:!1;function sT(e,t,n){e.addEventListener(t,n,yd)}function aT(e,t,n){e.canvas.removeEventListener(t,n,yd)}function oT(e,t){const n=iT[e.type]||e.type,{x:i,y:r}=Hn(e,t);return{type:n,chart:t,native:e,x:i!==void 0?i:null,y:r!==void 0?r:null}}function cs(e,t){for(const n of e)if(n===t||n.contains(t))return!0}function lT(e,t,n){const i=e.canvas,r=new MutationObserver(s=>{let a=!1;for(const o of s)a=a||cs(o.addedNodes,i),a=a&&!cs(o.removedNodes,i);a&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function cT(e,t,n){const i=e.canvas,r=new MutationObserver(s=>{let a=!1;for(const o of s)a=a||cs(o.removedNodes,i),a=a&&!cs(o.addedNodes,i);a&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const hr=new Map;let Pc=0;function Ed(){const e=window.devicePixelRatio;e!==Pc&&(Pc=e,hr.forEach((t,n)=>{n.currentDevicePixelRatio!==e&&t()}))}function uT(e,t){hr.size||window.addEventListener("resize",Ed),hr.set(e,t)}function fT(e){hr.delete(e),hr.size||window.removeEventListener("resize",Ed)}function dT(e,t,n){const i=e.canvas,r=i&&Mo(i);if(!r)return;const s=jf((o,l)=>{const c=r.clientWidth;n(o,l),c<r.clientWidth&&n()},window),a=new ResizeObserver(o=>{const l=o[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||s(c,u)});return a.observe(r),uT(e,s),a}function la(e,t,n){n&&n.disconnect(),t==="resize"&&fT(e)}function hT(e,t,n){const i=e.canvas,r=jf(s=>{e.ctx!==null&&n(oT(s,e))},e,s=>{const a=s[0];return[a,a.offsetX,a.offsetY]});return sT(i,t,r),r}class gT extends pd{acquireContext(t,n){const i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(rT(t,n),i):null}releaseContext(t){const n=t.canvas;if(!n[Xr])return!1;const i=n[Xr].initial;["height","width"].forEach(s=>{const a=i[s];At(a)?n.removeAttribute(s):n.setAttribute(s,a)});const r=i.style||{};return Object.keys(r).forEach(s=>{n.style[s]=r[s]}),n.width=n.width,delete n[Xr],!0}addEventListener(t,n,i){this.removeEventListener(t,n);const r=t.$proxies||(t.$proxies={}),a={attach:lT,detach:cT,resize:dT}[n]||hT;r[n]=a(t,n,i)}removeEventListener(t,n){const i=t.$proxies||(t.$proxies={}),r=i[n];if(!r)return;({attach:la,detach:la,resize:la}[n]||aT)(t,n,r),i[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,n,i,r){return Bx(t,n,i,r)}isAttached(t){const n=Mo(t);return!!(n&&n.isConnected)}}function vT(e){return!sd()||typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas?nT:gT}class mT{constructor(){this._init=[]}notify(t,n,i,r){n==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));const s=r?this._descriptors(t).filter(r):this._descriptors(t),a=this._notify(s,t,n,i);return n==="afterDestroy"&&(this._notify(s,t,"stop"),this._notify(this._init,t,"uninstall")),a}_notify(t,n,i,r){r=r||{};for(const s of t){const a=s.plugin,o=a[i],l=[n,r,s.options];if(Bt(o,l,a)===!1&&r.cancelable)return!1}return!0}invalidate(){At(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),n}_createDescriptors(t,n){const i=t&&t.config,r=xt(i.options&&i.options.plugins,{}),s=pT(i);return r===!1&&!n?[]:ET(t,s,r,n)}_notifyStateChanges(t){const n=this._oldCache||[],i=this._cache,r=(s,a)=>s.filter(o=>!a.some(l=>o.plugin.id===l.plugin.id));this._notify(r(n,i),t,"stop"),this._notify(r(i,n),t,"start")}}function pT(e){const t={},n=[],i=Object.keys($e.plugins.items);for(let s=0;s<i.length;s++)n.push($e.getPlugin(i[s]));const r=e.plugins||[];for(let s=0;s<r.length;s++){const a=r[s];n.indexOf(a)===-1&&(n.push(a),t[a.id]=!0)}return{plugins:n,localIds:t}}function yT(e,t){return!t&&e===!1?null:e===!0?{}:e}function ET(e,{plugins:t,localIds:n},i,r){const s=[],a=e.getContext();for(const o of t){const l=o.id,c=yT(i[l],r);c!==null&&s.push({plugin:o,options:xT(e.config,{plugin:o,local:n[l]},c,a)})}return s}function xT(e,{plugin:t,local:n},i,r){const s=e.pluginScopeKeys(t),a=e.getOptionScopes(i,s);return n&&t.defaults&&a.push(t.defaults),e.createResolver(a,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function wa(e,t){const n=Lt.datasets[e]||{};return((t.datasets||{})[e]||{}).indexAxis||t.indexAxis||n.indexAxis||"x"}function bT(e,t){let n=e;return e==="_index_"?n=t:e==="_value_"&&(n=t==="x"?"y":"x"),n}function TT(e,t){return e===t?"_index_":"_value_"}function _T(e){if(e==="top"||e==="bottom")return"x";if(e==="left"||e==="right")return"y"}function ka(e,t){return e==="x"||e==="y"?e:t.axis||_T(t.position)||e.charAt(0).toLowerCase()}function ST(e,t){const n=Jn[e.type]||{scales:{}},i=t.scales||{},r=wa(e.type,t),s=Object.create(null),a=Object.create(null);return Object.keys(i).forEach(o=>{const l=i[o];if(!_t(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=ka(o,l),u=TT(c,r),h=n.scales||{};s[c]=s[c]||o,a[o]=Gi(Object.create(null),[{axis:c},l,h[c],h[u]])}),e.data.datasets.forEach(o=>{const l=o.type||e.type,c=o.indexAxis||wa(l,t),h=(Jn[l]||{}).scales||{};Object.keys(h).forEach(d=>{const y=bT(d,c),E=o[y+"AxisID"]||s[y]||y;a[E]=a[E]||Object.create(null),Gi(a[E],[{axis:y},i[E],h[d]])})}),Object.keys(a).forEach(o=>{const l=a[o];Gi(l,[Lt.scales[l.type],Lt.scale])}),a}function xd(e){const t=e.options||(e.options={});t.plugins=xt(t.plugins,{}),t.scales=ST(e,t)}function bd(e){return e=e||{},e.datasets=e.datasets||[],e.labels=e.labels||[],e}function LT(e){return e=e||{},e.data=bd(e.data),xd(e),e}const Rc=new Map,Td=new Set;function Nr(e,t){let n=Rc.get(e);return n||(n=t(),Rc.set(e,n),Td.add(n)),n}const Bi=(e,t,n)=>{const i=Cn(t,n);i!==void 0&&e.add(i)};class DT{constructor(t){this._config=LT(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=bd(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){const t=this._config;this.clearCache(),xd(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Nr(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,n){return Nr(`${t}.transition.${n}`,()=>[[`datasets.${t}.transitions.${n}`,`transitions.${n}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,n){return Nr(`${t}-${n}`,()=>[[`datasets.${t}.elements.${n}`,`datasets.${t}`,`elements.${n}`,""]])}pluginScopeKeys(t){const n=t.id,i=this.type;return Nr(`${i}-plugin-${n}`,()=>[[`plugins.${n}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,n){const i=this._scopeCache;let r=i.get(t);return(!r||n)&&(r=new Map,i.set(t,r)),r}getOptionScopes(t,n,i){const{options:r,type:s}=this,a=this._cachedScopes(t,i),o=a.get(n);if(o)return o;const l=new Set;n.forEach(u=>{t&&(l.add(t),u.forEach(h=>Bi(l,t,h))),u.forEach(h=>Bi(l,r,h)),u.forEach(h=>Bi(l,Jn[s]||{},h)),u.forEach(h=>Bi(l,Lt,h)),u.forEach(h=>Bi(l,Pa,h))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),Td.has(n)&&a.set(n,c),c}chartOptionScopes(){const{options:t,type:n}=this;return[t,Jn[n]||{},Lt.datasets[n]||{},{type:n},Lt,Pa]}resolveNamedOptions(t,n,i,r=[""]){const s={$shared:!0},{resolver:a,subPrefixes:o}=Ic(this._resolverCache,t,r);let l=a;if(CT(a,n)){s.$shared=!1,i=On(i)?i():i;const c=this.createResolver(t,i,o);l=bi(a,i,c)}for(const c of n)s[c]=l[c];return s}createResolver(t,n,i=[""],r){const{resolver:s}=Ic(this._resolverCache,t,i);return _t(n)?bi(s,n,void 0,r):s}}function Ic(e,t,n){let i=e.get(t);i||(i=new Map,e.set(t,i));const r=n.join();let s=i.get(r);return s||(s={resolver:Ao(t,n),subPrefixes:n.filter(o=>!o.toLowerCase().includes("hover"))},i.set(r,s)),s}const AT=e=>_t(e)&&Object.getOwnPropertyNames(e).reduce((t,n)=>t||On(e[n]),!1);function CT(e,t){const{isScriptable:n,isIndexable:i}=qf(e);for(const r of t){const s=n(r),a=i(r),o=(a||s)&&e[r];if(s&&(On(o)||AT(o))||a&&Nt(o))return!0}return!1}var OT="3.9.1";const MT=["top","bottom","left","right","chartArea"];function wc(e,t){return e==="top"||e==="bottom"||MT.indexOf(e)===-1&&t==="x"}function kc(e,t){return function(n,i){return n[e]===i[e]?n[t]-i[t]:n[e]-i[e]}}function Fc(e){const t=e.chart,n=t.options.animation;t.notifyPlugins("afterRender"),Bt(n&&n.onComplete,[e],t)}function PT(e){const t=e.chart,n=t.options.animation;Bt(n&&n.onProgress,[e],t)}function _d(e){return sd()&&typeof e=="string"?e=document.getElementById(e):e&&e.length&&(e=e[0]),e&&e.canvas&&(e=e.canvas),e}const us={},Sd=e=>{const t=_d(e);return Object.values(us).filter(n=>n.canvas===t).pop()};function RT(e,t,n){const i=Object.keys(e);for(const r of i){const s=+r;if(s>=t){const a=e[r];delete e[r],(n>0||s>t)&&(e[s+n]=a)}}}function IT(e,t,n,i){return!n||e.type==="mouseout"?null:i?t:e}class Ve{constructor(t,n){const i=this.config=new DT(n),r=_d(t),s=Sd(r);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const a=i.createResolver(i.chartOptionScopes(),this.getContext());this.platform=new(i.platform||vT(r)),this.platform.updateConfig(i);const o=this.platform.acquireContext(r,a.aspectRatio),l=o&&o.canvas,c=l&&l.height,u=l&&l.width;if(this.id=yE(),this.ctx=o,this.canvas=l,this.width=u,this.height=c,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new mT,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=wE(h=>this.update(h),a.resizeDelay||0),this._dataChanges=[],us[this.id]=this,!o||!l){console.error("Failed to create chart: can't acquire context from the given item");return}en.listen(this,"complete",Fc),en.listen(this,"progress",PT),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:t,maintainAspectRatio:n},width:i,height:r,_aspectRatio:s}=this;return At(t)?n&&s?s:r?i/r:null:t}get data(){return this.config.data}set data(t){this.config.data=t}get options(){return this._options}set options(t){this.config.options=t}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():oc(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return rc(this.canvas,this.ctx),this}stop(){return en.stop(this),this}resize(t,n){en.running(this)?this._resizeBeforeDraw={width:t,height:n}:this._resize(t,n)}_resize(t,n){const i=this.options,r=this.canvas,s=i.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(r,t,n,s),o=i.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,oc(this,o,!0)&&(this.notifyPlugins("resize",{size:a}),Bt(i.onResize,[this,a],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Pt(n,(i,r)=>{i.id=r})}buildOrUpdateScales(){const t=this.options,n=t.scales,i=this.scales,r=Object.keys(i).reduce((a,o)=>(a[o]=!1,a),{});let s=[];n&&(s=s.concat(Object.keys(n).map(a=>{const o=n[a],l=ka(a,o),c=l==="r",u=l==="x";return{options:o,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),Pt(s,a=>{const o=a.options,l=o.id,c=ka(l,o),u=xt(o.type,a.dtype);(o.position===void 0||wc(o.position,c)!==wc(a.dposition))&&(o.position=a.dposition),r[l]=!0;let h=null;if(l in i&&i[l].type===u)h=i[l];else{const d=$e.getScale(u);h=new d({id:l,type:u,ctx:this.ctx,chart:this}),i[h.id]=h}h.init(o,t)}),Pt(r,(a,o)=>{a||delete i[o]}),Pt(i,a=>{se.configure(this,a,a.options),se.addBox(this,a)})}_updateMetasets(){const t=this._metasets,n=this.data.datasets.length,i=t.length;if(t.sort((r,s)=>r.index-s.index),i>n){for(let r=n;r<i;++r)this._destroyDatasetMeta(r);t.splice(n,i-n)}this._sortedMetasets=t.slice(0).sort(kc("order","index"))}_removeUnreferencedMetasets(){const{_metasets:t,data:{datasets:n}}=this;t.length>n.length&&delete this._stacks,t.forEach((i,r)=>{n.filter(s=>s===i._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const t=[],n=this.data.datasets;let i,r;for(this._removeUnreferencedMetasets(),i=0,r=n.length;i<r;i++){const s=n[i];let a=this.getDatasetMeta(i);const o=s.type||this.config.type;if(a.type&&a.type!==o&&(this._destroyDatasetMeta(i),a=this.getDatasetMeta(i)),a.type=o,a.indexAxis=s.indexAxis||wa(o,this.options),a.order=s.order||0,a.index=i,a.label=""+s.label,a.visible=this.isDatasetVisible(i),a.controller)a.controller.updateIndex(i),a.controller.linkScales();else{const l=$e.getController(o),{datasetElementType:c,dataElementType:u}=Lt.datasets[o];Object.assign(l.prototype,{dataElementType:$e.getElement(u),datasetElementType:c&&$e.getElement(c)}),a.controller=new l(this,i),t.push(a.controller)}}return this._updateMetasets(),t}_resetElements(){Pt(this.data.datasets,(t,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(t){const n=this.config;n.update();const i=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!i.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:t,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:h}=this.getDatasetMeta(c),d=!r&&s.indexOf(h)===-1;h.buildOrUpdateElements(d),a=Math.max(+h.getMaxOverflow(),a)}a=this._minPadding=i.layout.autoPadding?a:0,this._updateLayout(a),r||Pt(s,c=>{c.reset()}),this._updateDatasets(t),this.notifyPlugins("afterUpdate",{mode:t}),this._layers.sort(kc("z","_idx"));const{_active:o,_lastEvent:l}=this;l?this._eventHandler(l,!0):o.length&&this._updateHoverStyles(o,o,!0),this.render()}_updateScales(){Pt(this.scales,t=>{se.removeBox(this,t)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const t=this.options,n=new Set(Object.keys(this._listeners)),i=new Set(t.events);(!Gl(n,i)||!!this._responsiveListeners!==t.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:t}=this,n=this._getUniformDataChanges()||[];for(const{method:i,start:r,count:s}of n){const a=i==="_removeElements"?-s:s;RT(t,r,a)}}_getUniformDataChanges(){const t=this._dataChanges;if(!t||!t.length)return;this._dataChanges=[];const n=this.data.datasets.length,i=s=>new Set(t.filter(a=>a[0]===s).map((a,o)=>o+","+a.splice(1).join(","))),r=i(0);for(let s=1;s<n;s++)if(!Gl(r,i(s)))return;return Array.from(r).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(t){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;se.update(this,this.width,this.height,t);const n=this.chartArea,i=n.width<=0||n.height<=0;this._layers=[],Pt(this.boxes,r=>{i&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,s)=>{r._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(t){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:t,cancelable:!0})!==!1){for(let n=0,i=this.data.datasets.length;n<i;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,i=this.data.datasets.length;n<i;++n)this._updateDataset(n,On(t)?t({datasetIndex:n}):t);this.notifyPlugins("afterDatasetsUpdate",{mode:t})}}_updateDataset(t,n){const i=this.getDatasetMeta(t),r={meta:i,index:t,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(i.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(en.has(this)?this.attached&&!en.running(this)&&en.start(this):(this.draw(),Fc({chart:this})))}draw(){let t;if(this._resizeBeforeDraw){const{width:i,height:r}=this._resizeBeforeDraw;this._resize(i,r),this._resizeBeforeDraw=null}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(t=0;t<n.length&&n[t].z<=0;++t)n[t].draw(this.chartArea);for(this._drawDatasets();t<n.length;++t)n[t].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(t){const n=this._sortedMetasets,i=[];let r,s;for(r=0,s=n.length;r<s;++r){const a=n[r];(!t||a.visible)&&i.push(a)}return i}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const t=this.getSortedVisibleDatasetMetas();for(let n=t.length-1;n>=0;--n)this._drawDataset(t[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(t){const n=this.ctx,i=t._clip,r=!i.disabled,s=this.chartArea,a={meta:t,index:t.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",a)!==!1&&(r&&Ds(n,{left:i.left===!1?0:s.left-i.left,right:i.right===!1?this.width:s.right+i.right,top:i.top===!1?0:s.top-i.top,bottom:i.bottom===!1?this.height:s.bottom+i.bottom}),t.controller.draw(),r&&As(n),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(t){return fr(t,this.chartArea,this._minPadding)}getElementsAtEventForMode(t,n,i,r){const s=Yb.modes[n];return typeof s=="function"?s(this,t,i,r):[]}getDatasetMeta(t){const n=this.data.datasets[t],i=this._metasets;let r=i.filter(s=>s&&s._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:t,_dataset:n,_parsed:[],_sorted:!1},i.push(r)),r}getContext(){return this.$context||(this.$context=Mn(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(t){const n=this.data.datasets[t];if(!n)return!1;const i=this.getDatasetMeta(t);return typeof i.hidden=="boolean"?!i.hidden:!n.hidden}setDatasetVisibility(t,n){const i=this.getDatasetMeta(t);i.hidden=!n}toggleDataVisibility(t){this._hiddenIndices[t]=!this._hiddenIndices[t]}getDataVisibility(t){return!this._hiddenIndices[t]}_updateVisibility(t,n,i){const r=i?"show":"hide",s=this.getDatasetMeta(t),a=s.controller._resolveAnimations(void 0,r);Le(n)?(s.data[n].hidden=!i,this.update()):(this.setDatasetVisibility(t,i),a.update(s,{visible:i}),this.update(o=>o.datasetIndex===t?r:void 0))}hide(t,n){this._updateVisibility(t,n,!1)}show(t,n){this._updateVisibility(t,n,!0)}_destroyDatasetMeta(t){const n=this._metasets[t];n&&n.controller&&n.controller._destroy(),delete this._metasets[t]}_stop(){let t,n;for(this.stop(),en.remove(this),t=0,n=this.data.datasets.length;t<n;++t)this._destroyDatasetMeta(t)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:t,ctx:n}=this;this._stop(),this.config.clearCache(),t&&(this.unbindEvents(),rc(t,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),this.notifyPlugins("destroy"),delete us[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...t){return this.canvas.toDataURL(...t)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const t=this._listeners,n=this.platform,i=(s,a)=>{n.addEventListener(this,s,a),t[s]=a},r=(s,a,o)=>{s.offsetX=a,s.offsetY=o,this._eventHandler(s)};Pt(this.options.events,s=>i(s,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const t=this._responsiveListeners,n=this.platform,i=(l,c)=>{n.addEventListener(this,l,c),t[l]=c},r=(l,c)=>{t[l]&&(n.removeEventListener(this,l,c),delete t[l])},s=(l,c)=>{this.canvas&&this.resize(l,c)};let a;const o=()=>{r("attach",o),this.attached=!0,this.resize(),i("resize",s),i("detach",a)};a=()=>{this.attached=!1,r("resize",s),this._stop(),this._resize(0,0),i("attach",o)},n.isAttached(this.canvas)?o():a()}unbindEvents(){Pt(this._listeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._listeners={},Pt(this._responsiveListeners,(t,n)=>{this.platform.removeEventListener(this,n,t)}),this._responsiveListeners=void 0}updateHoverStyle(t,n,i){const r=i?"set":"remove";let s,a,o,l;for(n==="dataset"&&(s=this.getDatasetMeta(t[0].datasetIndex),s.controller["_"+r+"DatasetHoverStyle"]()),o=0,l=t.length;o<l;++o){a=t[o];const c=a&&this.getDatasetMeta(a.datasetIndex).controller;c&&c[r+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(t){const n=this._active||[],i=t.map(({datasetIndex:s,index:a})=>{const o=this.getDatasetMeta(s);if(!o)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:o.data[a],index:a}});!is(i,n)&&(this._active=i,this._lastEvent=null,this._updateHoverStyles(i,n))}notifyPlugins(t,n,i){return this._plugins.notify(this,t,n,i)}_updateHoverStyles(t,n,i){const r=this.options.hover,s=(l,c)=>l.filter(u=>!c.some(h=>u.datasetIndex===h.datasetIndex&&u.index===h.index)),a=s(n,t),o=i?t:s(t,n);a.length&&this.updateHoverStyle(a,r.mode,!1),o.length&&r.mode&&this.updateHoverStyle(o,r.mode,!0)}_eventHandler(t,n){const i={event:t,replay:n,cancelable:!0,inChartArea:this.isPointInArea(t)},r=a=>(a.options.events||this.options.events).includes(t.native.type);if(this.notifyPlugins("beforeEvent",i,r)===!1)return;const s=this._handleEvent(t,n,i.inChartArea);return i.cancelable=!1,this.notifyPlugins("afterEvent",i,r),(s||i.changed)&&this.render(),this}_handleEvent(t,n,i){const{_active:r=[],options:s}=this,a=n,o=this._getActiveElements(t,r,i,a),l=SE(t),c=IT(t,this._lastEvent,i,l);i&&(this._lastEvent=null,Bt(s.onHover,[t,o,this],this),l&&Bt(s.onClick,[t,o,this],this));const u=!is(o,r);return(u||n)&&(this._active=o,this._updateHoverStyles(o,r,n)),this._lastEvent=c,u}_getActiveElements(t,n,i,r){if(t.type==="mouseout")return[];if(!i)return n;const s=this.options.hover;return this.getElementsAtEventForMode(t,s.mode,s,r)}}const Bc=()=>Pt(Ve.instances,e=>e._plugins.invalidate()),vn=!0;Object.defineProperties(Ve,{defaults:{enumerable:vn,value:Lt},instances:{enumerable:vn,value:us},overrides:{enumerable:vn,value:Jn},registry:{enumerable:vn,value:$e},version:{enumerable:vn,value:OT},getChart:{enumerable:vn,value:Sd},register:{enumerable:vn,value:(...e)=>{$e.add(...e),Bc()}},unregister:{enumerable:vn,value:(...e)=>{$e.remove(...e),Bc()}}});function Ld(e,t,n){const{startAngle:i,pixelMargin:r,x:s,y:a,outerRadius:o,innerRadius:l}=t;let c=r/o;e.beginPath(),e.arc(s,a,o,i-c,n+c),l>r?(c=r/l,e.arc(s,a,l,n+c,i-c,!0)):e.arc(s,a,r,n+Vt,i-Vt),e.closePath(),e.clip()}function wT(e){return Do(e,["outerStart","outerEnd","innerStart","innerEnd"])}function kT(e,t,n,i){const r=wT(e.options.borderRadius),s=(n-t)/2,a=Math.min(s,i*t/2),o=l=>{const c=(n-Math.min(s,l))*i/2;return Qt(l,0,Math.min(s,c))};return{outerStart:o(r.outerStart),outerEnd:o(r.outerEnd),innerStart:Qt(r.innerStart,0,a),innerEnd:Qt(r.innerEnd,0,a)}}function ai(e,t,n,i){return{x:n+e*Math.cos(t),y:i+e*Math.sin(t)}}function Fa(e,t,n,i,r,s){const{x:a,y:o,startAngle:l,pixelMargin:c,innerRadius:u}=t,h=Math.max(t.outerRadius+i+n-c,0),d=u>0?u+i+n+c:0;let y=0;const E=r-l;if(i){const O=u>0?u-i:0,R=h>0?h-i:0,I=(O+R)/2,w=I!==0?E*I/(I+i):E;y=(E-w)/2}const L=Math.max(.001,E*h-n/Kt)/h,_=(E-L)/2,A=l+_+y,v=r-_-y,{outerStart:f,outerEnd:x,innerStart:S,innerEnd:C}=kT(t,d,h,v-A),p=h-f,g=h-x,m=A+f/p,D=v-x/g,b=d+S,T=d+C,P=A+S/b,M=v-C/T;if(e.beginPath(),s){if(e.arc(a,o,h,m,D),x>0){const I=ai(g,D,a,o);e.arc(I.x,I.y,x,D,v+Vt)}const O=ai(T,v,a,o);if(e.lineTo(O.x,O.y),C>0){const I=ai(T,M,a,o);e.arc(I.x,I.y,C,v+Vt,M+Math.PI)}if(e.arc(a,o,d,v-C/d,A+S/d,!0),S>0){const I=ai(b,P,a,o);e.arc(I.x,I.y,S,P+Math.PI,A-Vt)}const R=ai(p,A,a,o);if(e.lineTo(R.x,R.y),f>0){const I=ai(p,m,a,o);e.arc(I.x,I.y,f,A-Vt,m)}}else{e.moveTo(a,o);const O=Math.cos(m)*h+a,R=Math.sin(m)*h+o;e.lineTo(O,R);const I=Math.cos(D)*h+a,w=Math.sin(D)*h+o;e.lineTo(I,w)}e.closePath()}function FT(e,t,n,i,r){const{fullCircles:s,startAngle:a,circumference:o}=t;let l=t.endAngle;if(s){Fa(e,t,n,i,a+wt,r);for(let c=0;c<s;++c)e.fill();isNaN(o)||(l=a+o%wt,o%wt===0&&(l+=wt))}return Fa(e,t,n,i,l,r),e.fill(),l}function BT(e,t,n){const{x:i,y:r,startAngle:s,pixelMargin:a,fullCircles:o}=t,l=Math.max(t.outerRadius-a,0),c=t.innerRadius+a;let u;for(n&&Ld(e,t,s+wt),e.beginPath(),e.arc(i,r,c,s+wt,s,!0),u=0;u<o;++u)e.stroke();for(e.beginPath(),e.arc(i,r,l,s,s+wt),u=0;u<o;++u)e.stroke()}function NT(e,t,n,i,r,s){const{options:a}=t,{borderWidth:o,borderJoinStyle:l}=a,c=a.borderAlign==="inner";!o||(c?(e.lineWidth=o*2,e.lineJoin=l||"round"):(e.lineWidth=o,e.lineJoin=l||"bevel"),t.fullCircles&&BT(e,t,c),c&&Ld(e,t,r),Fa(e,t,n,i,r,s),e.stroke())}class Fs extends Be{constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,n,i){const r=this.getProps(["x","y"],i),{angle:s,distance:a}=Uf(r,{x:t,y:n}),{startAngle:o,endAngle:l,innerRadius:c,outerRadius:u,circumference:h}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),d=this.options.spacing/2,E=xt(h,l-o)>=wt||ur(s,o,l),L=an(a,c+d,u+d);return E&&L}getCenterPoint(t){const{x:n,y:i,startAngle:r,endAngle:s,innerRadius:a,outerRadius:o}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius","circumference"],t),{offset:l,spacing:c}=this.options,u=(r+s)/2,h=(a+o+c+l)/2;return{x:n+Math.cos(u)*h,y:i+Math.sin(u)*h}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:n,circumference:i}=this,r=(n.offset||0)/2,s=(n.spacing||0)/2,a=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=i>wt?Math.floor(i/wt):0,i===0||this.innerRadius<0||this.outerRadius<0)return;t.save();let o=0;if(r){o=r/2;const c=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(c)*o,Math.sin(c)*o),this.circumference>=Kt&&(o=r)}t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor;const l=FT(t,this,o,s,a);NT(t,this,o,s,l,a),t.restore()}}Fs.id="arc";Fs.defaults={borderAlign:"center",borderColor:"#fff",borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};Fs.defaultRoutes={backgroundColor:"backgroundColor"};function Dd(e,t,n=t){e.lineCap=xt(n.borderCapStyle,t.borderCapStyle),e.setLineDash(xt(n.borderDash,t.borderDash)),e.lineDashOffset=xt(n.borderDashOffset,t.borderDashOffset),e.lineJoin=xt(n.borderJoinStyle,t.borderJoinStyle),e.lineWidth=xt(n.borderWidth,t.borderWidth),e.strokeStyle=xt(n.borderColor,t.borderColor)}function UT(e,t,n){e.lineTo(n.x,n.y)}function WT(e){return e.stepped?ox:e.tension||e.cubicInterpolationMode==="monotone"?lx:UT}function Ad(e,t,n={}){const i=e.length,{start:r=0,end:s=i-1}=n,{start:a,end:o}=t,l=Math.max(r,a),c=Math.min(s,o),u=r<a&&s<a||r>o&&s>o;return{count:i,start:l,loop:t.loop,ilen:c<l&&!u?i+c-l:c-l}}function KT(e,t,n,i){const{points:r,options:s}=t,{count:a,start:o,loop:l,ilen:c}=Ad(r,n,i),u=WT(s);let{move:h=!0,reverse:d}=i||{},y,E,L;for(y=0;y<=c;++y)E=r[(o+(d?c-y:y))%a],!E.skip&&(h?(e.moveTo(E.x,E.y),h=!1):u(e,L,E,d,s.stepped),L=E);return l&&(E=r[(o+(d?c:0))%a],u(e,L,E,d,s.stepped)),!!l}function HT(e,t,n,i){const r=t.points,{count:s,start:a,ilen:o}=Ad(r,n,i),{move:l=!0,reverse:c}=i||{};let u=0,h=0,d,y,E,L,_,A;const v=x=>(a+(c?o-x:x))%s,f=()=>{L!==_&&(e.lineTo(u,_),e.lineTo(u,L),e.lineTo(u,A))};for(l&&(y=r[v(0)],e.moveTo(y.x,y.y)),d=0;d<=o;++d){if(y=r[v(d)],y.skip)continue;const x=y.x,S=y.y,C=x|0;C===E?(S<L?L=S:S>_&&(_=S),u=(h*u+x)/++h):(f(),e.lineTo(x,S),E=C,h=0,L=_=S),A=S}f()}function Ba(e){const t=e.options,n=t.borderDash&&t.borderDash.length;return!e._decimated&&!e._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!n?HT:KT}function jT(e){return e.stepped?Ux:e.tension||e.cubicInterpolationMode==="monotone"?Wx:jn}function VT(e,t,n,i){let r=t._path;r||(r=t._path=new Path2D,t.path(r,n,i)&&r.closePath()),Dd(e,t.options),e.stroke(r)}function $T(e,t,n,i){const{segments:r,options:s}=t,a=Ba(t);for(const o of r)Dd(e,s,o.style),e.beginPath(),a(e,t,o,{start:n,end:n+i-1})&&e.closePath(),e.stroke()}const GT=typeof Path2D=="function";function zT(e,t,n,i){GT&&!t.options.segment?VT(e,t,n,i):$T(e,t,n,i)}class Pn extends Be{constructor(t){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,t&&Object.assign(this,t)}updateControlPoints(t,n){const i=this.options;if((i.tension||i.cubicInterpolationMode==="monotone")&&!i.stepped&&!this._pointsUpdated){const r=i.spanGaps?this._loop:this._fullLoop;Px(this._points,i,t,r,n),this._pointsUpdated=!0}}set points(t){this._points=t,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=zx(this,this.options.segment))}first(){const t=this.segments,n=this.points;return t.length&&n[t[0].start]}last(){const t=this.segments,n=this.points,i=t.length;return i&&n[t[i-1].end]}interpolate(t,n){const i=this.options,r=t[n],s=this.points,a=ud(this,{property:n,start:r,end:r});if(!a.length)return;const o=[],l=jT(i);let c,u;for(c=0,u=a.length;c<u;++c){const{start:h,end:d}=a[c],y=s[h],E=s[d];if(y===E){o.push(y);continue}const L=Math.abs((r-y[n])/(E[n]-y[n])),_=l(y,E,L,i.stepped);_[n]=t[n],o.push(_)}return o.length===1?o[0]:o}pathSegment(t,n,i){return Ba(this)(t,this,n,i)}path(t,n,i){const r=this.segments,s=Ba(this);let a=this._loop;n=n||0,i=i||this.points.length-n;for(const o of r)a&=s(t,this,o,{start:n,end:n+i-1});return!!a}draw(t,n,i,r){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(t.save(),zT(t,this,i,r),t.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Pn.id="line";Pn.defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};Pn.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};Pn.descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};function Nc(e,t,n,i){const r=e.options,{[n]:s}=e.getProps([n],i);return Math.abs(t-s)<r.radius+r.hitRadius}class Bs extends Be{constructor(t){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,n,i){const r=this.options,{x:s,y:a}=this.getProps(["x","y"],i);return Math.pow(t-s,2)+Math.pow(n-a,2)<Math.pow(r.hitRadius+r.radius,2)}inXRange(t,n){return Nc(this,t,"x",n)}inYRange(t,n){return Nc(this,t,"y",n)}getCenterPoint(t){const{x:n,y:i}=this.getProps(["x","y"],t);return{x:n,y:i}}size(t){t=t||this.options||{};let n=t.radius||0;n=Math.max(n,n&&t.hoverRadius||0);const i=n&&t.borderWidth||0;return(n+i)*2}draw(t,n){const i=this.options;this.skip||i.radius<.1||!fr(this,n,this.size(i)/2)||(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,Ra(t,i,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}Bs.id="point";Bs.defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};Bs.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};function Cd(e,t){const{x:n,y:i,base:r,width:s,height:a}=e.getProps(["x","y","base","width","height"],t);let o,l,c,u,h;return e.horizontal?(h=a/2,o=Math.min(n,r),l=Math.max(n,r),c=i-h,u=i+h):(h=s/2,o=n-h,l=n+h,c=Math.min(i,r),u=Math.max(i,r)),{left:o,top:c,right:l,bottom:u}}function bn(e,t,n,i){return e?0:Qt(t,n,i)}function YT(e,t,n){const i=e.options.borderWidth,r=e.borderSkipped,s=Jf(i);return{t:bn(r.top,s.top,0,n),r:bn(r.right,s.right,0,t),b:bn(r.bottom,s.bottom,0,n),l:bn(r.left,s.left,0,t)}}function XT(e,t,n){const{enableBorderRadius:i}=e.getProps(["enableBorderRadius"]),r=e.options.borderRadius,s=Qn(r),a=Math.min(t,n),o=e.borderSkipped,l=i||_t(r);return{topLeft:bn(!l||o.top||o.left,s.topLeft,0,a),topRight:bn(!l||o.top||o.right,s.topRight,0,a),bottomLeft:bn(!l||o.bottom||o.left,s.bottomLeft,0,a),bottomRight:bn(!l||o.bottom||o.right,s.bottomRight,0,a)}}function QT(e){const t=Cd(e),n=t.right-t.left,i=t.bottom-t.top,r=YT(e,n/2,i/2),s=XT(e,n/2,i/2);return{outer:{x:t.left,y:t.top,w:n,h:i,radius:s},inner:{x:t.left+r.l,y:t.top+r.t,w:n-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}function ca(e,t,n,i){const r=t===null,s=n===null,o=e&&!(r&&s)&&Cd(e,i);return o&&(r||an(t,o.left,o.right))&&(s||an(n,o.top,o.bottom))}function ZT(e){return e.topLeft||e.topRight||e.bottomLeft||e.bottomRight}function JT(e,t){e.rect(t.x,t.y,t.w,t.h)}function ua(e,t,n={}){const i=e.x!==n.x?-t:0,r=e.y!==n.y?-t:0,s=(e.x+e.w!==n.x+n.w?t:0)-i,a=(e.y+e.h!==n.y+n.h?t:0)-r;return{x:e.x+i,y:e.y+r,w:e.w+s,h:e.h+a,radius:e.radius}}class Ns extends Be{constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){const{inflateAmount:n,options:{borderColor:i,backgroundColor:r}}=this,{inner:s,outer:a}=QT(this),o=ZT(a.radius)?dr:JT;t.save(),(a.w!==s.w||a.h!==s.h)&&(t.beginPath(),o(t,ua(a,n,s)),t.clip(),o(t,ua(s,-n,a)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),o(t,ua(s,n)),t.fillStyle=r,t.fill(),t.restore()}inRange(t,n,i){return ca(this,t,n,i)}inXRange(t,n){return ca(this,t,null,n)}inYRange(t,n){return ca(this,null,t,n)}getCenterPoint(t){const{x:n,y:i,base:r,horizontal:s}=this.getProps(["x","y","base","horizontal"],t);return{x:s?(n+r)/2:n,y:s?i:(i+r)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}}Ns.id="bar";Ns.defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};Ns.defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};var qT=Object.freeze({__proto__:null,ArcElement:Fs,LineElement:Pn,PointElement:Bs,BarElement:Ns});function t_(e,t,n,i,r){const s=r.samples||i;if(s>=n)return e.slice(t,t+n);const a=[],o=(n-2)/(s-2);let l=0;const c=t+n-1;let u=t,h,d,y,E,L;for(a[l++]=e[u],h=0;h<s-2;h++){let _=0,A=0,v;const f=Math.floor((h+1)*o)+1+t,x=Math.min(Math.floor((h+2)*o)+1,n)+t,S=x-f;for(v=f;v<x;v++)_+=e[v].x,A+=e[v].y;_/=S,A/=S;const C=Math.floor(h*o)+1+t,p=Math.min(Math.floor((h+1)*o)+1,n)+t,{x:g,y:m}=e[u];for(y=E=-1,v=C;v<p;v++)E=.5*Math.abs((g-_)*(e[v].y-m)-(g-e[v].x)*(A-m)),E>y&&(y=E,d=e[v],L=v);a[l++]=d,u=L}return a[l++]=e[c],a}function e_(e,t,n,i){let r=0,s=0,a,o,l,c,u,h,d,y,E,L;const _=[],A=t+n-1,v=e[t].x,x=e[A].x-v;for(a=t;a<t+n;++a){o=e[a],l=(o.x-v)/x*i,c=o.y;const S=l|0;if(S===u)c<E?(E=c,h=a):c>L&&(L=c,d=a),r=(s*r+o.x)/++s;else{const C=a-1;if(!At(h)&&!At(d)){const p=Math.min(h,d),g=Math.max(h,d);p!==y&&p!==C&&_.push({...e[p],x:r}),g!==y&&g!==C&&_.push({...e[g],x:r})}a>0&&C!==y&&_.push(e[C]),_.push(o),u=S,s=0,E=L=c,h=d=y=a}}return _}function Od(e){if(e._decimated){const t=e._data;delete e._decimated,delete e._data,Object.defineProperty(e,"data",{value:t})}}function Uc(e){e.data.datasets.forEach(t=>{Od(t)})}function n_(e,t){const n=t.length;let i=0,r;const{iScale:s}=e,{min:a,max:o,minDefined:l,maxDefined:c}=s.getUserBounds();return l&&(i=Qt(on(t,s.axis,a).lo,0,n-1)),c?r=Qt(on(t,s.axis,o).hi+1,i,n)-i:r=n-i,{start:i,count:r}}var i_={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(e,t,n)=>{if(!n.enabled){Uc(e);return}const i=e.width;e.data.datasets.forEach((r,s)=>{const{_data:a,indexAxis:o}=r,l=e.getDatasetMeta(s),c=a||r.data;if(Wi([o,e.options.indexAxis])==="y"||!l.controller.supportsDecimation)return;const u=e.scales[l.xAxisID];if(u.type!=="linear"&&u.type!=="time"||e.options.parsing)return;let{start:h,count:d}=n_(l,c);const y=n.threshold||4*i;if(d<=y){Od(r);return}At(a)&&(r._data=c,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(L){this._data=L}}));let E;switch(n.algorithm){case"lttb":E=t_(c,h,d,i,n);break;case"min-max":E=e_(c,h,d,i);break;default:throw new Error(`Unsupported decimation algorithm '${n.algorithm}'`)}r._decimated=E})},destroy(e){Uc(e)}};function r_(e,t,n){const i=e.segments,r=e.points,s=t.points,a=[];for(const o of i){let{start:l,end:c}=o;c=Ro(l,c,r);const u=Na(n,r[l],r[c],o.loop);if(!t.segments){a.push({source:o,target:u,start:r[l],end:r[c]});continue}const h=ud(t,u);for(const d of h){const y=Na(n,s[d.start],s[d.end],d.loop),E=cd(o,r,y);for(const L of E)a.push({source:L,target:d,start:{[n]:Wc(u,y,"start",Math.max)},end:{[n]:Wc(u,y,"end",Math.min)}})}}return a}function Na(e,t,n,i){if(i)return;let r=t[e],s=n[e];return e==="angle"&&(r=he(r),s=he(s)),{property:e,start:r,end:s}}function s_(e,t){const{x:n=null,y:i=null}=e||{},r=t.points,s=[];return t.segments.forEach(({start:a,end:o})=>{o=Ro(a,o,r);const l=r[a],c=r[o];i!==null?(s.push({x:l.x,y:i}),s.push({x:c.x,y:i})):n!==null&&(s.push({x:n,y:l.y}),s.push({x:n,y:c.y}))}),s}function Ro(e,t,n){for(;t>e;t--){const i=n[t];if(!isNaN(i.x)&&!isNaN(i.y))break}return t}function Wc(e,t,n,i){return e&&t?i(e[n],t[n]):e?e[n]:t?t[n]:0}function Md(e,t){let n=[],i=!1;return Nt(e)?(i=!0,n=e):n=s_(e,t),n.length?new Pn({points:n,options:{tension:0},_loop:i,_fullLoop:i}):null}function Kc(e){return e&&e.fill!==!1}function a_(e,t,n){let r=e[t].fill;const s=[t];let a;if(!n)return r;for(;r!==!1&&s.indexOf(r)===-1;){if(!$t(r))return r;if(a=e[r],!a)return!1;if(a.visible)return r;s.push(r),r=a.fill}return!1}function o_(e,t,n){const i=f_(e);if(_t(i))return isNaN(i.value)?!1:i;let r=parseFloat(i);return $t(r)&&Math.floor(r)===r?l_(i[0],t,r,n):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function l_(e,t,n,i){return(e==="-"||e==="+")&&(n=t+n),n===t||n<0||n>=i?!1:n}function c_(e,t){let n=null;return e==="start"?n=t.bottom:e==="end"?n=t.top:_t(e)?n=t.getPixelForValue(e.value):t.getBasePixel&&(n=t.getBasePixel()),n}function u_(e,t,n){let i;return e==="start"?i=n:e==="end"?i=t.options.reverse?t.min:t.max:_t(e)?i=e.value:i=t.getBaseValue(),i}function f_(e){const t=e.options,n=t.fill;let i=xt(n&&n.target,n);return i===void 0&&(i=!!t.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function d_(e){const{scale:t,index:n,line:i}=e,r=[],s=i.segments,a=i.points,o=h_(t,n);o.push(Md({x:null,y:t.bottom},i));for(let l=0;l<s.length;l++){const c=s[l];for(let u=c.start;u<=c.end;u++)g_(r,a[u],o)}return new Pn({points:r,options:{}})}function h_(e,t){const n=[],i=e.getMatchingVisibleMetas("line");for(let r=0;r<i.length;r++){const s=i[r];if(s.index===t)break;s.hidden||n.unshift(s.dataset)}return n}function g_(e,t,n){const i=[];for(let r=0;r<n.length;r++){const s=n[r],{first:a,last:o,point:l}=v_(s,t,"x");if(!(!l||a&&o)){if(a)i.unshift(l);else if(e.push(l),!o)break}}e.push(...i)}function v_(e,t,n){const i=e.interpolate(t,n);if(!i)return{};const r=i[n],s=e.segments,a=e.points;let o=!1,l=!1;for(let c=0;c<s.length;c++){const u=s[c],h=a[u.start][n],d=a[u.end][n];if(an(r,h,d)){o=r===h,l=r===d;break}}return{first:o,last:l,point:i}}class Pd{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,n,i){const{x:r,y:s,radius:a}=this;return n=n||{start:0,end:wt},t.arc(r,s,a,n.end,n.start,!0),!i.bounds}interpolate(t){const{x:n,y:i,radius:r}=this,s=t.angle;return{x:n+Math.cos(s)*r,y:i+Math.sin(s)*r,angle:s}}}function m_(e){const{chart:t,fill:n,line:i}=e;if($t(n))return p_(t,n);if(n==="stack")return d_(e);if(n==="shape")return!0;const r=y_(e);return r instanceof Pd?r:Md(r,i)}function p_(e,t){const n=e.getDatasetMeta(t);return n&&e.isDatasetVisible(t)?n.dataset:null}function y_(e){return(e.scale||{}).getPointPositionForValue?x_(e):E_(e)}function E_(e){const{scale:t={},fill:n}=e,i=c_(n,t);if($t(i)){const r=t.isHorizontal();return{x:r?i:null,y:r?null:i}}return null}function x_(e){const{scale:t,fill:n}=e,i=t.options,r=t.getLabels().length,s=i.reverse?t.max:t.min,a=u_(n,t,s),o=[];if(i.grid.circular){const l=t.getPointPositionForValue(0,s);return new Pd({x:l.x,y:l.y,radius:t.getDistanceFromCenterForValue(a)})}for(let l=0;l<r;++l)o.push(t.getPointPositionForValue(l,a));return o}function fa(e,t,n){const i=m_(t),{line:r,scale:s,axis:a}=t,o=r.options,l=o.fill,c=o.backgroundColor,{above:u=c,below:h=c}=l||{};i&&r.points.length&&(Ds(e,n),b_(e,{line:r,target:i,above:u,below:h,area:n,scale:s,axis:a}),As(e))}function b_(e,t){const{line:n,target:i,above:r,below:s,area:a,scale:o}=t,l=n._loop?"angle":t.axis;e.save(),l==="x"&&s!==r&&(Hc(e,i,a.top),jc(e,{line:n,target:i,color:r,scale:o,property:l}),e.restore(),e.save(),Hc(e,i,a.bottom)),jc(e,{line:n,target:i,color:s,scale:o,property:l}),e.restore()}function Hc(e,t,n){const{segments:i,points:r}=t;let s=!0,a=!1;e.beginPath();for(const o of i){const{start:l,end:c}=o,u=r[l],h=r[Ro(l,c,r)];s?(e.moveTo(u.x,u.y),s=!1):(e.lineTo(u.x,n),e.lineTo(u.x,u.y)),a=!!t.pathSegment(e,o,{move:a}),a?e.closePath():e.lineTo(h.x,n)}e.lineTo(t.first().x,n),e.closePath(),e.clip()}function jc(e,t){const{line:n,target:i,property:r,color:s,scale:a}=t,o=r_(n,i,r);for(const{source:l,target:c,start:u,end:h}of o){const{style:{backgroundColor:d=s}={}}=l,y=i!==!0;e.save(),e.fillStyle=d,T_(e,a,y&&Na(r,u,h)),e.beginPath();const E=!!n.pathSegment(e,l);let L;if(y){E?e.closePath():Vc(e,i,h,r);const _=!!i.pathSegment(e,c,{move:E,reverse:!0});L=E&&_,L||Vc(e,i,u,r)}e.closePath(),e.fill(L?"evenodd":"nonzero"),e.restore()}}function T_(e,t,n){const{top:i,bottom:r}=t.chart.chartArea,{property:s,start:a,end:o}=n||{};s==="x"&&(e.beginPath(),e.rect(a,i,o-a,r-i),e.clip())}function Vc(e,t,n,i){const r=t.interpolate(n,i);r&&e.lineTo(r.x,r.y)}var __={id:"filler",afterDatasetsUpdate(e,t,n){const i=(e.data.datasets||[]).length,r=[];let s,a,o,l;for(a=0;a<i;++a)s=e.getDatasetMeta(a),o=s.dataset,l=null,o&&o.options&&o instanceof Pn&&(l={visible:e.isDatasetVisible(a),index:a,fill:o_(o,a,i),chart:e,axis:s.controller.options.indexAxis,scale:s.vScale,line:o}),s.$filler=l,r.push(l);for(a=0;a<i;++a)l=r[a],!(!l||l.fill===!1)&&(l.fill=a_(r,a,n.propagate))},beforeDraw(e,t,n){const i=n.drawTime==="beforeDraw",r=e.getSortedVisibleDatasetMetas(),s=e.chartArea;for(let a=r.length-1;a>=0;--a){const o=r[a].$filler;!o||(o.line.updateControlPoints(s,o.axis),i&&o.fill&&fa(e.ctx,o,s))}},beforeDatasetsDraw(e,t,n){if(n.drawTime!=="beforeDatasetsDraw")return;const i=e.getSortedVisibleDatasetMetas();for(let r=i.length-1;r>=0;--r){const s=i[r].$filler;Kc(s)&&fa(e.ctx,s,e.chartArea)}},beforeDatasetDraw(e,t,n){const i=t.meta.$filler;!Kc(i)||n.drawTime!=="beforeDatasetDraw"||fa(e.ctx,i,e.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const $c=(e,t)=>{let{boxHeight:n=t,boxWidth:i=t}=e;return e.usePointStyle&&(n=Math.min(n,t),i=e.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:n,itemHeight:Math.max(t,n)}},S_=(e,t)=>e!==null&&t!==null&&e.datasetIndex===t.datasetIndex&&e.index===t.index;class Gc extends Be{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n,i){this.maxWidth=t,this.maxHeight=n,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const t=this.options.labels||{};let n=Bt(t.generateLabels,[this.chart],this)||[];t.filter&&(n=n.filter(i=>t.filter(i,this.chart.data))),t.sort&&(n=n.sort((i,r)=>t.sort(i,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:t,ctx:n}=this;if(!t.display){this.width=this.height=0;return}const i=t.labels,r=Gt(i.font),s=r.size,a=this._computeTitleHeight(),{boxWidth:o,itemHeight:l}=$c(i,s);let c,u;n.font=r.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(a,s,o,l)+10):(u=this.maxHeight,c=this._fitCols(a,s,o,l)+10),this.width=Math.min(c,t.maxWidth||this.maxWidth),this.height=Math.min(u,t.maxHeight||this.maxHeight)}_fitRows(t,n,i,r){const{ctx:s,maxWidth:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=r+o;let h=t;s.textAlign="left",s.textBaseline="middle";let d=-1,y=-u;return this.legendItems.forEach((E,L)=>{const _=i+n/2+s.measureText(E.text).width;(L===0||c[c.length-1]+_+2*o>a)&&(h+=u,c[c.length-(L>0?0:1)]=0,y+=u,d++),l[L]={left:0,top:y,row:d,width:_,height:r},c[c.length-1]+=_+o}),h}_fitCols(t,n,i,r){const{ctx:s,maxHeight:a,options:{labels:{padding:o}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=a-t;let h=o,d=0,y=0,E=0,L=0;return this.legendItems.forEach((_,A)=>{const v=i+n/2+s.measureText(_.text).width;A>0&&y+r+2*o>u&&(h+=d+o,c.push({width:d,height:y}),E+=d+o,L++,d=y=0),l[A]={left:E,top:y,col:L,width:v,height:r},d=Math.max(d,v),y+=r+o}),h+=d,c.push({width:d,height:y}),h}adjustHitBoxes(){if(!this.options.display)return;const t=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:i,labels:{padding:r},rtl:s}}=this,a=gi(s,this.left,this.width);if(this.isHorizontal()){let o=0,l=ne(i,this.left+r,this.right-this.lineWidths[o]);for(const c of n)o!==c.row&&(o=c.row,l=ne(i,this.left+r,this.right-this.lineWidths[o])),c.top+=this.top+t+r,c.left=a.leftForLtr(a.x(l),c.width),l+=c.width+r}else{let o=0,l=ne(i,this.top+t+r,this.bottom-this.columnSizes[o].height);for(const c of n)c.col!==o&&(o=c.col,l=ne(i,this.top+t+r,this.bottom-this.columnSizes[o].height)),c.top=l,c.left+=this.left+r,c.left=a.leftForLtr(a.x(c.left),c.width),l+=c.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const t=this.ctx;Ds(t,this),this._draw(),As(t)}}_draw(){const{options:t,columnSizes:n,lineWidths:i,ctx:r}=this,{align:s,labels:a}=t,o=Lt.color,l=gi(t.rtl,this.left,this.width),c=Gt(a.font),{color:u,padding:h}=a,d=c.size,y=d/2;let E;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=c.string;const{boxWidth:L,boxHeight:_,itemHeight:A}=$c(a,d),v=function(p,g,m){if(isNaN(L)||L<=0||isNaN(_)||_<0)return;r.save();const D=xt(m.lineWidth,1);if(r.fillStyle=xt(m.fillStyle,o),r.lineCap=xt(m.lineCap,"butt"),r.lineDashOffset=xt(m.lineDashOffset,0),r.lineJoin=xt(m.lineJoin,"miter"),r.lineWidth=D,r.strokeStyle=xt(m.strokeStyle,o),r.setLineDash(xt(m.lineDash,[])),a.usePointStyle){const b={radius:_*Math.SQRT2/2,pointStyle:m.pointStyle,rotation:m.rotation,borderWidth:D},T=l.xPlus(p,L/2),P=g+y;Zf(r,b,T,P,a.pointStyleWidth&&L)}else{const b=g+Math.max((d-_)/2,0),T=l.leftForLtr(p,L),P=Qn(m.borderRadius);r.beginPath(),Object.values(P).some(M=>M!==0)?dr(r,{x:T,y:b,w:L,h:_,radius:P}):r.rect(T,b,L,_),r.fill(),D!==0&&r.stroke()}r.restore()},f=function(p,g,m){qn(r,m.text,p,g+A/2,c,{strikethrough:m.hidden,textAlign:l.textAlign(m.textAlign)})},x=this.isHorizontal(),S=this._computeTitleHeight();x?E={x:ne(s,this.left+h,this.right-i[0]),y:this.top+h+S,line:0}:E={x:this.left+h,y:ne(s,this.top+S+h,this.bottom-n[0].height),line:0},ad(this.ctx,t.textDirection);const C=A+h;this.legendItems.forEach((p,g)=>{r.strokeStyle=p.fontColor||u,r.fillStyle=p.fontColor||u;const m=r.measureText(p.text).width,D=l.textAlign(p.textAlign||(p.textAlign=a.textAlign)),b=L+y+m;let T=E.x,P=E.y;l.setWidth(this.width),x?g>0&&T+b+h>this.right&&(P=E.y+=C,E.line++,T=E.x=ne(s,this.left+h,this.right-i[E.line])):g>0&&P+C>this.bottom&&(T=E.x=T+n[E.line].width+h,E.line++,P=E.y=ne(s,this.top+S+h,this.bottom-n[E.line].height));const M=l.x(T);v(M,P,p),T=kE(D,T+L+y,x?T+b:this.right,t.rtl),f(l.x(T),P,p),x?E.x+=b+h:E.y+=C}),od(this.ctx,t.textDirection)}drawTitle(){const t=this.options,n=t.title,i=Gt(n.font),r=ae(n.padding);if(!n.display)return;const s=gi(t.rtl,this.left,this.width),a=this.ctx,o=n.position,l=i.size/2,c=r.top+l;let u,h=this.left,d=this.width;if(this.isHorizontal())d=Math.max(...this.lineWidths),u=this.top+c,h=ne(t.align,h,this.right-d);else{const E=this.columnSizes.reduce((L,_)=>Math.max(L,_.height),0);u=c+ne(t.align,this.top,this.bottom-E-t.labels.padding-this._computeTitleHeight())}const y=ne(o,h,h+d);a.textAlign=s.textAlign(To(o)),a.textBaseline="middle",a.strokeStyle=n.color,a.fillStyle=n.color,a.font=i.string,qn(a,n.text,y,u,i)}_computeTitleHeight(){const t=this.options.title,n=Gt(t.font),i=ae(t.padding);return t.display?n.lineHeight+i.height:0}_getLegendItemAt(t,n){let i,r,s;if(an(t,this.left,this.right)&&an(n,this.top,this.bottom)){for(s=this.legendHitBoxes,i=0;i<s.length;++i)if(r=s[i],an(t,r.left,r.left+r.width)&&an(n,r.top,r.top+r.height))return this.legendItems[i]}return null}handleEvent(t){const n=this.options;if(!L_(t.type,n))return;const i=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){const r=this._hoveredItem,s=S_(r,i);r&&!s&&Bt(n.onLeave,[t,r,this],this),this._hoveredItem=i,i&&!s&&Bt(n.onHover,[t,i,this],this)}else i&&Bt(n.onClick,[t,i,this],this)}}function L_(e,t){return!!((e==="mousemove"||e==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(e==="click"||e==="mouseup"))}var D_={id:"legend",_element:Gc,start(e,t,n){const i=e.legend=new Gc({ctx:e.ctx,options:n,chart:e});se.configure(e,i,n),se.addBox(e,i)},stop(e){se.removeBox(e,e.legend),delete e.legend},beforeUpdate(e,t,n){const i=e.legend;se.configure(e,i,n),i.options=n},afterUpdate(e){const t=e.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(e,t){t.replay||e.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(e,t,n){const i=t.datasetIndex,r=n.chart;r.isDatasetVisible(i)?(r.hide(i),t.hidden=!0):(r.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:e=>e.chart.options.color,boxWidth:40,padding:10,generateLabels(e){const t=e.data.datasets,{labels:{usePointStyle:n,pointStyle:i,textAlign:r,color:s}}=e.legend.options;return e._getSortedDatasetMetas().map(a=>{const o=a.controller.getStyle(n?0:void 0),l=ae(o.borderWidth);return{text:t[a.index].label,fillStyle:o.backgroundColor,fontColor:s,hidden:!a.visible,lineCap:o.borderCapStyle,lineDash:o.borderDash,lineDashOffset:o.borderDashOffset,lineJoin:o.borderJoinStyle,lineWidth:(l.width+l.height)/4,strokeStyle:o.borderColor,pointStyle:i||o.pointStyle,rotation:o.rotation,textAlign:r||o.textAlign,borderRadius:0,datasetIndex:a.index}},this)}},title:{color:e=>e.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:e=>!e.startsWith("on"),labels:{_scriptable:e=>!["generateLabels","filter","sort"].includes(e)}}};class Io extends Be{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,n){const i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=n;const r=Nt(i.text)?i.text.length:1;this._padding=ae(i.padding);const s=r*Gt(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){const{top:n,left:i,bottom:r,right:s,options:a}=this,o=a.align;let l=0,c,u,h;return this.isHorizontal()?(u=ne(o,i,s),h=n+t,c=s-i):(a.position==="left"?(u=i+t,h=ne(o,r,n),l=Kt*-.5):(u=s-t,h=ne(o,n,r),l=Kt*.5),c=r-n),{titleX:u,titleY:h,maxWidth:c,rotation:l}}draw(){const t=this.ctx,n=this.options;if(!n.display)return;const i=Gt(n.font),s=i.lineHeight/2+this._padding.top,{titleX:a,titleY:o,maxWidth:l,rotation:c}=this._drawArgs(s);qn(t,n.text,0,0,i,{color:n.color,maxWidth:l,rotation:c,textAlign:To(n.align),textBaseline:"middle",translation:[a,o]})}}function A_(e,t){const n=new Io({ctx:e.ctx,options:t,chart:e});se.configure(e,n,t),se.addBox(e,n),e.titleBlock=n}var C_={id:"title",_element:Io,start(e,t,n){A_(e,n)},stop(e){const t=e.titleBlock;se.removeBox(e,t),delete e.titleBlock},beforeUpdate(e,t,n){const i=e.titleBlock;se.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Ur=new WeakMap;var O_={id:"subtitle",start(e,t,n){const i=new Io({ctx:e.ctx,options:n,chart:e});se.configure(e,i,n),se.addBox(e,i),Ur.set(e,i)},stop(e){se.removeBox(e,Ur.get(e)),Ur.delete(e)},beforeUpdate(e,t,n){const i=Ur.get(e);se.configure(e,i,n),i.options=n},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Qi={average(e){if(!e.length)return!1;let t,n,i=0,r=0,s=0;for(t=0,n=e.length;t<n;++t){const a=e[t].element;if(a&&a.hasValue()){const o=a.tooltipPosition();i+=o.x,r+=o.y,++s}}return{x:i/s,y:r/s}},nearest(e,t){if(!e.length)return!1;let n=t.x,i=t.y,r=Number.POSITIVE_INFINITY,s,a,o;for(s=0,a=e.length;s<a;++s){const l=e[s].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=Oa(t,c);u<r&&(r=u,o=l)}}if(o){const l=o.tooltipPosition();n=l.x,i=l.y}return{x:n,y:i}}};function Ke(e,t){return t&&(Nt(t)?Array.prototype.push.apply(e,t):e.push(t)),e}function nn(e){return(typeof e=="string"||e instanceof String)&&e.indexOf(`
`)>-1?e.split(`
`):e}function M_(e,t){const{element:n,datasetIndex:i,index:r}=t,s=e.getDatasetMeta(i).controller,{label:a,value:o}=s.getLabelAndValue(r);return{chart:e,label:a,parsed:s.getParsed(r),raw:e.data.datasets[i].data[r],formattedValue:o,dataset:s.getDataset(),dataIndex:r,datasetIndex:i,element:n}}function zc(e,t){const n=e.chart.ctx,{body:i,footer:r,title:s}=e,{boxWidth:a,boxHeight:o}=t,l=Gt(t.bodyFont),c=Gt(t.titleFont),u=Gt(t.footerFont),h=s.length,d=r.length,y=i.length,E=ae(t.padding);let L=E.height,_=0,A=i.reduce((x,S)=>x+S.before.length+S.lines.length+S.after.length,0);if(A+=e.beforeBody.length+e.afterBody.length,h&&(L+=h*c.lineHeight+(h-1)*t.titleSpacing+t.titleMarginBottom),A){const x=t.displayColors?Math.max(o,l.lineHeight):l.lineHeight;L+=y*x+(A-y)*l.lineHeight+(A-1)*t.bodySpacing}d&&(L+=t.footerMarginTop+d*u.lineHeight+(d-1)*t.footerSpacing);let v=0;const f=function(x){_=Math.max(_,n.measureText(x).width+v)};return n.save(),n.font=c.string,Pt(e.title,f),n.font=l.string,Pt(e.beforeBody.concat(e.afterBody),f),v=t.displayColors?a+2+t.boxPadding:0,Pt(i,x=>{Pt(x.before,f),Pt(x.lines,f),Pt(x.after,f)}),v=0,n.font=u.string,Pt(e.footer,f),n.restore(),_+=E.width,{width:_,height:L}}function P_(e,t){const{y:n,height:i}=t;return n<i/2?"top":n>e.height-i/2?"bottom":"center"}function R_(e,t,n,i){const{x:r,width:s}=i,a=n.caretSize+n.caretPadding;if(e==="left"&&r+s+a>t.width||e==="right"&&r-s-a<0)return!0}function I_(e,t,n,i){const{x:r,width:s}=n,{width:a,chartArea:{left:o,right:l}}=e;let c="center";return i==="center"?c=r<=(o+l)/2?"left":"right":r<=s/2?c="left":r>=a-s/2&&(c="right"),R_(c,e,t,n)&&(c="center"),c}function Yc(e,t,n){const i=n.yAlign||t.yAlign||P_(e,n);return{xAlign:n.xAlign||t.xAlign||I_(e,t,n,i),yAlign:i}}function w_(e,t){let{x:n,width:i}=e;return t==="right"?n-=i:t==="center"&&(n-=i/2),n}function k_(e,t,n){let{y:i,height:r}=e;return t==="top"?i+=n:t==="bottom"?i-=r+n:i-=r/2,i}function Xc(e,t,n,i){const{caretSize:r,caretPadding:s,cornerRadius:a}=e,{xAlign:o,yAlign:l}=n,c=r+s,{topLeft:u,topRight:h,bottomLeft:d,bottomRight:y}=Qn(a);let E=w_(t,o);const L=k_(t,l,c);return l==="center"?o==="left"?E+=c:o==="right"&&(E-=c):o==="left"?E-=Math.max(u,d)+r:o==="right"&&(E+=Math.max(h,y)+r),{x:Qt(E,0,i.width-t.width),y:Qt(L,0,i.height-t.height)}}function Wr(e,t,n){const i=ae(n.padding);return t==="center"?e.x+e.width/2:t==="right"?e.x+e.width-i.right:e.x+i.left}function Qc(e){return Ke([],nn(e))}function F_(e,t,n){return Mn(e,{tooltip:t,tooltipItems:n,type:"tooltip"})}function Zc(e,t){const n=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return n?e.override(n):e}class Ua extends Be{constructor(t){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=t.chart||t._chart,this._chart=this.chart,this.options=t.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(t){this.options=t,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const t=this._cachedAnimations;if(t)return t;const n=this.chart,i=this.options.setContext(this.getContext()),r=i.enabled&&n.options.animation&&i.animations,s=new fd(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=F_(this.chart.getContext(),this,this._tooltipItems))}getTitle(t,n){const{callbacks:i}=n,r=i.beforeTitle.apply(this,[t]),s=i.title.apply(this,[t]),a=i.afterTitle.apply(this,[t]);let o=[];return o=Ke(o,nn(r)),o=Ke(o,nn(s)),o=Ke(o,nn(a)),o}getBeforeBody(t,n){return Qc(n.callbacks.beforeBody.apply(this,[t]))}getBody(t,n){const{callbacks:i}=n,r=[];return Pt(t,s=>{const a={before:[],lines:[],after:[]},o=Zc(i,s);Ke(a.before,nn(o.beforeLabel.call(this,s))),Ke(a.lines,o.label.call(this,s)),Ke(a.after,nn(o.afterLabel.call(this,s))),r.push(a)}),r}getAfterBody(t,n){return Qc(n.callbacks.afterBody.apply(this,[t]))}getFooter(t,n){const{callbacks:i}=n,r=i.beforeFooter.apply(this,[t]),s=i.footer.apply(this,[t]),a=i.afterFooter.apply(this,[t]);let o=[];return o=Ke(o,nn(r)),o=Ke(o,nn(s)),o=Ke(o,nn(a)),o}_createItems(t){const n=this._active,i=this.chart.data,r=[],s=[],a=[];let o=[],l,c;for(l=0,c=n.length;l<c;++l)o.push(M_(this.chart,n[l]));return t.filter&&(o=o.filter((u,h,d)=>t.filter(u,h,d,i))),t.itemSort&&(o=o.sort((u,h)=>t.itemSort(u,h,i))),Pt(o,u=>{const h=Zc(t.callbacks,u);r.push(h.labelColor.call(this,u)),s.push(h.labelPointStyle.call(this,u)),a.push(h.labelTextColor.call(this,u))}),this.labelColors=r,this.labelPointStyles=s,this.labelTextColors=a,this.dataPoints=o,o}update(t,n){const i=this.options.setContext(this.getContext()),r=this._active;let s,a=[];if(!r.length)this.opacity!==0&&(s={opacity:0});else{const o=Qi[i.position].call(this,r,this._eventPosition);a=this._createItems(i),this.title=this.getTitle(a,i),this.beforeBody=this.getBeforeBody(a,i),this.body=this.getBody(a,i),this.afterBody=this.getAfterBody(a,i),this.footer=this.getFooter(a,i);const l=this._size=zc(this,i),c=Object.assign({},o,l),u=Yc(this.chart,i,c),h=Xc(i,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,s={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:o.x,caretY:o.y}}this._tooltipItems=a,this.$context=void 0,s&&this._resolveAnimations().update(this,s),t&&i.external&&i.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(t,n,i,r){const s=this.getCaretPosition(t,i,r);n.lineTo(s.x1,s.y1),n.lineTo(s.x2,s.y2),n.lineTo(s.x3,s.y3)}getCaretPosition(t,n,i){const{xAlign:r,yAlign:s}=this,{caretSize:a,cornerRadius:o}=i,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:h}=Qn(o),{x:d,y}=t,{width:E,height:L}=n;let _,A,v,f,x,S;return s==="center"?(x=y+L/2,r==="left"?(_=d,A=_-a,f=x+a,S=x-a):(_=d+E,A=_+a,f=x-a,S=x+a),v=_):(r==="left"?A=d+Math.max(l,u)+a:r==="right"?A=d+E-Math.max(c,h)-a:A=this.caretX,s==="top"?(f=y,x=f-a,_=A-a,v=A+a):(f=y+L,x=f+a,_=A+a,v=A-a),S=f),{x1:_,x2:A,x3:v,y1:f,y2:x,y3:S}}drawTitle(t,n,i){const r=this.title,s=r.length;let a,o,l;if(s){const c=gi(i.rtl,this.x,this.width);for(t.x=Wr(this,i.titleAlign,i),n.textAlign=c.textAlign(i.titleAlign),n.textBaseline="middle",a=Gt(i.titleFont),o=i.titleSpacing,n.fillStyle=i.titleColor,n.font=a.string,l=0;l<s;++l)n.fillText(r[l],c.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+o,l+1===s&&(t.y+=i.titleMarginBottom-o)}}_drawColorBox(t,n,i,r,s){const a=this.labelColors[i],o=this.labelPointStyles[i],{boxHeight:l,boxWidth:c,boxPadding:u}=s,h=Gt(s.bodyFont),d=Wr(this,"left",s),y=r.x(d),E=l<h.lineHeight?(h.lineHeight-l)/2:0,L=n.y+E;if(s.usePointStyle){const _={radius:Math.min(c,l)/2,pointStyle:o.pointStyle,rotation:o.rotation,borderWidth:1},A=r.leftForLtr(y,c)+c/2,v=L+l/2;t.strokeStyle=s.multiKeyBackground,t.fillStyle=s.multiKeyBackground,Ra(t,_,A,v),t.strokeStyle=a.borderColor,t.fillStyle=a.backgroundColor,Ra(t,_,A,v)}else{t.lineWidth=_t(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,t.strokeStyle=a.borderColor,t.setLineDash(a.borderDash||[]),t.lineDashOffset=a.borderDashOffset||0;const _=r.leftForLtr(y,c-u),A=r.leftForLtr(r.xPlus(y,1),c-u-2),v=Qn(a.borderRadius);Object.values(v).some(f=>f!==0)?(t.beginPath(),t.fillStyle=s.multiKeyBackground,dr(t,{x:_,y:L,w:c,h:l,radius:v}),t.fill(),t.stroke(),t.fillStyle=a.backgroundColor,t.beginPath(),dr(t,{x:A,y:L+1,w:c-2,h:l-2,radius:v}),t.fill()):(t.fillStyle=s.multiKeyBackground,t.fillRect(_,L,c,l),t.strokeRect(_,L,c,l),t.fillStyle=a.backgroundColor,t.fillRect(A,L+1,c-2,l-2))}t.fillStyle=this.labelTextColors[i]}drawBody(t,n,i){const{body:r}=this,{bodySpacing:s,bodyAlign:a,displayColors:o,boxHeight:l,boxWidth:c,boxPadding:u}=i,h=Gt(i.bodyFont);let d=h.lineHeight,y=0;const E=gi(i.rtl,this.x,this.width),L=function(g){n.fillText(g,E.x(t.x+y),t.y+d/2),t.y+=d+s},_=E.textAlign(a);let A,v,f,x,S,C,p;for(n.textAlign=a,n.textBaseline="middle",n.font=h.string,t.x=Wr(this,_,i),n.fillStyle=i.bodyColor,Pt(this.beforeBody,L),y=o&&_!=="right"?a==="center"?c/2+u:c+2+u:0,x=0,C=r.length;x<C;++x){for(A=r[x],v=this.labelTextColors[x],n.fillStyle=v,Pt(A.before,L),f=A.lines,o&&f.length&&(this._drawColorBox(n,t,x,E,i),d=Math.max(h.lineHeight,l)),S=0,p=f.length;S<p;++S)L(f[S]),d=h.lineHeight;Pt(A.after,L)}y=0,d=h.lineHeight,Pt(this.afterBody,L),t.y-=s}drawFooter(t,n,i){const r=this.footer,s=r.length;let a,o;if(s){const l=gi(i.rtl,this.x,this.width);for(t.x=Wr(this,i.footerAlign,i),t.y+=i.footerMarginTop,n.textAlign=l.textAlign(i.footerAlign),n.textBaseline="middle",a=Gt(i.footerFont),n.fillStyle=i.footerColor,n.font=a.string,o=0;o<s;++o)n.fillText(r[o],l.x(t.x),t.y+a.lineHeight/2),t.y+=a.lineHeight+i.footerSpacing}}drawBackground(t,n,i,r){const{xAlign:s,yAlign:a}=this,{x:o,y:l}=t,{width:c,height:u}=i,{topLeft:h,topRight:d,bottomLeft:y,bottomRight:E}=Qn(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(o+h,l),a==="top"&&this.drawCaret(t,n,i,r),n.lineTo(o+c-d,l),n.quadraticCurveTo(o+c,l,o+c,l+d),a==="center"&&s==="right"&&this.drawCaret(t,n,i,r),n.lineTo(o+c,l+u-E),n.quadraticCurveTo(o+c,l+u,o+c-E,l+u),a==="bottom"&&this.drawCaret(t,n,i,r),n.lineTo(o+y,l+u),n.quadraticCurveTo(o,l+u,o,l+u-y),a==="center"&&s==="left"&&this.drawCaret(t,n,i,r),n.lineTo(o,l+h),n.quadraticCurveTo(o,l,o+h,l),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(t){const n=this.chart,i=this.$animations,r=i&&i.x,s=i&&i.y;if(r||s){const a=Qi[t.position].call(this,this._active,this._eventPosition);if(!a)return;const o=this._size=zc(this,t),l=Object.assign({},a,this._size),c=Yc(n,t,l),u=Xc(t,l,c,n);(r._to!==u.x||s._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=o.width,this.height=o.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(t){const n=this.options.setContext(this.getContext());let i=this.opacity;if(!i)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},s={x:this.x,y:this.y};i=Math.abs(i)<.001?0:i;const a=ae(n.padding),o=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&o&&(t.save(),t.globalAlpha=i,this.drawBackground(s,t,r,n),ad(t,n.textDirection),s.y+=a.top,this.drawTitle(s,t,n),this.drawBody(s,t,n),this.drawFooter(s,t,n),od(t,n.textDirection),t.restore())}getActiveElements(){return this._active||[]}setActiveElements(t,n){const i=this._active,r=t.map(({datasetIndex:o,index:l})=>{const c=this.chart.getDatasetMeta(o);if(!c)throw new Error("Cannot find a dataset at index "+o);return{datasetIndex:o,element:c.data[l],index:l}}),s=!is(i,r),a=this._positionChanged(r,n);(s||a)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(t,n,i=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,s=this._active||[],a=this._getActiveElements(t,s,n,i),o=this._positionChanged(a,t),l=n||!is(a,s)||o;return l&&(this._active=a,(r.enabled||r.external)&&(this._eventPosition={x:t.x,y:t.y},this.update(!0,n))),l}_getActiveElements(t,n,i,r){const s=this.options;if(t.type==="mouseout")return[];if(!r)return n;const a=this.chart.getElementsAtEventForMode(t,s.mode,s,i);return s.reverse&&a.reverse(),a}_positionChanged(t,n){const{caretX:i,caretY:r,options:s}=this,a=Qi[s.position].call(this,t,n);return a!==!1&&(i!==a.x||r!==a.y)}}Ua.positioners=Qi;var B_={id:"tooltip",_element:Ua,positioners:Qi,afterInit(e,t,n){n&&(e.tooltip=new Ua({chart:e,options:n}))},beforeUpdate(e,t,n){e.tooltip&&e.tooltip.initialize(n)},reset(e,t,n){e.tooltip&&e.tooltip.initialize(n)},afterDraw(e){const t=e.tooltip;if(t&&t._willRender()){const n={tooltip:t};if(e.notifyPlugins("beforeTooltipDraw",n)===!1)return;t.draw(e.ctx),e.notifyPlugins("afterTooltipDraw",n)}},afterEvent(e,t){if(e.tooltip){const n=t.replay;e.tooltip.handleEvent(t.event,n,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(e,t)=>t.bodyFont.size,boxWidth:(e,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:{beforeTitle:qe,title(e){if(e.length>0){const t=e[0],n=t.chart.data.labels,i=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return n[t.dataIndex]}return""},afterTitle:qe,beforeBody:qe,beforeLabel:qe,label(e){if(this&&this.options&&this.options.mode==="dataset")return e.label+": "+e.formattedValue||e.formattedValue;let t=e.dataset.label||"";t&&(t+=": ");const n=e.formattedValue;return At(n)||(t+=n),t},labelColor(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(e){const n=e.chart.getDatasetMeta(e.datasetIndex).controller.getStyle(e.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:qe,afterBody:qe,beforeFooter:qe,footer:qe,afterFooter:qe}},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:e=>e!=="filter"&&e!=="itemSort"&&e!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},N_=Object.freeze({__proto__:null,Decimation:i_,Filler:__,Legend:D_,SubTitle:O_,Title:C_,Tooltip:B_});const U_=(e,t,n,i)=>(typeof t=="string"?(n=e.push(t)-1,i.unshift({index:n,label:t})):isNaN(t)&&(n=null),n);function W_(e,t,n,i){const r=e.indexOf(t);if(r===-1)return U_(e,t,n,i);const s=e.lastIndexOf(t);return r!==s?n:r}const K_=(e,t)=>e===null?null:Qt(Math.round(e),0,t);class fs extends ei{constructor(t){super(t),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(t){const n=this._addedLabels;if(n.length){const i=this.getLabels();for(const{index:r,label:s}of n)i[r]===s&&i.splice(r,1);this._addedLabels=[]}super.init(t)}parse(t,n){if(At(t))return null;const i=this.getLabels();return n=isFinite(n)&&i[n]===t?n:W_(i,t,xt(n,t),this._addedLabels),K_(n,i.length-1)}determineDataLimits(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:i,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(t||(i=0),n||(r=this.getLabels().length-1)),this.min=i,this.max=r}buildTicks(){const t=this.min,n=this.max,i=this.options.offset,r=[];let s=this.getLabels();s=t===0&&n===s.length-1?s:s.slice(t,n+1),this._valueRange=Math.max(s.length-(i?0:1),1),this._startValue=this.min-(i?.5:0);for(let a=t;a<=n;a++)r.push({value:a});return r}getLabelForValue(t){const n=this.getLabels();return t>=0&&t<n.length?n[t]:t}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(t){return typeof t!="number"&&(t=this.parse(t)),t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getPixelForTick(t){const n=this.ticks;return t<0||t>n.length-1?null:this.getPixelForValue(n[t].value)}getValueForPixel(t){return Math.round(this._startValue+this.getDecimalForPixel(t)*this._valueRange)}getBasePixel(){return this.bottom}}fs.id="category";fs.defaults={ticks:{callback:fs.prototype.getLabelForValue}};function H_(e,t){const n=[],{bounds:r,step:s,min:a,max:o,precision:l,count:c,maxTicks:u,maxDigits:h,includeBounds:d}=e,y=s||1,E=u-1,{min:L,max:_}=t,A=!At(a),v=!At(o),f=!At(c),x=(_-L)/(h+1);let S=Yl((_-L)/E/y)*y,C,p,g,m;if(S<1e-14&&!A&&!v)return[{value:L},{value:_}];m=Math.ceil(_/S)-Math.floor(L/S),m>E&&(S=Yl(m*S/E/y)*y),At(l)||(C=Math.pow(10,l),S=Math.ceil(S*C)/C),r==="ticks"?(p=Math.floor(L/S)*S,g=Math.ceil(_/S)*S):(p=L,g=_),A&&v&&s&&CE((o-a)/s,S/1e3)?(m=Math.round(Math.min((o-a)/S,u)),S=(o-a)/m,p=a,g=o):f?(p=A?a:p,g=v?o:g,m=c-1,S=(g-p)/m):(m=(g-p)/S,zi(m,Math.round(m),S/1e3)?m=Math.round(m):m=Math.ceil(m));const D=Math.max(Xl(S),Xl(p));C=Math.pow(10,At(l)?D:l),p=Math.round(p*C)/C,g=Math.round(g*C)/C;let b=0;for(A&&(d&&p!==a?(n.push({value:a}),p<a&&b++,zi(Math.round((p+b*S)*C)/C,a,Jc(a,x,e))&&b++):p<a&&b++);b<m;++b)n.push({value:Math.round((p+b*S)*C)/C});return v&&d&&g!==o?n.length&&zi(n[n.length-1].value,o,Jc(o,x,e))?n[n.length-1].value=o:n.push({value:o}):(!v||g===o)&&n.push({value:g}),n}function Jc(e,t,{horizontal:n,minRotation:i}){const r=Me(i),s=(n?Math.sin(r):Math.cos(r))||.001,a=.75*t*(""+e).length;return Math.min(t/s,a)}class ds extends ei{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,n){return At(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){const{beginAtZero:t}=this.options,{minDefined:n,maxDefined:i}=this.getUserBounds();let{min:r,max:s}=this;const a=l=>r=n?r:l,o=l=>s=i?s:l;if(t){const l=Ye(r),c=Ye(s);l<0&&c<0?o(0):l>0&&c>0&&a(0)}if(r===s){let l=1;(s>=Number.MAX_SAFE_INTEGER||r<=Number.MIN_SAFE_INTEGER)&&(l=Math.abs(s*.05)),o(s+l),t||a(r-l)}this.min=r,this.max=s}getTickLimit(){const t=this.options.ticks;let{maxTicksLimit:n,stepSize:i}=t,r;return i?(r=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const t=this.options,n=t.ticks;let i=this.getTickLimit();i=Math.max(2,i);const r={maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},s=this._range||this,a=H_(r,s);return t.bounds==="ticks"&&Nf(a,this,"value"),t.reverse?(a.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),a}configure(){const t=this.ticks;let n=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){const r=(i-n)/Math.max(t.length-1,1)/2;n-=r,i+=r}this._startValue=n,this._endValue=i,this._valueRange=i-n}getLabelForValue(t){return Er(t,this.chart.options.locale,this.options.ticks.format)}}class wo extends ds{determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=$t(t)?t:0,this.max=$t(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const t=this.isHorizontal(),n=t?this.width:this.height,i=Me(this.options.ticks.minRotation),r=(t?Math.sin(i):Math.cos(i))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,s.lineHeight/r))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}}wo.id="linear";wo.defaults={ticks:{callback:ws.formatters.numeric}};function qc(e){return e/Math.pow(10,Math.floor(be(e)))===1}function j_(e,t){const n=Math.floor(be(t.max)),i=Math.ceil(t.max/Math.pow(10,n)),r=[];let s=Ee(e.min,Math.pow(10,Math.floor(be(t.min)))),a=Math.floor(be(s)),o=Math.floor(s/Math.pow(10,a)),l=a<0?Math.pow(10,Math.abs(a)):1;do r.push({value:s,major:qc(s)}),++o,o===10&&(o=1,++a,l=a>=0?1:l),s=Math.round(o*Math.pow(10,a)*l)/l;while(a<n||a===n&&o<i);const c=Ee(e.max,s);return r.push({value:c,major:qc(s)}),r}class ko extends ei{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,n){const i=ds.prototype.parse.apply(this,[t,n]);if(i===0){this._zero=!0;return}return $t(i)&&i>0?i:null}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!0);this.min=$t(t)?Math.max(0,t):null,this.max=$t(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:t,maxDefined:n}=this.getUserBounds();let i=this.min,r=this.max;const s=l=>i=t?i:l,a=l=>r=n?r:l,o=(l,c)=>Math.pow(10,Math.floor(be(l))+c);i===r&&(i<=0?(s(1),a(10)):(s(o(i,-1)),a(o(r,1)))),i<=0&&s(o(r,-1)),r<=0&&a(o(i,1)),this._zero&&this.min!==this._suggestedMin&&i===o(this.min,0)&&s(o(i,-1)),this.min=i,this.max=r}buildTicks(){const t=this.options,n={min:this._userMin,max:this._userMax},i=j_(n,this);return t.bounds==="ticks"&&Nf(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(t){return t===void 0?"0":Er(t,this.chart.options.locale,this.options.ticks.format)}configure(){const t=this.min;super.configure(),this._startValue=be(t),this._valueRange=be(this.max)-be(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(be(t)-this._startValue)/this._valueRange)}getValueForPixel(t){const n=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+n*this._valueRange)}}ko.id="logarithmic";ko.defaults={ticks:{callback:ws.formatters.logarithmic,major:{enabled:!0}}};function Wa(e){const t=e.ticks;if(t.display&&e.display){const n=ae(t.backdropPadding);return xt(t.font&&t.font.size,Lt.font.size)+n.height}return 0}function V_(e,t,n){return n=Nt(n)?n:[n],{w:ax(e,t.string,n),h:n.length*t.lineHeight}}function tu(e,t,n,i,r){return e===i||e===r?{start:t-n/2,end:t+n/2}:e<i||e>r?{start:t-n,end:t}:{start:t,end:t+n}}function $_(e){const t={l:e.left+e._padding.left,r:e.right-e._padding.right,t:e.top+e._padding.top,b:e.bottom-e._padding.bottom},n=Object.assign({},t),i=[],r=[],s=e._pointLabels.length,a=e.options.pointLabels,o=a.centerPointLabels?Kt/s:0;for(let l=0;l<s;l++){const c=a.setContext(e.getPointLabelContext(l));r[l]=c.padding;const u=e.getPointPosition(l,e.drawingArea+r[l],o),h=Gt(c.font),d=V_(e.ctx,h,e._pointLabels[l]);i[l]=d;const y=he(e.getIndexAngle(l)+o),E=Math.round(xo(y)),L=tu(E,u.x,d.w,0,180),_=tu(E,u.y,d.h,90,270);G_(n,t,y,L,_)}e.setCenterPoint(t.l-n.l,n.r-t.r,t.t-n.t,n.b-t.b),e._pointLabelItems=z_(e,i,r)}function G_(e,t,n,i,r){const s=Math.abs(Math.sin(n)),a=Math.abs(Math.cos(n));let o=0,l=0;i.start<t.l?(o=(t.l-i.start)/s,e.l=Math.min(e.l,t.l-o)):i.end>t.r&&(o=(i.end-t.r)/s,e.r=Math.max(e.r,t.r+o)),r.start<t.t?(l=(t.t-r.start)/a,e.t=Math.min(e.t,t.t-l)):r.end>t.b&&(l=(r.end-t.b)/a,e.b=Math.max(e.b,t.b+l))}function z_(e,t,n){const i=[],r=e._pointLabels.length,s=e.options,a=Wa(s)/2,o=e.drawingArea,l=s.pointLabels.centerPointLabels?Kt/r:0;for(let c=0;c<r;c++){const u=e.getPointPosition(c,o+a+n[c],l),h=Math.round(xo(he(u.angle+Vt))),d=t[c],y=Q_(u.y,d.h,h),E=Y_(h),L=X_(u.x,d.w,E);i.push({x:u.x,y,textAlign:E,left:L,top:y,right:L+d.w,bottom:y+d.h})}return i}function Y_(e){return e===0||e===180?"center":e<180?"left":"right"}function X_(e,t,n){return n==="right"?e-=t:n==="center"&&(e-=t/2),e}function Q_(e,t,n){return n===90||n===270?e-=t/2:(n>270||n<90)&&(e-=t),e}function Z_(e,t){const{ctx:n,options:{pointLabels:i}}=e;for(let r=t-1;r>=0;r--){const s=i.setContext(e.getPointLabelContext(r)),a=Gt(s.font),{x:o,y:l,textAlign:c,left:u,top:h,right:d,bottom:y}=e._pointLabelItems[r],{backdropColor:E}=s;if(!At(E)){const L=Qn(s.borderRadius),_=ae(s.backdropPadding);n.fillStyle=E;const A=u-_.left,v=h-_.top,f=d-u+_.width,x=y-h+_.height;Object.values(L).some(S=>S!==0)?(n.beginPath(),dr(n,{x:A,y:v,w:f,h:x,radius:L}),n.fill()):n.fillRect(A,v,f,x)}qn(n,e._pointLabels[r],o,l+a.lineHeight/2,a,{color:s.color,textAlign:c,textBaseline:"middle"})}}function Rd(e,t,n,i){const{ctx:r}=e;if(n)r.arc(e.xCenter,e.yCenter,t,0,wt);else{let s=e.getPointPosition(0,t);r.moveTo(s.x,s.y);for(let a=1;a<i;a++)s=e.getPointPosition(a,t),r.lineTo(s.x,s.y)}}function J_(e,t,n,i){const r=e.ctx,s=t.circular,{color:a,lineWidth:o}=t;!s&&!i||!a||!o||n<0||(r.save(),r.strokeStyle=a,r.lineWidth=o,r.setLineDash(t.borderDash),r.lineDashOffset=t.borderDashOffset,r.beginPath(),Rd(e,n,s,i),r.closePath(),r.stroke(),r.restore())}function q_(e,t,n){return Mn(e,{label:n,index:t,type:"pointLabel"})}class br extends ds{constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const t=this._padding=ae(Wa(this.options)/2),n=this.width=this.maxWidth-t.width,i=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+n/2+t.left),this.yCenter=Math.floor(this.top+i/2+t.top),this.drawingArea=Math.floor(Math.min(n,i)/2)}determineDataLimits(){const{min:t,max:n}=this.getMinMax(!1);this.min=$t(t)&&!isNaN(t)?t:0,this.max=$t(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Wa(this.options))}generateTickLabels(t){ds.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((n,i)=>{const r=Bt(this.options.pointLabels.callback,[n,i],this);return r||r===0?r:""}).filter((n,i)=>this.chart.getDataVisibility(i))}fit(){const t=this.options;t.display&&t.pointLabels.display?$_(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,n,i,r){this.xCenter+=Math.floor((t-n)/2),this.yCenter+=Math.floor((i-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,n,i,r))}getIndexAngle(t){const n=wt/(this._pointLabels.length||1),i=this.options.startAngle||0;return he(t*n+Me(i))}getDistanceFromCenterForValue(t){if(At(t))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*n:(t-this.min)*n}getValueForDistanceFromCenter(t){if(At(t))return NaN;const n=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(t){const n=this._pointLabels||[];if(t>=0&&t<n.length){const i=n[t];return q_(this.getContext(),t,i)}}getPointPosition(t,n,i=0){const r=this.getIndexAngle(t)-Vt+i;return{x:Math.cos(r)*n+this.xCenter,y:Math.sin(r)*n+this.yCenter,angle:r}}getPointPositionForValue(t,n){return this.getPointPosition(t,this.getDistanceFromCenterForValue(n))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){const{left:n,top:i,right:r,bottom:s}=this._pointLabelItems[t];return{left:n,top:i,right:r,bottom:s}}drawBackground(){const{backgroundColor:t,grid:{circular:n}}=this.options;if(t){const i=this.ctx;i.save(),i.beginPath(),Rd(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){const t=this.ctx,n=this.options,{angleLines:i,grid:r}=n,s=this._pointLabels.length;let a,o,l;if(n.pointLabels.display&&Z_(this,s),r.display&&this.ticks.forEach((c,u)=>{if(u!==0){o=this.getDistanceFromCenterForValue(c.value);const h=r.setContext(this.getContext(u-1));J_(this,h,o,s)}}),i.display){for(t.save(),a=s-1;a>=0;a--){const c=i.setContext(this.getPointLabelContext(a)),{color:u,lineWidth:h}=c;!h||!u||(t.lineWidth=h,t.strokeStyle=u,t.setLineDash(c.borderDash),t.lineDashOffset=c.borderDashOffset,o=this.getDistanceFromCenterForValue(n.ticks.reverse?this.min:this.max),l=this.getPointPosition(a,o),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(l.x,l.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){const t=this.ctx,n=this.options,i=n.ticks;if(!i.display)return;const r=this.getIndexAngle(0);let s,a;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(r),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((o,l)=>{if(l===0&&!n.reverse)return;const c=i.setContext(this.getContext(l)),u=Gt(c.font);if(s=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){t.font=u.string,a=t.measureText(o.label).width,t.fillStyle=c.backdropColor;const h=ae(c.backdropPadding);t.fillRect(-a/2-h.left,-s-u.size/2-h.top,a+h.width,u.size+h.height)}qn(t,o.label,0,-s,u,{color:c.color})}),t.restore()}drawTitle(){}}br.id="radialLinear";br.defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:ws.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}};br.defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};br.descriptors={angleLines:{_fallback:"grid"}};const Us={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},fe=Object.keys(Us);function tS(e,t){return e-t}function eu(e,t){if(At(t))return null;const n=e._adapter,{parser:i,round:r,isoWeekday:s}=e._parseOpts;let a=t;return typeof i=="function"&&(a=i(a)),$t(a)||(a=typeof i=="string"?n.parse(a,i):n.parse(a)),a===null?null:(r&&(a=r==="week"&&(xi(s)||s===!0)?n.startOf(a,"isoWeek",s):n.startOf(a,r)),+a)}function nu(e,t,n,i){const r=fe.length;for(let s=fe.indexOf(e);s<r-1;++s){const a=Us[fe[s]],o=a.steps?a.steps:Number.MAX_SAFE_INTEGER;if(a.common&&Math.ceil((n-t)/(o*a.size))<=i)return fe[s]}return fe[r-1]}function eS(e,t,n,i,r){for(let s=fe.length-1;s>=fe.indexOf(n);s--){const a=fe[s];if(Us[a].common&&e._adapter.diff(r,i,a)>=t-1)return a}return fe[n?fe.indexOf(n):0]}function nS(e){for(let t=fe.indexOf(e)+1,n=fe.length;t<n;++t)if(Us[fe[t]].common)return fe[t]}function iu(e,t,n){if(!n)e[t]=!0;else if(n.length){const{lo:i,hi:r}=bo(n,t),s=n[i]>=t?n[i]:n[r];e[s]=!0}}function iS(e,t,n,i){const r=e._adapter,s=+r.startOf(t[0].value,i),a=t[t.length-1].value;let o,l;for(o=s;o<=a;o=+r.add(o,1,i))l=n[o],l>=0&&(t[l].major=!0);return t}function ru(e,t,n){const i=[],r={},s=t.length;let a,o;for(a=0;a<s;++a)o=t[a],r[o]=a,i.push({value:o,major:!1});return s===0||!n?i:iS(e,i,r,n)}class Tr extends ei{constructor(t){super(t),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(t,n){const i=t.time||(t.time={}),r=this._adapter=new jb._date(t.adapters.date);r.init(n),Gi(i.displayFormats,r.formats()),this._parseOpts={parser:i.parser,round:i.round,isoWeekday:i.isoWeekday},super.init(t),this._normalized=n.normalized}parse(t,n){return t===void 0?null:eu(this,t)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const t=this.options,n=this._adapter,i=t.time.unit||"day";let{min:r,max:s,minDefined:a,maxDefined:o}=this.getUserBounds();function l(c){!a&&!isNaN(c.min)&&(r=Math.min(r,c.min)),!o&&!isNaN(c.max)&&(s=Math.max(s,c.max))}(!a||!o)&&(l(this._getLabelBounds()),(t.bounds!=="ticks"||t.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=$t(r)&&!isNaN(r)?r:+n.startOf(Date.now(),i),s=$t(s)&&!isNaN(s)?s:+n.endOf(Date.now(),i)+1,this.min=Math.min(r,s-1),this.max=Math.max(r+1,s)}_getLabelBounds(){const t=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,i=Number.NEGATIVE_INFINITY;return t.length&&(n=t[0],i=t[t.length-1]),{min:n,max:i}}buildTicks(){const t=this.options,n=t.time,i=t.ticks,r=i.source==="labels"?this.getLabelTimestamps():this._generate();t.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const s=this.min,a=this.max,o=RE(r,s,a);return this._unit=n.unit||(i.autoSkip?nu(n.minUnit,this.min,this.max,this._getLabelCapacity(s)):eS(this,o.length,n.minUnit,this.min,this.max)),this._majorUnit=!i.major.enabled||this._unit==="year"?void 0:nS(this._unit),this.initOffsets(r),t.reverse&&o.reverse(),ru(this,o,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(t=>+t.value))}initOffsets(t){let n=0,i=0,r,s;this.options.offset&&t.length&&(r=this.getDecimalForValue(t[0]),t.length===1?n=1-r:n=(this.getDecimalForValue(t[1])-r)/2,s=this.getDecimalForValue(t[t.length-1]),t.length===1?i=s:i=(s-this.getDecimalForValue(t[t.length-2]))/2);const a=t.length<3?.5:.25;n=Qt(n,0,a),i=Qt(i,0,a),this._offsets={start:n,end:i,factor:1/(n+1+i)}}_generate(){const t=this._adapter,n=this.min,i=this.max,r=this.options,s=r.time,a=s.unit||nu(s.minUnit,n,i,this._getLabelCapacity(n)),o=xt(s.stepSize,1),l=a==="week"?s.isoWeekday:!1,c=xi(l)||l===!0,u={};let h=n,d,y;if(c&&(h=+t.startOf(h,"isoWeek",l)),h=+t.startOf(h,c?"day":a),t.diff(i,n,a)>1e5*o)throw new Error(n+" and "+i+" are too far apart with stepSize of "+o+" "+a);const E=r.ticks.source==="data"&&this.getDataTimestamps();for(d=h,y=0;d<i;d=+t.add(d,o,a),y++)iu(u,d,E);return(d===i||r.bounds==="ticks"||y===1)&&iu(u,d,E),Object.keys(u).sort((L,_)=>L-_).map(L=>+L)}getLabelForValue(t){const n=this._adapter,i=this.options.time;return i.tooltipFormat?n.format(t,i.tooltipFormat):n.format(t,i.displayFormats.datetime)}_tickFormatFunction(t,n,i,r){const s=this.options,a=s.time.displayFormats,o=this._unit,l=this._majorUnit,c=o&&a[o],u=l&&a[l],h=i[n],d=l&&u&&h&&h.major,y=this._adapter.format(t,r||(d?u:c)),E=s.ticks.callback;return E?Bt(E,[y,n,i],this):y}generateTickLabels(t){let n,i,r;for(n=0,i=t.length;n<i;++n)r=t[n],r.label=this._tickFormatFunction(r.value,n,t)}getDecimalForValue(t){return t===null?NaN:(t-this.min)/(this.max-this.min)}getPixelForValue(t){const n=this._offsets,i=this.getDecimalForValue(t);return this.getPixelForDecimal((n.start+i)*n.factor)}getValueForPixel(t){const n=this._offsets,i=this.getDecimalForPixel(t)/n.factor-n.end;return this.min+i*(this.max-this.min)}_getLabelSize(t){const n=this.options.ticks,i=this.ctx.measureText(t).width,r=Me(this.isHorizontal()?n.maxRotation:n.minRotation),s=Math.cos(r),a=Math.sin(r),o=this._resolveTickFontOptions(0).size;return{w:i*s+o*a,h:i*a+o*s}}_getLabelCapacity(t){const n=this.options.time,i=n.displayFormats,r=i[n.unit]||i.millisecond,s=this._tickFormatFunction(t,0,ru(this,[t],this._majorUnit),r),a=this._getLabelSize(s),o=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return o>0?o:1}getDataTimestamps(){let t=this._cache.data||[],n,i;if(t.length)return t;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,i=r.length;n<i;++n)t=t.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(t)}getLabelTimestamps(){const t=this._cache.labels||[];let n,i;if(t.length)return t;const r=this.getLabels();for(n=0,i=r.length;n<i;++n)t.push(eu(this,r[n]));return this._cache.labels=this._normalized?t:this.normalize(t)}normalize(t){return Kf(t.sort(tS))}}Tr.id="time";Tr.defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",major:{enabled:!1}}};function Kr(e,t,n){let i=0,r=e.length-1,s,a,o,l;n?(t>=e[i].pos&&t<=e[r].pos&&({lo:i,hi:r}=on(e,"pos",t)),{pos:s,time:o}=e[i],{pos:a,time:l}=e[r]):(t>=e[i].time&&t<=e[r].time&&({lo:i,hi:r}=on(e,"time",t)),{time:s,pos:o}=e[i],{time:a,pos:l}=e[r]);const c=a-s;return c?o+(l-o)*(t-s)/c:o}class Fo extends Tr{constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const t=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(t);this._minPos=Kr(n,this.min),this._tableRange=Kr(n,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){const{min:n,max:i}=this,r=[],s=[];let a,o,l,c,u;for(a=0,o=t.length;a<o;++a)c=t[a],c>=n&&c<=i&&r.push(c);if(r.length<2)return[{time:n,pos:0},{time:i,pos:1}];for(a=0,o=r.length;a<o;++a)u=r[a+1],l=r[a-1],c=r[a],Math.round((u+l)/2)!==c&&s.push({time:c,pos:a/(o-1)});return s}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;const n=this.getDataTimestamps(),i=this.getLabelTimestamps();return n.length&&i.length?t=this.normalize(n.concat(i)):t=n.length?n:i,t=this._cache.all=t,t}getDecimalForValue(t){return(Kr(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){const n=this._offsets,i=this.getDecimalForPixel(t)/n.factor-n.end;return Kr(this._table,i*this._tableRange+this._minPos,!0)}}Fo.id="timeseries";Fo.defaults=Tr.defaults;var rS=Object.freeze({__proto__:null,CategoryScale:fs,LinearScale:wo,LogarithmicScale:ko,RadialLinearScale:br,TimeScale:Tr,TimeSeriesScale:Fo});const sS=[Hb,qT,N_,rS];Ve.register(...sS);const Ws=e=>(cn("data-v-a9b23cdf"),e=e(),un(),e),aS={key:0,class:"loader-holder"},oS={class:"twitch-analyze-container"},lS={key:0,class:"channel-info"},cS={class:"header-buttons"},uS={class:"info-each"},fS=Ws(()=>G("div",{class:"info-type"}," Channel ",-1)),dS={class:"info-data"},hS={class:"info-each"},gS=Ws(()=>G("div",{class:"info-type"}," Num Vods Analyzed ",-1)),vS={class:"info-data"},mS={key:0},pS={class:"info-each"},yS=Ws(()=>G("div",{class:"info-type"}," Average Vod Views ",-1)),ES={class:"info-data"},xS={class:"info-each"},bS=Ws(()=>G("div",{class:"info-type"}," Average Stream Length ",-1)),TS={class:"info-data"},_S={key:1,class:"click-tip"},SS={class:"chart-container chart-top"},LS={class:"chart-container"},DS={class:"chart-container"},AS={class:"chart-container"},CS={class:"chart-container"},OS={__name:"TwitchAnalyzeView",setup(e){const t=pr(),n=me(),i=100,r=ot(null),s=ot(null),a=ot(null),o=ot(null),l=ot(null),c=ot([]),u=ot(!0);ve(async()=>{await h(),c.value.length>i&&(c.value.length=i),Ve.defaults.color="#ffffff",_(r.value,"node.game.displayName","Categories"),_(s.value,"node.publishedAt","Days Streamed",!0),A(),v(),f(),u.value=!1});const h=async()=>{u.value=!0;const C=t.params.twitchChannelName;let p=null,g=null;for(console.log("channel: ",C);c.value.length<i;){g=Xt(Cf(C,p));const m=await fetch(de,g).then(D=>D.json());if(console.log(m),c.value.push(...m.data.user.videos.edges),c.value.length)p=c.value[c.value.length-1].cursor;else return;if(!p)return;console.log(c.value)}},d=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],y=C=>d[new Date(C).getDay()],E=(C,p)=>p.split(".").reduce((g,m)=>g&&g[m]?g[m]:null,C),L=C=>["rgba(255, 99, 132, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)","rgba(255, 159, 64, 1)","white","rgba(255, 99, 132, 0.5)","rgba(54, 162, 235, 0.5)","rgba(255, 206, 86, 0.5)","rgba(75, 192, 192, 0.5)","rgba(153, 102, 255, 0.5)","rgba(255, 159, 64, 0.5)"].slice(0,C),_=(C,p,g,m=!1)=>{let D={};for(const b of c.value){const T=m?y(E(b,p)):E(b,p);D[T]?D[T]+=1:D[T]=1}console.log(D),m&&(D=Object.assign(d.reduce((b,T)=>({...b,[T]:null}),{}),D)),new Ve(C,{type:"doughnut",data:{labels:Object.keys(D),datasets:[{label:g,data:Object.values(D),backgroundColor:L(Object.keys(D).length),borderColor:L(Object.keys(D).length)}]}})},A=()=>{const C=c.value.map(p=>({x:p.node.lengthSeconds,y:p.node.viewCount}));console.log(C),new Ve(a.value,{type:"scatter",data:{labels:C.map(p=>Pi(p.x)),datasets:[{label:"Vod Views",data:C,backgroundColor:"#a970ff"}]},options:{plugins:{title:{display:!0,text:"Vod Views vs Stream Length"},tooltip:{callbacks:{beforeLabel:p=>`(${Pi(p.raw.x)})`,label:p=>`Vod Views: ${Ce(p.raw.y)}`}}},scales:{x:{ticks:{callback:Pi}},y:{ticks:{callback:Ce}}}}})},v=()=>{const C=c.value.map(g=>g.node.viewCount).reverse(),p=c.value.map(g=>new Date(g.node.publishedAt).toLocaleDateString()).reverse();console.log(C,p),new Ve(o.value,{type:"bar",data:{labels:p,datasets:[{label:"Vod Views",data:C,backgroundColor:"#a970ff"}]},options:{plugins:{title:{display:!0,text:"Vod Views per Stream"},tooltip:{callbacks:{label:g=>`Vod Views: ${Ce(g.raw)}`}}},scales:{y:{ticks:{callback:Ce}}}}})},f=()=>{const C={};let p=null;for(const g of c.value.reverse()){p||(p=new Date(g.node.publishedAt));const m=new Date(g.node.publishedAt).toLocaleDateString(),D=g.node.lengthSeconds;if(C[m]===void 0){let b=0;for(;C[m]===void 0;)if(C[p.toLocaleDateString()]=0,p.setDate(p.getDate()+1),b++,b>100)return}C[m]+=D}console.log(C),new Ve(l.value,{type:"bar",data:{labels:Object.keys(C),datasets:[{label:"Stream Length",data:Object.values(C),backgroundColor:"#a970ff"}]},options:{plugins:{title:{display:!0,text:"Stream Length vs Date"},tooltip:{callbacks:{label:g=>Pi(g.raw)}}},scales:{y:{ticks:{callback:Pi}}}}})},x=()=>{const C=c.value.map(g=>g.node.viewCount),p=C.reduce((g,m)=>g+m,0)/C.length;return Ce(p)},S=()=>{const C=c.value.map(g=>g.node.lengthSeconds),p=C.reduce((g,m)=>g+m,0)/C.length;return fo(Math.round(p))};return(C,p)=>(st(),ct(Rt,null,[u.value?(st(),ct("div",aS,[pt(yo)])):Ot("",!0),G("div",oS,[u.value?Ot("",!0):(st(),ct("div",lS,[G("div",cS,[G("div",{class:"button",onClick:p[0]||(p[0]=g=>ht(n).go(-1))},"Back")]),G("div",uS,[fS,G("div",dS,mt(ht(t).params.twitchChannelName),1)]),G("div",hS,[gS,G("div",vS,[c.value.length<i?(st(),ct("span",mS,"(All available vods) ")):Ot("",!0),Se(mt(c.value.length),1)])]),G("div",pS,[yS,G("div",ES,mt(x()),1)]),G("div",xS,[bS,G("div",TS,mt(S()),1)])])),u.value?Ot("",!0):(st(),ct("div",_S,"click a category in legend to hide")),G("div",SS,[G("canvas",{ref_key:"gamesChart",ref:r,width:"400",height:"400"},null,512)]),G("div",LS,[G("canvas",{ref_key:"daysChart",ref:s,width:"400",height:"400"},null,512)]),G("div",DS,[G("canvas",{ref_key:"viewsChart",ref:a,width:"400",height:"400"},null,512)]),G("div",AS,[G("canvas",{ref_key:"viewsVsTimeChart",ref:o,width:"400",height:"400"},null,512)]),G("div",CS,[G("canvas",{ref_key:"streamLengthOverTimeChart",ref:l,width:"400",height:"400"},null,512)])])],64))}},MS=Ut(OS,[["__scopeId","data-v-a9b23cdf"]]);const Ci=e=>(cn("data-v-821a356a"),e=e(),un(),e),PS={key:0,class:"loader-holder"},RS={class:"channel-info"},IS={class:"header-buttons"},wS={key:0,class:"raw-data"},kS={key:1},FS={class:"info-each"},BS=Ci(()=>G("div",{class:"info-type"}," Channel ",-1)),NS={class:"info-data"},US={class:"info-each"},WS=Ci(()=>G("div",{class:"info-type"}," Sample Size ",-1)),KS={class:"info-data"},HS={key:0,class:"info-each"},jS=Ci(()=>G("div",{class:"info-type"}," Average Account Creation Date ",-1)),VS={class:"info-data"},$S={key:1,class:"info-each"},GS=Ci(()=>G("div",{class:"info-type"}," Common Name Length ",-1)),zS={class:"info-data"},YS={key:2,class:"info-each"},XS=Ci(()=>G("div",{class:"info-type"}," Most Common Name in Viewers ",-1)),QS={class:"info-data"},ZS={key:3,class:"info-each"},JS=Ci(()=>G("div",{class:"info-type red"}," Invalid Channel ",-1)),qS=[JS],t1={__name:"TwitchAnalyzeLiveView",setup(e){const i=pr(),r=me(),s=ot([]),a=ot([]),o=ot(""),l=ot(null),c=ot(!0),u=ot(!1),h=ot(""),d=ot(5),y=ot(!1),E=async()=>{var p;const v=i.params.twitchChannelName,f=await fetch(Ca(`http://tmi.twitch.tv/group/user/${v}/chatters`)).then(g=>g.json()),x=(p=f==null?void 0:f.chatters)==null?void 0:p.viewers;s.value=x;const S=Math.min(x.length,100),C=Array(S).fill(null).map(()=>Mm(i.params.twitchChannelName,x[Math.floor(Math.random()*x.length)]));for(let g=0;g<S;g+=35){const m=Xt(C.slice(g,g+35)),D=await fetch(de,m).then(b=>b.json());a.value=a.value.concat(D.map(b=>{var T,P;return new Date((P=(T=b==null?void 0:b.data)==null?void 0:T.targetUser)==null?void 0:P.createdAt).getTime()}))}a.value.sort()},L=()=>{if(!a.value.length)return;const v=[],f=new Date(a.value[0]).getFullYear();console.log(f);for(const S of a.value){const C=new Date(S).getFullYear()-f;v[C]?v[C]++:v[C]=1}const x=[];for(let S=0;S<v.length;S++)x[S]=String(S+f);console.log(x),new Ve(l.value,{type:"bar",data:{labels:x,datasets:[{label:"Current Viewers",data:v,backgroundColor:"#a970ff"}]},options:{plugins:{title:{display:!0,text:"Viewer Account Date Created"}}}})};ve(async()=>{c.value=!0,await E(),Ve.defaults.color="#ffffff",L(),c.value=!1,_()}),Re([s,d],()=>{A()});const _=()=>{let v=0;a.value.forEach(f=>v+=f),console.log(v,v/a.value.length),u.value=v==0,v!=0&&(o.value=new Date(v/a.value.length).toLocaleDateString("default"))},A=()=>{if(!s.value||!s.value.length)return;let v="",f="",x=0,S=0;for(const C of s.value){const p=C.substring(0,d.value);p.length<d.value||(p==f?S++:(S=0,f=p),S>x&&(x=S,v=f))}h.value=v||"'None'"};return(v,f)=>(st(),ct(Rt,null,[c.value?(st(),ct("div",PS,[pt(yo)])):Ot("",!0),G("div",RS,[G("div",IS,[G("div",{class:"back-button",onClick:f[0]||(f[0]=x=>ht(r).go(-1))},"Back"),G("div",{class:"data-button",onClick:f[1]||(f[1]=x=>y.value=!y.value)},mt(y.value?"Show Summary":"Show All"),1)]),y.value?(st(),ct("div",wS,mt(s.value),1)):(st(),ct("div",kS,[G("div",FS,[BS,G("div",NS,mt(ht(i).params.twitchChannelName),1)]),G("div",US,[WS,G("div",KS,mt(a.value.length),1)]),u.value?Ot("",!0):(st(),ct("div",HS,[jS,G("div",VS,mt(o.value),1)])),u.value?Ot("",!0):(st(),ct("div",$S,[GS,G("div",zS,[ce(G("input",{class:"number-input",type:"number","onUpdate:modelValue":f[2]||(f[2]=x=>d.value=x),min:"1"},null,512),[[li,d.value]])])])),u.value?(st(),ct("div",ZS,qS)):(st(),ct("div",YS,[XS,G("div",QS,mt(h.value),1)]))]))]),G("div",{class:"chart-container",style:Ge(y.value?"opacity: 0":"")},[G("canvas",{ref_key:"createdChart",ref:l,width:"400",height:"400"},null,512)],4)],64))}},e1=Ut(t1,[["__scopeId","data-v-821a356a"]]),n1={},i1={class:"svg-icon",style:{width:"1em",height:"1em","vertical-align":"middle",fill:"currentColor",overflow:"hidden"},viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},r1=G("path",{d:"M891.161 512l-749.992 450v-900l749.992 450z"},null,-1),s1=[r1];function a1(e,t){return st(),ct("svg",i1,s1)}const o1=Ut(n1,[["render",a1]]),l1={},c1={version:"1.1",id:"Layer_1",xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",x:"0px",y:"0px",viewBox:"0 0 511.955 511.955",style:{"enable-background":"new 0 0 511.955 511.955"},"xml:space":"preserve"},u1=G("g",null,[G("path",{d:`M511.813,254.103c-0.96-5.227-5.653-8.853-10.88-8.853H36.293l195.2-195.093c4.053-4.267,3.947-10.987-0.213-15.04
        c-4.16-3.947-10.667-3.947-14.827,0L3.12,248.45c-4.16,4.16-4.16,10.88,0,15.04l213.333,213.333
        c4.267,4.053,10.987,3.947,15.04-0.213c3.947-4.16,3.947-10.667,0-14.827l-195.2-195.2h464.96
        C507.76,266.583,512.88,260.717,511.813,254.103z`})],-1),f1=[u1];function d1(e,t){return st(),ct("svg",c1,f1)}const h1=Ut(l1,[["render",d1]]);const g1={class:"page-view"},v1={class:"clips-page"},m1={class:"video-container"},p1=["src"],y1={class:"clip-title"},E1={class:"clip-date"},x1={class:"clip-views"},b1={__name:"TwitchClipsView",setup(e){const n=pr(),i=me(),r=ot(null),s=ot([]),a=ot(0),o=ot(!1),l=ot(0),c=ot(null),u=ot(!1),h=ot(0);ve(async()=>{await y(),await E(),window.addEventListener("wheel",A),window.addEventListener("scroll",v),window.addEventListener("keydown",f)}),Di(()=>{window.removeEventListener("wheel",A),window.removeEventListener("scroll",v),window.removeEventListener("keydown",f)}),Re(()=>s.value[1],async()=>{c.value.length<2&&await Jr(),d()});const d=()=>{const m=s.value[1].source;c.value.forEach(D=>{D.src==m?(D.currentTime=0,D.play().then(()=>u.value=!1).catch(b=>{u.value=!0,console.log("play e-r")})):D.pause()})},y=async()=>{var b,T,P;const m=Xt(Hl(n.params.twitchChannelName)),D=await fetch(de,m).then(M=>M.json());console.log(D),r.value=(P=(T=(b=D==null?void 0:D.data)==null?void 0:b.user)==null?void 0:T.clips)==null?void 0:P.edges},E=async()=>{if(console.log(r.value),!!r.value){s.value.push({});for(const m in[0,1])await _(m),s.value.push(r.value[m]);_(2)}},L=m=>(m.includes("production.assets.clips.twitchcdn.net")||console.log(`error in converting clip src, origin not found:
`,m),m.replace("production.assets.clips.twitchcdn.net","clips-media-assets2.twitch.tv")),_=async m=>{const D=r.value[m].node.slug,b=Xt(Pm(D)),T=await fetch(de,b).then(M=>M.json()),P=L(T.data.clip.videoQualities[0].sourceURL);r.value[m].source=P},A=m=>{if(!r.value)return;const D=m.deltaY>0;S(D)},v=m=>{const D=window.pageYOffset||document.documentElement.scrollTop,b=D>h.value;h.value=D,S(b)},f=m=>{m.key=="ArrowDown"?S(!0):m.key=="ArrowUp"?S(!1):(m.key==" "||m.key=="k")&&p({target:c.value.filter(D=>D.src==s.value[1].source)[0]})},x=m=>{setTimeout(()=>{Date.now()-l.value>150?o.value=!1:x(300-(Date.now()-l.value))},m)},S=async m=>{if(l.value=Date.now(),!o.value)if(o.value=!0,x(300),m)s.value=s.value.slice(1),s.value.push(r.value[a.value+2]),a.value++,await C();else{if(a.value==0)return;s.value.unshift(a.value==1?{}:r.value[a.value-2]),Jr().then(()=>s.value.pop()),a.value--}},C=async()=>{var m,D,b;if(a.value==r.value.length-2){console.log("fetching next batch: ");const T=r.value[a.value+1].cursor;if(!T)return console.log("error, no cursor present");const P=Xt(Hl(n.params.twitchChannelName,T)),M=await fetch(de,P).then(O=>O.json());console.log(M),r.value.push(...(b=(D=(m=M==null?void 0:M.data)==null?void 0:m.user)==null?void 0:D.clips)==null?void 0:b.edges)}r.value[a.value+2].source||_(a.value+2)},p=m=>{m.target.paused?(u.value=!1,m.target.play()):(u.value=!0,m.target.pause())},g=()=>{i.options.history.state.back?i.back():i.push(`/twitch/${n.params.twitchChannelName}`)};return(m,D)=>(st(),ct("div",g1,[G("div",v1,[pt(ff,{name:"clip-flow"},{default:Sn(()=>[(st(!0),ct(Rt,null,Ie(s.value,b=>{var T,P,M,O;return st(),ct("div",{class:"clip-window",key:(b==null?void 0:b.source)||"empty"},[G("div",m1,[G("video",{class:"clip-video",src:b==null?void 0:b.source,controls:!1,autoplay:!1,loop:"","webkit-playsinline":"",playsinline:"",ref_for:!0,ref_key:"videoEls",ref:c,onClick:p,autobuffer:!0},null,8,p1),G("div",y1,mt((T=b==null?void 0:b.node)==null?void 0:T.title),1),G("div",E1,mt(ht(ho)((P=b==null?void 0:b.node)==null?void 0:P.createdAt)),1),G("div",x1,mt((M=b==null?void 0:b.node)!=null&&M.viewCount?`${ht(Ce)((O=b==null?void 0:b.node)==null?void 0:O.viewCount)} Views`:""),1),u.value?(st(),zt(o1,{key:0,class:"play-button"})):Ot("",!0)]),pt(h1,{class:"icon-back",onClick:g})])}),128))]),_:1})])]))}},T1=Ut(b1,[["__scopeId","data-v-f2437a80"]]);const _1={},S1={class:"container"};function L1(e,t){return st(),ct("div",S1,[(st(),ct(Rt,null,Ie(100,n=>G("div",{style:Ge(`font-size: ${n/2}px`)}," team@bazzled.com ",4)),64))])}const D1=Ut(_1,[["render",L1],["__scopeId","data-v-41b68ca9"]]),A1=Em({history:Fv("/"),routes:[{path:"/",name:"home",component:Ay},{path:"/twitch/:twitchChannelName?",name:"twitch",component:cE},{path:"/youtube",name:"youtubelive",component:pE},{path:"/hls",alias:["/hls/twitch/:twitchChannelName?","/hls/twitchvod/:twitchVodId?","/hls/yt/:ytWatchId?"],name:"hls",component:ty},{path:"/twitch/:twitchChannelName/analyze",name:"twitchAnalysis",component:MS},{path:"/twitch/:twitchChannelName/analyzelive/",name:"twitchLiveAnalysis",component:e1},{path:"/twitch/:twitchChannelName/clips",name:"twitchChannelClips",component:T1},{path:"/contact",name:"contact",component:D1}]});const Id=pv(bm);Id.use(A1);Id.mount("#app");
